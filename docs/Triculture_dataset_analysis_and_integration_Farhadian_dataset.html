<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Katharina Mikulik" />


<title>Triculture dataset</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Report</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Abstract</a>
</li>
<li>
  <a href="Introduction.html">Introduction</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Results
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="HIV_CSF_dataset_analysis.html">1. CSF/Blood samples</a>
    </li>
    <li>
      <a href="TF_activity_analysis_of_myeloid2_cluster.html">2. TF activity Myeloid2</a>
    </li>
    <li>
      <a href="Triculture_dataset_analysis_and_integration_Farhadian_dataset.html">3. Integration CSF/Blood &amp; triculture</a>
    </li>
    <li>
      <a href="Triculture_dataset_GRN_with_Scenic.html">4. TF activity iMg</a>
    </li>
  </ul>
</li>
<li>
  <a href="Discussion.html">Discussion</a>
</li>
<li>
  <a href="Methods.html">Methods</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Katharina782/report">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Triculture dataset</h1>
<h4 class="author">Katharina Mikulik</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-12-28
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 5 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 2
</p>
<p>
<strong>Knit directory:</strong> <code>report/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges"> <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges" class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of the R Markdown file created these results, you’ll want to first commit it to the Git repo. If you’re still working on the analysis, you can ignore this warning. When you’re finished, you can run <code>wflow_publish</code> to commit the R Markdown file and build the HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20211203code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20211203)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20211203code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20211203)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongdetected"> <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> <strong>Cache:</strong> detected </a>
</p>
</div>
<div id="strongCachestrongdetected" class="panel-collapse collapse">
<div class="panel-body">
The following chunks had caches available:
<ul>
<li>
session-info-chunk-inserted-by-workflowr
</li>
<li>
unnamed-chunk-1
</li>
<li>
unnamed-chunk-10
</li>
<li>
unnamed-chunk-11
</li>
<li>
unnamed-chunk-12
</li>
<li>
unnamed-chunk-13
</li>
<li>
unnamed-chunk-14
</li>
<li>
unnamed-chunk-15
</li>
<li>
unnamed-chunk-16
</li>
<li>
unnamed-chunk-17
</li>
<li>
unnamed-chunk-18
</li>
<li>
unnamed-chunk-19
</li>
<li>
unnamed-chunk-2
</li>
<li>
unnamed-chunk-20
</li>
<li>
unnamed-chunk-21
</li>
<li>
unnamed-chunk-22
</li>
<li>
unnamed-chunk-23
</li>
<li>
unnamed-chunk-24
</li>
<li>
unnamed-chunk-25
</li>
<li>
unnamed-chunk-26
</li>
<li>
unnamed-chunk-27
</li>
<li>
unnamed-chunk-28
</li>
<li>
unnamed-chunk-29
</li>
<li>
unnamed-chunk-3
</li>
<li>
unnamed-chunk-30
</li>
<li>
unnamed-chunk-31
</li>
<li>
unnamed-chunk-32
</li>
<li>
unnamed-chunk-33
</li>
<li>
unnamed-chunk-34
</li>
<li>
unnamed-chunk-35
</li>
<li>
unnamed-chunk-36
</li>
<li>
unnamed-chunk-37
</li>
<li>
unnamed-chunk-38
</li>
<li>
unnamed-chunk-39
</li>
<li>
unnamed-chunk-4
</li>
<li>
unnamed-chunk-40
</li>
<li>
unnamed-chunk-41
</li>
<li>
unnamed-chunk-42
</li>
<li>
unnamed-chunk-43
</li>
<li>
unnamed-chunk-44
</li>
<li>
unnamed-chunk-45
</li>
<li>
unnamed-chunk-46
</li>
<li>
unnamed-chunk-47
</li>
<li>
unnamed-chunk-48
</li>
<li>
unnamed-chunk-49
</li>
<li>
unnamed-chunk-5
</li>
<li>
unnamed-chunk-50
</li>
<li>
unnamed-chunk-51
</li>
<li>
unnamed-chunk-52
</li>
<li>
unnamed-chunk-53
</li>
<li>
unnamed-chunk-54
</li>
<li>
unnamed-chunk-55
</li>
<li>
unnamed-chunk-56
</li>
<li>
unnamed-chunk-57
</li>
<li>
unnamed-chunk-58
</li>
<li>
unnamed-chunk-6
</li>
<li>
unnamed-chunk-7
</li>
<li>
unnamed-chunk-8
</li>
<li>
unnamed-chunk-9
</li>
</ul>
<p>To ensure reproducibility of the results, delete the cache directory <code>Triculture_dataset_analysis_and_integration_Farhadian_dataset_cache</code> and re-run the analysis. To have workflowr automatically delete the cache directory prior to building the file, set <code>delete_cache = TRUE</code> when running <code>wflow_build()</code> or <code>wflow_publish()</code>.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKatharina782reporttree6c5f3b175db2cc63caa1ba67e59c08e1a22f412btargetblank6c5f3b1a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/Katharina782/report/tree/6c5f3b175db2cc63caa1ba67e59c08e1a22f412b" target="_blank">6c5f3b1</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKatharina782reporttree6c5f3b175db2cc63caa1ba67e59c08e1a22f412btargetblank6c5f3b1a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/Katharina782/report/tree/6c5f3b175db2cc63caa1ba67e59c08e1a22f412b" target="_blank">6c5f3b1</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    analysis/Independent_cell_type_identification_Farhadian_dataset_cache/
    Ignored:    analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset_cache/

Untracked files:
    Untracked:  README.html

Unstaged changes:
    Modified:   analysis/HIV_CSF_dataset_analysis.Rmd
    Modified:   analysis/Methods.Rmd
    Modified:   analysis/TF_activity_analysis_of_myeloid2_cluster.Rmd
    Modified:   analysis/Triculture_dataset_GRN_with_Scenic.Rmd
    Modified:   analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd</code>) and HTML (<code>docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/6c5f3b175db2cc63caa1ba67e59c08e1a22f412b/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">6c5f3b1</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-27
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/d2f59b2d133fb7c2394b97182e5052ef1e4aadd5/analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd" target="_blank">d2f59b2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-27
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/d2f59b2d133fb7c2394b97182e5052ef1e4aadd5/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">d2f59b2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-27
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/d85a63137b84a09c19647281ffe67edbcce2e1eb/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">d85a631</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/fdf25ce5decf9dff024fb0470f591b4a70f6aee6/analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd" target="_blank">fdf25ce</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/fdf25ce5decf9dff024fb0470f591b4a70f6aee6/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">fdf25ce</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/22c8da852024074e3acc07ff7b24979c64230432/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">22c8da8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/b5ca15af752c979d67e766665b32222bbc1cdb03/analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd" target="_blank">b5ca15a</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
wflow_publish(c(“analysis/HIV_CSF_dataset_analysis.Rmd,” “analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd”),
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/4b6fc54beba20e237901f4a0b2369f5ceb9cbd27/analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd" target="_blank">4b6fc54</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
updates
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/9597c36bc5a6df5f071249d97949566b2c7db870/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/40651d96647f10219a4aec953c8d618d57bc13f5/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/f7243f8882ef1868800d5f0e420f83d5e4ba39bb/analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd" target="_blank">f7243f8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/f7243f8882ef1868800d5f0e420f83d5e4ba39bb/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">f7243f8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/db265f0c6ad2025573eb49092eb0d5efa283267c/analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd" target="_blank">db265f0</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(“analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd”)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/8979e1abf82cc2b12f5f7751155bf4fc7d0b5ed4/docs/Triculture_dataset_analysis_and_integration_Farhadian_dataset.html" target="_blank">8979e1a</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-17
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/cfbba705d93776f304478e5a62d9bbd6d4aaf007/analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd" target="_blank">cfbba70</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-17
</td>
<td>
wflow_publish(files = rmd)
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/e87fa963caeed78821ac7f482359072ce58b8529/analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd" target="_blank">e87fa96</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
<td>
new files
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
<td>
recent updates
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<style>
body {
text-align: justify}
</style>
<pre class="r"><code>knitr::opts_chunk$set(echo = TRUE, collapse = TRUE, message = FALSE,
                      cache = TRUE, cache.lazy = FALSE, autodep = TRUE)
set.seed(42) # TODO: check with default seed</code></pre>
<pre class="r"><code>library(tidyverse)
library(Seurat)
library(edgeR)
library(Matrix)
library(data.table)
library(ggrepel)
#library(harmony)
library(RColorBrewer)
library(pheatmap)
library(ggcorrplot)
library(ComplexHeatmap)
library(circlize)
library(ggpubr)
library(gridExtra)
library(corrplot)
library(rstatix)
library(knitr)
library(metap)
library(multtest)
library(readxl)</code></pre>
<div id="triculture-dataset" class="section level1">
<h1>Triculture Dataset</h1>
<p>The triculture dataset used was published by <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>. They used a Triculture system with induced neurons, induced astrocytes and induced microglia. Induced microglia express marker genes CX3CR1, IBA1, TMEM119 and P2RY12. CCR5 which is a co-receptor necessary for HIV infection is also expressed by these cells, but they lack expression of myeloid-progenitor markers <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>.</p>
<p>iMg were infected with HIV for 15 days (resulting in 94% of cells infected, positive for HIV capsid protein p24 and exhibiting multinucleation). Some cells were treated with the ART EFZ. EFZ blocks HIV reverse transcription. This way it was possible to study non-productively infected cells. EFZ reduced infection by two thirds <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>.</p>
<p>In the infected, but not treated iMg (Inf) inflammatory pathways were significantly uperegulated compared to the uninfected condition(Uninf), including IL-8, NFkB and EIF2. There was decreased expression of pro-imflammatory genes IL1b, Il8 and TNFalpha in the infected and treated (Inf+EFZ) vs Inf condition. This suggests a reduced inflammatory reaction <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>. Nevertheless, there were two distinct pathways which were upregulated in Inf+EFZ iMg, namely RhoGDI signaling and CD40 signaling pathway. This will be discussed in more detail later on <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>.</p>
<p>There was a change in signaling pathways caused by EFZ treatment even in the uninfected and treated (Uninf+EFZ) versus the uninfected, but not treated (Uninf) condition. The EFZ treatment alone was very different from the EFZ treatment with infection <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>.</p>
<details>
<summary>
<strong>Files and data structure</strong>
</summary>
<p><strong>Read in Files:</strong></p>
<p>abbreviations:</p>
<ul>
<li>ia/2 = infected with HIV + treated with ART</li>
<li>ca = uninfected + ART</li>
<li>ctl = uninfected</li>
<li>inf = infected</li>
</ul>
<p>file structure:</p>
<ul>
<li>the “.mtx” files contains a sparse matrix of class dgTMatrix</li>
<li>the “barcodes.tsv” files contain the cell barcodes</li>
<li>the “features.tsv” files contain the feature names as well as ensemble gene ids and “gene expression” strings in a third column</li>
</ul>
<p>There are duplicated features in the data. How do you deal with this problem? (probably, because there are multiple ensemble gene IDs mapping to the same gene symbol -&gt; the same gene symbol has multiple expression values)</p>
<ul>
<li>You could make them unique with the function <code>make.unique()</code></li>
<li>You could remove the duplicated features -&gt; this is what I did</li>
</ul>
<pre><code>path &lt;- &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/GSE143686_RAW/&quot; #&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/GSE143686_RAW/&quot;
all_files &lt;- list.files(path)

all_cond_list &lt;- map(seq.int(3,7), function(n){
  file &lt;- all_files[grepl(paste0(&quot;GSM427258&quot;, n), all_files)]
  name &lt;- str_extract(file[[1]],&quot;ca|ctl|ia2|ia|inf&quot;)
  barcodes &lt;- read.table(paste0(path,file[[1]]), sep = &quot;\t&quot;) 
  features &lt;- read.table(paste0(path, file[[2]]), sep = &quot;\t&quot;)
  matrix &lt;- readMM(paste0(path, file[[3]]))
  colnames(matrix) &lt;- barcodes$V1
  rownames(matrix) &lt;- features$V2
  matrix &lt;- matrix[!duplicated(rownames(matrix)),]
  seurat_ob &lt;- CreateSeuratObject(matrix, project = name,
                                  assay = &quot;RNA&quot;, min.cells = 1, min.features = 1)
  seurat_ob[[&quot;percent_mt&quot;]] &lt;- PercentageFeatureSet(seurat_ob, pattern = &quot;^MT-&quot;)
  list(name = name, count = matrix, seurat_ob = seurat_ob)
})

#saveRDS(all_cond_list, &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/seurat_list&quot;)</code></pre>
<hr />
</details>
</div>
<div id="data-processing" class="section level1 tabset">
<h1 class="tabset">Data processing</h1>
<div id="before-quality-control" class="section level2">
<h2>Before Quality Control:</h2>
<pre class="r"><code>all_cond_list &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/seurat_list&quot;)

before_qc &lt;- merge(all_cond_list[[1]]$seurat_ob,
                    c(all_cond_list[[2]]$seurat_ob,
                      all_cond_list[[3]]$seurat_ob,
                      all_cond_list[[4]]$seurat_ob,
                      all_cond_list[[5]]$seurat_ob),
                    project = &quot;triculture_all_conditions&quot;,
                    add.cell.ids = c(paste0(all_cond_list[[1]]$name),
                                     paste0(all_cond_list[[2]]$name),
                                     paste0(all_cond_list[[3]]$name),
                                     paste0(all_cond_list[[4]]$name),
                                     paste0(all_cond_list[[5]]$name)))</code></pre>
<pre class="r"><code>qual_metric &lt;- c(&quot;nFeature_RNA&quot;, &quot;nCount_RNA&quot;, &quot;percent_mt&quot;)

plots &lt;- map(qual_metric, function(metric){
  ggplot() +
    geom_violin(aes(x = before_qc@meta.data %&gt;% pull(&quot;orig.ident&quot;),
                 y = before_qc@meta.data %&gt;% pull(metric), 
                 fill = before_qc@meta.data %&gt;% pull(&quot;orig.ident&quot;)), 
                alpha = .5) +
    geom_boxplot(aes(x = before_qc@meta.data %&gt;% pull(&quot;orig.ident&quot;),
                     y = before_qc@meta.data %&gt;% pull(metric)),
                 alpha = 0) +
    xlab(&quot;sample origin&quot;) +
    ylab(paste0(metric)) +
    NoLegend() 
})

do.call(grid.arrange, c(plots, ncol = 3, nrow = 1))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-3-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-1">
Past versions of unnamed-chunk-3-1.png
</button>
</p>
<div id="fig-unnamed-chunk-3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-3-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-3-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-3-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="after-quality-control" class="section level2">
<h2>After quality control</h2>
<p>For each sample separately</p>
<ul>
<li>remove genes expressing less than 200 genes or more than 5000</li>
<li>remove cells expressing more than 20% mitochondrial genes</li>
<li>merge Seurat objects after Quality Control</li>
</ul>
<pre class="r"><code># add percentage of mitochondiral genes to metadata
all_cond &lt;- map(seq.int(1,5), function(n){
  seurat_ob &lt;- all_cond_list[[n]]$seurat_ob
  #seurat_ob[[&quot;percent_mt&quot;]] &lt;- PercentageFeatureSet(seurat_ob, pattern = &quot;^MT-&quot;)
  #plot &lt;- VlnPlot(seurat_ob,
   #               features = c(&quot;nFeature_RNA&quot;, &quot;percent_mt&quot;, &quot;nCount_RNA&quot;),
    #              ncol = 3) +
    #labs(title = paste0(&quot;condition &quot;, all_cond_list[[n]]$name))
  seurat_ob &lt;- subset(seurat_ob, nFeature_RNA &gt; 200 &amp; nFeature_RNA &lt; 5000 &amp; percent_mt &lt; 20)
  list(name = all_cond_list[[n]]$name, seurat_ob = seurat_ob)#, plot = plot)
})</code></pre>
<pre class="r"><code>triculture &lt;- merge(all_cond[[1]]$seurat_ob,
                    c(all_cond[[2]]$seurat_ob,
                      all_cond[[3]]$seurat_ob,
                      all_cond[[4]]$seurat_ob,
                      all_cond[[5]]$seurat_ob),
                    project = &quot;triculture_all_conditions&quot;,
                    add.cell.ids = c(paste0(all_cond[[1]]$name),
                                     paste0(all_cond[[2]]$name),
                                     paste0(all_cond[[3]]$name),
                                     paste0(all_cond[[4]]$name),
                                     paste0(all_cond[[5]]$name)))</code></pre>
<pre class="r"><code>qual_metric &lt;- c(&quot;nFeature_RNA&quot;, &quot;nCount_RNA&quot;, &quot;percent_mt&quot;)

plots &lt;- map(qual_metric, function(metric){
  ggplot() +
    geom_violin(aes(x = triculture@meta.data %&gt;% pull(&quot;orig.ident&quot;),
                 y = triculture@meta.data %&gt;% pull(metric), 
                 fill = triculture@meta.data %&gt;% pull(&quot;orig.ident&quot;)), 
                alpha = .5) +
    geom_boxplot(aes(x = triculture@meta.data %&gt;% pull(&quot;orig.ident&quot;),
                     y = triculture@meta.data %&gt;% pull(metric)),
                 alpha = 0) +
    xlab(&quot;sample origin&quot;) +
    ylab(paste0(metric)) +
    NoLegend() 
})

do.call(grid.arrange, c(plots, ncol = 3, nrow = 1))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-6-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-6-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-6-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-6-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="normalization-scaling-find-variable-features" class="section level2">
<h2>Normalization, Scaling, Find Variable Features</h2>
<ul>
<li>log normalization</li>
<li>scale data so that we have mean = 0 and variance = 1</li>
<li>Find the 2000 most highly variable features</li>
</ul>
<pre><code>triculture &lt;- NormalizeData(triculture, verbose = FALSE)
triculture &lt;- ScaleData(triculture, verbose = FALSE)
triculture &lt;- FindVariableFeatures(triculture, verbose = FALSE)</code></pre>
</div>
<div id="dimensionality-reduction" class="section level2">
<h2>Dimensionality reduction</h2>
<ul>
<li>compute PCA</li>
<li>use elbow plot to determine dimensions that contribute to variability</li>
<li>find the k-nearest neighbors</li>
<li>find Clusters based on KNN-graph</li>
<li>calculate TSNE embedding</li>
</ul>
<pre><code>triculture &lt;- RunPCA(triculture, features = VariableFeatures(triculture), verbose = FALSE)
ElbowPlot(triculture)

triculture &lt;- FindNeighbors(triculture, verbose = FALSE)
triculture &lt;- FindClusters(triculture, verbose = FALSE)

triculture &lt;- RunTSNE(triculture, dims = 1:10, verbose = FALSE)</code></pre>
<pre class="r"><code>triculture &lt;- readRDS(&quot;seurat_objects/triculture_seurat_object&quot;)

#triculture &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/triculture_seurat_object&quot;)

DimPlot(triculture, reduction = &quot;tsne&quot;, pt.size = .01,label = TRUE,
        group.by = &quot;seurat_clusters&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-7-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-7-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-7-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cell-type-annotation" class="section level2">
<h2>Cell type annotation</h2>
<p>For annotating the different clusters the same markers as in <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span> were used:</p>
<ul>
<li><em>Microglia:</em> AIF1, SPI1, CD4</li>
<li><em>Astrocytes:</em> SOX9, THBS1</li>
<li><em>Neurons:</em> SYN1, MAP2</li>
</ul>
<pre class="r"><code>#markers &lt;- FindAllMarkers(triculture)
#triculture &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/triculture_seurat_object&quot;)
markers &lt;- read.table(&quot;data_files/marker_genes_triculture_dataset&quot;)
#markers &lt;- read.table(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/marker_genes_triculture_dataset&quot;)

top_2 &lt;- markers %&gt;% group_by(&quot;seurat_cluster&quot;) %&gt;% top_n(n = 2, wt = avg_log2FC)

marker_genes &lt;- c(&quot;AIF1&quot;, &quot;SPI1&quot;, &quot;CD4&quot;, &quot;MAP2&quot;, &quot;SYN1&quot;, &quot;THBS1&quot;, &quot;SOX9&quot;)
p1 &lt;- FeaturePlot(triculture, features = &quot;AIF1&quot;)
p2 &lt;- FeaturePlot(triculture, features = &quot;SPI1&quot;)
p3 &lt;- FeaturePlot(triculture, features = &quot;CD4&quot;)
p4 &lt;- FeaturePlot(triculture, features = &quot;MAP2&quot;)
p5 &lt;- FeaturePlot(triculture, features = &quot;SYN1&quot;)
p6 &lt;- FeaturePlot(triculture, features = &quot;THBS1&quot;)
p7 &lt;- FeaturePlot(triculture, features = &quot;SOX9&quot;)

ggarrange(p1,p2,p3,p4,p5,p6,p7, ncol = 2, nrow =4 )</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-8-1">
Past versions of unnamed-chunk-8-1.png
</button>
</p>
<div id="fig-unnamed-chunk-8-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-8-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-8-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-8-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>
<strong>Details on cell type annotation</strong>
</summary>
<p><strong>Gene expression</strong></p>
<p>Different clusters were annotated according to the gene expression of marker genes mentioned above.</p>
<pre class="r"><code>
VlnPlot(triculture, features = c(&quot;CD4&quot;, &quot;SPI1&quot;, &quot;AIF1&quot;), group.by = &quot;seurat_clusters&quot;)#, group.by = seurat_cluster)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-9-1">
Past versions of unnamed-chunk-9-1.png
</button>
</p>
<div id="fig-unnamed-chunk-9-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>VlnPlot(triculture, features = c(&quot;MAP2&quot;, &quot;SYN1&quot;), group.by = &quot;seurat_clusters&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-2.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-9-2">
Past versions of unnamed-chunk-9-2.png
</button>
</p>
<div id="fig-unnamed-chunk-9-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-2.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-2.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-2.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>VlnPlot(triculture, features = c(&quot;THBS1&quot;, &quot;SOX9&quot;), group.by = &quot;seurat_clusters&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-3.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-9-3">
Past versions of unnamed-chunk-9-3.png
</button>
</p>
<div id="fig-unnamed-chunk-9-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-3.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-3.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-9-3.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># 4, 9, 11, 18 = Microglia
# 0, 1, 2, 3,8, 10, 13, 15, 18, 19 = Neurons 
# 6, 7, 12, 14, 16 = Astrocytes
# 5, 17 are undesginated
cell_types &lt;- (triculture@meta.data %&gt;% 
  mutate(cell_type = ifelse(seurat_clusters %in% c(4,9,11), &quot;iMg&quot;, 
                            ifelse(seurat_clusters %in% c(6,7,12,14,16), &quot;iAst&quot;, 
                                   ifelse(seurat_clusters %in% 
                                            c(0,1,2,3,8,10,13,15,18,19), 
                                          &quot;iNeurons&quot;, &quot;Undesignated&quot;)))))[[&quot;cell_type&quot;]]
  
triculture &lt;- AddMetaData(triculture, cell_types, col.name = &quot;cell_type&quot;)</code></pre>
<hr />
</details>
<hr />
</div>
</div>
<div id="exploring-the-dataset" class="section level1">
<h1>Exploring the dataset</h1>
<div id="remove-undesignated-cells" class="section level3">
<h3>Remove undesignated cells</h3>
<p>There is one group of cells where it is not clear which cell state they represent (Undesignated), we will exclude them from further analysis as <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span> did.</p>
<pre class="r"><code>p1 &lt;- DimPlot(triculture, reduction = &quot;tsne&quot;, pt.size = .01, label = TRUE,
        group.by = &quot;cell_type&quot;)</code></pre>
<pre class="r"><code>triculture_clean &lt;- subset(triculture, cell_type %in% c(&quot;iMg&quot;, &quot;iNeurons&quot;, &quot;iAst&quot;)) </code></pre>
<pre class="r"><code>p2 &lt;- DimPlot(triculture_clean, reduction = &quot;tsne&quot;, pt.size = .01, label = TRUE,
        group.by = &quot;cell_type&quot;)</code></pre>
<pre class="r"><code>p1+p2</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-14-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-14-1">
Past versions of unnamed-chunk-14-1.png
</button>
</p>
<div id="fig-unnamed-chunk-14-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-14-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-14-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-14-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>
<strong>Heatmap of top 20 marker genes for each cell type</strong>
</summary>
<p>Top20 marker genes for each cell cell type:</p>
<pre class="r"><code>Idents(triculture_clean) &lt;- &quot;cell_type&quot;
top_n &lt;- markers %&gt;% group_by (cluster) %&gt;% top_n(n = 20, wt = avg_log2FC)
DoHeatmap(triculture_clean, features = top_n$gene)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-15-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-15-1">
Past versions of unnamed-chunk-15-1.png
</button>
</p>
<div id="fig-unnamed-chunk-15-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-15-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-15-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-15-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</details>
<details>
<summary>
<strong>Number of cells per condition and cell type</strong>
</summary>
<p>How many cells of each cell type and condition are present in the dataset?</p>
<pre class="r"><code>triculture_clean@meta.data %&gt;% group_by(cell_type, orig.ident) %&gt;% 
  summarize(n = n()) %&gt;% 
  mutate(orig.ident = case_when(
                      orig.ident %in% c(&quot;ia&quot;, &quot;ia2&quot;) ~ &quot;Inf+EFZ&quot;, 
                      orig.ident == &quot;ca&quot; ~ &quot;Uninf&quot;,
                      orig.ident == &quot;ctl&quot; ~ &quot;Uninf+EFZ&quot;,
                      orig.ident == &quot;inf&quot; ~ &quot;Inf&quot;)) %&gt;% 
  pivot_wider(names_from = orig.ident, values_from = n) %&gt;% 
  kable(caption = &quot;Number of cells per condition and cell type&quot;) # to make table look nice in Rmarkdown
Warning: Values are not uniquely identified; output will contain list-cols.
* Use `values_fn = list` to suppress this warning.
* Use `values_fn = length` to identify where the duplicates arise
* Use `values_fn = {summary_fun}` to summarise duplicates</code></pre>
<table>
<caption>Number of cells per condition and cell type</caption>
<thead>
<tr class="header">
<th align="left">cell_type</th>
<th align="left">Uninf</th>
<th align="left">Uninf+EFZ</th>
<th align="left">Inf+EFZ</th>
<th align="left">Inf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">iAst</td>
<td align="left">1481</td>
<td align="left">686</td>
<td align="left">878, 944</td>
<td align="left">1269</td>
</tr>
<tr class="even">
<td align="left">iMg</td>
<td align="left">1163</td>
<td align="left">722</td>
<td align="left">632, 750</td>
<td align="left">1166</td>
</tr>
<tr class="odd">
<td align="left">iNeurons</td>
<td align="left">6733</td>
<td align="left">4899</td>
<td align="left">747, 2250</td>
<td align="left">3964</td>
</tr>
</tbody>
</table>
<hr />
</details>
</div>
<div id="different-infection-and-treatment-conditions-gene-expression" class="section level3">
<h3>Different infection and treatment conditions &amp; gene expression</h3>
<p>Interestingly, the infected cells treated with EFZ (Inf+EFZ) clearly separate from the infected, but untreated cells (Inf) and the the uninfected cells (Uninf, Uninf+EFZ) in the microglia cluster as can be seen in the figure below.</p>
<pre class="r"><code># rename origin of ident for easier interpretation
origin_vector &lt;- (triculture_clean@meta.data %&gt;% 
                    mutate(orig.ident = case_when(
                      orig.ident %in% c(&quot;ia&quot;, &quot;ia2&quot;) ~ &quot;Inf+EFZ&quot;, 
                      orig.ident == &quot;ca&quot; ~ &quot;Uninf&quot;,
                      orig.ident == &quot;ctl&quot; ~ &quot;Uninf+EFZ&quot;,
                      orig.ident == &quot;inf&quot; ~ &quot;Inf&quot;)))[[&quot;orig.ident&quot;]]

triculture_clean &lt;- AddMetaData(triculture_clean, origin_vector, col.name = &quot;orig.ident&quot;)</code></pre>
<pre class="r"><code>DimPlot(triculture_clean, reduction = &quot;tsne&quot;, group.by = &quot;orig.ident&quot;, pt.size = .01, )</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-18-1">
Past versions of unnamed-chunk-18-1.png
</button>
</p>
<div id="fig-unnamed-chunk-18-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-18-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-18-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-18-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>
<strong>Inflammatory gene expression in iMg</strong>
</summary>
<p><strong>Inflammatory gene expression in iMg</strong></p>
<p>The largest change in gene expression related to inflammation was found in iMg among the 3 cell types <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>. Shown are only inflammatory genes.</p>
<pre class="r"><code>inflamm_genes &lt;- c(&quot;TNF&quot;, &quot;ACSL1&quot;, &quot;MGST3&quot;, &quot;B2M&quot;, &quot;IFNGR2&quot;, &quot;GRINA&quot;, &quot;TLR2&quot;, 
                   &quot;SOD2&quot;, &quot;GLUL&quot;, &quot;CFLAR&quot;, &quot;CTNNB1&quot;, &quot;CXCL8&quot;, &quot;CCL4&quot;, &quot;IL1B&quot;,
                   &quot;ATF4&quot;, &quot;CXCL8&quot;, &quot;CCL4&quot;, &quot;CCL2&quot;, &quot;IL1B&quot;, &quot;ATF4&quot;, &quot;CXCL1&quot;, 
                   &quot;NFKB1&quot;, &quot;TANK&quot;, &quot;APOE&quot;, &quot;TREM2&quot;, &quot;LY96&quot;, &quot;SRC&quot;, &quot;NCF1&quot;, 
                   &quot;HCK&quot;, &quot;LYN&quot;, &quot;VASP&quot;, &quot;C3&quot;, &quot;C5&quot;, &quot;RAP1B&quot;, &quot;RAP2B&quot;, &quot;MAF&quot;,
                   &quot;JUND&quot;, &quot;SQSTM1&quot;, &quot;FTH1&quot;, &quot;RHOQ&quot;, &quot;CD36&quot;, &quot;FOS&quot;, &quot;NFKBIA&quot;,
                   &quot;ICAM1&quot;, &quot;TNFAIP3&quot;, &quot;LYZ&quot;, &quot;PPP1R12A&quot;, &quot;RND3&quot;, &quot;CYBA&quot;, &quot;IRF8&quot;,
                   &quot;SLC25A6&quot;)

DoHeatmap(triculture_clean, features = inflamm_genes)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-19-1">
Past versions of unnamed-chunk-19-1.png
</button>
</p>
<div id="fig-unnamed-chunk-19-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-19-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-19-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-19-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</details>
<details>
<summary>
<strong>Differences of inflammatory gene expression between conditions</strong>
</summary>
<p>The gene expression of inflammatory genes in microglia was not very different between the conditions. The Inf+EFZ cells show a slightly different pattern of gene expression.</p>
<pre class="r"><code>DoHeatmap(subset(triculture_clean, cell_type == &quot;iMg&quot;), 
          features = inflamm_genes, group.by = &quot;orig.ident&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-20-1">
Past versions of unnamed-chunk-20-1.png
</button>
</p>
<div id="fig-unnamed-chunk-20-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-20-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-20-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-20-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</details>
</div>
</div>
<div id="integration-triculture-csfblood-dataset" class="section level1">
<h1>Integration triculture &amp; CSF/Blood dataset</h1>
<p>The HIV Blood &amp; CSF dataset <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> used in the previous analysis was integrated with the triculture dataset <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>.</p>
<p>Integration of two datasets is based on Seurat <span class="citation">(<a href="#ref-Stuart" role="doc-biblioref">Stuart T 2019</a>)</span>. It first identifies anchors between datasets, calculates scores for all anchors and then calculates an integrated expression matrix which can be used for downstream analysis.</p>
<ol style="list-style-type: decimal">
<li>Identify features which are variable across datasets</li>
<li>Identify anchors between the two datasets and create an integrated data assay</li>
<li>Run a single integrated analysis on all cells</li>
</ol>
<details>
<summary>
<strong>Details on integration</strong>
</summary>
<p>For more details see: <span class="citation">(<a href="#ref-Stuart" role="doc-biblioref">Stuart T 2019</a>)</span></p>
<ol style="list-style-type: decimal">
<li>Identify features which are variable across datasets</li>
<li>Identify anchors between the two datasets and create an integrated data assay</li>
<li>Run a single integrated analysis on all cells</li>
</ol>
<pre><code>hiv7 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/total_7_samples_label_transfer.rds&quot;)
hiv7 &lt;- NormalizeData(hiv7, verbose = FALSE)
hiv7 &lt;- FindVariableFeatures(hiv7, verbose = FALSE)

# add both datasets to a lits
data_list &lt;- list(hiv = hiv7, triculture = triculture_clean)

# select features that are repeatedly variable across datasets for integration
features &lt;- SelectIntegrationFeatures(object.list = data_list, verbose = FALSE)

# identify integration anchors and perform integration
anchors &lt;- FindIntegrationAnchors(object.list = data_list, 
                                  anchor.features = features, verbose = FALSE) 
combined &lt;- IntegrateData(anchorset = anchors, verbose = FALSE)

# run analysis on integrated dataset
combined &lt;- ScaleData(combined, verbose = FALSE)
combined &lt;- RunPCA(combined, verbose = FALSE)
#ElbowPlot(combined)
combined &lt;- RunTSNE(combined, reduction = &quot;pca&quot;, dims = 1:10, verbose = FALSE)
combined &lt;- FindNeighbors(combined, reduction = &quot;pca&quot;, dims = 1:10, verbose = FALSE)
combined &lt;- FindClusters(combined, resolution = .3, verbose = FALSE)

# add annotations from which dataset the sample came from
dataset_vector &lt;- (combined@meta.data %&gt;% mutate(dataset = ifelse(orig.ident %in%
                                                 c(&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;,
                                                   &quot;HIV3_CSF&quot;, &quot;HIV1_Bld&quot;, 
                                                   &quot;HIV2_Bld&quot;, &quot;Uninfected1_CSF&quot;,
                                                   &quot;Uninfected2_CSF&quot;),
                                               &quot;csf&quot;, &quot;triculture&quot;)))[[&quot;dataset&quot;]]

combined &lt;- AddMetaData(combined, dataset_vector, col.name = &quot;dataset&quot;)

# add information on the cell groups in the combined datasets
combined_clusters &lt;- (combined@meta.data %&gt;% 
  mutate(combined_clusters = ifelse(seurat_clusters %in% c(2,10), &quot;Microglia&quot;, 
                            ifelse(seurat_clusters %in% c(3,9), &quot;iAst&quot;, 
                                   ifelse(seurat_clusters %in% c(0,1,7,11),
                                          &quot;iNeurons&quot;, 
                                          ifelse(seurat_clusters %in% c(8,5,6), &quot;Immune Cells&quot;, &quot;Undesignated&quot;))))))[[&quot;combined_clusters&quot;]]
  
combined &lt;- AddMetaData(combined, combined_clusters, col.name = &quot;combined_clusters&quot;)

#saveRDS(combined,&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/triculture_hiv_combined_seurat_object&quot;)
</code></pre>
<hr />
</details>
<div id="integrated-clusters" class="section level2">
<h2>Integrated clusters</h2>
<p>When integrating the CSF dataset and the Triculture dataset the iMg cells clustered together with the Myeloid cells from the CSF and Blood samples from the HIV-1 infected/uninfected patients. This was expected since they are both myeloid-lineage cells. However, this makes it more difficult to draw conclusions on which of the five Myeloid clusters is the most microglia-like. Therefore, we had a closer look at this myeloid-lineage cluster consisting of iMg from triculture and Myeloid cells from CSF and Blood samples.</p>
<div id="visualization-of-the-integrated-dataset" class="section level4">
<h4>Visualization of the integrated dataset</h4>
<pre class="r"><code>combined = readRDS(&quot;seurat_objects/triculture_hiv_combined_seurat_object_2&quot;)

p1 &lt;- DimPlot(combined, reduction = &quot;tsne&quot;, group.by  = &quot;dataset&quot;,
              label = TRUE) + NoLegend() +
  labs(title = &quot;Dataset&quot;)
p2 &lt;- DimPlot(combined, reduction = &quot;tsne&quot;, group.by = &quot;cell_type&quot;,
              label = TRUE, repel = TRUE) + NoLegend() +
  labs(title = &quot;Cell types&quot;)
p3 &lt;- DimPlot(combined, reduction = &quot;tsne&quot;, group.by = &quot;cell_type&quot;,
              split.by = &quot;dataset&quot;, label = TRUE, repel = TRUE) + NoLegend() +
  labs(title = &quot;Cell types split into datasets&quot;)
p4 &lt;- DimPlot(combined, reduction = &quot;tsne&quot;, group.by = &quot;seurat_clusters&quot;,
              label = TRUE) + NoLegend() +
  labs(title = &quot;Clusters&quot;)

a1 &lt;- DimPlot(combined, reduction = &quot;tsne&quot;, split.by = &quot;dataset&quot;, 
        group.by = &quot;seurat_clusters&quot;, label = TRUE, repel =TRUE) +
  NoLegend() +
  labs(title = &quot;Clusters split into datasets&quot;)

a2 &lt;- DimPlot(combined, reduction = &quot;tsne&quot;, split.by = &quot;dataset&quot;, 
              group.by = &quot;orig.ident&quot;) +
  labs(title = &quot;Sample origin split into datasets&quot;)

ggarrange(p1, p2, p3,p4, a1, a2, ncol = 2, nrow = 3)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-21-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-21-1">
Past versions of unnamed-chunk-21-1.png
</button>
</p>
<div id="fig-unnamed-chunk-21-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-21-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-21-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-21-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-21-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-21-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="myeloid-lineage-cluster" class="section level2">
<h2>Myeloid lineage cluster</h2>
<div id="visualization-of-myeloid-lineage-cluster-img-myeloid12345" class="section level4">
<h4>Visualization of Myeloid lineage cluster (iMg, Myeloid1/2/3/4/5)</h4>
<p>The plot below visualizes that iMg and CSF/Blood Myeloid cells cluster together, independent of their infection status.</p>
<pre class="r"><code>subset_monocytes &lt;- subset(combined, cell_type %in% c(&quot;Myeloid1&quot;, 
                                                            &quot;Myeloid2&quot;, 
                                                            &quot;Myeloid3&quot;, 
                                                            &quot;Myeloid4&quot;, 
                                                            &quot;Myeloid5&quot;, 
                                                            &quot;iMg&quot;))

p1 &lt;- DimPlot(subset_monocytes, group.by = &quot;cell_type&quot;) +
  labs(title = &quot;Cell type&quot;)
p2 &lt;- DimPlot(subset_monocytes, group.by = &quot;orig.ident&quot;) +
  labs(title = &quot;Sample origin&quot;)
p3 &lt;- DimPlot(subset_monocytes, group.by = &quot;seurat_clusters&quot;) +
  labs(title = &quot;Cluster&quot;)
fig &lt;- ggarrange(p1, p2, p3, ncol = 3, nrow = 1)
annotate_figure(fig, top = text_grob(&quot;Myeloid-lineage cells&quot;, size = 20))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-22-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-22-1">
Past versions of unnamed-chunk-22-1.png
</button>
</p>
<div id="fig-unnamed-chunk-22-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-22-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-22-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-22-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-22-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-22-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As expected the CSF/Blood Myeloid cells cluster together with Inf+EFZ and mainly contribute to the same subcluster, as can be seen in the plot below, which shows only CSF/Blood Myeloid cells and the Inf+EFZ iMg. Blood Myeloid 4 is an exception and belongs to a different subcluster.</p>
<pre class="r"><code>
subset_infected &lt;- subset(combined, orig.ident %in% c(&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;, &quot;HIV3_CSF&quot;,
                                             &quot;HIV1_Bld&quot;, &quot;HIV2_Bld&quot;,&quot;Inf+EFZ&quot;) &amp;
                            cell_type %in% c(&quot;Myeloid1&quot;, 
                                                            &quot;Myeloid2&quot;, 
                                                            &quot;Myeloid3&quot;, 
                                                            &quot;Myeloid4&quot;, 
                                                            &quot;Myeloid5&quot;, 
                                                            &quot;iMg&quot;))


p1 &lt;- DimPlot(subset_infected, group.by = &quot;cell_type&quot;) +
  labs(title = &quot;Cell Type&quot;)
p2 &lt;- DimPlot(subset_infected, group.by = &quot;orig.ident&quot;) +
  labs(title = &quot;Sample origin&quot;)
p3 &lt;- DimPlot(subset_infected, group.by = &quot;seurat_clusters&quot;) +
  labs(title = &quot;Clusters&quot;)
fig &lt;- ggarrange(p1, p2, p3, ncol = 3, nrow = 1)
annotate_figure(fig, top = text_grob(&quot;Infected CSF/Blood Myeloid cells &amp; Inf+EFZ iMg&quot;))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-23-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-23-1">
Past versions of unnamed-chunk-23-1.png
</button>
</p>
<div id="fig-unnamed-chunk-23-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/22c8da852024074e3acc07ff7b24979c64230432/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-23-1.png" target="_blank">22c8da8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-23-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-23-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-23-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-23-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-23-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cell-types-and-conditions-partially-separate-according-to-the-two-img-clusters" class="section level4">
<h4>Cell types and conditions partially separate according to the two iMg clusters</h4>
<p>The myeloid-lineage cluster separated into two distinct subclusters. Interestingly, the infected + EFZ iMg separated clearly from the infected iMg. The separation was not so clear for the uninfected cells, which contributed to both subclusters. Another observations is that the infected Myeloid1/2/3/5 cells belong<br />
to the same subcluster as the infected + EFZ iMg. Conversely, the Myeloid4 cells cluster with the infected iMg. Since the infected CSF/Blood Myeloid cells originate from HIV infected and treated patients we would expect them to cluster togehter with the infected + EFZ iMg. However, there might also be infected CSF/Blood Myeloid cells which are not affected by the treatment. The Myeloid4 cells which are from Blood samples might consitute an infected cell population unaffected by the ART treatment.</p>
<pre class="r"><code>
DimPlot(subset_monocytes, group.by = &quot;seurat_clusters&quot;, 
        split.by = &quot;orig.ident&quot;, ncol = 4) +
  labs(title = &quot;Contribution of different samples to different subclusters&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-24-1">
Past versions of unnamed-chunk-24-1.png
</button>
</p>
<div id="fig-unnamed-chunk-24-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>DimPlot(subset_monocytes, group.by = &quot;seurat_clusters&quot;, 
        split.by = &quot;cell_type&quot;, ncol = 3) +
  labs(title = &quot;Contribution of different cell types to different subclusters&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-2.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-24-2">
Past versions of unnamed-chunk-24-2.png
</button>
</p>
<div id="fig-unnamed-chunk-24-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-2.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-2.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-2.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-2.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-24-2.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="de-nove-clustering" class="section level2">
<h2>De-nove clustering</h2>
<p>De-novo clustering of the myeloid-lineage cluster of the integrated dataset was performed. Isolating the iMg and all Myeloid cell clusters from the integrated dataset and normalizing, scaling and re-clustering these isolated cells might<br />
give us additional insights.</p>
<details>
<summary>
<strong>Details on de-novo clustering</strong>
</summary>
<pre><code>
microglia &lt;- subset(combined, cell_type %in% c(&quot;iMg&quot;,
                                                &quot;Myeloid1&quot;,
                                                &quot;Myeloid2&quot;,
                                                &quot;Myeloid3&quot;,
                                                &quot;Myeloid4&quot;,
                                                &quot;Myeloid5&quot;))
microglia_recluster &lt;- SCTransform(microglia, verbose = FALSE)
microglia_recluster &lt;- ScaleData(microglia_recluster, verbose = FALSE)
microglia_recluster &lt;- RunPCA(microglia_recluster, verbose = FALSE)
ElbowPlot(microglia_recluster)
microglia_recluster &lt;- RunTSNE(microglia_recluster, reduction = &quot;pca&quot;, dims = 1:10)
microglia_recluster &lt;- FindNeighbors(microglia_recluster)
microglia_recluster &lt;- FindClusters(microglia_recluster, resolution = 0.5)</code></pre>
<hr />
</details>
<p>It is no surprise that cells from the triculture dataset separate from the CSF/Blood-derived cells which can be seen in the plot below. When we recluster the myeloid lineage derived cells, we obtain five subclusters for the iMg and three subclusters for the five CSF/Blood Myeloid clusters as can be seen in the plots below. We can also observe that the Myeloid2 and Myeloid5 separate from Myeloid1/2/3 which is expected, since Myeloid2/5 originate from CSF samples and Myeloid1/3/4 originate from blood samples.</p>
<pre class="r"><code>microglia_recluster &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/microglia_myeloid_seurat_object_reclustering&quot;)
a1 &lt;- DimPlot(microglia_recluster, reduction = &quot;tsne&quot;,
              group.by = &quot;seurat_clusters&quot;, pt.size = .4) +
  labs(title = &quot;Clustering&quot;)
a2 &lt;- DimPlot(microglia_recluster, reduction =&quot;tsne&quot;, 
              group.by = &quot;cell_type&quot;, pt.size = .4) +
  labs(title = &quot;Cell type&quot;)
a3 &lt;- DimPlot(microglia_recluster, reduction =&quot;tsne&quot;,
              group.by = &quot;dataset&quot;, pt.size = .4) +
    labs(title = &quot;Dataset&quot;)
a4 &lt;- DimPlot(microglia_recluster, reduction = &quot;tsne&quot;,
              group.by = &quot;orig.ident&quot;, pt.size = .4) +
  labs(title = &quot;Sample origin&quot;)

fig &lt;- ggarrange(a1, a2, a3, a4, ncol = 2, nrow = 2)
annotate_figure(fig, 
                top = text_grob(&quot;De-novo clustering of myeloid-lineage clusters&quot;, 
               color = &quot;black&quot;, face = &quot;bold&quot;, size = 20))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-25-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-25-1">
Past versions of unnamed-chunk-25-1.png
</button>
</p>
<div id="fig-unnamed-chunk-25-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/22c8da852024074e3acc07ff7b24979c64230432/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-25-1.png" target="_blank">22c8da8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-25-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-25-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-25-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-25-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-25-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Interestingly, both the Myeloid5 cells and the Myeloid2 cells are split between the cluster six (blue) and seven (purple) in the figure below. In the following we will have a closer look at this segregation.<br />
When performing GRN inference with Scenic we also identified two potentially biologically relevant subclusters of the Myeloid2 cells. It could be that these independently found clusters correlate.</p>
<pre class="r"><code>a5 &lt;- DimPlot(microglia_recluster, reduction =&quot;tsne&quot;, 
              split.by = &quot;cell_type&quot;, pt.size = .4, ncol=3) +
  labs(title = &quot;Contribution of different cell types to different myeloid clusters&quot;)
a5</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-26-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-26-1">
Past versions of unnamed-chunk-26-1.png
</button>
</p>
<div id="fig-unnamed-chunk-26-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/22c8da852024074e3acc07ff7b24979c64230432/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-26-1.png" target="_blank">22c8da8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-26-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-26-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-26-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-26-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-26-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It looks like the two clusters identified this way correspond to different sample origins. CSF cells from patient1 (HIV1_CSF) and patient2 (HIV2_CSF) belong to cluster six,while CSF cells from patient3 (HIV3_CSF) and the two uninfected patients (Uninfected1_CSF, Uninfected2_CSF) belong to cluster seven. The separation of patient3 (HIV3_CSF) from patient1 (HIV1_CSF) and patient2 (HIV2_CSF) might correspond to a batch effect, or it might be a biological effect, because the infection affected the cells differently.</p>
<pre class="r"><code>#a1 &lt;- DimPlot(subset(microglia_recluster, cell_type == &quot;iMg&quot;), reduction = &quot;tsne&quot;,
           #   group.by = &quot;orig.ident&quot;, pt.size = .4)
a2 &lt;- DimPlot(subset(microglia_recluster, cell_type != &quot;iMg&quot;), reduction = &quot;tsne&quot;,
              group.by = &quot;orig.ident&quot;, pt.size = .4) +
  labs(title = &quot;Sample origin&quot;)
#a3 &lt;- DimPlot(subset(microglia_recluster, cell_type == &quot;iMg&quot;), reduction = &quot;tsne&quot;,
              #group.by = &quot;seurat_clusters&quot;, pt.size = .4)
a4 &lt;- DimPlot(subset(microglia_recluster, cell_type != &quot;iMg&quot;), reduction = &quot;tsne&quot;,
              group.by = &quot;seurat_clusters&quot;, pt.size = .4) +
  labs(title = &quot;Cluster&quot;)
fig &lt;- ggarrange(a2, a4, ncol = 2, nrow = 1)
annotate_figure(fig, top = text_grob(&quot;CSF/Blood Myeloid cells&quot;, 
                                     face = &quot;bold&quot;, size = 20))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-27-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-27-1">
Past versions of unnamed-chunk-27-1.png
</button>
</p>
<div id="fig-unnamed-chunk-27-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/22c8da852024074e3acc07ff7b24979c64230432/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-27-1.png" target="_blank">22c8da8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-27-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-27-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-27-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-27-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-27-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Since the segregation into two clusters seems to be related to the sample origin rather than to the infection status, we would not expect the clusters to overlap with the clusters identified after GRN inference with SCENIC. In the figure below this is exactly what can be observed, only the Myeloid2 cells from infected CSF samples (HIV1_CSF, HIV2_CSF, HIV3_CSF) are shown.</p>
<pre class="r"><code># read in Myeloid2 cells
hivmy2 &lt;- readRDS(&quot;data_files/hiv_myeloid2_subclusters&quot;)

my2 &lt;- subset(microglia_recluster, cell_type == &quot;Myeloid2&quot; &amp; 
                orig.ident %in% c(&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;, &quot;HIV3_CSF&quot;))

my2 &lt;- AddMetaData(my2, hivmy2@meta.data[&quot;ht_cluster&quot;], 
                   col.name = &quot;TF_activity_clusters&quot;)
p1 &lt;- DimPlot(my2, group.by = &quot;seurat_clusters&quot;) +
  labs(title=&quot;Clusters&quot;)
p2 &lt;- DimPlot(my2, group.by = &quot;TF_activity_clusters&quot;) +
  labs(title = &quot;TF activity&quot;)
p3 &lt;- DimPlot(my2, group.by = &quot;orig.ident&quot;) +
  labs(title = &quot;Sample origin&quot;)
figure &lt;- ggarrange(p1, p2, p3, ncol = 3, nrow = 1)
annotate_figure(figure, 
                top = text_grob(&quot;Comparison with clusters of different TF acitivty&quot;, 
               color = &quot;black&quot;, face = &quot;bold&quot;, size = 20))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-28-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-28-1">
Past versions of unnamed-chunk-28-1.png
</button>
</p>
<div id="fig-unnamed-chunk-28-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/22c8da852024074e3acc07ff7b24979c64230432/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-28-1.png" target="_blank">22c8da8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-28-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-28-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-28-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-28-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-28-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>#my25 &lt;- subset(microglia, seurat_clusters %in% c(6,7) &amp;cell_type %in% c(&quot;Myeloid2&quot;, &quot;Myeloid5&quot;))</code></pre>
<p>For this reason the reclustering did not lead to any useful insights and will not be analyzed further.</p>
</div>
</div>
<div id="differential-gene-expression" class="section level1">
<h1>Differential gene expression</h1>
<div id="differential-gene-expression-between-infected-and-uninfected---efz-img" class="section level3">
<h3>Differential gene expression between infected and uninfected +/- EFZ iMg</h3>
<p>In the following I will compare gene expression between infected cells and uninfected cells, both treated with EFZ and not treated. I will use the uninfected cells as a baseline to find genes which are upregulated or downregulated in infected cells compared to uninfected cells. Since we have both cells treated with EFZ and cells not treated with EFZ, we can define a signature for both treatment conditions separately and then see if there is an overlap between the gene signatures of infected cells +/- EFZ. Finding genes which overlap independently of treamtent condition increases the confidence in the results</p>
<details>
<summary>
<strong>List if top up- or downregulated genes in Inf+EFZ vs Uninf+EFZ</strong>
</summary>
<pre class="r"><code># isolate iMg cells
microglia &lt;- subset(combined, cell_type == &quot;iMg&quot;)

# only iMg cells to identify potential signatures between infected vs uninfected
Idents(microglia) =  &quot;orig.ident&quot;

# find marker genes between Uninf+EFZ and Inf+EFZ
inf_uninf_art_marker &lt;- FindMarkers(microglia, ident.1 = &quot;Inf+EFZ&quot;, 
                                    ident.2 = &quot;Uninf+EFZ&quot;, verbose = FALSE)
#upregulated genes
up_inf_art &lt;- inf_uninf_art_marker %&gt;% 
  arrange(desc(avg_log2FC)) %&gt;%
  head(10) %&gt;% 
  rownames_to_column(&quot;gene&quot;)
up_inf_art  %&gt;% kable(caption = &quot;Genes upregulated in Inf+EFZ vs. Uninf+EFZ&quot;)</code></pre>
<table>
<caption>Genes upregulated in Inf+EFZ vs. Uninf+EFZ</caption>
<thead>
<tr class="header">
<th align="left">gene</th>
<th align="right">p_val</th>
<th align="right">avg_log2FC</th>
<th align="right">pct.1</th>
<th align="right">pct.2</th>
<th align="right">p_val_adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RAB32</td>
<td align="right">0</td>
<td align="right">1.2840817</td>
<td align="right">0.656</td>
<td align="right">0.291</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">NUPR1</td>
<td align="right">0</td>
<td align="right">1.0569999</td>
<td align="right">0.680</td>
<td align="right">0.460</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">HMOX1</td>
<td align="right">0</td>
<td align="right">0.9031207</td>
<td align="right">0.597</td>
<td align="right">0.309</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">PDK4</td>
<td align="right">0</td>
<td align="right">0.8673561</td>
<td align="right">0.204</td>
<td align="right">0.019</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">SLC38A2</td>
<td align="right">0</td>
<td align="right">0.8452040</td>
<td align="right">0.288</td>
<td align="right">0.079</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">LPAR6</td>
<td align="right">0</td>
<td align="right">0.8045929</td>
<td align="right">0.579</td>
<td align="right">0.289</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ID3</td>
<td align="right">0</td>
<td align="right">0.7434776</td>
<td align="right">0.258</td>
<td align="right">0.102</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CYP1B1</td>
<td align="right">0</td>
<td align="right">0.7204238</td>
<td align="right">0.911</td>
<td align="right">0.776</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ID2</td>
<td align="right">0</td>
<td align="right">0.7083962</td>
<td align="right">0.501</td>
<td align="right">0.259</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">NEAT1</td>
<td align="right">0</td>
<td align="right">0.6849097</td>
<td align="right">0.784</td>
<td align="right">0.579</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code># downregulated genes
down_inf_art &lt;- inf_uninf_art_marker %&gt;% 
  arrange(avg_log2FC) %&gt;% 
  head(10) %&gt;%
  rownames_to_column(&quot;gene&quot;)
down_inf_art %&gt;% kable(caption = &quot;Genes downregulated in Inf+EFZ vs. Uninf+EFZ&quot;)</code></pre>
<table>
<caption>Genes downregulated in Inf+EFZ vs. Uninf+EFZ</caption>
<thead>
<tr class="header">
<th align="left">gene</th>
<th align="right">p_val</th>
<th align="right">avg_log2FC</th>
<th align="right">pct.1</th>
<th align="right">pct.2</th>
<th align="right">p_val_adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MT1X</td>
<td align="right">0</td>
<td align="right">-3.413896</td>
<td align="right">0.147</td>
<td align="right">0.735</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">MT2A</td>
<td align="right">0</td>
<td align="right">-3.113559</td>
<td align="right">0.167</td>
<td align="right">0.695</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">CCL4</td>
<td align="right">0</td>
<td align="right">-3.102918</td>
<td align="right">0.321</td>
<td align="right">0.910</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CCL4L2</td>
<td align="right">0</td>
<td align="right">-2.676517</td>
<td align="right">0.235</td>
<td align="right">0.816</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">CCL3L1</td>
<td align="right">0</td>
<td align="right">-2.579091</td>
<td align="right">0.290</td>
<td align="right">0.807</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CCL3</td>
<td align="right">0</td>
<td align="right">-2.560332</td>
<td align="right">0.611</td>
<td align="right">0.982</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">IL1B</td>
<td align="right">0</td>
<td align="right">-2.405276</td>
<td align="right">0.090</td>
<td align="right">0.530</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CXCL1</td>
<td align="right">0</td>
<td align="right">-2.335406</td>
<td align="right">0.244</td>
<td align="right">0.734</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">MT1G</td>
<td align="right">0</td>
<td align="right">-1.926247</td>
<td align="right">0.025</td>
<td align="right">0.177</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">MT1E</td>
<td align="right">0</td>
<td align="right">-1.822557</td>
<td align="right">0.016</td>
<td align="right">0.234</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<hr />
</details>
<pre class="r"><code># find marker genes between Inf and Uninf
inf_uninf_marker &lt;- FindMarkers(microglia, ident.1 = &quot;Inf&quot;, 
                                ident.2 = &quot;Uninf&quot;, verbose = FALSE)

# upregulated in Inf vs Uninf, no treatment
up_inf_no &lt;- inf_uninf_marker %&gt;% 
  arrange(desc(avg_log2FC)) %&gt;%
  head(20) %&gt;% 
  rownames_to_column(&quot;gene&quot;)
#up_inf_no  %&gt;% kable()


down_inf_no&lt;- inf_uninf_marker %&gt;% 
  arrange(avg_log2FC) %&gt;% 
  head(20) %&gt;%
  rownames_to_column(&quot;gene&quot;)
#down_inf_no%&gt;% kable()</code></pre>
<p>Only 3% of genes which are upregulated and only 11% of genes which are downregulated in infected vs. uninfected cells overlap between the treatment conditions. This means, that the gene expression response defining the infection might differ between cells with and without treatment. This reflects the findings of <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span> that the EFZ treatment lead to a distinct immune response of iMg and distinct activation of two inflammatory pathways, RhoGDI and CD40 pathways as will be describe later on. Since there is hardly any overlap we will use the genes upregulated in Inf+EFZ compared to Uninf+EFZ in the following analysis steps, since the probably best resemble the CSF/Blood samples which originate from patients treated with ART.</p>
<pre class="r"><code>up_inf &lt;- intersect(up_inf_art$gene, up_inf_no$gene)
down_inf &lt;- intersect(down_inf_art$gene, down_inf_no$gene)
print(c(up_inf, down_inf))
[1] &quot;HMOX1&quot;  &quot;MT1X&quot;   &quot;MT2A&quot;   &quot;CCL4L2&quot;</code></pre>
<pre class="r"><code>p1 &lt;- ggVennDiagram::ggVennDiagram(list(up_inf_art$gene, up_inf_no$gene),
              label_alpha = 0,
              category.names= c(&quot;Inf+EFZ&quot;, &quot;Inf&quot;),
              #set.size = 20,
              label = &quot;percent&quot;,
              label_size = 6) +
   scale_fill_distiller(palette = &quot;RdBu&quot;) +
  labs(title = &quot;Genes upregulated in infected cells&quot;)

p2 &lt;- ggVennDiagram::ggVennDiagram(list(down_inf_art$gene, down_inf_no$gene),
              label_alpha = 0,
              category.names= c(&quot;Inf+EFZ&quot;, &quot;Inf&quot;),
              #set.size = 20,
              label = &quot;percent&quot;,
              label_size = 6,
              set_color = c(&quot;red&quot;, &quot;blue&quot;)) +
  scale_fill_distiller(palette = &quot;RdBu&quot;) +
  labs(title = &quot;Genes downregulated in infected cells&quot;)

ggarrange(p1, p2, ncol = 2)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-33-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-33-1">
Past versions of unnamed-chunk-33-1.png
</button>
</p>
<div id="fig-unnamed-chunk-33-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-33-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-33-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-33-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-33-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-33-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>
<strong>Volcano Plot of Infection (+ EFZ) signature</strong>
</summary>
<p>Interestingly, the genes downregulatd in Inf+EFZ vs. Uninfected cells show a higher average log fold change with higher significance (p-values).</p>
<pre class="r"><code>inf_uninf_art_marker %&gt;% 
  rownames_to_column(&quot;gene&quot;) %&gt;%
  filter(gene %in% c(up_inf_art$gene, down_inf_art$gene)) %&gt;% 
  # add a column containing information in which condition the corresponding TF 
  # is upregulated
  mutate(condition = case_when(gene %in% up_inf_art$gene ~ &quot;upregulated&quot;,
                               gene %in% down_inf_art$gene ~ &quot;downregulated&quot;,
                               TRUE ~ &quot;NA&quot;)) %&gt;%
  # add a column conaining the labels for the plot
  # I only want to label cells which are also found by Scenic
  mutate(label = ifelse(gene %in% c(up_inf_art$gene, down_inf_art$gene), gene, NA)) %&gt;% 
  ggplot(aes(x = avg_log2FC,
             y = -log10(p_val_adj),
             col = condition, 
             label = label)) +
  geom_point() +
  geom_hline(yintercept = -log10(1e-50), col = &quot;red&quot;) +
  geom_text(nudge_x = .05, nudge_y = 2) +
  labs(title = &quot;Genes which are up- or downregulated in Inf+EFZ vs Uninf+EFZ&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-34-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-34-1">
Past versions of unnamed-chunk-34-1.png
</button>
</p>
<div id="fig-unnamed-chunk-34-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/22c8da852024074e3acc07ff7b24979c64230432/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-34-1.png" target="_blank">22c8da8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-34-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-34-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-34-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-34-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-34-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</details>
</div>
<div id="differential-gene-expression-between-treatment-conditions" class="section level3">
<h3>Differential gene expression between treatment conditions</h3>
<p>Comparing Uninf+EFZ with Uninf and Inf+EFZ with Inf iMg one might be able to identify genes which are different after treatment of cells with EFZ. Finding overlapping genes between the two infection states increases the confidence in the results, because the identified genes are associated with treatment independently of infection status.</p>
<p>The diagram below shows, that 36% of genes are upregulated both in Inf and Inf+EFZ iMg compared to Uninf and Uninf+EFZ iMg. These genes are probably associated with the EFZ treatment. The drug affects the iMg and changes their gene expression. This signature might be used to identify Myeloid2 CSF cells which are affected by the treatment. Since ART drugs are found at lower concentrations in CSF than in blood, probably only a subgroup of Myeloid2 are affected by the ART drugs and it would be interesting to know which are affected by treatement and which are not. However, this comparison might be far fetched, since the patients from which the CSF samples have been derived have not been treated with EFZ, but with a combination of other ART drugs which probably have a slightly different effect on cells.</p>
<pre class="r"><code>treatment_marker_uninf &lt;- FindMarkers(microglia, ident.1 = &quot;Uninf+EFZ&quot;, 
                                ident.2 = &quot;Uninf&quot;, verbose = FALSE)

# find marker genes between Inf+EFZ and Inf
treatment_marker_inf &lt;- FindMarkers(microglia, ident.1 = &quot;Inf+EFZ&quot;, ident.2 = &quot;Inf&quot;)

# overlap between upregulated genes
treatment_up &lt;- intersect((treatment_marker_inf %&gt;% 
             rownames_to_column(&quot;gene&quot;) %&gt;% 
             filter(avg_log2FC &gt; 0))$gene, 
           (treatment_marker_uninf %&gt;% 
             rownames_to_column(&quot;gene&quot;) %&gt;% 
             filter(avg_log2FC &gt; 0))$gene)

treatment_down &lt;- intersect((treatment_marker_inf %&gt;% 
             rownames_to_column(&quot;gene&quot;) %&gt;% 
             filter(avg_log2FC &lt; 0))$gene, 
           (treatment_marker_uninf %&gt;% 
             rownames_to_column(&quot;gene&quot;) %&gt;% 
             filter(avg_log2FC &lt; 0))$gene)
treatment_marker &lt;- c(treatment_up, treatment_down)</code></pre>
<pre class="r"><code>p1 &lt;- ggVennDiagram::ggVennDiagram(list((treatment_marker_inf %&gt;% 
             rownames_to_column(&quot;gene&quot;) %&gt;% 
             filter(avg_log2FC &gt; 0))$gene, 
             (treatment_marker_uninf %&gt;% 
             rownames_to_column(&quot;gene&quot;) %&gt;% 
             filter(avg_log2FC &gt; 0))$gene),
              label_alpha = 0,
              category.names= c(&quot;Inf+EFZ&quot;, &quot;Uninf+EFZ&quot;),
              #set.size = 20,
              label = &quot;percent&quot;,
              label_size = 6) +
   scale_fill_distiller(palette = &quot;RdBu&quot;) +
  labs(title = &quot;Genes upregulated in cells treated with EFZ&quot;)

p2 &lt;- ggVennDiagram::ggVennDiagram(list((treatment_marker_inf %&gt;% 
             rownames_to_column(&quot;gene&quot;) %&gt;% 
             filter(avg_log2FC &lt; 0))$gene, 
             (treatment_marker_uninf %&gt;% 
             rownames_to_column(&quot;gene&quot;) %&gt;% 
             filter(avg_log2FC &lt; 0))$gene),
              label_alpha = 0,
              category.names= c(&quot;Inf+EFZ&quot;, &quot;Uninf+EFZ&quot;),
              #set.size = 20,
              label = &quot;percent&quot;,
              label_size = 6,
              set_color = c(&quot;red&quot;, &quot;blue&quot;)) +
  scale_fill_distiller(palette = &quot;RdBu&quot;) +
  labs(title = &quot;Genes downregulated in cells treated with EFZ&quot;)

ggarrange(p1, p2, ncol = 2)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-36-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-36-1">
Past versions of unnamed-chunk-36-1.png
</button>
</p>
<div id="fig-unnamed-chunk-36-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-36-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-36-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-36-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-36-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-36-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>
<strong>Volcano Plot of Treatment signature</strong>
</summary>
<pre class="r"><code>treatment_marker_uninf %&gt;% 
  rownames_to_column(&quot;gene&quot;) %&gt;%
  filter(gene %in% treatment_marker) %&gt;% 
  # add a column containing information in which condition the corresponding TF 
  # is upregulated
  mutate(condition = case_when(gene %in% treatment_up ~ &quot;upregulated&quot;,
                               gene %in% treatment_down ~ &quot;downregulated&quot;,
                               TRUE ~ &quot;NA&quot;)) %&gt;%
  # add a column conaining the labels for the plot
  # I only want to label cells which are also found by Scenic
  #mutate(label = ifelse(gene %in% c(up_inf$gene, down_inf$gene), gene, NA)) %&gt;% 
  ggplot(aes(x = avg_log2FC,
             y = -log10(p_val_adj),
             col = condition, 
             label = gene)) +
  geom_point() +
  geom_hline(yintercept = -log10(1e-10), col = &quot;red&quot;) +
  geom_text(nudge_x = .05, nudge_y = 2) +
  labs(title = &quot;Top 20 Genes which are up/downregulated in treatment vs. no treatment, Uninf cells&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-37-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-37-1">
Past versions of unnamed-chunk-37-1.png
</button>
</p>
<div id="fig-unnamed-chunk-37-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/22c8da852024074e3acc07ff7b24979c64230432/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-37-1.png" target="_blank">22c8da8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-37-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-37-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-37-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-37-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-37-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</details>
</div>
</div>
<div id="infection-treatment-gene-signature" class="section level1">
<h1>Infection &amp; treatment gene signature</h1>
<p>Checking the differentially expressed genes and trying to identify an infection signature through literature search turned out to be very difficult. Therefore, a different approach was used. The top twenty up- and downregulated genes in Inf+EFZ vs Uninf+EFZ were computed. Using these genes as an “infection signature” we will check if some of the Myeloid2 cells from the CSF samples show a similar signature.</p>
<pre class="r"><code># select only genes which are also found in the sc-RNAseq dataset
up_inf_filt &lt;- up_inf_art$gene[up_inf_art$gene %in% rownames(hivmy2@assays$RNA@counts)]
down_inf_filt &lt;- down_inf_art$gene[down_inf_art$gene %in% rownames(hivmy2@assays$RNA@counts)]</code></pre>
<div id="gene-signature-scoring-in-myeloid2-cells" class="section level2">
<h2>Gene signature scoring in Myeloid2 cells</h2>
<p>Using the signature genes from differential gene expression analysis between Inf+EFZ and Uninf+EFZ we can compute a score of activity of these gene sets in the Myeloid2 cluster of CSF samples. We can plot these scores in a TSNE representation, but we can also get the scores from the metadata and use them for other visualizations</p>
<p>If the Inf+EFZ signature can be found in some of the Myeloid2 cells from the CSF samples this migth provide additional insights about the infection status of these microglia-like cells.</p>
<div id="scores-of-gene-signature-upregulated-in-infefz-img-in-myeloid2-cells" class="section level4">
<h4>Scores of gene signature upregulated in Inf+EFZ iMg in Myeloid2 cells</h4>
<p>In the plot below there are some cells visible which have a high score for the signature composed of genes upregulated in Inf+EFZ microglia. To be precise, eleven percent of the Myeloid2 cells have a positive score (17 out of 145 cells). These high scroing cells do, however, not correspond to the two clusters (c1, c2) obtained from analysis of TF activity (SCENIC).</p>
<pre class="r"><code>up_sign &lt;- AddModuleScore(hivmy2,
                           features = up_inf_filt)

p1 &lt;- FeaturePlot(subset(up_sign, ht_cluster == &quot;c1&quot;),
                  features = &quot;Cluster1&quot;, pt.size = 1) +#, split.by = &quot;ht_cluster&quot;) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;Myeloid2 Cluster c1&quot;)

p2 &lt;- FeaturePlot(subset(up_sign, ht_cluster == &quot;c2&quot;),
                  features = &quot;Cluster1&quot;, pt.size = 1) +#, split.by = &quot;ht_cluster&quot;) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;Myeloid2 Cluster c2&quot;)

figure &lt;- ggarrange(p1, p2, ncol = 2)#, nrow = 2) 
annotate_figure(figure, top = text_grob(&quot;Signature score of genes upregulated in Inf+EFZ iMg applied to CSF Myeloid2 cells&quot;, 
               color = &quot;black&quot;, face = &quot;bold&quot;, size = 20))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-39-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-39-1">
Past versions of unnamed-chunk-39-1.png
</button>
</p>
<div id="fig-unnamed-chunk-39-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-39-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-39-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-39-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-39-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-39-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>
<strong>Exact scores for each cell</strong>
</summary>
<pre class="r"><code># divide the number of rows(cells) with positive ccores by the number of total 
# rows(cells) to get the percentage of cells with positive scores.
percentage_inf &lt;- dim((up_sign@meta.data[&quot;Cluster1&quot;] %&gt;% 
                         filter(Cluster1 &gt; 0)))[1] / 
  dim(up_sign@meta.data[&quot;Cluster1&quot;])[1]

# show the positive scores.
up_sign@meta.data[&quot;Cluster1&quot;] %&gt;% 
  filter(Cluster1 &gt; 0) %&gt;% 
  rename(&quot;Score&quot; = &quot;Cluster1&quot;) %&gt;% 
  kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3C_GTAGTTGACTCA</td>
<td align="right">1.4410307</td>
</tr>
<tr class="even">
<td align="left">3C_ATCTATTATGTG</td>
<td align="right">1.4998133</td>
</tr>
<tr class="odd">
<td align="left">3C_GGGTTCACCTGC</td>
<td align="right">1.8181493</td>
</tr>
<tr class="even">
<td align="left">3C_TGCTGAACGTCC</td>
<td align="right">1.4618718</td>
</tr>
<tr class="odd">
<td align="left">1C_TGGATCTAATTA</td>
<td align="right">0.8425356</td>
</tr>
<tr class="even">
<td align="left">1C_CCACAGTCCTCC</td>
<td align="right">1.0406455</td>
</tr>
<tr class="odd">
<td align="left">1C_TTATACTCAGAT</td>
<td align="right">0.8008646</td>
</tr>
<tr class="even">
<td align="left">1C_CCGCCACGGAAC</td>
<td align="right">0.8290332</td>
</tr>
<tr class="odd">
<td align="left">1C_GTGCTGGACGTT</td>
<td align="right">0.9487856</td>
</tr>
<tr class="even">
<td align="left">1C_GTTTCCGTCGCT</td>
<td align="right">0.8474260</td>
</tr>
<tr class="odd">
<td align="left">1C_TGCTTATCAGCT</td>
<td align="right">1.0056428</td>
</tr>
<tr class="even">
<td align="left">1C_ACTGGCCTCCTC</td>
<td align="right">1.8245069</td>
</tr>
<tr class="odd">
<td align="left">1C_TTGTAATTGAAT</td>
<td align="right">1.3877296</td>
</tr>
<tr class="even">
<td align="left">1C_GCACGACGGCGC</td>
<td align="right">1.8305736</td>
</tr>
<tr class="odd">
<td align="left">1C_CGTCCGTGTGGT</td>
<td align="right">1.6682062</td>
</tr>
<tr class="even">
<td align="left">2C_TAGCAGAGTAGT</td>
<td align="right">1.0958695</td>
</tr>
<tr class="odd">
<td align="left">2C_CTTTTCCCAGCT</td>
<td align="right">1.6833139</td>
</tr>
</tbody>
</table>
<hr />
</details>
</div>
<div id="defining-a-signature-composed-of-downregulated-genes" class="section level4">
<h4>Defining a signature composed of downregulated genes</h4>
<p>Defining a gene signature composed of both up- and downregulated genes turned out to be more difficult than expected. One idea was to separately investigate upregulated versus downregulated genes. Above the upregulated gene signature scores in Myeloid2 cells were shown.</p>
<p>We will now have a closer look at the problems that arise when investigating downregulated genes. Assuming that our Myeloid2 cells are composed of two distinct populations, one infected and one uninfected, we would expect a bimodal distribution of gene expression for genes upregulated in the infected condition. There should be one peak with base level gene expression corresponding to uninfected cells and a second peak with higher levels of gene expression corresponding to infected cells.</p>
<p>In the histograms below the distribution of the sum of log-normalized feature counts of genes upregulated or downregulated respectively can be seen.</p>
<p>For the upregulated genes (green) a bimodal distribution is not evident from the histogram below. No clear conclusions can be drawn, since the number of cells is probably too low.</p>
<p>For the downregulated genes there seem to be a large number of cells which do not express these genes at all. This group of cells could include infected cells, however this is a dangerous assumption, since in general there might be cells with low or none expression of these genes. There is no way to know if these cells are actually infected cells.</p>
<pre class="r"><code>#normalize counts of upregulated genes
counts_up &lt;- (hivmy2@assays$RNA@data)
counts_up &lt;- t(t(counts_up)) / colSums(counts_up)
counts_up &lt;- log1p(counts_up)
counts_up &lt;- counts_up[up_inf_filt, ]

# compute average expression of the 20 signature genes
p1 &lt;- as.data.frame(rowSums(t(counts_up))) %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;% 
  rename(&quot;count&quot; = &quot;rowSums(t(counts_up))&quot;) %&gt;% 
  arrange(desc(count)) %&gt;% 
  ggplot(aes(x  = count)) +
  geom_histogram(bins = 70, color = &quot;olivedrab4&quot;, fill = &quot;olivedrab4&quot;) +
  xlab(&quot;normalized feature counts&quot;) +
  ylab(&quot;number of cells&quot;) +
  ylim(0,100) +
  labs(title = &quot;Sum of feature counts of genes upregulated in Inf+EFZ vs. Uninf+EFZ&quot;)

#normalize counts of downregulated genes
counts_down &lt;- (hivmy2@assays$RNA@data)
counts_down &lt;- t(t(counts_down)) / colSums(counts_down)
counts_down &lt;- log1p(counts_down)
counts_down &lt;- counts_down[down_inf_filt, ]

# compute average expression of the 20 signature genes
p2 &lt;- as.data.frame(rowSums(t(counts_down))) %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;% 
  rename(&quot;count&quot; = &quot;rowSums(t(counts_down))&quot;) %&gt;% 
  arrange(desc(count)) %&gt;% 
  ggplot(aes(x  = count)) +
  geom_histogram(bins = 70, color = &quot;red4&quot;, fill = &quot;red4&quot;) +
  xlab(&quot;normalized feature counts&quot;) +
  ylab(&quot;number of cells&quot;) +
  labs(title = &quot;Sum of feature count of genes downregulated in Inf+EFZ vs. Uninf+EFZ&quot;)</code></pre>
<pre class="r"><code>p1 + p2</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-42-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-42-1">
Past versions of unnamed-chunk-42-1.png
</button>
</p>
<div id="fig-unnamed-chunk-42-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/22c8da852024074e3acc07ff7b24979c64230432/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-42-1.png" target="_blank">22c8da8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-42-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-42-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-42-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-42-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-42-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="scores-of-gene-signature-upregulated-in-cells-treated-with-efz-independently-of-infection-condition." class="section level4">
<h4>Scores of gene signature upregulated in cells treated with EFZ independently of infection condition.</h4>
<pre class="r"><code>up_treat &lt;- AddModuleScore(hivmy2,
                           features = treatment_up)

p1 &lt;- FeaturePlot(subset(up_treat, ht_cluster == &quot;c1&quot;),
                  features = &quot;Cluster1&quot;, pt.size = 1) +#, split.by = &quot;ht_cluster&quot;) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;Myeloid2 Cluster c1&quot;)

p2 &lt;- FeaturePlot(subset(up_treat, ht_cluster == &quot;c2&quot;),
                  features = &quot;Cluster1&quot;, pt.size = 1) +#, split.by = &quot;ht_cluster&quot;) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;Myeloid2 Cluster c2&quot;)

figure &lt;- ggarrange(p1, p2, ncol = 2)#, nrow = 2) 
annotate_figure(figure, top = text_grob(&quot;Signature score of genes upregulated in EFZ treatment&quot;, 
               color = &quot;black&quot;, face = &quot;bold&quot;, size = 20))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-43-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-43-1">
Past versions of unnamed-chunk-43-1.png
</button>
</p>
<div id="fig-unnamed-chunk-43-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-43-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-43-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-43-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-43-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/a5b39dcf024b9c39f73044e12a1c5e581e6ec861/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-43-1.png" target="_blank">a5b39dc</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="overlay-infefz-signature-with-the-tf-activity-heatmap-of-myeloid2-cells" class="section level2 tabset">
<h2 class="tabset">Overlay Inf+EFZ signature with the TF activity heatmap of Myeloid2 cells</h2>
<p>There are a few cells which express the Inf+EFZ signature and they are highlighted with an orange colour in the heatmap below. However, they are spread across all clusters and patients and since there are so few cells drawing a conclusion or finding a pattern is not feasible.</p>
<div id="k-3-hierarchical-clustering" class="section level3">
<h3>k = 3 hierarchical clustering</h3>
<pre class="r"><code># calculate scores for genes upregualted in Inf+EFZ iMg
up_sign &lt;- AddModuleScore(hivmy2,
                           features = up_inf_filt)

# extract the Myeloid2 cells which have a positive score for the Inf+EFZ signature
inf_efz_cells &lt;- rownames(up_sign@meta.data %&gt;% filter(Cluster1 &gt; 0))
#uninf_efz_cells &lt;- rownames(hivmy2_uninf_efz_sign@meta.data %&gt;% filter(Cluster1 &gt; 0))
#uninf_cells &lt;- rownames(hivmy2_uninf_sign@meta.data %&gt;% filter(Cluster1 &gt; 0))</code></pre>
<pre class="r"><code># read in Seurat object contianing alls samples and conditions
hiv7 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/total_7_samples_label_transfer.rds&quot;)
# import TF activity matrix of  Myeloid2 cells
auc_mtx &lt;- read.table(&quot;data_files/aucell_matrix_10k_hvg.tsv&quot;, sep = &quot;\t&quot;)


# 3 heatmaps with all Scenic TFs
ht_list &lt;- map(seq.int(1:3), function(n) {
  patients &lt;- c (&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;, &quot;HIV3_CSF&quot;) # 3 different patients
  # filter the dataset for only Myeloid2 cells and iteratively one of the patients
  df &lt;- hiv7@meta.data %&gt;% filter(cell_type == &quot;Myeloid2&quot;, 
                                  orig.ident == patients[n])
  # select only the cells of the activity matrix which are myeloid2 and the correct patient
  mtx &lt;- auc_mtx[rownames(auc_mtx) %in% rownames(df),]
  # heatmap
  ht &lt;- Heatmap(t(mtx), 
               column_title = paste0(&quot;patient: &quot;, patients[n]), 
               top_annotation = HeatmapAnnotation(signature = case_when(
                 rownames(mtx) %in% inf_efz_cells ~ &quot;Inf_EFZ_signature&quot;,
                 #rownames(mtx) %in% uninf_efz_cells ~ &quot;Uninf_EFZ_signature&quot;,
                 #rownames(mtx) %in% uninf_cells ~ &quot;Uninf_signature&quot;,
                 TRUE ~ &quot;no_signature&quot;),
                 name = &quot;signature&quot;,
                 col = list(signature = c(&quot;Inf_EFZ_signature&quot; = &quot;orange2&quot;,
                                          #&quot;Uninf_EFZ_signature&quot; = &quot;lightblue&quot;,
                                          #&quot;Uninf_signature&quot; = &quot;orange&quot;,
                                          &quot;no_signature&quot; = &quot;navy&quot;))),
               column_km = 3,
               #row_km = n, 
               show_column_names = FALSE,
               col =colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
               show_row_names = TRUE
               ) 
               #top_annotation = column_annotation) 
  list(name = patients[n], heatmap = ht)
})

ht_list[[1]]$heatmap + ht_list[[2]]$heatmap + ht_list[[3]]$heatmap </code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-45-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-45-1">
Past versions of unnamed-chunk-45-1.png
</button>
</p>
<div id="fig-unnamed-chunk-45-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-45-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-45-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-45-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-45-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/8979e1abf82cc2b12f5f7751155bf4fc7d0b5ed4/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-45-1.png" target="_blank">8979e1a</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-17
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
<div id="group-according-to-infection-condition" class="section level3">
<h3>group according to infection condition</h3>
<p>When you group the cells according to their different gene signatures as in the heatmap below, you do not really see a difference between the groups.</p>
<pre class="r"><code># filter the dataset for only Myeloid2 cells 
df &lt;- hiv7@meta.data %&gt;% filter(cell_type == &quot;Myeloid2&quot;, 
                                orig.ident %in% c (&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;, &quot;HIV3_CSF&quot;))
# select only the cells of the activity matrix which are myeloid2 and the correct patient
mtx &lt;- auc_mtx[rownames(auc_mtx) %in% rownames(df),]

# add signature column to dataframe
signature &lt;- df %&gt;%
  rownames_to_column(&quot;cell&quot;) %&gt;% 
  mutate(signature = case_when(cell %in% inf_efz_cells ~ &quot;Inf_signature&quot;,
                                #cell %in% uninf_efz_cells ~&quot;Uninf_EFZ_signature&quot;,
                                #cell %in% uninf_cells ~ &quot;Uninf_signature&quot;,
                               TRUE ~ &quot;no_signature&quot;))


ht &lt;- draw(Heatmap(t(mtx), 
             column_title = &quot;All patients split according to gene signature scores&quot;, 
             top_annotation = HeatmapAnnotation(signature = case_when(
               rownames(mtx) %in% inf_efz_cells ~ &quot;Inf_signature&quot;,
               #rownames(mtx) %in% uninf_efz_cells ~ &quot;Uninf_EFZ_signature&quot;,
               #rownames(mtx) %in% uninf_cells ~ &quot;Uninf_signature&quot;,
               TRUE ~ &quot;no_signature&quot;),
               name = &quot;signature&quot;,
               col = list(signature = c(&quot;Inf_signature&quot; = &quot;orange2&quot;,
                                        #&quot;Uninf_EFZ_signature&quot; = &quot;lightblue&quot;,
                                        #&quot;Uninf_signature&quot; = &quot;orange&quot;,
                                        &quot;no_signature&quot; = &quot;navy&quot;))),       
             column_split = signature$signature,
             show_column_names = FALSE,
             col =colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
             show_row_names = TRUE
             ))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-46-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-46-1">
Past versions of unnamed-chunk-46-1.png
</button>
</p>
<div id="fig-unnamed-chunk-46-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-46-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-46-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-46-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-46-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/8979e1abf82cc2b12f5f7751155bf4fc7d0b5ed4/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-46-1.png" target="_blank">8979e1a</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-17
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
</div>
<div id="overlay-efz-treatment-signature-with-the-tf-activity-heatmap-of-myeloid2-cells" class="section level2 tabset">
<h2 class="tabset">Overlay EFZ treatment signature with the TF activity heatmap of Myeloid2 cells</h2>
<pre class="r"><code># extract the Myeloid2 cells which have a positive score for the treatment signature
treat_cells &lt;- rownames(up_treat@meta.data %&gt;% filter(Cluster1 &gt; 0))</code></pre>
<div id="k-3-hierarchical-clustering-1" class="section level3">
<h3>k = 3 hierarchical clustering</h3>
<pre class="r"><code>
# 3 heatmaps with all Scenic TFs
ht_list &lt;- map(seq.int(1:3), function(n) {
  patients &lt;- c (&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;, &quot;HIV3_CSF&quot;) # 3 different patients
  # filter the dataset for only Myeloid2 cells and iteratively one of the patients
  df &lt;- hiv7@meta.data %&gt;% filter(cell_type == &quot;Myeloid2&quot;, 
                                  orig.ident == patients[n])
  # select only the cells of the activity matrix which are myeloid2 and the correct patient
  mtx &lt;- auc_mtx[rownames(auc_mtx) %in% rownames(df),]
  # heatmap
  ht &lt;- Heatmap(t(mtx), 
               column_title = paste0(&quot;patient: &quot;, patients[n]), 
               top_annotation = HeatmapAnnotation(signature = case_when(
                 rownames(mtx) %in% treat_cells ~ &quot;EFZ_treatment_signature&quot;,
                 #rownames(mtx) %in% uninf_efz_cells ~ &quot;Uninf_EFZ_signature&quot;,
                 #rownames(mtx) %in% uninf_cells ~ &quot;Uninf_signature&quot;,
                 TRUE ~ &quot;no_signature&quot;),
                 name = &quot;signature&quot;,
                 col = list(signature = c(&quot;EFZ_treatment_signature&quot; = &quot;olivedrab3&quot;,
                                          #&quot;Uninf_EFZ_signature&quot; = &quot;lightblue&quot;,
                                          #&quot;Uninf_signature&quot; = &quot;orange&quot;,
                                          &quot;no_signature&quot; = &quot;navy&quot;))),
               column_km = 3,
               #row_km = n, 
               show_column_names = FALSE,
               col =colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
               show_row_names = TRUE
               ) 
               #top_annotation = column_annotation) 
  list(name = patients[n], heatmap = ht)
})

ht_list[[1]]$heatmap + ht_list[[2]]$heatmap + ht_list[[3]]$heatmap </code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-48-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-48-1">
Past versions of unnamed-chunk-48-1.png
</button>
</p>
<div id="fig-unnamed-chunk-48-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/d85a63137b84a09c19647281ffe67edbcce2e1eb/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-48-1.png" target="_blank">d85a631</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
<div id="group-by-treatment-condition" class="section level3">
<h3>Group by treatment condition</h3>
<pre class="r"><code># filter the dataset for only Myeloid2 cells 
df &lt;- hiv7@meta.data %&gt;% filter(cell_type == &quot;Myeloid2&quot;, 
                                orig.ident %in% c (&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;, &quot;HIV3_CSF&quot;))
# select only the cells of the activity matrix which are myeloid2 and the correct patient
mtx &lt;- auc_mtx[rownames(auc_mtx) %in% rownames(df),]

# add signature column to dataframe
signature &lt;- df %&gt;%
  rownames_to_column(&quot;cell&quot;) %&gt;% 
  mutate(signature = case_when(cell %in% treat_cells ~ &quot;EFZ_treatment_signature&quot;,
                                #cell %in% uninf_efz_cells ~&quot;Uninf_EFZ_signature&quot;,
                                #cell %in% uninf_cells ~ &quot;Uninf_signature&quot;,
                               TRUE ~ &quot;no_signature&quot;))


ht &lt;- draw(Heatmap(t(mtx), 
             column_title = &quot;All patients split according to gene signature scores&quot;, 
             top_annotation = HeatmapAnnotation(signature = case_when(
               rownames(mtx) %in% treat_cells ~ &quot;EFZ_treatment_signature&quot;,
               #rownames(mtx) %in% uninf_efz_cells ~ &quot;Uninf_EFZ_signature&quot;,
               #rownames(mtx) %in% uninf_cells ~ &quot;Uninf_signature&quot;,
               TRUE ~ &quot;no_signature&quot;),
               name = &quot;signature&quot;,
               col = list(signature = c(&quot;EFZ_treatment_signature&quot; = &quot;olivedrab3&quot;,
                                        #&quot;Uninf_EFZ_signature&quot; = &quot;lightblue&quot;,
                                        #&quot;Uninf_signature&quot; = &quot;orange&quot;,
                                        &quot;no_signature&quot; = &quot;navy&quot;))),       
             column_split = signature$signature,
             show_column_names = FALSE,
             col =colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
             show_row_names = TRUE
             ))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-49-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-49-1">
Past versions of unnamed-chunk-49-1.png
</button>
</p>
<div id="fig-unnamed-chunk-49-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/fdf25ce5decf9dff024fb0470f591b4a70f6aee6/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-49-1.png" target="_blank">fdf25ce</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-49-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-49-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-49-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/f7843b5a7865b5270e721642ea06e9cb5261d374/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-49-1.png" target="_blank">f7843b5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/8979e1abf82cc2b12f5f7751155bf4fc7d0b5ed4/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-49-1.png" target="_blank">8979e1a</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-17
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
</div>
</div>
<div id="differential-tf-activity" class="section level1 tabset">
<h1 class="tabset">Differential TF activity</h1>
<p>After having identified a few cells with a high scores for the infection signature (Inf+EFZ), as well as cells with a high score for the EFZ treatment signatures, we can now check if some of the TFs show significantly different activity between the two conditions. For this we can use a pairwise Wilcox Test.</p>
<div id="between-infection-conditions" class="section level2">
<h2>Between infection conditions</h2>
<p>Are some TFs in Myeloid2 differentially active between the infection conditions?</p>
<p>There are no significant differences in TF activity between the cells with high scores for the Inf+EFZ signature compared to cells without the signature. Since no significant differences were found with the Kruskal-Wallis test, no further posthoc analysis was performed.</p>
<pre class="r"><code>hivmy2_scenic &lt;- AddMetaData(hivmy2, 
                    metadata = auc_mtx, 
                    col.name = colnames(auc_mtx))

inf_sign_df &lt;- hivmy2_scenic@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;% 
  mutate(signature = case_when(cell %in% inf_efz_cells ~ &quot;Inf_EFZ_signature&quot;,
                                TRUE ~ &quot;no_signature&quot;))

# check all TFs 
p_values &lt;- map(seq.int(1:125), function(n){
  tf &lt;- colnames(auc_mtx)[n]
  p_values &lt;- unlist(kruskal.test(pull(inf_sign_df[tf]) ~ signature, inf_sign_df))[&quot;p.value&quot;]
})

# adjust for multiple testing with FDR
adj_p_values &lt;- p.adjust(as.numeric(unname(unlist(p_values))), method = &quot;fdr&quot;)

# how many transcription factors are significantly different between the clusters?
sign &lt;- adj_p_values[adj_p_values &lt; 0.05]</code></pre>
<hr />
</div>
<div id="between-treatment-conditions" class="section level2">
<h2>Between treatment conditions</h2>
<p>Are some TFs in Myeloid2 differentially active between the treatment conditions?</p>
<p>There are no significant differences in TF activity between the cells with high scores for EFZ treatment signature compared to cells without the signature. Therefore, no posthoc analysis was performed.</p>
<pre class="r"><code>df &lt;- hivmy2_scenic@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;% 
        # filter(cell %in% c(inf_efz_cells, uninf_efz_cells, uninf_cells)) %&gt;% 
  mutate(signature = case_when(cell %in% treat_cells ~ &quot;treatment_signature&quot;,
                                TRUE ~ &quot;no_signature&quot;))

# check all TFs 
p_values &lt;- map(seq.int(1:125), function(n){
  tf &lt;- colnames(auc_mtx)[n]
  p_values &lt;- unlist(kruskal.test(pull(df[tf]) ~ signature, df))[&quot;p.value&quot;]
})

# adjust for multiple testing with FDR
adj_p_values &lt;- p.adjust(as.numeric(unname(unlist(p_values))), method = &quot;fdr&quot;)

# how many transcription factors are significantly different between the clusters?
sign &lt;- adj_p_values[adj_p_values &lt; 0.05]</code></pre>
<hr />
</div>
<div id="gene-expression-of-inflammatory-genes" class="section level2">
<h2>Gene expression of inflammatory genes</h2>
<p><span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span> showed that two pathways are specifically activated in the Inf+EFZ condition, namely RhoGDI signaling and CD40 signaling. This effect was not seen in Uninf+EFZ, so it does not seem to be caused by EFZ alone, but rather a combination of infection and EFZ treatment <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>.</p>
<ul>
<li>RhoGDI signaling:
<ul>
<li>PP1R12A was upregulated</li>
<li>RND3, CD44, ACTG1 were downregulated</li>
</ul></li>
<li>CD40 signaling:
<ul>
<li>FOS was upregulated</li>
<li>NFKBIA, ICAM1, TFNAIP3 were downregulated</li>
</ul></li>
</ul>
<p>Here, we would like to see if cell with high scores for the Inf+EFZ signature show gene expression patterns that are in line with the findings by <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>. The gene expression for each gene is shown in the figure below. We would expect only PP1R12A and FOS to be more highly expressed in the cells with Inf+EFZ signature, while all other genes should be less highly expressed. This pattern in gene expression is, however, not observed.</p>
<pre class="r"><code># read in Seurat object containing Myeloid2 cells
hivmy2_scenic &lt;- AddMetaData(hivmy2_scenic, metadata = inf_sign_df$signature, col.name = &quot;signature&quot;)

# RhoGDI signaling in myeloid2
p1 &lt;- VlnPlot(hivmy2_scenic, features = c(&quot;RND3&quot;, &quot;CD44&quot;, &quot;ACTG1&quot;, &quot;PPP1R12A&quot;), 
              group.by = &quot;signature&quot;, ncol = 2)

# CD40 signaling in myeloid2
p2 &lt;- VlnPlot(hivmy2_scenic, features =c(&quot;NFKBIA&quot;, &quot;ICAM1&quot;, &quot;TNFAIP3&quot;, &quot;FOS&quot;), 
              group.by = &quot;signature&quot;, ncol = 2)
Warning: The following variables were found in both object metadata and the default assay: FOS
Returning metadata; if you want the feature, please use the assay&#39;s key (eg. rna_FOS)

# RhoGDI signaling in iMg
p3 &lt;- VlnPlot(microglia, features = c(&quot;RND3&quot;, &quot;CD44&quot;, &quot;ACTG1&quot;, &quot;PPP1R12A&quot;), 
        ncol = 2, pt.size = 0, group.by = &quot;orig.ident&quot;)
Warning: Could not find ACTG1 in the default search locations, found in RNA
assay instead
Warning: Could not find PPP1R12A in the default search locations, found in RNA
assay instead

# CD40 signaling in iMg
p4 &lt;- VlnPlot(microglia, features = c(&quot;NFKBIA&quot;, &quot;ICAM1&quot;, &quot;TNFAIP3&quot;, &quot;FOS&quot;), 
        ncol = 2, pt.size = 0, group.by = &quot;orig.ident&quot;)

fig &lt;- ggarrange(p1, p3, ncol = 2, nrow = 1)
annotate_figure(fig, top = text_grob(&quot;Expression of four genes of the RhoGDI signaling pathway in Myeloid2 (left column) and iMg (right column)&quot;,
                                     size = 20 , face = &quot;bold&quot;))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-52-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-52-1">
Past versions of unnamed-chunk-52-1.png
</button>
</p>
<div id="fig-unnamed-chunk-52-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/d2f59b2d133fb7c2394b97182e5052ef1e4aadd5/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-52-1.png" target="_blank">d2f59b2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-27
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/d85a63137b84a09c19647281ffe67edbcce2e1eb/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-52-1.png" target="_blank">d85a631</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>
fig &lt;- ggarrange(p2, p4, ncol = 2, nrow = 1)
annotate_figure(fig, top = text_grob(&quot;Expression of four genes of the CD40 signaling pathway in Myeloid2 (left column) and iMg (right column)&quot;,
                                     size = 20 , face = &quot;bold&quot;))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-52-2.png" width="1440" style="display: block; margin: auto;" /></p>
<p>Only FOS which encodes a TF is found in the TF activity matrix, so for FOS the TF acivity is shown as well. Judging from the figure below FOS seems to be more active in cells with high score for Inf+EFZ signature, but this difference is not statistically significant.</p>
<pre class="r"><code>inf_sign_df %&gt;% ggplot(aes(x = signature, y = FOS)) +
  geom_violin(aes(fill = signature, alpha = .6)) +
  geom_boxplot(alpha = 0) +
  stat_pvalue_manual(inf_sign_df %&gt;% 
                       pairwise_wilcox_test(FOS ~ signature) %&gt;% 
  add_xy_position())</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-53-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="inflammatory-pathways" class="section level2">
<h2>Inflammatory Pathways</h2>
<p>As already mentioned above <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span> showed that two pathways are specifically activated in the Inf+EFZ condition, namely RhoGDI signaling and CD40 signaling. This effect was not seen in Uninf+EFZ, so it does not seem to be caused by EFZ alone, but rather a combination of infection and EFZ treatment <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>.</p>
<ul>
<li>RhoGDI signaling:
<ul>
<li>PP1R12A was upregulated</li>
<li>RND3, CD44, ACTG1 were downregulated</li>
</ul></li>
<li>CD40 signaling:
<ul>
<li>FOS was upregulated</li>
<li>NFKBIA, ICAM1, TFNAIP3 were downregulated</li>
</ul></li>
</ul>
<p>To answer the question whether we could find similar patterns in the two Myeloid2 clusters with different TF activity, we had a look at the gene expression.</p>
<div id="myeloid2-cells" class="section level5">
<h5>Myeloid2 cells</h5>
<p>Two genes of the RhoGDI signaling pathway were found among the differentially expressed genes between Inf+EFZ and Uninf+EFZ. Both of them were downregulated in Inf+EFZ compared to Uninf+EFZ iMg as can be seen in the table below.</p>
<pre class="r"><code>inf_uninf_art_marker %&gt;% 
  rownames_to_column(&quot;gene&quot;) %&gt;%
  filter(gene %in% c(&quot;RND3&quot;, &quot;CD44&quot;, &quot;ACTG1&quot;, &quot;PPP1R12A&quot;)) %&gt;%
  kable(caption = &quot;Genes of the RhoGDI signaling pathway found among genes differentially expressed between Inf+EFZ and Uninf+EFZ&quot;)</code></pre>
<table>
<caption>Genes of the RhoGDI signaling pathway found among genes differentially expressed between Inf+EFZ and Uninf+EFZ</caption>
<thead>
<tr class="header">
<th align="left">gene</th>
<th align="right">p_val</th>
<th align="right">avg_log2FC</th>
<th align="right">pct.1</th>
<th align="right">pct.2</th>
<th align="right">p_val_adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RND3</td>
<td align="right">0</td>
<td align="right">-1.6635458</td>
<td align="right">0.045</td>
<td align="right">0.386</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CD44</td>
<td align="right">0</td>
<td align="right">-0.5883562</td>
<td align="right">0.396</td>
<td align="right">0.539</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>All four genes of the CD40 signaling were found among the differentially expressed genes between Inf+EFZ and Uninf+EFZ. FOS was upregulated, while NFKBIA, ICAM1 and TFNAIP3 were downregulated in Inf+EFZ compared to Uninf+EFZ as can be seen in the table below.</p>
<pre class="r"><code>inf_uninf_art_marker %&gt;% 
  rownames_to_column(var = &quot;gene&quot;) %&gt;%
  filter(gene %in% c(&quot;FOS&quot;, &quot;NFKBIA&quot;, &quot;ICAM1&quot;, &quot;TNFAIP3&quot;)) %&gt;% kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">gene</th>
<th align="right">p_val</th>
<th align="right">avg_log2FC</th>
<th align="right">pct.1</th>
<th align="right">pct.2</th>
<th align="right">p_val_adj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ICAM1</td>
<td align="right">0</td>
<td align="right">-1.3649862</td>
<td align="right">0.169</td>
<td align="right">0.496</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">NFKBIA</td>
<td align="right">0</td>
<td align="right">-1.0940764</td>
<td align="right">0.527</td>
<td align="right">0.784</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">TNFAIP3</td>
<td align="right">0</td>
<td align="right">-1.3232813</td>
<td align="right">0.158</td>
<td align="right">0.465</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">FOS</td>
<td align="right">0</td>
<td align="right">0.5719556</td>
<td align="right">0.293</td>
<td align="right">0.139</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The changes in gene expression of both pathways are in line with the findings by <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span>.</p>
<p>Additionally, we were interested whether this pattern in gene expression correlated with the two clusters identified in Myeloid2 which exhibit different TF activities. The figure below show the gene expression of the four genes of the respective pathways both in Myeloid2 cells (left column) and in iMg (right column).</p>
<p>FOS is the only gene which shows a high expression in Myeloid2 cluster c1. This supports our hypothesis that c1 might be a latently infected reactive microglia cell state. However then we would expect to see a similar pattern for the RhoGDI signaling, meaning PPP1R12A should be the only gene which is highly expressed in c1. This is not the case, but rather CD44 and ACTG1 also show higher expression in c1 compared to c2. Consequently, our hypothesis is not clearly supported by the expression patterns of these inflammatory genes.</p>
<pre class="r"><code># isolate microglia cells
microglia &lt;- subset(combined, cell_type == &quot;iMg&quot;)

# read in Seurat object containing Myeloid2 cells
hivmy2 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/hiv_myeloid2_subclusters&quot;)


p1 &lt;- VlnPlot(hivmy2, features = c(&quot;RND3&quot;, &quot;CD44&quot;, &quot;ACTG1&quot;, &quot;PPP1R12A&quot;), 
              group.by = &quot;ht_cluster&quot;, ncol = 2)

p2 &lt;- VlnPlot(hivmy2, features =c(&quot;NFKBIA&quot;, &quot;ICAM1&quot;, &quot;TNFAIP3&quot;, &quot;FOS&quot;), 
              group.by = &quot;ht_cluster&quot;, ncol = 2)

p3 &lt;- VlnPlot(microglia, features = c(&quot;RND3&quot;, &quot;CD44&quot;, &quot;ACTG1&quot;, &quot;PPP1R12A&quot;), 
        ncol = 2, pt.size = 0, group.by = &quot;orig.ident&quot;)
Warning: Could not find ACTG1 in the default search locations, found in RNA
assay instead
Warning: Could not find PPP1R12A in the default search locations, found in RNA
assay instead

p4 &lt;- VlnPlot(microglia, features = c(&quot;NFKBIA&quot;, &quot;ICAM1&quot;, &quot;TNFAIP3&quot;, &quot;FOS&quot;), 
        ncol = 2, pt.size = 0, group.by = &quot;orig.ident&quot;)

fig &lt;- ggarrange(p1, p3, ncol = 2, nrow = 1)
annotate_figure(fig, top = text_grob(&quot;Expression of four genes of the RhoGDI signaling pathway in Myeloid2 (left column) and iMg (right column)&quot;,
                                     size = 20 , face = &quot;bold&quot;))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-56-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-56-1">
Past versions of unnamed-chunk-56-1.png
</button>
</p>
<div id="fig-unnamed-chunk-56-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/d85a63137b84a09c19647281ffe67edbcce2e1eb/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-56-1.png" target="_blank">d85a631</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>
fig &lt;- ggarrange(p2, p4, ncol = 2, nrow = 1)
annotate_figure(fig, top = text_grob(&quot;Expression of four genes of the CD40 signaling pathway in Myeloid2 (left column) and iMg (right column)&quot;,
                                     size = 20 , face = &quot;bold&quot;))</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-56-2.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-56-2">
Past versions of unnamed-chunk-56-2.png
</button>
</p>
<div id="fig-unnamed-chunk-56-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/d85a63137b84a09c19647281ffe67edbcce2e1eb/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-56-2.png" target="_blank">d85a631</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>
Same two pathways in Myeloid5 cells
</summary>
<p>Myeloid5 cells</p>
<pre class="r"><code>
# isolate the Myeloid5 cluster
hivmy5 &lt;- subset(hiv7, cell_type == &quot;Myeloid5&quot; &amp; orig.ident %in% c(&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;, &quot;HIV3_CSF&quot;))

# process Myeloid 5 Seurat object
hivmy5 &lt;- ScaleData(hivmy5, verbose = FALSE)
hivmy5 &lt;- NormalizeData(hivmy5, verbose = FALSE)
hivmy5 &lt;- ScaleData(hivmy5, verbose = FALSE)
hivmy5 &lt;- FindVariableFeatures(hivmy5, verbose = FALSE)
Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
parametric, : pseudoinverse used at -2.0668
Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
parametric, : neighborhood radius 0.49858
Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
parametric, : reciprocal condition number 3.7892e-16
Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
parametric, : There are other near singularities as well. 0.090619
hivmy5 &lt;- RunPCA(hivmy5, features = VariableFeatures(hivmy5), verbose = FALSE)
#ElbowPlot(hivmy5)
hivmy5 &lt;- RunTSNE(hivmy5, dims= 1:10, verbose = FALSE)</code></pre>
<pre class="r"><code>
p1 &lt;- VlnPlot(hivmy5, features = c(&quot;RND3&quot;, &quot;CD44&quot;, &quot;ACTG1&quot;, &quot;PPP1R12A&quot;), 
              group.by = &quot;orig.ident&quot;,ncol = 2)
Warning in SingleExIPlot(type = type, data = data[, x, drop = FALSE], idents =
idents, : All cells have the same value of RND3.

p2 &lt;- VlnPlot(hivmy5, features =c(&quot;NFKBIA&quot;, &quot;ICAM1&quot;, &quot;TNFAIP3&quot;, &quot;FOS&quot;), 
              group.by = &quot;orig.ident&quot;, ncol = 2)

p3 &lt;- VlnPlot(microglia, features = c(&quot;RND3&quot;, &quot;CD44&quot;, &quot;ACTG1&quot;, &quot;PPP1R12A&quot;), 
        ncol = 2, pt.size = 0, group.by = &quot;orig.ident&quot;)
Warning: Could not find ACTG1 in the default search locations, found in RNA
assay instead
Warning: Could not find PPP1R12A in the default search locations, found in RNA
assay instead

p4 &lt;- VlnPlot(microglia, features = c(&quot;NFKBIA&quot;, &quot;ICAM1&quot;, &quot;TNFAIP3&quot;, &quot;FOS&quot;), 
        ncol = 2, pt.size = 0, group.by = &quot;orig.ident&quot;)

ggarrange(p2, p4, p1, p3, ncol = 2, nrow = 2)</code></pre>
<p><img src="figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-58-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-58-1">
Past versions of unnamed-chunk-58-1.png
</button>
</p>
<div id="fig-unnamed-chunk-58-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/d85a63137b84a09c19647281ffe67edbcce2e1eb/docs/figure/Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd/unnamed-chunk-58-1.png" target="_blank">d85a631</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Ryan" class="csl-entry">
Ryan SK, Garifallou JP, Gonzalez MV. 2020. <em>Neuroinflammation and Eif2 Signaling Persist Despite Antiretroviral Treatment in an hiPSC Tri-Culture Model of HIV Infection</em>. <em>#SStem Cell Reports</em>. Vol. 14(4). <a href="https://doi: 10.1016/j.stemcr.2020.02.010">doi: 10.1016/j.stemcr.2020.02.010</a>.
</div>
<div id="ref-Farhadian" class="csl-entry">
Shelli F. Farhadian, Chrysoula Zografou, Sameet S. Mehta, and Serena S. Spudich. 2018. <em>Single-Cell RNA Sequencing Reveals Microglia-Like Cells in Cerebrospinal Fluid During Virologically Suppressed HIV</em>. <em>JCI Insight</em>. Vol. 3(18):e121718. <a href="https://doi.org/10.1172/jci.insight.121718">https://doi.org/10.1172/jci.insight.121718</a>.
</div>
<div id="ref-Stuart" class="csl-entry">
Stuart T, Hoffman P, Butler A. 2019. <em>Comprehensive Integration of Single-Cell Data</em>. <em>Cell</em>. Vol. 177(7). <a href="https://doi: 10.1016/j.cell.2019.05.031">doi: 10.1016/j.cell.2019.05.031</a>.
</div>
</div>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()
R version 4.0.2 (2020-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.3.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] parallel  grid      stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] readxl_1.3.1         multtest_2.46.0      Biobase_2.50.0      
 [4] BiocGenerics_0.36.1  metap_1.6            knitr_1.30          
 [7] rstatix_0.6.0        corrplot_0.92        gridExtra_2.3       
[10] ggpubr_0.4.0         circlize_0.4.13      ComplexHeatmap_2.9.4
[13] ggcorrplot_0.1.3     pheatmap_1.0.12      RColorBrewer_1.1-2  
[16] ggrepel_0.9.1        data.table_1.14.2    Matrix_1.3-4        
[19] edgeR_3.32.0         limma_3.46.0         SeuratObject_4.0.3  
[22] Seurat_4.0.5         forcats_0.5.0        stringr_1.4.0       
[25] dplyr_1.0.7          purrr_0.3.4          readr_1.4.0         
[28] tidyr_1.1.2          tibble_3.1.6         ggplot2_3.3.5       
[31] tidyverse_1.3.0      workflowr_1.6.2     

loaded via a namespace (and not attached):
  [1] utf8_1.2.2            reticulate_1.22       tidyselect_1.1.1     
  [4] htmlwidgets_1.5.4     Rtsne_0.15            munsell_0.5.0        
  [7] units_0.6-7           mutoss_0.1-12         codetools_0.2-18     
 [10] ica_1.0-2             future_1.23.0         miniUI_0.1.1.1       
 [13] withr_2.4.3           colorspace_2.0-2      highr_0.8            
 [16] rstudioapi_0.13       stats4_4.0.2          ROCR_1.0-11          
 [19] ggsignif_0.6.0        tensor_1.5            listenv_0.8.0        
 [22] labeling_0.4.2        Rdpack_2.1.2          git2r_0.27.1         
 [25] mnormt_2.0.2          polyclip_1.10-0       farver_2.1.0         
 [28] rprojroot_2.0.2       TH.data_1.0-10        parallelly_1.29.0    
 [31] vctrs_0.3.8           generics_0.1.1        xfun_0.29            
 [34] R6_2.5.1              doParallel_1.0.16     clue_0.3-60          
 [37] RVenn_1.1.0           locfit_1.5-9.4        spatstat.utils_2.2-0 
 [40] assertthat_0.2.1      promises_1.2.0.1      scales_1.1.1         
 [43] multcomp_1.4-15       gtable_0.3.0          globals_0.14.0       
 [46] goftest_1.2-3         sandwich_3.0-0        rlang_0.4.12         
 [49] GlobalOptions_0.1.2   splines_4.0.2         lazyeval_0.2.2       
 [52] spatstat.geom_2.3-0   broom_0.7.2           yaml_2.2.1           
 [55] reshape2_1.4.4        abind_1.4-5           modelr_0.1.8         
 [58] backports_1.2.0       httpuv_1.6.3          tools_4.0.2          
 [61] ellipsis_0.3.2        spatstat.core_2.3-1   ggridges_0.5.2       
 [64] TFisher_0.2.0         Rcpp_1.0.7            plyr_1.8.6           
 [67] classInt_0.4-3        rpart_4.1-15          deldir_1.0-6         
 [70] pbapply_1.5-0         GetoptLong_1.0.5      cowplot_1.1.1        
 [73] S4Vectors_0.28.1      zoo_1.8-9             haven_2.3.1          
 [76] cluster_2.1.0         fs_1.5.1              magrittr_2.0.1       
 [79] magick_2.5.2          scattermore_0.7       openxlsx_4.2.3       
 [82] lmtest_0.9-39         reprex_0.3.0          RANN_2.6.1           
 [85] tmvnsim_1.0-2         mvtnorm_1.1-1         whisker_0.4          
 [88] fitdistrplus_1.1-6    matrixStats_0.61.0    hms_1.1.1            
 [91] patchwork_1.1.1       mime_0.12             evaluate_0.14        
 [94] xtable_1.8-4          rio_0.5.16            IRanges_2.24.1       
 [97] shape_1.4.6           compiler_4.0.2        KernSmooth_2.23-18   
[100] crayon_1.4.2          htmltools_0.5.2       mgcv_1.8-33          
[103] later_1.3.0           ggVennDiagram_1.2.0   lubridate_1.7.9.2    
[106] DBI_1.1.1             dbplyr_2.0.0          MASS_7.3-53          
[109] sf_0.9-6              car_3.0-10            cli_3.1.0            
[112] rbibutils_2.2.4       igraph_1.2.9          pkgconfig_2.0.3      
[115] sn_2.0.1              numDeriv_2016.8-1.1   foreign_0.8-80       
[118] plotly_4.9.2.1        spatstat.sparse_2.0-0 xml2_1.3.2           
[121] foreach_1.5.1         rvest_0.3.6           digest_0.6.29        
[124] sctransform_0.3.2     RcppAnnoy_0.0.19      spatstat.data_2.1-0  
[127] rmarkdown_2.6         cellranger_1.1.0      leiden_0.3.5         
[130] uwot_0.1.10           curl_4.3.2            shiny_1.7.1          
[133] rjson_0.2.20          lifecycle_1.0.1       nlme_3.1-150         
[136] jsonlite_1.7.2        carData_3.0-4         viridisLite_0.4.0    
[139] fansi_0.5.0           pillar_1.6.4          lattice_0.20-41      
[142] plotrix_3.8-2         fastmap_1.1.0         httr_1.4.2           
[145] survival_3.2-7        glue_1.6.0            zip_2.1.1            
[148] png_0.1-7             iterators_1.0.13      class_7.3-17         
[151] stringi_1.7.6         mathjaxr_1.4-0        e1071_1.7-4          
[154] irlba_2.3.3           future.apply_1.8.1   </code></pre>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiVHJpY3VsdHVyZSBkYXRhc2V0IgphdXRob3I6ICJLYXRoYXJpbmEgTWlrdWxpayIKYmlibGlvZ3JhcGh5OiByZWZlcmVuY2VzLmJpYgpsaW5rLWNpdGF0aW9uczogeWVzCi0tLQoKPHN0eWxlPgpib2R5IHsKdGV4dC1hbGlnbjoganVzdGlmeX0KPC9zdHlsZT4KCgpgYGB7ciBzZXR1cH0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLCBjb2xsYXBzZSA9IFRSVUUsIG1lc3NhZ2UgPSBGQUxTRSwKICAgICAgICAgICAgICAgICAgICAgIGNhY2hlID0gVFJVRSwgY2FjaGUubGF6eSA9IEZBTFNFLCBhdXRvZGVwID0gVFJVRSkKc2V0LnNlZWQoNDIpICMgVE9ETzogY2hlY2sgd2l0aCBkZWZhdWx0IHNlZWQKYGBgCgoKCmBgYHtyfQpsaWJyYXJ5KHRpZHl2ZXJzZSkKbGlicmFyeShTZXVyYXQpCmxpYnJhcnkoZWRnZVIpCmxpYnJhcnkoTWF0cml4KQpsaWJyYXJ5KGRhdGEudGFibGUpCmxpYnJhcnkoZ2dyZXBlbCkKI2xpYnJhcnkoaGFybW9ueSkKbGlicmFyeShSQ29sb3JCcmV3ZXIpCmxpYnJhcnkocGhlYXRtYXApCmxpYnJhcnkoZ2djb3JycGxvdCkKbGlicmFyeShDb21wbGV4SGVhdG1hcCkKbGlicmFyeShjaXJjbGl6ZSkKbGlicmFyeShnZ3B1YnIpCmxpYnJhcnkoZ3JpZEV4dHJhKQpsaWJyYXJ5KGNvcnJwbG90KQpsaWJyYXJ5KHJzdGF0aXgpCmxpYnJhcnkoa25pdHIpCmxpYnJhcnkobWV0YXApCmxpYnJhcnkobXVsdHRlc3QpCmxpYnJhcnkocmVhZHhsKQpgYGAKCiMgVHJpY3VsdHVyZSBEYXRhc2V0CgpUaGUgdHJpY3VsdHVyZSBkYXRhc2V0IHVzZWQgd2FzIHB1Ymxpc2hlZCBieSBbQFJ5YW5dLiAKVGhleSB1c2VkIGEgVHJpY3VsdHVyZSBzeXN0ZW0gd2l0aCBpbmR1Y2VkIG5ldXJvbnMsIGluZHVjZWQgYXN0cm9jeXRlcyBhbmQgCmluZHVjZWQgbWljcm9nbGlhLgpJbmR1Y2VkIG1pY3JvZ2xpYSBleHByZXNzIG1hcmtlciBnZW5lcyBDWDNDUjEsIElCQTEsIFRNRU0xMTkgYW5kIFAyUlkxMi4KQ0NSNSB3aGljaCBpcyBhIGNvLXJlY2VwdG9yIG5lY2Vzc2FyeSBmb3IgSElWIGluZmVjdGlvbiBpcyBhbHNvIGV4cHJlc3NlZCBieSAKdGhlc2UgY2VsbHMsIGJ1dCB0aGV5IGxhY2sgZXhwcmVzc2lvbiBvZiBteWVsb2lkLXByb2dlbml0b3IgbWFya2VycyBbQFJ5YW5dLgoKaU1nIHdlcmUgaW5mZWN0ZWQgd2l0aCBISVYgZm9yIDE1IGRheXMgKHJlc3VsdGluZyBpbiA5NCUgb2YgY2VsbHMgaW5mZWN0ZWQsIApwb3NpdGl2ZSBmb3IgSElWIGNhcHNpZCBwcm90ZWluIHAyNCBhbmQgZXhoaWJpdGluZyBtdWx0aW51Y2xlYXRpb24pLiBTb21lIGNlbGxzCndlcmUgdHJlYXRlZCB3aXRoIHRoZSBBUlQgRUZaLiBFRlogYmxvY2tzIEhJViByZXZlcnNlIHRyYW5zY3JpcHRpb24uIFRoaXMgd2F5IGl0IHdhcyBwb3NzaWJsZSB0byBzdHVkeSBub24tcHJvZHVjdGl2ZWx5IGluZmVjdGVkIGNlbGxzLiBFRlogcmVkdWNlZCBpbmZlY3Rpb24gYnkgdHdvIAp0aGlyZHMgW0BSeWFuXS4KCkluIHRoZSBpbmZlY3RlZCwgYnV0IG5vdCB0cmVhdGVkIGlNZyAoSW5mKSBpbmZsYW1tYXRvcnkgcGF0aHdheXMgd2VyZSAKc2lnbmlmaWNhbnRseSB1cGVyZWd1bGF0ZWQgY29tcGFyZWQgdG8gdGhlIHVuaW5mZWN0ZWQgY29uZGl0aW9uKFVuaW5mKSwgaW5jbHVkaW5nCklMLTgsIE5Ga0IgYW5kIEVJRjIuIApUaGVyZSB3YXMgZGVjcmVhc2VkIGV4cHJlc3Npb24gb2YgcHJvLWltZmxhbW1hdG9yeSBnZW5lcyBJTDFiLCBJbDggYW5kIFRORmFscGhhCmluIHRoZSBpbmZlY3RlZCBhbmQgdHJlYXRlZCAoSW5mK0VGWikgdnMgSW5mIGNvbmRpdGlvbi4gVGhpcyBzdWdnZXN0cyBhIHJlZHVjZWQgaW5mbGFtbWF0b3J5IHJlYWN0aW9uIFtAUnlhbl0uIE5ldmVydGhlbGVzcywgdGhlcmUgd2VyZQp0d28gZGlzdGluY3QgcGF0aHdheXMgd2hpY2ggd2VyZSB1cHJlZ3VsYXRlZCBpbiAKSW5mK0VGWiBpTWcsIG5hbWVseSBSaG9HREkgc2lnbmFsaW5nIGFuZCBDRDQwIHNpZ25hbGluZyBwYXRod2F5LiBUaGlzIHdpbGwgYmUgCmRpc2N1c3NlZCBpbiBtb3JlIGRldGFpbCBsYXRlciBvbiBbQFJ5YW5dLgoKVGhlcmUgd2FzICBhIGNoYW5nZSBpbiBzaWduYWxpbmcgcGF0aHdheXMgY2F1c2VkIGJ5IEVGWiB0cmVhdG1lbnQgZXZlbiBpbiAKdGhlIHVuaW5mZWN0ZWQgYW5kIHRyZWF0ZWQgKFVuaW5mK0VGWikgdmVyc3VzIHRoZSB1bmluZmVjdGVkLCBidXQgbm90IHRyZWF0ZWQKKFVuaW5mKSBjb25kaXRpb24uIFRoZSBFRlogdHJlYXRtZW50IGFsb25lIHdhcyB2ZXJ5IGRpZmZlcmVudCBmcm9tIHRoZSBFRlogdHJlYXRtZW50IHdpdGggaW5mZWN0aW9uIFtAUnlhbl0uIAoKIAo8ZGV0YWlscz4KPHN1bW1hcnk+KipGaWxlcyBhbmQgZGF0YSBzdHJ1Y3R1cmUqKjwvc3VtbWFyeT4KICAKKipSZWFkIGluIEZpbGVzOioqCgphYmJyZXZpYXRpb25zOiAKCiogaWEvMiA9IGluZmVjdGVkIHdpdGggSElWICsgdHJlYXRlZCB3aXRoIEFSVAoqIGNhID0gdW5pbmZlY3RlZCArIEFSVAoqIGN0bCA9IHVuaW5mZWN0ZWQKKiBpbmYgPSBpbmZlY3RlZCAKCmZpbGUgc3RydWN0dXJlOiAKCiogdGhlICIubXR4IiBmaWxlcyBjb250YWlucyBhIHNwYXJzZSBtYXRyaXggb2YgY2xhc3MgZGdUTWF0cml4CiogdGhlICJiYXJjb2Rlcy50c3YiIGZpbGVzIGNvbnRhaW4gdGhlIGNlbGwgYmFyY29kZXMKKiB0aGUgImZlYXR1cmVzLnRzdiIgZmlsZXMgY29udGFpbiB0aGUgZmVhdHVyZSBuYW1lcyBhcyB3ZWxsIGFzIGVuc2VtYmxlIGdlbmUgaWRzIAphbmQgImdlbmUgZXhwcmVzc2lvbiIgc3RyaW5ncyBpbiBhIHRoaXJkIGNvbHVtbgoKClRoZXJlIGFyZSBkdXBsaWNhdGVkIGZlYXR1cmVzIGluIHRoZSBkYXRhLiBIb3cgZG8geW91IGRlYWwgd2l0aCB0aGlzIHByb2JsZW0/Cihwcm9iYWJseSwgYmVjYXVzZSB0aGVyZSBhcmUgbXVsdGlwbGUgZW5zZW1ibGUgZ2VuZSBJRHMgbWFwcGluZyB0byB0aGUgc2FtZQpnZW5lIHN5bWJvbCAtPiB0aGUgc2FtZSBnZW5lIHN5bWJvbCBoYXMgbXVsdGlwbGUgZXhwcmVzc2lvbiB2YWx1ZXMpCgoqIFlvdSBjb3VsZCBtYWtlIHRoZW0gdW5pcXVlIHdpdGggdGhlIGZ1bmN0aW9uIGBtYWtlLnVuaXF1ZSgpYAoqIFlvdSBjb3VsZCByZW1vdmUgdGhlIGR1cGxpY2F0ZWQgZmVhdHVyZXMgLT4gdGhpcyBpcyB3aGF0IEkgZGlkCgpgYGAKcGF0aCA8LSAiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL2RhdGEvR1NFMTQzNjg2X1JBVy8iICMiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL2RhdGEvR1NFMTQzNjg2X1JBVy8iCmFsbF9maWxlcyA8LSBsaXN0LmZpbGVzKHBhdGgpCgphbGxfY29uZF9saXN0IDwtIG1hcChzZXEuaW50KDMsNyksIGZ1bmN0aW9uKG4pewogIGZpbGUgPC0gYWxsX2ZpbGVzW2dyZXBsKHBhc3RlMCgiR1NNNDI3MjU4IiwgbiksIGFsbF9maWxlcyldCiAgbmFtZSA8LSBzdHJfZXh0cmFjdChmaWxlW1sxXV0sImNhfGN0bHxpYTJ8aWF8aW5mIikKICBiYXJjb2RlcyA8LSByZWFkLnRhYmxlKHBhc3RlMChwYXRoLGZpbGVbWzFdXSksIHNlcCA9ICJcdCIpIAogIGZlYXR1cmVzIDwtIHJlYWQudGFibGUocGFzdGUwKHBhdGgsIGZpbGVbWzJdXSksIHNlcCA9ICJcdCIpCiAgbWF0cml4IDwtIHJlYWRNTShwYXN0ZTAocGF0aCwgZmlsZVtbM11dKSkKICBjb2xuYW1lcyhtYXRyaXgpIDwtIGJhcmNvZGVzJFYxCiAgcm93bmFtZXMobWF0cml4KSA8LSBmZWF0dXJlcyRWMgogIG1hdHJpeCA8LSBtYXRyaXhbIWR1cGxpY2F0ZWQocm93bmFtZXMobWF0cml4KSksXQogIHNldXJhdF9vYiA8LSBDcmVhdGVTZXVyYXRPYmplY3QobWF0cml4LCBwcm9qZWN0ID0gbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2F5ID0gIlJOQSIsIG1pbi5jZWxscyA9IDEsIG1pbi5mZWF0dXJlcyA9IDEpCiAgc2V1cmF0X29iW1sicGVyY2VudF9tdCJdXSA8LSBQZXJjZW50YWdlRmVhdHVyZVNldChzZXVyYXRfb2IsIHBhdHRlcm4gPSAiXk1ULSIpCiAgbGlzdChuYW1lID0gbmFtZSwgY291bnQgPSBtYXRyaXgsIHNldXJhdF9vYiA9IHNldXJhdF9vYikKfSkKCiNzYXZlUkRTKGFsbF9jb25kX2xpc3QsICIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL1RyaWN1bHR1cmVfZGF0YXNldF9SeWFuX3BhcGVyL3NldXJhdF9saXN0IikKYGBgCgotLS0KPC9kZXRhaWxzPgoKIyBEYXRhIHByb2Nlc3Npbmcgey50YWJzZXR9CgojIyBCZWZvcmUgUXVhbGl0eSBDb250cm9sOgoKCmBgYHtyLCBmaWcud2lkdGg9MTV9CmFsbF9jb25kX2xpc3QgPC0gcmVhZFJEUygiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9UcmljdWx0dXJlX2RhdGFzZXRfUnlhbl9wYXBlci9zZXVyYXRfbGlzdCIpCgpiZWZvcmVfcWMgPC0gbWVyZ2UoYWxsX2NvbmRfbGlzdFtbMV1dJHNldXJhdF9vYiwKICAgICAgICAgICAgICAgICAgICBjKGFsbF9jb25kX2xpc3RbWzJdXSRzZXVyYXRfb2IsCiAgICAgICAgICAgICAgICAgICAgICBhbGxfY29uZF9saXN0W1szXV0kc2V1cmF0X29iLAogICAgICAgICAgICAgICAgICAgICAgYWxsX2NvbmRfbGlzdFtbNF1dJHNldXJhdF9vYiwKICAgICAgICAgICAgICAgICAgICAgIGFsbF9jb25kX2xpc3RbWzVdXSRzZXVyYXRfb2IpLAogICAgICAgICAgICAgICAgICAgIHByb2plY3QgPSAidHJpY3VsdHVyZV9hbGxfY29uZGl0aW9ucyIsCiAgICAgICAgICAgICAgICAgICAgYWRkLmNlbGwuaWRzID0gYyhwYXN0ZTAoYWxsX2NvbmRfbGlzdFtbMV1dJG5hbWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzdGUwKGFsbF9jb25kX2xpc3RbWzJdXSRuYW1lKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3RlMChhbGxfY29uZF9saXN0W1szXV0kbmFtZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXN0ZTAoYWxsX2NvbmRfbGlzdFtbNF1dJG5hbWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzdGUwKGFsbF9jb25kX2xpc3RbWzVdXSRuYW1lKSkpCmBgYAoKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9N30KcXVhbF9tZXRyaWMgPC0gYygibkZlYXR1cmVfUk5BIiwgIm5Db3VudF9STkEiLCAicGVyY2VudF9tdCIpCgpwbG90cyA8LSBtYXAocXVhbF9tZXRyaWMsIGZ1bmN0aW9uKG1ldHJpYyl7CiAgZ2dwbG90KCkgKwogICAgZ2VvbV92aW9saW4oYWVzKHggPSBiZWZvcmVfcWNAbWV0YS5kYXRhICU+JSBwdWxsKCJvcmlnLmlkZW50IiksCiAgICAgICAgICAgICAgICAgeSA9IGJlZm9yZV9xY0BtZXRhLmRhdGEgJT4lIHB1bGwobWV0cmljKSwgCiAgICAgICAgICAgICAgICAgZmlsbCA9IGJlZm9yZV9xY0BtZXRhLmRhdGEgJT4lIHB1bGwoIm9yaWcuaWRlbnQiKSksIAogICAgICAgICAgICAgICAgYWxwaGEgPSAuNSkgKwogICAgZ2VvbV9ib3hwbG90KGFlcyh4ID0gYmVmb3JlX3FjQG1ldGEuZGF0YSAlPiUgcHVsbCgib3JpZy5pZGVudCIpLAogICAgICAgICAgICAgICAgICAgICB5ID0gYmVmb3JlX3FjQG1ldGEuZGF0YSAlPiUgcHVsbChtZXRyaWMpKSwKICAgICAgICAgICAgICAgICBhbHBoYSA9IDApICsKICAgIHhsYWIoInNhbXBsZSBvcmlnaW4iKSArCiAgICB5bGFiKHBhc3RlMChtZXRyaWMpKSArCiAgICBOb0xlZ2VuZCgpIAp9KQoKZG8uY2FsbChncmlkLmFycmFuZ2UsIGMocGxvdHMsIG5jb2wgPSAzLCBucm93ID0gMSkpCmBgYAoKIyMgQWZ0ZXIgcXVhbGl0eSBjb250cm9sCgpGb3IgZWFjaCBzYW1wbGUgc2VwYXJhdGVseQoKKiByZW1vdmUgZ2VuZXMgZXhwcmVzc2luZyBsZXNzIHRoYW4gMjAwIGdlbmVzIG9yIG1vcmUgdGhhbiA1MDAwCiogcmVtb3ZlIGNlbGxzIGV4cHJlc3NpbmcgbW9yZSB0aGFuIDIwJSBtaXRvY2hvbmRyaWFsIGdlbmVzCiogbWVyZ2UgU2V1cmF0IG9iamVjdHMgYWZ0ZXIgUXVhbGl0eSBDb250cm9sCgpgYGB7cn0KIyBhZGQgcGVyY2VudGFnZSBvZiBtaXRvY2hvbmRpcmFsIGdlbmVzIHRvIG1ldGFkYXRhCmFsbF9jb25kIDwtIG1hcChzZXEuaW50KDEsNSksIGZ1bmN0aW9uKG4pewogIHNldXJhdF9vYiA8LSBhbGxfY29uZF9saXN0W1tuXV0kc2V1cmF0X29iCiAgI3NldXJhdF9vYltbInBlcmNlbnRfbXQiXV0gPC0gUGVyY2VudGFnZUZlYXR1cmVTZXQoc2V1cmF0X29iLCBwYXR0ZXJuID0gIl5NVC0iKQogICNwbG90IDwtIFZsblBsb3Qoc2V1cmF0X29iLAogICAjICAgICAgICAgICAgICAgZmVhdHVyZXMgPSBjKCJuRmVhdHVyZV9STkEiLCAicGVyY2VudF9tdCIsICJuQ291bnRfUk5BIiksCiAgICAjICAgICAgICAgICAgICBuY29sID0gMykgKwogICAgI2xhYnModGl0bGUgPSBwYXN0ZTAoImNvbmRpdGlvbiAiLCBhbGxfY29uZF9saXN0W1tuXV0kbmFtZSkpCiAgc2V1cmF0X29iIDwtIHN1YnNldChzZXVyYXRfb2IsIG5GZWF0dXJlX1JOQSA+IDIwMCAmIG5GZWF0dXJlX1JOQSA8IDUwMDAgJiBwZXJjZW50X210IDwgMjApCiAgbGlzdChuYW1lID0gYWxsX2NvbmRfbGlzdFtbbl1dJG5hbWUsIHNldXJhdF9vYiA9IHNldXJhdF9vYikjLCBwbG90ID0gcGxvdCkKfSkKYGBgCgoKYGBge3IsIGZpZy53aWR0aD0xNX0KdHJpY3VsdHVyZSA8LSBtZXJnZShhbGxfY29uZFtbMV1dJHNldXJhdF9vYiwKICAgICAgICAgICAgICAgICAgICBjKGFsbF9jb25kW1syXV0kc2V1cmF0X29iLAogICAgICAgICAgICAgICAgICAgICAgYWxsX2NvbmRbWzNdXSRzZXVyYXRfb2IsCiAgICAgICAgICAgICAgICAgICAgICBhbGxfY29uZFtbNF1dJHNldXJhdF9vYiwKICAgICAgICAgICAgICAgICAgICAgIGFsbF9jb25kW1s1XV0kc2V1cmF0X29iKSwKICAgICAgICAgICAgICAgICAgICBwcm9qZWN0ID0gInRyaWN1bHR1cmVfYWxsX2NvbmRpdGlvbnMiLAogICAgICAgICAgICAgICAgICAgIGFkZC5jZWxsLmlkcyA9IGMocGFzdGUwKGFsbF9jb25kW1sxXV0kbmFtZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXN0ZTAoYWxsX2NvbmRbWzJdXSRuYW1lKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3RlMChhbGxfY29uZFtbM11dJG5hbWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzdGUwKGFsbF9jb25kW1s0XV0kbmFtZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXN0ZTAoYWxsX2NvbmRbWzVdXSRuYW1lKSkpCmBgYAoKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9N30KcXVhbF9tZXRyaWMgPC0gYygibkZlYXR1cmVfUk5BIiwgIm5Db3VudF9STkEiLCAicGVyY2VudF9tdCIpCgpwbG90cyA8LSBtYXAocXVhbF9tZXRyaWMsIGZ1bmN0aW9uKG1ldHJpYyl7CiAgZ2dwbG90KCkgKwogICAgZ2VvbV92aW9saW4oYWVzKHggPSB0cmljdWx0dXJlQG1ldGEuZGF0YSAlPiUgcHVsbCgib3JpZy5pZGVudCIpLAogICAgICAgICAgICAgICAgIHkgPSB0cmljdWx0dXJlQG1ldGEuZGF0YSAlPiUgcHVsbChtZXRyaWMpLCAKICAgICAgICAgICAgICAgICBmaWxsID0gdHJpY3VsdHVyZUBtZXRhLmRhdGEgJT4lIHB1bGwoIm9yaWcuaWRlbnQiKSksIAogICAgICAgICAgICAgICAgYWxwaGEgPSAuNSkgKwogICAgZ2VvbV9ib3hwbG90KGFlcyh4ID0gdHJpY3VsdHVyZUBtZXRhLmRhdGEgJT4lIHB1bGwoIm9yaWcuaWRlbnQiKSwKICAgICAgICAgICAgICAgICAgICAgeSA9IHRyaWN1bHR1cmVAbWV0YS5kYXRhICU+JSBwdWxsKG1ldHJpYykpLAogICAgICAgICAgICAgICAgIGFscGhhID0gMCkgKwogICAgeGxhYigic2FtcGxlIG9yaWdpbiIpICsKICAgIHlsYWIocGFzdGUwKG1ldHJpYykpICsKICAgIE5vTGVnZW5kKCkgCn0pCgpkby5jYWxsKGdyaWQuYXJyYW5nZSwgYyhwbG90cywgbmNvbCA9IDMsIG5yb3cgPSAxKSkKYGBgCgojIyBOb3JtYWxpemF0aW9uLCBTY2FsaW5nLCBGaW5kIFZhcmlhYmxlIEZlYXR1cmVzCgoqIGxvZyBub3JtYWxpemF0aW9uCiogc2NhbGUgZGF0YSBzbyB0aGF0IHdlIGhhdmUgbWVhbiA9IDAgYW5kIHZhcmlhbmNlID0gMQoqIEZpbmQgdGhlIDIwMDAgbW9zdCBoaWdobHkgdmFyaWFibGUgZmVhdHVyZXMKCmBgYAp0cmljdWx0dXJlIDwtIE5vcm1hbGl6ZURhdGEodHJpY3VsdHVyZSwgdmVyYm9zZSA9IEZBTFNFKQp0cmljdWx0dXJlIDwtIFNjYWxlRGF0YSh0cmljdWx0dXJlLCB2ZXJib3NlID0gRkFMU0UpCnRyaWN1bHR1cmUgPC0gRmluZFZhcmlhYmxlRmVhdHVyZXModHJpY3VsdHVyZSwgdmVyYm9zZSA9IEZBTFNFKQpgYGAKCgojIyBEaW1lbnNpb25hbGl0eSByZWR1Y3Rpb24KCiogY29tcHV0ZSBQQ0EKKiB1c2UgZWxib3cgcGxvdCB0byBkZXRlcm1pbmUgZGltZW5zaW9ucyB0aGF0IGNvbnRyaWJ1dGUgdG8gdmFyaWFiaWxpdHkKKiBmaW5kIHRoZSBrLW5lYXJlc3QgbmVpZ2hib3JzCiogZmluZCBDbHVzdGVycyBiYXNlZCBvbiBLTk4tZ3JhcGgKKiBjYWxjdWxhdGUgVFNORSBlbWJlZGRpbmcKCmBgYAp0cmljdWx0dXJlIDwtIFJ1blBDQSh0cmljdWx0dXJlLCBmZWF0dXJlcyA9IFZhcmlhYmxlRmVhdHVyZXModHJpY3VsdHVyZSksIHZlcmJvc2UgPSBGQUxTRSkKRWxib3dQbG90KHRyaWN1bHR1cmUpCgp0cmljdWx0dXJlIDwtIEZpbmROZWlnaGJvcnModHJpY3VsdHVyZSwgdmVyYm9zZSA9IEZBTFNFKQp0cmljdWx0dXJlIDwtIEZpbmRDbHVzdGVycyh0cmljdWx0dXJlLCB2ZXJib3NlID0gRkFMU0UpCgp0cmljdWx0dXJlIDwtIFJ1blRTTkUodHJpY3VsdHVyZSwgZGltcyA9IDE6MTAsIHZlcmJvc2UgPSBGQUxTRSkKYGBgCgpgYGB7cn0KdHJpY3VsdHVyZSA8LSByZWFkUkRTKCJzZXVyYXRfb2JqZWN0cy90cmljdWx0dXJlX3NldXJhdF9vYmplY3QiKQoKI3RyaWN1bHR1cmUgPC0gcmVhZFJEUygiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9UcmljdWx0dXJlX2RhdGFzZXRfUnlhbl9wYXBlci90cmljdWx0dXJlX3NldXJhdF9vYmplY3QiKQoKRGltUGxvdCh0cmljdWx0dXJlLCByZWR1Y3Rpb24gPSAidHNuZSIsIHB0LnNpemUgPSAuMDEsbGFiZWwgPSBUUlVFLAogICAgICAgIGdyb3VwLmJ5ID0gInNldXJhdF9jbHVzdGVycyIpCmBgYAoKIyMgQ2VsbCB0eXBlIGFubm90YXRpb24KCkZvciBhbm5vdGF0aW5nIHRoZSBkaWZmZXJlbnQgY2x1c3RlcnMgdGhlIHNhbWUgbWFya2VycyBhcyBpbiBbQFJ5YW5dIHdlcmUgdXNlZDoKCiogKk1pY3JvZ2xpYToqIEFJRjEsIFNQSTEsIENENAoqICpBc3Ryb2N5dGVzOiogU09YOSwgVEhCUzEKKiAqTmV1cm9uczoqIFNZTjEsIE1BUDIKCmBgYHtyLCBmaWcud2lkaHQgPSAxNSwgZmlnLmhlaWdodD0xMn0KI21hcmtlcnMgPC0gRmluZEFsbE1hcmtlcnModHJpY3VsdHVyZSkKI3RyaWN1bHR1cmUgPC0gcmVhZFJEUygiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9UcmljdWx0dXJlX2RhdGFzZXRfUnlhbl9wYXBlci90cmljdWx0dXJlX3NldXJhdF9vYmplY3QiKQptYXJrZXJzIDwtIHJlYWQudGFibGUoImRhdGFfZmlsZXMvbWFya2VyX2dlbmVzX3RyaWN1bHR1cmVfZGF0YXNldCIpCiNtYXJrZXJzIDwtIHJlYWQudGFibGUoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9kYXRhL21hcmtlcl9nZW5lc190cmljdWx0dXJlX2RhdGFzZXQiKQoKdG9wXzIgPC0gbWFya2VycyAlPiUgZ3JvdXBfYnkoInNldXJhdF9jbHVzdGVyIikgJT4lIHRvcF9uKG4gPSAyLCB3dCA9IGF2Z19sb2cyRkMpCgptYXJrZXJfZ2VuZXMgPC0gYygiQUlGMSIsICJTUEkxIiwgIkNENCIsICJNQVAyIiwgIlNZTjEiLCAiVEhCUzEiLCAiU09YOSIpCnAxIDwtIEZlYXR1cmVQbG90KHRyaWN1bHR1cmUsIGZlYXR1cmVzID0gIkFJRjEiKQpwMiA8LSBGZWF0dXJlUGxvdCh0cmljdWx0dXJlLCBmZWF0dXJlcyA9ICJTUEkxIikKcDMgPC0gRmVhdHVyZVBsb3QodHJpY3VsdHVyZSwgZmVhdHVyZXMgPSAiQ0Q0IikKcDQgPC0gRmVhdHVyZVBsb3QodHJpY3VsdHVyZSwgZmVhdHVyZXMgPSAiTUFQMiIpCnA1IDwtIEZlYXR1cmVQbG90KHRyaWN1bHR1cmUsIGZlYXR1cmVzID0gIlNZTjEiKQpwNiA8LSBGZWF0dXJlUGxvdCh0cmljdWx0dXJlLCBmZWF0dXJlcyA9ICJUSEJTMSIpCnA3IDwtIEZlYXR1cmVQbG90KHRyaWN1bHR1cmUsIGZlYXR1cmVzID0gIlNPWDkiKQoKZ2dhcnJhbmdlKHAxLHAyLHAzLHA0LHA1LHA2LHA3LCBuY29sID0gMiwgbnJvdyA9NCApCgpgYGAKCgoKPGRldGFpbHM+CjxzdW1tYXJ5PioqRGV0YWlscyBvbiBjZWxsIHR5cGUgYW5ub3RhdGlvbioqPC9zdW1tYXJ5PgoKKipHZW5lIGV4cHJlc3Npb24qKgoKRGlmZmVyZW50IGNsdXN0ZXJzIHdlcmUgYW5ub3RhdGVkIGFjY29yZGluZyB0byB0aGUgZ2VuZSBleHByZXNzaW9uIG9mIAptYXJrZXIgZ2VuZXMgbWVudGlvbmVkIGFib3ZlLgoKYGBge3IsIGZpZy53aWR0aD0xNX0KClZsblBsb3QodHJpY3VsdHVyZSwgZmVhdHVyZXMgPSBjKCJDRDQiLCAiU1BJMSIsICJBSUYxIiksIGdyb3VwLmJ5ID0gInNldXJhdF9jbHVzdGVycyIpIywgZ3JvdXAuYnkgPSBzZXVyYXRfY2x1c3RlcikKVmxuUGxvdCh0cmljdWx0dXJlLCBmZWF0dXJlcyA9IGMoIk1BUDIiLCAiU1lOMSIpLCBncm91cC5ieSA9ICJzZXVyYXRfY2x1c3RlcnMiKQpWbG5QbG90KHRyaWN1bHR1cmUsIGZlYXR1cmVzID0gYygiVEhCUzEiLCAiU09YOSIpLCBncm91cC5ieSA9ICJzZXVyYXRfY2x1c3RlcnMiKQpgYGAKCmBgYHtyfQojIDQsIDksIDExLCAxOCA9IE1pY3JvZ2xpYQojIDAsIDEsIDIsIDMsOCwgMTAsIDEzLCAxNSwgMTgsIDE5ID0gTmV1cm9ucyAKIyA2LCA3LCAxMiwgMTQsIDE2ID0gQXN0cm9jeXRlcwojIDUsIDE3IGFyZSB1bmRlc2dpbmF0ZWQKY2VsbF90eXBlcyA8LSAodHJpY3VsdHVyZUBtZXRhLmRhdGEgJT4lIAogIG11dGF0ZShjZWxsX3R5cGUgPSBpZmVsc2Uoc2V1cmF0X2NsdXN0ZXJzICVpbiUgYyg0LDksMTEpLCAiaU1nIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2Uoc2V1cmF0X2NsdXN0ZXJzICVpbiUgYyg2LDcsMTIsMTQsMTYpLCAiaUFzdCIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShzZXVyYXRfY2x1c3RlcnMgJWluJSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjKDAsMSwyLDMsOCwxMCwxMywxNSwxOCwxOSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaU5ldXJvbnMiLCAiVW5kZXNpZ25hdGVkIikpKSkpW1siY2VsbF90eXBlIl1dCiAgCnRyaWN1bHR1cmUgPC0gQWRkTWV0YURhdGEodHJpY3VsdHVyZSwgY2VsbF90eXBlcywgY29sLm5hbWUgPSAiY2VsbF90eXBlIikKCmBgYAoKLS0tCjwvZGV0YWlscz4KCi0tLQoKIyBFeHBsb3JpbmcgdGhlIGRhdGFzZXQKCiMjIyBSZW1vdmUgdW5kZXNpZ25hdGVkIGNlbGxzCgpUaGVyZSBpcyBvbmUgZ3JvdXAgb2YgY2VsbHMgd2hlcmUgaXQgaXMgbm90IGNsZWFyIHdoaWNoIGNlbGwgc3RhdGUgdGhleSAKcmVwcmVzZW50IChVbmRlc2lnbmF0ZWQpLCB3ZSB3aWxsIGV4Y2x1ZGUgdGhlbSBmcm9tIGZ1cnRoZXIgYW5hbHlzaXMgYXMgW0BSeWFuXSAKZGlkLgoKCmBgYHtyfQpwMSA8LSBEaW1QbG90KHRyaWN1bHR1cmUsIHJlZHVjdGlvbiA9ICJ0c25lIiwgcHQuc2l6ZSA9IC4wMSwgbGFiZWwgPSBUUlVFLAogICAgICAgIGdyb3VwLmJ5ID0gImNlbGxfdHlwZSIpCmBgYAoKCmBgYHtyfQp0cmljdWx0dXJlX2NsZWFuIDwtIHN1YnNldCh0cmljdWx0dXJlLCBjZWxsX3R5cGUgJWluJSBjKCJpTWciLCAiaU5ldXJvbnMiLCAiaUFzdCIpKSAKYGBgCgpgYGB7cn0KcDIgPC0gRGltUGxvdCh0cmljdWx0dXJlX2NsZWFuLCByZWR1Y3Rpb24gPSAidHNuZSIsIHB0LnNpemUgPSAuMDEsIGxhYmVsID0gVFJVRSwKICAgICAgICBncm91cC5ieSA9ICJjZWxsX3R5cGUiKQpgYGAKCmBgYHtyLCBmaWcud2lkdGg9MTV9CnAxK3AyCmBgYAoKCjxkZXRhaWxzPgo8c3VtbWFyeT4qKkhlYXRtYXAgb2YgdG9wIDIwIG1hcmtlciBnZW5lcyBmb3IgZWFjaCBjZWxsIHR5cGUqKjwvc3VtbWFyeT4KCgpUb3AyMCBtYXJrZXIgZ2VuZXMgZm9yIGVhY2ggY2VsbCBjZWxsIHR5cGU6IAogCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MjV9CklkZW50cyh0cmljdWx0dXJlX2NsZWFuKSA8LSAiY2VsbF90eXBlIgp0b3BfbiA8LSBtYXJrZXJzICU+JSBncm91cF9ieSAoY2x1c3RlcikgJT4lIHRvcF9uKG4gPSAyMCwgd3QgPSBhdmdfbG9nMkZDKQpEb0hlYXRtYXAodHJpY3VsdHVyZV9jbGVhbiwgZmVhdHVyZXMgPSB0b3BfbiRnZW5lKQpgYGAKCgotLS0KPC9kZXRhaWxzPgoKCjxkZXRhaWxzPgo8c3VtbWFyeT4qKk51bWJlciBvZiBjZWxscyBwZXIgY29uZGl0aW9uIGFuZCBjZWxsIHR5cGUqKjwvc3VtbWFyeT4KCgpIb3cgbWFueSBjZWxscyBvZiBlYWNoIGNlbGwgdHlwZSBhbmQgY29uZGl0aW9uIGFyZSBwcmVzZW50IGluIHRoZSBkYXRhc2V0PwoKYGBge3IsIHJlc3VsdHMgPSAiYXNpcyJ9CnRyaWN1bHR1cmVfY2xlYW5AbWV0YS5kYXRhICU+JSBncm91cF9ieShjZWxsX3R5cGUsIG9yaWcuaWRlbnQpICU+JSAKICBzdW1tYXJpemUobiA9IG4oKSkgJT4lIAogIG11dGF0ZShvcmlnLmlkZW50ID0gY2FzZV93aGVuKAogICAgICAgICAgICAgICAgICAgICAgb3JpZy5pZGVudCAlaW4lIGMoImlhIiwgImlhMiIpIH4gIkluZitFRloiLCAKICAgICAgICAgICAgICAgICAgICAgIG9yaWcuaWRlbnQgPT0gImNhIiB+ICJVbmluZiIsCiAgICAgICAgICAgICAgICAgICAgICBvcmlnLmlkZW50ID09ICJjdGwiIH4gIlVuaW5mK0VGWiIsCiAgICAgICAgICAgICAgICAgICAgICBvcmlnLmlkZW50ID09ICJpbmYiIH4gIkluZiIpKSAlPiUgCiAgcGl2b3Rfd2lkZXIobmFtZXNfZnJvbSA9IG9yaWcuaWRlbnQsIHZhbHVlc19mcm9tID0gbikgJT4lIAogIGthYmxlKGNhcHRpb24gPSAiTnVtYmVyIG9mIGNlbGxzIHBlciBjb25kaXRpb24gYW5kIGNlbGwgdHlwZSIpICMgdG8gbWFrZSB0YWJsZSBsb29rIG5pY2UgaW4gUm1hcmtkb3duCiAgCmBgYAoKCi0tLQo8L2RldGFpbHM+CgoKIyMjIERpZmZlcmVudCBpbmZlY3Rpb24gYW5kIHRyZWF0bWVudCBjb25kaXRpb25zICYgZ2VuZSBleHByZXNzaW9uCgpJbnRlcmVzdGluZ2x5LCB0aGUgaW5mZWN0ZWQgY2VsbHMgdHJlYXRlZCB3aXRoIEVGWiAoSW5mK0VGWikgY2xlYXJseSBzZXBhcmF0ZSAKZnJvbSB0aGUgaW5mZWN0ZWQsIGJ1dCB1bnRyZWF0ZWQgY2VsbHMgKEluZikgYW5kIHRoZSB0aGUgdW5pbmZlY3RlZCBjZWxscwooVW5pbmYsIFVuaW5mK0VGWikgaW4gdGhlIG1pY3JvZ2xpYSBjbHVzdGVyIGFzIGNhbiBiZSBzZWVuIGluIHRoZSBmaWd1cmUgYmVsb3cuCgoKYGBge3J9CiMgcmVuYW1lIG9yaWdpbiBvZiBpZGVudCBmb3IgZWFzaWVyIGludGVycHJldGF0aW9uCm9yaWdpbl92ZWN0b3IgPC0gKHRyaWN1bHR1cmVfY2xlYW5AbWV0YS5kYXRhICU+JSAKICAgICAgICAgICAgICAgICAgICBtdXRhdGUob3JpZy5pZGVudCA9IGNhc2Vfd2hlbigKICAgICAgICAgICAgICAgICAgICAgIG9yaWcuaWRlbnQgJWluJSBjKCJpYSIsICJpYTIiKSB+ICJJbmYrRUZaIiwgCiAgICAgICAgICAgICAgICAgICAgICBvcmlnLmlkZW50ID09ICJjYSIgfiAiVW5pbmYiLAogICAgICAgICAgICAgICAgICAgICAgb3JpZy5pZGVudCA9PSAiY3RsIiB+ICJVbmluZitFRloiLAogICAgICAgICAgICAgICAgICAgICAgb3JpZy5pZGVudCA9PSAiaW5mIiB+ICJJbmYiKSkpW1sib3JpZy5pZGVudCJdXQoKdHJpY3VsdHVyZV9jbGVhbiA8LSBBZGRNZXRhRGF0YSh0cmljdWx0dXJlX2NsZWFuLCBvcmlnaW5fdmVjdG9yLCBjb2wubmFtZSA9ICJvcmlnLmlkZW50IikKYGBgCgpgYGB7cn0KRGltUGxvdCh0cmljdWx0dXJlX2NsZWFuLCByZWR1Y3Rpb24gPSAidHNuZSIsIGdyb3VwLmJ5ID0gIm9yaWcuaWRlbnQiLCBwdC5zaXplID0gLjAxLCApCmBgYAoKCjxkZXRhaWxzPgo8c3VtbWFyeT4qKkluZmxhbW1hdG9yeSBnZW5lIGV4cHJlc3Npb24gaW4gaU1nKio8L3N1bW1hcnk+CgoqKkluZmxhbW1hdG9yeSBnZW5lIGV4cHJlc3Npb24gaW4gaU1nKioKClRoZSBsYXJnZXN0IGNoYW5nZSBpbiBnZW5lIGV4cHJlc3Npb24gcmVsYXRlZCB0byBpbmZsYW1tYXRpb24gd2FzIGZvdW5kIGluIGlNZwphbW9uZyB0aGUgMyBjZWxsIHR5cGVzIFtAUnlhbl0uIFNob3duIGFyZSBvbmx5IGluZmxhbW1hdG9yeSBnZW5lcy4gCgpgYGB7ciwgZmlnLmhlaWdodCA9IDEyfQppbmZsYW1tX2dlbmVzIDwtIGMoIlRORiIsICJBQ1NMMSIsICJNR1NUMyIsICJCMk0iLCAiSUZOR1IyIiwgIkdSSU5BIiwgIlRMUjIiLCAKICAgICAgICAgICAgICAgICAgICJTT0QyIiwgIkdMVUwiLCAiQ0ZMQVIiLCAiQ1ROTkIxIiwgIkNYQ0w4IiwgIkNDTDQiLCAiSUwxQiIsCiAgICAgICAgICAgICAgICAgICAiQVRGNCIsICJDWENMOCIsICJDQ0w0IiwgIkNDTDIiLCAiSUwxQiIsICJBVEY0IiwgIkNYQ0wxIiwgCiAgICAgICAgICAgICAgICAgICAiTkZLQjEiLCAiVEFOSyIsICJBUE9FIiwgIlRSRU0yIiwgIkxZOTYiLCAiU1JDIiwgIk5DRjEiLCAKICAgICAgICAgICAgICAgICAgICJIQ0siLCAiTFlOIiwgIlZBU1AiLCAiQzMiLCAiQzUiLCAiUkFQMUIiLCAiUkFQMkIiLCAiTUFGIiwKICAgICAgICAgICAgICAgICAgICJKVU5EIiwgIlNRU1RNMSIsICJGVEgxIiwgIlJIT1EiLCAiQ0QzNiIsICJGT1MiLCAiTkZLQklBIiwKICAgICAgICAgICAgICAgICAgICJJQ0FNMSIsICJUTkZBSVAzIiwgIkxZWiIsICJQUFAxUjEyQSIsICJSTkQzIiwgIkNZQkEiLCAiSVJGOCIsCiAgICAgICAgICAgICAgICAgICAiU0xDMjVBNiIpCgpEb0hlYXRtYXAodHJpY3VsdHVyZV9jbGVhbiwgZmVhdHVyZXMgPSBpbmZsYW1tX2dlbmVzKQpgYGAKCi0tLQo8L2RldGFpbHM+Cgo8ZGV0YWlscz4KPHN1bW1hcnk+KipEaWZmZXJlbmNlcyBvZiBpbmZsYW1tYXRvcnkgZ2VuZSBleHByZXNzaW9uIGJldHdlZW4gY29uZGl0aW9ucyoqPC9zdW1tYXJ5PgoKClRoZSBnZW5lIGV4cHJlc3Npb24gb2YgaW5mbGFtbWF0b3J5IGdlbmVzIGluIG1pY3JvZ2xpYSB3YXMgbm90IHZlcnkgZGlmZmVyZW50CmJldHdlZW4gdGhlIGNvbmRpdGlvbnMuIFRoZSBJbmYrRUZaIGNlbGxzIHNob3cgYSBzbGlnaHRseSBkaWZmZXJlbnQgcGF0dGVybiBvZgpnZW5lIGV4cHJlc3Npb24uCgpgYGB7ciwgZmlnLmhlaWdodD0xMn0KRG9IZWF0bWFwKHN1YnNldCh0cmljdWx0dXJlX2NsZWFuLCBjZWxsX3R5cGUgPT0gImlNZyIpLCAKICAgICAgICAgIGZlYXR1cmVzID0gaW5mbGFtbV9nZW5lcywgZ3JvdXAuYnkgPSAib3JpZy5pZGVudCIpCmBgYAoKCi0tLQo8L2RldGFpbHM+CgoKIyBJbnRlZ3JhdGlvbiB0cmljdWx0dXJlICYgQ1NGL0Jsb29kIGRhdGFzZXQKClRoZSBISVYgQmxvb2QgJiBDU0YgZGF0YXNldCBbQEZhcmhhZGlhbl0KdXNlZCBpbiB0aGUgcHJldmlvdXMgYW5hbHlzaXMgd2FzIGludGVncmF0ZWQgd2l0aCB0aGUgdHJpY3VsdHVyZSBkYXRhc2V0IFtAUnlhbl0uCgpJbnRlZ3JhdGlvbiBvZiB0d28gZGF0YXNldHMgaXMgYmFzZWQgb24gU2V1cmF0IFtAU3R1YXJ0XS4gSXQgZmlyc3QgaWRlbnRpZmllcyAKYW5jaG9ycyBiZXR3ZWVuIGRhdGFzZXRzLCBjYWxjdWxhdGVzIHNjb3JlcyBmb3IgYWxsIGFuY2hvcnMgYW5kIAp0aGVuIGNhbGN1bGF0ZXMgYW4gaW50ZWdyYXRlZCBleHByZXNzaW9uIG1hdHJpeCB3aGljaCBjYW4gYmUgdXNlZCBmb3IgZG93bnN0cmVhbQphbmFseXNpcy4KCgoxLiBJZGVudGlmeSBmZWF0dXJlcyB3aGljaCBhcmUgdmFyaWFibGUgYWNyb3NzIGRhdGFzZXRzCjIuIElkZW50aWZ5IGFuY2hvcnMgYmV0d2VlbiB0aGUgdHdvIGRhdGFzZXRzIGFuZCBjcmVhdGUgYW4gaW50ZWdyYXRlZCBkYXRhIGFzc2F5CjMuIFJ1biBhIHNpbmdsZSBpbnRlZ3JhdGVkIGFuYWx5c2lzIG9uIGFsbCBjZWxscwoKCjxkZXRhaWxzPgo8c3VtbWFyeT4qKkRldGFpbHMgb24gaW50ZWdyYXRpb24qKjwvc3VtbWFyeT4KCkZvciBtb3JlIGRldGFpbHMgc2VlOiBbQFN0dWFydF0KCjEuIElkZW50aWZ5IGZlYXR1cmVzIHdoaWNoIGFyZSB2YXJpYWJsZSBhY3Jvc3MgZGF0YXNldHMKMi4gSWRlbnRpZnkgYW5jaG9ycyBiZXR3ZWVuIHRoZSB0d28gZGF0YXNldHMgYW5kIGNyZWF0ZSBhbiBpbnRlZ3JhdGVkIGRhdGEgYXNzYXkKMy4gUnVuIGEgc2luZ2xlIGludGVncmF0ZWQgYW5hbHlzaXMgb24gYWxsIGNlbGxzCgpgYGAKaGl2NyA8LSByZWFkUkRTKCIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL1JlcHJvZHVjZV9GYXJoYWRpYW5fUGFwZXIvU2V1cmF0X29iamVjdHMvdG90YWxfN19zYW1wbGVzX2xhYmVsX3RyYW5zZmVyLnJkcyIpCmhpdjcgPC0gTm9ybWFsaXplRGF0YShoaXY3LCB2ZXJib3NlID0gRkFMU0UpCmhpdjcgPC0gRmluZFZhcmlhYmxlRmVhdHVyZXMoaGl2NywgdmVyYm9zZSA9IEZBTFNFKQoKIyBhZGQgYm90aCBkYXRhc2V0cyB0byBhIGxpdHMKZGF0YV9saXN0IDwtIGxpc3QoaGl2ID0gaGl2NywgdHJpY3VsdHVyZSA9IHRyaWN1bHR1cmVfY2xlYW4pCgojIHNlbGVjdCBmZWF0dXJlcyB0aGF0IGFyZSByZXBlYXRlZGx5IHZhcmlhYmxlIGFjcm9zcyBkYXRhc2V0cyBmb3IgaW50ZWdyYXRpb24KZmVhdHVyZXMgPC0gU2VsZWN0SW50ZWdyYXRpb25GZWF0dXJlcyhvYmplY3QubGlzdCA9IGRhdGFfbGlzdCwgdmVyYm9zZSA9IEZBTFNFKQoKIyBpZGVudGlmeSBpbnRlZ3JhdGlvbiBhbmNob3JzIGFuZCBwZXJmb3JtIGludGVncmF0aW9uCmFuY2hvcnMgPC0gRmluZEludGVncmF0aW9uQW5jaG9ycyhvYmplY3QubGlzdCA9IGRhdGFfbGlzdCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3IuZmVhdHVyZXMgPSBmZWF0dXJlcywgdmVyYm9zZSA9IEZBTFNFKSAKY29tYmluZWQgPC0gSW50ZWdyYXRlRGF0YShhbmNob3JzZXQgPSBhbmNob3JzLCB2ZXJib3NlID0gRkFMU0UpCgojIHJ1biBhbmFseXNpcyBvbiBpbnRlZ3JhdGVkIGRhdGFzZXQKY29tYmluZWQgPC0gU2NhbGVEYXRhKGNvbWJpbmVkLCB2ZXJib3NlID0gRkFMU0UpCmNvbWJpbmVkIDwtIFJ1blBDQShjb21iaW5lZCwgdmVyYm9zZSA9IEZBTFNFKQojRWxib3dQbG90KGNvbWJpbmVkKQpjb21iaW5lZCA8LSBSdW5UU05FKGNvbWJpbmVkLCByZWR1Y3Rpb24gPSAicGNhIiwgZGltcyA9IDE6MTAsIHZlcmJvc2UgPSBGQUxTRSkKY29tYmluZWQgPC0gRmluZE5laWdoYm9ycyhjb21iaW5lZCwgcmVkdWN0aW9uID0gInBjYSIsIGRpbXMgPSAxOjEwLCB2ZXJib3NlID0gRkFMU0UpCmNvbWJpbmVkIDwtIEZpbmRDbHVzdGVycyhjb21iaW5lZCwgcmVzb2x1dGlvbiA9IC4zLCB2ZXJib3NlID0gRkFMU0UpCgojIGFkZCBhbm5vdGF0aW9ucyBmcm9tIHdoaWNoIGRhdGFzZXQgdGhlIHNhbXBsZSBjYW1lIGZyb20KZGF0YXNldF92ZWN0b3IgPC0gKGNvbWJpbmVkQG1ldGEuZGF0YSAlPiUgbXV0YXRlKGRhdGFzZXQgPSBpZmVsc2Uob3JpZy5pZGVudCAlaW4lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjKCJISVYxX0NTRiIsICJISVYyX0NTRiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJISVYzX0NTRiIsICJISVYxX0JsZCIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSElWMl9CbGQiLCAiVW5pbmZlY3RlZDFfQ1NGIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlVuaW5mZWN0ZWQyX0NTRiIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjc2YiLCAidHJpY3VsdHVyZSIpKSlbWyJkYXRhc2V0Il1dCgpjb21iaW5lZCA8LSBBZGRNZXRhRGF0YShjb21iaW5lZCwgZGF0YXNldF92ZWN0b3IsIGNvbC5uYW1lID0gImRhdGFzZXQiKQoKIyBhZGQgaW5mb3JtYXRpb24gb24gdGhlIGNlbGwgZ3JvdXBzIGluIHRoZSBjb21iaW5lZCBkYXRhc2V0cwpjb21iaW5lZF9jbHVzdGVycyA8LSAoY29tYmluZWRAbWV0YS5kYXRhICU+JSAKICBtdXRhdGUoY29tYmluZWRfY2x1c3RlcnMgPSBpZmVsc2Uoc2V1cmF0X2NsdXN0ZXJzICVpbiUgYygyLDEwKSwgIk1pY3JvZ2xpYSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHNldXJhdF9jbHVzdGVycyAlaW4lIGMoMyw5KSwgImlBc3QiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2Uoc2V1cmF0X2NsdXN0ZXJzICVpbiUgYygwLDEsNywxMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpTmV1cm9ucyIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2Uoc2V1cmF0X2NsdXN0ZXJzICVpbiUgYyg4LDUsNiksICJJbW11bmUgQ2VsbHMiLCAiVW5kZXNpZ25hdGVkIikpKSkpKVtbImNvbWJpbmVkX2NsdXN0ZXJzIl1dCiAgCmNvbWJpbmVkIDwtIEFkZE1ldGFEYXRhKGNvbWJpbmVkLCBjb21iaW5lZF9jbHVzdGVycywgY29sLm5hbWUgPSAiY29tYmluZWRfY2x1c3RlcnMiKQoKI3NhdmVSRFMoY29tYmluZWQsIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvVHJpY3VsdHVyZV9kYXRhc2V0X1J5YW5fcGFwZXIvdHJpY3VsdHVyZV9oaXZfY29tYmluZWRfc2V1cmF0X29iamVjdCIpCgpgYGAKCi0tLQo8L2RldGFpbHM+CgojIyBJbnRlZ3JhdGVkIGNsdXN0ZXJzCgpXaGVuIGludGVncmF0aW5nIHRoZSBDU0YgZGF0YXNldCBhbmQgdGhlIFRyaWN1bHR1cmUgZGF0YXNldCB0aGUgaU1nIGNlbGxzIApjbHVzdGVyZWQgdG9nZXRoZXIgd2l0aCB0aGUgTXllbG9pZCBjZWxscyBmcm9tIHRoZSBDU0YgYW5kIEJsb29kIHNhbXBsZXMgZnJvbSAKdGhlIEhJVi0xIGluZmVjdGVkL3VuaW5mZWN0ZWQgcGF0aWVudHMuIFRoaXMgd2FzIGV4cGVjdGVkIHNpbmNlIHRoZXkgYXJlIGJvdGgKbXllbG9pZC1saW5lYWdlIGNlbGxzLiBIb3dldmVyLCB0aGlzIG1ha2VzIGl0IG1vcmUgZGlmZmljdWx0IHRvIGRyYXcgY29uY2x1c2lvbnMKb24gd2hpY2ggb2YgdGhlIGZpdmUgTXllbG9pZCBjbHVzdGVycyBpcyB0aGUgbW9zdCBtaWNyb2dsaWEtbGlrZS4gVGhlcmVmb3JlLCB3ZSAKaGFkIGEgY2xvc2VyIGxvb2sgYXQgdGhpcyBteWVsb2lkLWxpbmVhZ2UgY2x1c3RlciBjb25zaXN0aW5nIG9mIGlNZyBmcm9tCnRyaWN1bHR1cmUgYW5kIE15ZWxvaWQgY2VsbHMgZnJvbSBDU0YgYW5kIEJsb29kIHNhbXBsZXMuCgoKIyMjIyBWaXN1YWxpemF0aW9uIG9mIHRoZSBpbnRlZ3JhdGVkIGRhdGFzZXQKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MTV9CmNvbWJpbmVkID0gcmVhZFJEUygic2V1cmF0X29iamVjdHMvdHJpY3VsdHVyZV9oaXZfY29tYmluZWRfc2V1cmF0X29iamVjdF8yIikKCnAxIDwtIERpbVBsb3QoY29tYmluZWQsIHJlZHVjdGlvbiA9ICJ0c25lIiwgZ3JvdXAuYnkgID0gImRhdGFzZXQiLAogICAgICAgICAgICAgIGxhYmVsID0gVFJVRSkgKyBOb0xlZ2VuZCgpICsKICBsYWJzKHRpdGxlID0gIkRhdGFzZXQiKQpwMiA8LSBEaW1QbG90KGNvbWJpbmVkLCByZWR1Y3Rpb24gPSAidHNuZSIsIGdyb3VwLmJ5ID0gImNlbGxfdHlwZSIsCiAgICAgICAgICAgICAgbGFiZWwgPSBUUlVFLCByZXBlbCA9IFRSVUUpICsgTm9MZWdlbmQoKSArCiAgbGFicyh0aXRsZSA9ICJDZWxsIHR5cGVzIikKcDMgPC0gRGltUGxvdChjb21iaW5lZCwgcmVkdWN0aW9uID0gInRzbmUiLCBncm91cC5ieSA9ICJjZWxsX3R5cGUiLAogICAgICAgICAgICAgIHNwbGl0LmJ5ID0gImRhdGFzZXQiLCBsYWJlbCA9IFRSVUUsIHJlcGVsID0gVFJVRSkgKyBOb0xlZ2VuZCgpICsKICBsYWJzKHRpdGxlID0gIkNlbGwgdHlwZXMgc3BsaXQgaW50byBkYXRhc2V0cyIpCnA0IDwtIERpbVBsb3QoY29tYmluZWQsIHJlZHVjdGlvbiA9ICJ0c25lIiwgZ3JvdXAuYnkgPSAic2V1cmF0X2NsdXN0ZXJzIiwKICAgICAgICAgICAgICBsYWJlbCA9IFRSVUUpICsgTm9MZWdlbmQoKSArCiAgbGFicyh0aXRsZSA9ICJDbHVzdGVycyIpCgphMSA8LSBEaW1QbG90KGNvbWJpbmVkLCByZWR1Y3Rpb24gPSAidHNuZSIsIHNwbGl0LmJ5ID0gImRhdGFzZXQiLCAKICAgICAgICBncm91cC5ieSA9ICJzZXVyYXRfY2x1c3RlcnMiLCBsYWJlbCA9IFRSVUUsIHJlcGVsID1UUlVFKSArCiAgTm9MZWdlbmQoKSArCiAgbGFicyh0aXRsZSA9ICJDbHVzdGVycyBzcGxpdCBpbnRvIGRhdGFzZXRzIikKCmEyIDwtIERpbVBsb3QoY29tYmluZWQsIHJlZHVjdGlvbiA9ICJ0c25lIiwgc3BsaXQuYnkgPSAiZGF0YXNldCIsIAogICAgICAgICAgICAgIGdyb3VwLmJ5ID0gIm9yaWcuaWRlbnQiKSArCiAgbGFicyh0aXRsZSA9ICJTYW1wbGUgb3JpZ2luIHNwbGl0IGludG8gZGF0YXNldHMiKQoKZ2dhcnJhbmdlKHAxLCBwMiwgcDMscDQsIGExLCBhMiwgbmNvbCA9IDIsIG5yb3cgPSAzKQoKYGBgCgoKIyMgTXllbG9pZCBsaW5lYWdlIGNsdXN0ZXIKCiMjIyMgVmlzdWFsaXphdGlvbiBvZiBNeWVsb2lkIGxpbmVhZ2UgY2x1c3RlciAoaU1nLCBNeWVsb2lkMS8yLzMvNC81KQoKVGhlIHBsb3QgYmVsb3cgdmlzdWFsaXplcyB0aGF0IGlNZyBhbmQgQ1NGL0Jsb29kIE15ZWxvaWQgY2VsbHMgY2x1c3RlciB0b2dldGhlciwKaW5kZXBlbmRlbnQgb2YgdGhlaXIgaW5mZWN0aW9uIHN0YXR1cy4KCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9N30Kc3Vic2V0X21vbm9jeXRlcyA8LSBzdWJzZXQoY29tYmluZWQsIGNlbGxfdHlwZSAlaW4lIGMoIk15ZWxvaWQxIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNeWVsb2lkMiIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTXllbG9pZDMiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk15ZWxvaWQ0IiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNeWVsb2lkNSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaU1nIikpCgpwMSA8LSBEaW1QbG90KHN1YnNldF9tb25vY3l0ZXMsIGdyb3VwLmJ5ID0gImNlbGxfdHlwZSIpICsKICBsYWJzKHRpdGxlID0gIkNlbGwgdHlwZSIpCnAyIDwtIERpbVBsb3Qoc3Vic2V0X21vbm9jeXRlcywgZ3JvdXAuYnkgPSAib3JpZy5pZGVudCIpICsKICBsYWJzKHRpdGxlID0gIlNhbXBsZSBvcmlnaW4iKQpwMyA8LSBEaW1QbG90KHN1YnNldF9tb25vY3l0ZXMsIGdyb3VwLmJ5ID0gInNldXJhdF9jbHVzdGVycyIpICsKICBsYWJzKHRpdGxlID0gIkNsdXN0ZXIiKQpmaWcgPC0gZ2dhcnJhbmdlKHAxLCBwMiwgcDMsIG5jb2wgPSAzLCBucm93ID0gMSkKYW5ub3RhdGVfZmlndXJlKGZpZywgdG9wID0gdGV4dF9ncm9iKCJNeWVsb2lkLWxpbmVhZ2UgY2VsbHMiLCBzaXplID0gMjApKQpgYGAKCkFzIGV4cGVjdGVkIHRoZSBDU0YvQmxvb2QgTXllbG9pZCBjZWxscyBjbHVzdGVyIHRvZ2V0aGVyIHdpdGggSW5mK0VGWiBhbmQgbWFpbmx5IGNvbnRyaWJ1dGUgdG8gdGhlIHNhbWUgc3ViY2x1c3RlciwgYXMgY2FuIApiZSBzZWVuIGluIHRoZSBwbG90IGJlbG93LCB3aGljaCBzaG93cyBvbmx5IENTRi9CbG9vZCBNeWVsb2lkIGNlbGxzIGFuZCB0aGUgCkluZitFRlogaU1nLiBCbG9vZCBNeWVsb2lkIDQgaXMgYW4gZXhjZXB0aW9uIGFuZCBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IHN1YmNsdXN0ZXIuCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTd9CgpzdWJzZXRfaW5mZWN0ZWQgPC0gc3Vic2V0KGNvbWJpbmVkLCBvcmlnLmlkZW50ICVpbiUgYygiSElWMV9DU0YiLCAiSElWMl9DU0YiLCAiSElWM19DU0YiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSElWMV9CbGQiLCAiSElWMl9CbGQiLCJJbmYrRUZaIikgJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbF90eXBlICVpbiUgYygiTXllbG9pZDEiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk15ZWxvaWQyIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNeWVsb2lkMyIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTXllbG9pZDQiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk15ZWxvaWQ1IiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpTWciKSkKCgpwMSA8LSBEaW1QbG90KHN1YnNldF9pbmZlY3RlZCwgZ3JvdXAuYnkgPSAiY2VsbF90eXBlIikgKwogIGxhYnModGl0bGUgPSAiQ2VsbCBUeXBlIikKcDIgPC0gRGltUGxvdChzdWJzZXRfaW5mZWN0ZWQsIGdyb3VwLmJ5ID0gIm9yaWcuaWRlbnQiKSArCiAgbGFicyh0aXRsZSA9ICJTYW1wbGUgb3JpZ2luIikKcDMgPC0gRGltUGxvdChzdWJzZXRfaW5mZWN0ZWQsIGdyb3VwLmJ5ID0gInNldXJhdF9jbHVzdGVycyIpICsKICBsYWJzKHRpdGxlID0gIkNsdXN0ZXJzIikKZmlnIDwtIGdnYXJyYW5nZShwMSwgcDIsIHAzLCBuY29sID0gMywgbnJvdyA9IDEpCmFubm90YXRlX2ZpZ3VyZShmaWcsIHRvcCA9IHRleHRfZ3JvYigiSW5mZWN0ZWQgQ1NGL0Jsb29kIE15ZWxvaWQgY2VsbHMgJiBJbmYrRUZaIGlNZyIpKQpgYGAKCgoKIyMjIyBDZWxsIHR5cGVzIGFuZCBjb25kaXRpb25zIHBhcnRpYWxseSBzZXBhcmF0ZSBhY2NvcmRpbmcgdG8gdGhlIHR3byBpTWcgY2x1c3RlcnMKClRoZSBteWVsb2lkLWxpbmVhZ2UgY2x1c3RlciBzZXBhcmF0ZWQgaW50byB0d28gZGlzdGluY3Qgc3ViY2x1c3RlcnMuIApJbnRlcmVzdGluZ2x5LCB0aGUgaW5mZWN0ZWQgKyBFRlogaU1nIHNlcGFyYXRlZCBjbGVhcmx5IGZyb20gdGhlIGluZmVjdGVkIGlNZy4gClRoZSBzZXBhcmF0aW9uIHdhcyBub3Qgc28gY2xlYXIgZm9yIHRoZSB1bmluZmVjdGVkIGNlbGxzLCB3aGljaCBjb250cmlidXRlZCB0byAKYm90aCBzdWJjbHVzdGVycy4gQW5vdGhlciBvYnNlcnZhdGlvbnMgaXMgdGhhdCB0aGUgaW5mZWN0ZWQgTXllbG9pZDEvMi8zLzUgY2VsbHMgYmVsb25nICAKdG8gdGhlIHNhbWUgc3ViY2x1c3RlciBhcyB0aGUgaW5mZWN0ZWQgKyBFRlogaU1nLiBDb252ZXJzZWx5LCB0aGUgTXllbG9pZDQgY2VsbHMKY2x1c3RlciB3aXRoIHRoZSBpbmZlY3RlZCBpTWcuIFNpbmNlIHRoZSBpbmZlY3RlZCBDU0YvQmxvb2QgTXllbG9pZCBjZWxscyBvcmlnaW5hdGUgZnJvbSBISVYgCmluZmVjdGVkIGFuZCB0cmVhdGVkIHBhdGllbnRzIHdlIHdvdWxkIGV4cGVjdCB0aGVtIHRvIGNsdXN0ZXIgdG9nZWh0ZXIgd2l0aCB0aGUKaW5mZWN0ZWQgKyBFRlogaU1nLiBIb3dldmVyLCB0aGVyZSBtaWdodCBhbHNvIGJlIGluZmVjdGVkIENTRi9CbG9vZCBNeWVsb2lkIGNlbGxzIHdoaWNoIGFyZSBub3QgCmFmZmVjdGVkIGJ5IHRoZSB0cmVhdG1lbnQuIFRoZSBNeWVsb2lkNCBjZWxscyB3aGljaCBhcmUgZnJvbSBCbG9vZCBzYW1wbGVzIG1pZ2h0CmNvbnNpdHV0ZSBhbiBpbmZlY3RlZCBjZWxsIHBvcHVsYXRpb24gdW5hZmZlY3RlZCBieSB0aGUgQVJUIHRyZWF0bWVudC4gCgoKCmBgYHtyLGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMH0KCkRpbVBsb3Qoc3Vic2V0X21vbm9jeXRlcywgZ3JvdXAuYnkgPSAic2V1cmF0X2NsdXN0ZXJzIiwgCiAgICAgICAgc3BsaXQuYnkgPSAib3JpZy5pZGVudCIsIG5jb2wgPSA0KSArCiAgbGFicyh0aXRsZSA9ICJDb250cmlidXRpb24gb2YgZGlmZmVyZW50IHNhbXBsZXMgdG8gZGlmZmVyZW50IHN1YmNsdXN0ZXJzIikKRGltUGxvdChzdWJzZXRfbW9ub2N5dGVzLCBncm91cC5ieSA9ICJzZXVyYXRfY2x1c3RlcnMiLCAKICAgICAgICBzcGxpdC5ieSA9ICJjZWxsX3R5cGUiLCBuY29sID0gMykgKwogIGxhYnModGl0bGUgPSAiQ29udHJpYnV0aW9uIG9mIGRpZmZlcmVudCBjZWxsIHR5cGVzIHRvIGRpZmZlcmVudCBzdWJjbHVzdGVycyIpCmBgYAoKCiMjIERlLW5vdmUgY2x1c3RlcmluZyAKCkRlLW5vdm8gY2x1c3RlcmluZyBvZiB0aGUgbXllbG9pZC1saW5lYWdlIGNsdXN0ZXIgb2YgdGhlIGludGVncmF0ZWQgZGF0YXNldCB3YXMKcGVyZm9ybWVkLiBJc29sYXRpbmcgdGhlIGlNZyBhbmQgYWxsIE15ZWxvaWQgY2VsbCBjbHVzdGVycyBmcm9tIHRoZSBpbnRlZ3JhdGVkICBkYXRhc2V0IGFuZCBub3JtYWxpemluZywgc2NhbGluZyBhbmQgcmUtY2x1c3RlcmluZyB0aGVzZSBpc29sYXRlZCBjZWxscyBtaWdodCAgIApnaXZlIHVzIGFkZGl0aW9uYWwgaW5zaWdodHMuIAoKCgo8ZGV0YWlscz4KPHN1bW1hcnk+KipEZXRhaWxzIG9uIGRlLW5vdm8gY2x1c3RlcmluZyoqPC9zdW1tYXJ5PgoKCmBgYAoKbWljcm9nbGlhIDwtIHN1YnNldChjb21iaW5lZCwgY2VsbF90eXBlICVpbiUgYygiaU1nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk15ZWxvaWQxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk15ZWxvaWQyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk15ZWxvaWQzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk15ZWxvaWQ0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk15ZWxvaWQ1IikpCm1pY3JvZ2xpYV9yZWNsdXN0ZXIgPC0gU0NUcmFuc2Zvcm0obWljcm9nbGlhLCB2ZXJib3NlID0gRkFMU0UpCm1pY3JvZ2xpYV9yZWNsdXN0ZXIgPC0gU2NhbGVEYXRhKG1pY3JvZ2xpYV9yZWNsdXN0ZXIsIHZlcmJvc2UgPSBGQUxTRSkKbWljcm9nbGlhX3JlY2x1c3RlciA8LSBSdW5QQ0EobWljcm9nbGlhX3JlY2x1c3RlciwgdmVyYm9zZSA9IEZBTFNFKQpFbGJvd1Bsb3QobWljcm9nbGlhX3JlY2x1c3RlcikKbWljcm9nbGlhX3JlY2x1c3RlciA8LSBSdW5UU05FKG1pY3JvZ2xpYV9yZWNsdXN0ZXIsIHJlZHVjdGlvbiA9ICJwY2EiLCBkaW1zID0gMToxMCkKbWljcm9nbGlhX3JlY2x1c3RlciA8LSBGaW5kTmVpZ2hib3JzKG1pY3JvZ2xpYV9yZWNsdXN0ZXIpCm1pY3JvZ2xpYV9yZWNsdXN0ZXIgPC0gRmluZENsdXN0ZXJzKG1pY3JvZ2xpYV9yZWNsdXN0ZXIsIHJlc29sdXRpb24gPSAwLjUpCmBgYAoKLS0tCjwvZGV0YWlscz4gCgoKSXQgaXMgbm8gc3VycHJpc2UgdGhhdCBjZWxscyBmcm9tIHRoZSB0cmljdWx0dXJlIGRhdGFzZXQgc2VwYXJhdGUgZnJvbSB0aGUgCkNTRi9CbG9vZC1kZXJpdmVkIGNlbGxzIHdoaWNoIGNhbiBiZSBzZWVuIGluIHRoZSBwbG90IGJlbG93LiBXaGVuIHdlIHJlY2x1c3RlciB0aGUgbXllbG9pZCBsaW5lYWdlIGRlcml2ZWQgY2VsbHMsIHdlIApvYnRhaW4gZml2ZSBzdWJjbHVzdGVycyBmb3IgdGhlIGlNZyBhbmQgdGhyZWUgc3ViY2x1c3RlcnMgZm9yIHRoZSBmaXZlIENTRi9CbG9vZCBNeWVsb2lkIGNsdXN0ZXJzIGFzIGNhbiBiZSBzZWVuIGluIHRoZSBwbG90cyBiZWxvdy4gV2UgY2FuIGFsc28gb2JzZXJ2ZSB0aGF0IHRoZSBNeWVsb2lkMiBhbmQgTXllbG9pZDUgc2VwYXJhdGUgZnJvbSBNeWVsb2lkMS8yLzMgCndoaWNoIGlzIGV4cGVjdGVkLCBzaW5jZSBNeWVsb2lkMi81IG9yaWdpbmF0ZSBmcm9tIENTRiBzYW1wbGVzIGFuZCAKTXllbG9pZDEvMy80IG9yaWdpbmF0ZSBmcm9tIGJsb29kIHNhbXBsZXMuCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTEyfQptaWNyb2dsaWFfcmVjbHVzdGVyIDwtIHJlYWRSRFMoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvVHJpY3VsdHVyZV9kYXRhc2V0X1J5YW5fcGFwZXIvbWljcm9nbGlhX215ZWxvaWRfc2V1cmF0X29iamVjdF9yZWNsdXN0ZXJpbmciKQphMSA8LSBEaW1QbG90KG1pY3JvZ2xpYV9yZWNsdXN0ZXIsIHJlZHVjdGlvbiA9ICJ0c25lIiwKICAgICAgICAgICAgICBncm91cC5ieSA9ICJzZXVyYXRfY2x1c3RlcnMiLCBwdC5zaXplID0gLjQpICsKICBsYWJzKHRpdGxlID0gIkNsdXN0ZXJpbmciKQphMiA8LSBEaW1QbG90KG1pY3JvZ2xpYV9yZWNsdXN0ZXIsIHJlZHVjdGlvbiA9InRzbmUiLCAKICAgICAgICAgICAgICBncm91cC5ieSA9ICJjZWxsX3R5cGUiLCBwdC5zaXplID0gLjQpICsKICBsYWJzKHRpdGxlID0gIkNlbGwgdHlwZSIpCmEzIDwtIERpbVBsb3QobWljcm9nbGlhX3JlY2x1c3RlciwgcmVkdWN0aW9uID0idHNuZSIsCiAgICAgICAgICAgICAgZ3JvdXAuYnkgPSAiZGF0YXNldCIsIHB0LnNpemUgPSAuNCkgKwogICAgbGFicyh0aXRsZSA9ICJEYXRhc2V0IikKYTQgPC0gRGltUGxvdChtaWNyb2dsaWFfcmVjbHVzdGVyLCByZWR1Y3Rpb24gPSAidHNuZSIsCiAgICAgICAgICAgICAgZ3JvdXAuYnkgPSAib3JpZy5pZGVudCIsIHB0LnNpemUgPSAuNCkgKwogIGxhYnModGl0bGUgPSAiU2FtcGxlIG9yaWdpbiIpCgpmaWcgPC0gZ2dhcnJhbmdlKGExLCBhMiwgYTMsIGE0LCBuY29sID0gMiwgbnJvdyA9IDIpCmFubm90YXRlX2ZpZ3VyZShmaWcsIAogICAgICAgICAgICAgICAgdG9wID0gdGV4dF9ncm9iKCJEZS1ub3ZvIGNsdXN0ZXJpbmcgb2YgbXllbG9pZC1saW5lYWdlIGNsdXN0ZXJzIiwgCiAgICAgICAgICAgICAgIGNvbG9yID0gImJsYWNrIiwgZmFjZSA9ICJib2xkIiwgc2l6ZSA9IDIwKSkKYGBgCgoKSW50ZXJlc3RpbmdseSwgYm90aCB0aGUgTXllbG9pZDUgY2VsbHMgYW5kIHRoZSBNeWVsb2lkMiBjZWxscyBhcmUgc3BsaXQgYmV0d2VlbiAKdGhlIGNsdXN0ZXIgc2l4IChibHVlKSBhbmQgc2V2ZW4gKHB1cnBsZSkgaW4gdGhlIGZpZ3VyZSBiZWxvdy4gSW4gdGhlIGZvbGxvd2luZyB3ZSB3aWxsIGhhdmUgYSAKY2xvc2VyIGxvb2sgYXQgdGhpcyBzZWdyZWdhdGlvbi4gIApXaGVuIHBlcmZvcm1pbmcgR1JOIGluZmVyZW5jZSB3aXRoIFNjZW5pYyB3ZSBhbHNvIGlkZW50aWZpZWQgdHdvIHBvdGVudGlhbGx5IApiaW9sb2dpY2FsbHkgcmVsZXZhbnQgc3ViY2x1c3RlcnMgb2YgdGhlIE15ZWxvaWQyIGNlbGxzLiBJdCBjb3VsZCBiZSB0aGF0IHRoZXNlCmluZGVwZW5kZW50bHkgZm91bmQgY2x1c3RlcnMgY29ycmVsYXRlLiAKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MTB9CmE1IDwtIERpbVBsb3QobWljcm9nbGlhX3JlY2x1c3RlciwgcmVkdWN0aW9uID0idHNuZSIsIAogICAgICAgICAgICAgIHNwbGl0LmJ5ID0gImNlbGxfdHlwZSIsIHB0LnNpemUgPSAuNCwgbmNvbD0zKSArCiAgbGFicyh0aXRsZSA9ICJDb250cmlidXRpb24gb2YgZGlmZmVyZW50IGNlbGwgdHlwZXMgdG8gZGlmZmVyZW50IG15ZWxvaWQgY2x1c3RlcnMiKQphNQpgYGAKCkl0IGxvb2tzIGxpa2UgdGhlIHR3byBjbHVzdGVycyBpZGVudGlmaWVkIHRoaXMgd2F5IGNvcnJlc3BvbmQgdG8gZGlmZmVyZW50CnNhbXBsZSBvcmlnaW5zLiBDU0YgY2VsbHMgZnJvbSBwYXRpZW50MSAoSElWMV9DU0YpIGFuZCBwYXRpZW50MiAoSElWMl9DU0YpCmJlbG9uZyB0byBjbHVzdGVyIHNpeCx3aGlsZSBDU0YgY2VsbHMgZnJvbSBwYXRpZW50MyAoSElWM19DU0YpIGFuZCB0aGUgdHdvIAp1bmluZmVjdGVkIHBhdGllbnRzIChVbmluZmVjdGVkMV9DU0YsIFVuaW5mZWN0ZWQyX0NTRikgYmVsb25nIHRvIApjbHVzdGVyIHNldmVuLiBUaGUgc2VwYXJhdGlvbiBvZiBwYXRpZW50MyAoSElWM19DU0YpIGZyb20gcGF0aWVudDEgKEhJVjFfQ1NGKSAKYW5kIHBhdGllbnQyIChISVYyX0NTRikgbWlnaHQgY29ycmVzcG9uZCB0byBhIGJhdGNoIGVmZmVjdCwgb3IgaXQgbWlnaHQgYmUgYSAKYmlvbG9naWNhbCBlZmZlY3QsIGJlY2F1c2UgdGhlIGluZmVjdGlvbiBhZmZlY3RlZCB0aGUgY2VsbHMgZGlmZmVyZW50bHkuCgoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD03fQojYTEgPC0gRGltUGxvdChzdWJzZXQobWljcm9nbGlhX3JlY2x1c3RlciwgY2VsbF90eXBlID09ICJpTWciKSwgcmVkdWN0aW9uID0gInRzbmUiLAogICAgICAgICAgICMgICBncm91cC5ieSA9ICJvcmlnLmlkZW50IiwgcHQuc2l6ZSA9IC40KQphMiA8LSBEaW1QbG90KHN1YnNldChtaWNyb2dsaWFfcmVjbHVzdGVyLCBjZWxsX3R5cGUgIT0gImlNZyIpLCByZWR1Y3Rpb24gPSAidHNuZSIsCiAgICAgICAgICAgICAgZ3JvdXAuYnkgPSAib3JpZy5pZGVudCIsIHB0LnNpemUgPSAuNCkgKwogIGxhYnModGl0bGUgPSAiU2FtcGxlIG9yaWdpbiIpCiNhMyA8LSBEaW1QbG90KHN1YnNldChtaWNyb2dsaWFfcmVjbHVzdGVyLCBjZWxsX3R5cGUgPT0gImlNZyIpLCByZWR1Y3Rpb24gPSAidHNuZSIsCiAgICAgICAgICAgICAgI2dyb3VwLmJ5ID0gInNldXJhdF9jbHVzdGVycyIsIHB0LnNpemUgPSAuNCkKYTQgPC0gRGltUGxvdChzdWJzZXQobWljcm9nbGlhX3JlY2x1c3RlciwgY2VsbF90eXBlICE9ICJpTWciKSwgcmVkdWN0aW9uID0gInRzbmUiLAogICAgICAgICAgICAgIGdyb3VwLmJ5ID0gInNldXJhdF9jbHVzdGVycyIsIHB0LnNpemUgPSAuNCkgKwogIGxhYnModGl0bGUgPSAiQ2x1c3RlciIpCmZpZyA8LSBnZ2FycmFuZ2UoYTIsIGE0LCBuY29sID0gMiwgbnJvdyA9IDEpCmFubm90YXRlX2ZpZ3VyZShmaWcsIHRvcCA9IHRleHRfZ3JvYigiQ1NGL0Jsb29kIE15ZWxvaWQgY2VsbHMiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY2UgPSAiYm9sZCIsIHNpemUgPSAyMCkpCmBgYAoKU2luY2UgdGhlIHNlZ3JlZ2F0aW9uIGludG8gdHdvIGNsdXN0ZXJzIHNlZW1zIHRvIGJlIHJlbGF0ZWQgdG8gdGhlIHNhbXBsZSBvcmlnaW4KcmF0aGVyIHRoYW4gdG8gdGhlIGluZmVjdGlvbiBzdGF0dXMsIHdlIHdvdWxkIG5vdCBleHBlY3QgdGhlIGNsdXN0ZXJzIHRvIG92ZXJsYXAKd2l0aCB0aGUgY2x1c3RlcnMgaWRlbnRpZmllZCBhZnRlciBHUk4gaW5mZXJlbmNlIHdpdGggU0NFTklDLiBJbiB0aGUgZmlndXJlIApiZWxvdyB0aGlzIGlzIGV4YWN0bHkgd2hhdCBjYW4gYmUgb2JzZXJ2ZWQsIG9ubHkgdGhlIE15ZWxvaWQyIGNlbGxzIGZyb20gaW5mZWN0ZWQgQ1NGIHNhbXBsZXMgKEhJVjFfQ1NGLCBISVYyX0NTRiwgSElWM19DU0YpIGFyZSBzaG93bi4gCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWdoLmhlaWdodCA9IDV9CiMgcmVhZCBpbiBNeWVsb2lkMiBjZWxscwpoaXZteTIgPC0gcmVhZFJEUygiZGF0YV9maWxlcy9oaXZfbXllbG9pZDJfc3ViY2x1c3RlcnMiKQoKbXkyIDwtIHN1YnNldChtaWNyb2dsaWFfcmVjbHVzdGVyLCBjZWxsX3R5cGUgPT0gIk15ZWxvaWQyIiAmIAogICAgICAgICAgICAgICAgb3JpZy5pZGVudCAlaW4lIGMoIkhJVjFfQ1NGIiwgIkhJVjJfQ1NGIiwgIkhJVjNfQ1NGIikpCgpteTIgPC0gQWRkTWV0YURhdGEobXkyLCBoaXZteTJAbWV0YS5kYXRhWyJodF9jbHVzdGVyIl0sIAogICAgICAgICAgICAgICAgICAgY29sLm5hbWUgPSAiVEZfYWN0aXZpdHlfY2x1c3RlcnMiKQpwMSA8LSBEaW1QbG90KG15MiwgZ3JvdXAuYnkgPSAic2V1cmF0X2NsdXN0ZXJzIikgKwogIGxhYnModGl0bGU9IkNsdXN0ZXJzIikKcDIgPC0gRGltUGxvdChteTIsIGdyb3VwLmJ5ID0gIlRGX2FjdGl2aXR5X2NsdXN0ZXJzIikgKwogIGxhYnModGl0bGUgPSAiVEYgYWN0aXZpdHkiKQpwMyA8LSBEaW1QbG90KG15MiwgZ3JvdXAuYnkgPSAib3JpZy5pZGVudCIpICsKICBsYWJzKHRpdGxlID0gIlNhbXBsZSBvcmlnaW4iKQpmaWd1cmUgPC0gZ2dhcnJhbmdlKHAxLCBwMiwgcDMsIG5jb2wgPSAzLCBucm93ID0gMSkKYW5ub3RhdGVfZmlndXJlKGZpZ3VyZSwgCiAgICAgICAgICAgICAgICB0b3AgPSB0ZXh0X2dyb2IoIkNvbXBhcmlzb24gd2l0aCBjbHVzdGVycyBvZiBkaWZmZXJlbnQgVEYgYWNpdGl2dHkiLCAKICAgICAgICAgICAgICAgY29sb3IgPSAiYmxhY2siLCBmYWNlID0gImJvbGQiLCBzaXplID0gMjApKQojbXkyNSA8LSBzdWJzZXQobWljcm9nbGlhLCBzZXVyYXRfY2x1c3RlcnMgJWluJSBjKDYsNykgJmNlbGxfdHlwZSAlaW4lIGMoIk15ZWxvaWQyIiwgIk15ZWxvaWQ1IikpCgpgYGAKCgpGb3IgdGhpcyByZWFzb24gdGhlIHJlY2x1c3RlcmluZyBkaWQgbm90IGxlYWQgdG8gYW55IHVzZWZ1bCBpbnNpZ2h0cyBhbmQgd2lsbCAKbm90IGJlIGFuYWx5emVkIGZ1cnRoZXIuIAoKCgojIERpZmZlcmVudGlhbCBnZW5lIGV4cHJlc3Npb24KCiMjIyBEaWZmZXJlbnRpYWwgZ2VuZSBleHByZXNzaW9uIGJldHdlZW4gaW5mZWN0ZWQgYW5kIHVuaW5mZWN0ZWQgKy8tIEVGWiBpTWcKCkluIHRoZSBmb2xsb3dpbmcgSSB3aWxsIGNvbXBhcmUgZ2VuZSBleHByZXNzaW9uIGJldHdlZW4gaW5mZWN0ZWQgY2VsbHMgYW5kIAp1bmluZmVjdGVkIGNlbGxzLCBib3RoIHRyZWF0ZWQgd2l0aCBFRlogYW5kIG5vdCB0cmVhdGVkLiBJIHdpbGwgdXNlIHRoZSB1bmluZmVjdGVkIGNlbGxzIGFzIGEgCmJhc2VsaW5lIHRvIGZpbmQgZ2VuZXMgd2hpY2ggYXJlIHVwcmVndWxhdGVkIG9yIGRvd25yZWd1bGF0ZWQgaW4gaW5mZWN0ZWQgY2VsbHMKY29tcGFyZWQgdG8gdW5pbmZlY3RlZCBjZWxscy4gU2luY2Ugd2UgaGF2ZSBib3RoIGNlbGxzIHRyZWF0ZWQgd2l0aCBFRlogYW5kIApjZWxscyBub3QgdHJlYXRlZCB3aXRoIEVGWiwgd2UgY2FuIGRlZmluZSBhIHNpZ25hdHVyZSBmb3IgYm90aCB0cmVhdG1lbnQgCmNvbmRpdGlvbnMgc2VwYXJhdGVseSBhbmQgdGhlbiBzZWUgaWYgdGhlcmUgaXMgYW4gb3ZlcmxhcCBiZXR3ZWVuIHRoZSBnZW5lIApzaWduYXR1cmVzIG9mIGluZmVjdGVkIGNlbGxzICsvLSBFRlouIEZpbmRpbmcgZ2VuZXMgd2hpY2ggb3ZlcmxhcCBpbmRlcGVuZGVudGx5IApvZiB0cmVhbXRlbnQgY29uZGl0aW9uIGluY3JlYXNlcyB0aGUgY29uZmlkZW5jZSBpbiB0aGUgcmVzdWx0cwoKPGRldGFpbHM+CjxzdW1tYXJ5PioqTGlzdCBpZiB0b3AgdXAtIG9yIGRvd25yZWd1bGF0ZWQgZ2VuZXMgaW4gSW5mK0VGWiB2cyBVbmluZitFRloqKjwvc3VtbWFyeT4KCmBgYHtyLCByZXN1bHRzID0gImFzaXMifQojIGlzb2xhdGUgaU1nIGNlbGxzCm1pY3JvZ2xpYSA8LSBzdWJzZXQoY29tYmluZWQsIGNlbGxfdHlwZSA9PSAiaU1nIikKCiMgb25seSBpTWcgY2VsbHMgdG8gaWRlbnRpZnkgcG90ZW50aWFsIHNpZ25hdHVyZXMgYmV0d2VlbiBpbmZlY3RlZCB2cyB1bmluZmVjdGVkCklkZW50cyhtaWNyb2dsaWEpID0gICJvcmlnLmlkZW50IgoKIyBmaW5kIG1hcmtlciBnZW5lcyBiZXR3ZWVuIFVuaW5mK0VGWiBhbmQgSW5mK0VGWgppbmZfdW5pbmZfYXJ0X21hcmtlciA8LSBGaW5kTWFya2VycyhtaWNyb2dsaWEsIGlkZW50LjEgPSAiSW5mK0VGWiIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZGVudC4yID0gIlVuaW5mK0VGWiIsIHZlcmJvc2UgPSBGQUxTRSkKI3VwcmVndWxhdGVkIGdlbmVzCnVwX2luZl9hcnQgPC0gaW5mX3VuaW5mX2FydF9tYXJrZXIgJT4lIAogIGFycmFuZ2UoZGVzYyhhdmdfbG9nMkZDKSkgJT4lCiAgaGVhZCgxMCkgJT4lIAogIHJvd25hbWVzX3RvX2NvbHVtbigiZ2VuZSIpCnVwX2luZl9hcnQgICU+JSBrYWJsZShjYXB0aW9uID0gIkdlbmVzIHVwcmVndWxhdGVkIGluIEluZitFRlogdnMuIFVuaW5mK0VGWiIpCmBgYAoKYGBge3J9CiMgZG93bnJlZ3VsYXRlZCBnZW5lcwpkb3duX2luZl9hcnQgPC0gaW5mX3VuaW5mX2FydF9tYXJrZXIgJT4lIAogIGFycmFuZ2UoYXZnX2xvZzJGQykgJT4lIAogIGhlYWQoMTApICU+JQogIHJvd25hbWVzX3RvX2NvbHVtbigiZ2VuZSIpCmRvd25faW5mX2FydCAlPiUga2FibGUoY2FwdGlvbiA9ICJHZW5lcyBkb3ducmVndWxhdGVkIGluIEluZitFRlogdnMuIFVuaW5mK0VGWiIpCmBgYAoKLS0tCjwvZGV0YWlscz4KCmBgYHtyfQojIGZpbmQgbWFya2VyIGdlbmVzIGJldHdlZW4gSW5mIGFuZCBVbmluZgppbmZfdW5pbmZfbWFya2VyIDwtIEZpbmRNYXJrZXJzKG1pY3JvZ2xpYSwgaWRlbnQuMSA9ICJJbmYiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZGVudC4yID0gIlVuaW5mIiwgdmVyYm9zZSA9IEZBTFNFKQoKIyB1cHJlZ3VsYXRlZCBpbiBJbmYgdnMgVW5pbmYsIG5vIHRyZWF0bWVudAp1cF9pbmZfbm8gPC0gaW5mX3VuaW5mX21hcmtlciAlPiUgCiAgYXJyYW5nZShkZXNjKGF2Z19sb2cyRkMpKSAlPiUKICBoZWFkKDIwKSAlPiUgCiAgcm93bmFtZXNfdG9fY29sdW1uKCJnZW5lIikKI3VwX2luZl9ubyAgJT4lIGthYmxlKCkKCgpkb3duX2luZl9ubzwtIGluZl91bmluZl9tYXJrZXIgJT4lIAogIGFycmFuZ2UoYXZnX2xvZzJGQykgJT4lIAogIGhlYWQoMjApICU+JQogIHJvd25hbWVzX3RvX2NvbHVtbigiZ2VuZSIpCiNkb3duX2luZl9ubyU+JSBrYWJsZSgpCmBgYAoKT25seSAzJSBvZiBnZW5lcyB3aGljaCBhcmUgdXByZWd1bGF0ZWQgYW5kIG9ubHkgMTElIG9mIGdlbmVzIHdoaWNoIGFyZSAKZG93bnJlZ3VsYXRlZCBpbiBpbmZlY3RlZCB2cy4gdW5pbmZlY3RlZCBjZWxscyAKb3ZlcmxhcCBiZXR3ZWVuIHRoZSB0cmVhdG1lbnQgY29uZGl0aW9ucy4gVGhpcyBtZWFucywgdGhhdCB0aGUgZ2VuZSBleHByZXNzaW9uIHJlc3BvbnNlIGRlZmluaW5nIAp0aGUgaW5mZWN0aW9uIG1pZ2h0IGRpZmZlciBiZXR3ZWVuIGNlbGxzIHdpdGggYW5kIHdpdGhvdXQgdHJlYXRtZW50LiBUaGlzCnJlZmxlY3RzIHRoZSBmaW5kaW5ncyBvZiBbQFJ5YW5dIHRoYXQgdGhlIEVGWiB0cmVhdG1lbnQgbGVhZCB0byBhIGRpc3RpbmN0CmltbXVuZSByZXNwb25zZSBvZiBpTWcgYW5kIGRpc3RpbmN0IGFjdGl2YXRpb24gb2YgdHdvIGluZmxhbW1hdG9yeSBwYXRod2F5cywgClJob0dESSBhbmQgQ0Q0MCBwYXRod2F5cyBhcyB3aWxsIGJlIGRlc2NyaWJlIGxhdGVyIG9uLiBTaW5jZSB0aGVyZSBpcyBoYXJkbHkgYW55Cm92ZXJsYXAgd2Ugd2lsbCB1c2UgdGhlIGdlbmVzIHVwcmVndWxhdGVkIGluIEluZitFRlogY29tcGFyZWQgdG8gVW5pbmYrRUZaCmluIHRoZSBmb2xsb3dpbmcgYW5hbHlzaXMgc3RlcHMsIHNpbmNlIHRoZSBwcm9iYWJseSBiZXN0IHJlc2VtYmxlIHRoZSBDU0YvQmxvb2Qgc2FtcGxlcyB3aGljaCBvcmlnaW5hdGUgZnJvbSBwYXRpZW50cyB0cmVhdGVkIHdpdGggQVJULgoKYGBge3J9CnVwX2luZiA8LSBpbnRlcnNlY3QodXBfaW5mX2FydCRnZW5lLCB1cF9pbmZfbm8kZ2VuZSkKZG93bl9pbmYgPC0gaW50ZXJzZWN0KGRvd25faW5mX2FydCRnZW5lLCBkb3duX2luZl9ubyRnZW5lKQpwcmludChjKHVwX2luZiwgZG93bl9pbmYpKQpgYGAKCmBgYHtyLCBmaWcud2lkdGg9MTV9CnAxIDwtIGdnVmVubkRpYWdyYW06OmdnVmVubkRpYWdyYW0obGlzdCh1cF9pbmZfYXJ0JGdlbmUsIHVwX2luZl9ubyRnZW5lKSwKICAgICAgICAgICAgICBsYWJlbF9hbHBoYSA9IDAsCiAgICAgICAgICAgICAgY2F0ZWdvcnkubmFtZXM9IGMoIkluZitFRloiLCAiSW5mIiksCiAgICAgICAgICAgICAgI3NldC5zaXplID0gMjAsCiAgICAgICAgICAgICAgbGFiZWwgPSAicGVyY2VudCIsCiAgICAgICAgICAgICAgbGFiZWxfc2l6ZSA9IDYpICsKICAgc2NhbGVfZmlsbF9kaXN0aWxsZXIocGFsZXR0ZSA9ICJSZEJ1IikgKwogIGxhYnModGl0bGUgPSAiR2VuZXMgdXByZWd1bGF0ZWQgaW4gaW5mZWN0ZWQgY2VsbHMiKQoKcDIgPC0gZ2dWZW5uRGlhZ3JhbTo6Z2dWZW5uRGlhZ3JhbShsaXN0KGRvd25faW5mX2FydCRnZW5lLCBkb3duX2luZl9ubyRnZW5lKSwKICAgICAgICAgICAgICBsYWJlbF9hbHBoYSA9IDAsCiAgICAgICAgICAgICAgY2F0ZWdvcnkubmFtZXM9IGMoIkluZitFRloiLCAiSW5mIiksCiAgICAgICAgICAgICAgI3NldC5zaXplID0gMjAsCiAgICAgICAgICAgICAgbGFiZWwgPSAicGVyY2VudCIsCiAgICAgICAgICAgICAgbGFiZWxfc2l6ZSA9IDYsCiAgICAgICAgICAgICAgc2V0X2NvbG9yID0gYygicmVkIiwgImJsdWUiKSkgKwogIHNjYWxlX2ZpbGxfZGlzdGlsbGVyKHBhbGV0dGUgPSAiUmRCdSIpICsKICBsYWJzKHRpdGxlID0gIkdlbmVzIGRvd25yZWd1bGF0ZWQgaW4gaW5mZWN0ZWQgY2VsbHMiKQoKZ2dhcnJhbmdlKHAxLCBwMiwgbmNvbCA9IDIpCmBgYAoKPGRldGFpbHM+CjxzdW1tYXJ5PioqVm9sY2FubyBQbG90IG9mIEluZmVjdGlvbiAoKyBFRlopIHNpZ25hdHVyZSoqPC9zdW1tYXJ5PgoKSW50ZXJlc3RpbmdseSwgdGhlIGdlbmVzIGRvd25yZWd1bGF0ZCBpbiBJbmYrRUZaIHZzLiBVbmluZmVjdGVkIGNlbGxzIHNob3cKYSBoaWdoZXIgYXZlcmFnZSBsb2cgZm9sZCBjaGFuZ2Ugd2l0aCBoaWdoZXIgc2lnbmlmaWNhbmNlIChwLXZhbHVlcykuIAoKYGBge3IsIGZpZy5oZWlnaHQ9OCwgZmlnLndpZHRoPTEyfQppbmZfdW5pbmZfYXJ0X21hcmtlciAlPiUgCiAgcm93bmFtZXNfdG9fY29sdW1uKCJnZW5lIikgJT4lCiAgZmlsdGVyKGdlbmUgJWluJSBjKHVwX2luZl9hcnQkZ2VuZSwgZG93bl9pbmZfYXJ0JGdlbmUpKSAlPiUgCiAgIyBhZGQgYSBjb2x1bW4gY29udGFpbmluZyBpbmZvcm1hdGlvbiBpbiB3aGljaCBjb25kaXRpb24gdGhlIGNvcnJlc3BvbmRpbmcgVEYgCiAgIyBpcyB1cHJlZ3VsYXRlZAogIG11dGF0ZShjb25kaXRpb24gPSBjYXNlX3doZW4oZ2VuZSAlaW4lIHVwX2luZl9hcnQkZ2VuZSB+ICJ1cHJlZ3VsYXRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZW5lICVpbiUgZG93bl9pbmZfYXJ0JGdlbmUgfiAiZG93bnJlZ3VsYXRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gIk5BIikpICU+JQogICMgYWRkIGEgY29sdW1uIGNvbmFpbmluZyB0aGUgbGFiZWxzIGZvciB0aGUgcGxvdAogICMgSSBvbmx5IHdhbnQgdG8gbGFiZWwgY2VsbHMgd2hpY2ggYXJlIGFsc28gZm91bmQgYnkgU2NlbmljCiAgbXV0YXRlKGxhYmVsID0gaWZlbHNlKGdlbmUgJWluJSBjKHVwX2luZl9hcnQkZ2VuZSwgZG93bl9pbmZfYXJ0JGdlbmUpLCBnZW5lLCBOQSkpICU+JSAKICBnZ3Bsb3QoYWVzKHggPSBhdmdfbG9nMkZDLAogICAgICAgICAgICAgeSA9IC1sb2cxMChwX3ZhbF9hZGopLAogICAgICAgICAgICAgY29sID0gY29uZGl0aW9uLCAKICAgICAgICAgICAgIGxhYmVsID0gbGFiZWwpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAtbG9nMTAoMWUtNTApLCBjb2wgPSAicmVkIikgKwogIGdlb21fdGV4dChudWRnZV94ID0gLjA1LCBudWRnZV95ID0gMikgKwogIGxhYnModGl0bGUgPSAiR2VuZXMgd2hpY2ggYXJlIHVwLSBvciBkb3ducmVndWxhdGVkIGluIEluZitFRlogdnMgVW5pbmYrRUZaIikKCmBgYAoKLS0tCjwvZGV0YWlscz4KCiMjIyBEaWZmZXJlbnRpYWwgZ2VuZSBleHByZXNzaW9uIGJldHdlZW4gdHJlYXRtZW50IGNvbmRpdGlvbnMKCkNvbXBhcmluZyBVbmluZitFRlogd2l0aCBVbmluZiBhbmQgSW5mK0VGWiB3aXRoIEluZiBpTWcgb25lIG1pZ2h0IGJlIGFibGUgdG8gCmlkZW50aWZ5IGdlbmVzIHdoaWNoIGFyZSBkaWZmZXJlbnQgYWZ0ZXIgdHJlYXRtZW50IG9mIGNlbGxzIHdpdGggRUZaLiBGaW5kaW5nIApvdmVybGFwcGluZyBnZW5lcyBiZXR3ZWVuIHRoZSB0d28gaW5mZWN0aW9uIHN0YXRlcyBpbmNyZWFzZXMgdGhlIGNvbmZpZGVuY2UgaW4gdGhlIHJlc3VsdHMsIGJlY2F1c2UgdGhlIGlkZW50aWZpZWQgZ2VuZXMgYXJlIGFzc29jaWF0ZWQgd2l0aCB0cmVhdG1lbnQgaW5kZXBlbmRlbnRseSBvZiBpbmZlY3Rpb24gc3RhdHVzLgoKVGhlIGRpYWdyYW0gYmVsb3cgc2hvd3MsIHRoYXQgMzYlIG9mIGdlbmVzIGFyZSB1cHJlZ3VsYXRlZCBib3RoIGluIEluZiBhbmQKSW5mK0VGWiBpTWcgY29tcGFyZWQgdG8gVW5pbmYgYW5kIFVuaW5mK0VGWiBpTWcuIFRoZXNlIGdlbmVzIGFyZSBwcm9iYWJseSAKYXNzb2NpYXRlZCB3aXRoIHRoZSBFRlogdHJlYXRtZW50LiBUaGUgZHJ1ZyBhZmZlY3RzIAp0aGUgaU1nIGFuZCBjaGFuZ2VzIHRoZWlyIGdlbmUgZXhwcmVzc2lvbi4gVGhpcyBzaWduYXR1cmUgbWlnaHQgYmUgdXNlZCB0byAKaWRlbnRpZnkgTXllbG9pZDIgQ1NGIGNlbGxzIHdoaWNoIGFyZSBhZmZlY3RlZCBieSB0aGUgdHJlYXRtZW50LiBTaW5jZSBBUlQgZHJ1Z3MgCmFyZSBmb3VuZCBhdCBsb3dlciBjb25jZW50cmF0aW9ucyBpbiBDU0YgdGhhbiBpbiBibG9vZCwgcHJvYmFibHkKb25seSBhIHN1Ymdyb3VwIG9mIE15ZWxvaWQyIGFyZSBhZmZlY3RlZCBieSB0aGUgQVJUIGRydWdzIGFuZCBpdCB3b3VsZCBiZSAKaW50ZXJlc3RpbmcgdG8ga25vdyB3aGljaCBhcmUgYWZmZWN0ZWQgYnkgdHJlYXRlbWVudCBhbmQgd2hpY2ggYXJlIG5vdC4gSG93ZXZlciwgdGhpcwpjb21wYXJpc29uIG1pZ2h0IGJlIGZhciBmZXRjaGVkLCBzaW5jZSB0aGUgcGF0aWVudHMgZnJvbSB3aGljaCB0aGUgQ1NGIHNhbXBsZXMgCmhhdmUgYmVlbiBkZXJpdmVkIGhhdmUgbm90IGJlZW4gdHJlYXRlZCB3aXRoIEVGWiwgYnV0IHdpdGggYSBjb21iaW5hdGlvbiBvZiAKb3RoZXIgQVJUIGRydWdzIHdoaWNoIHByb2JhYmx5IGhhdmUgYSBzbGlnaHRseSBkaWZmZXJlbnQgZWZmZWN0IG9uIGNlbGxzLiAKCmBgYHtyfQp0cmVhdG1lbnRfbWFya2VyX3VuaW5mIDwtIEZpbmRNYXJrZXJzKG1pY3JvZ2xpYSwgaWRlbnQuMSA9ICJVbmluZitFRloiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZGVudC4yID0gIlVuaW5mIiwgdmVyYm9zZSA9IEZBTFNFKQoKIyBmaW5kIG1hcmtlciBnZW5lcyBiZXR3ZWVuIEluZitFRlogYW5kIEluZgp0cmVhdG1lbnRfbWFya2VyX2luZiA8LSBGaW5kTWFya2VycyhtaWNyb2dsaWEsIGlkZW50LjEgPSAiSW5mK0VGWiIsIGlkZW50LjIgPSAiSW5mIikKCiMgb3ZlcmxhcCBiZXR3ZWVuIHVwcmVndWxhdGVkIGdlbmVzCnRyZWF0bWVudF91cCA8LSBpbnRlcnNlY3QoKHRyZWF0bWVudF9tYXJrZXJfaW5mICU+JSAKICAgICAgICAgICAgIHJvd25hbWVzX3RvX2NvbHVtbigiZ2VuZSIpICU+JSAKICAgICAgICAgICAgIGZpbHRlcihhdmdfbG9nMkZDID4gMCkpJGdlbmUsIAogICAgICAgICAgICh0cmVhdG1lbnRfbWFya2VyX3VuaW5mICU+JSAKICAgICAgICAgICAgIHJvd25hbWVzX3RvX2NvbHVtbigiZ2VuZSIpICU+JSAKICAgICAgICAgICAgIGZpbHRlcihhdmdfbG9nMkZDID4gMCkpJGdlbmUpCgp0cmVhdG1lbnRfZG93biA8LSBpbnRlcnNlY3QoKHRyZWF0bWVudF9tYXJrZXJfaW5mICU+JSAKICAgICAgICAgICAgIHJvd25hbWVzX3RvX2NvbHVtbigiZ2VuZSIpICU+JSAKICAgICAgICAgICAgIGZpbHRlcihhdmdfbG9nMkZDIDwgMCkpJGdlbmUsIAogICAgICAgICAgICh0cmVhdG1lbnRfbWFya2VyX3VuaW5mICU+JSAKICAgICAgICAgICAgIHJvd25hbWVzX3RvX2NvbHVtbigiZ2VuZSIpICU+JSAKICAgICAgICAgICAgIGZpbHRlcihhdmdfbG9nMkZDIDwgMCkpJGdlbmUpCnRyZWF0bWVudF9tYXJrZXIgPC0gYyh0cmVhdG1lbnRfdXAsIHRyZWF0bWVudF9kb3duKQpgYGAKCmBgYHtyLCBmaWcud2lkdGg9MTV9CnAxIDwtIGdnVmVubkRpYWdyYW06OmdnVmVubkRpYWdyYW0obGlzdCgodHJlYXRtZW50X21hcmtlcl9pbmYgJT4lIAogICAgICAgICAgICAgcm93bmFtZXNfdG9fY29sdW1uKCJnZW5lIikgJT4lIAogICAgICAgICAgICAgZmlsdGVyKGF2Z19sb2cyRkMgPiAwKSkkZ2VuZSwgCiAgICAgICAgICAgICAodHJlYXRtZW50X21hcmtlcl91bmluZiAlPiUgCiAgICAgICAgICAgICByb3duYW1lc190b19jb2x1bW4oImdlbmUiKSAlPiUgCiAgICAgICAgICAgICBmaWx0ZXIoYXZnX2xvZzJGQyA+IDApKSRnZW5lKSwKICAgICAgICAgICAgICBsYWJlbF9hbHBoYSA9IDAsCiAgICAgICAgICAgICAgY2F0ZWdvcnkubmFtZXM9IGMoIkluZitFRloiLCAiVW5pbmYrRUZaIiksCiAgICAgICAgICAgICAgI3NldC5zaXplID0gMjAsCiAgICAgICAgICAgICAgbGFiZWwgPSAicGVyY2VudCIsCiAgICAgICAgICAgICAgbGFiZWxfc2l6ZSA9IDYpICsKICAgc2NhbGVfZmlsbF9kaXN0aWxsZXIocGFsZXR0ZSA9ICJSZEJ1IikgKwogIGxhYnModGl0bGUgPSAiR2VuZXMgdXByZWd1bGF0ZWQgaW4gY2VsbHMgdHJlYXRlZCB3aXRoIEVGWiIpCgpwMiA8LSBnZ1Zlbm5EaWFncmFtOjpnZ1Zlbm5EaWFncmFtKGxpc3QoKHRyZWF0bWVudF9tYXJrZXJfaW5mICU+JSAKICAgICAgICAgICAgIHJvd25hbWVzX3RvX2NvbHVtbigiZ2VuZSIpICU+JSAKICAgICAgICAgICAgIGZpbHRlcihhdmdfbG9nMkZDIDwgMCkpJGdlbmUsIAogICAgICAgICAgICAgKHRyZWF0bWVudF9tYXJrZXJfdW5pbmYgJT4lIAogICAgICAgICAgICAgcm93bmFtZXNfdG9fY29sdW1uKCJnZW5lIikgJT4lIAogICAgICAgICAgICAgZmlsdGVyKGF2Z19sb2cyRkMgPCAwKSkkZ2VuZSksCiAgICAgICAgICAgICAgbGFiZWxfYWxwaGEgPSAwLAogICAgICAgICAgICAgIGNhdGVnb3J5Lm5hbWVzPSBjKCJJbmYrRUZaIiwgIlVuaW5mK0VGWiIpLAogICAgICAgICAgICAgICNzZXQuc2l6ZSA9IDIwLAogICAgICAgICAgICAgIGxhYmVsID0gInBlcmNlbnQiLAogICAgICAgICAgICAgIGxhYmVsX3NpemUgPSA2LAogICAgICAgICAgICAgIHNldF9jb2xvciA9IGMoInJlZCIsICJibHVlIikpICsKICBzY2FsZV9maWxsX2Rpc3RpbGxlcihwYWxldHRlID0gIlJkQnUiKSArCiAgbGFicyh0aXRsZSA9ICJHZW5lcyBkb3ducmVndWxhdGVkIGluIGNlbGxzIHRyZWF0ZWQgd2l0aCBFRloiKQoKZ2dhcnJhbmdlKHAxLCBwMiwgbmNvbCA9IDIpCmBgYAoKCjxkZXRhaWxzPgo8c3VtbWFyeT4qKlZvbGNhbm8gUGxvdCBvZiBUcmVhdG1lbnQgc2lnbmF0dXJlKio8L3N1bW1hcnk+CgpgYGB7cixmaWcuaGVpZ2h0PTgsIGZpZy53aWR0aD0xMn0KdHJlYXRtZW50X21hcmtlcl91bmluZiAlPiUgCiAgcm93bmFtZXNfdG9fY29sdW1uKCJnZW5lIikgJT4lCiAgZmlsdGVyKGdlbmUgJWluJSB0cmVhdG1lbnRfbWFya2VyKSAlPiUgCiAgIyBhZGQgYSBjb2x1bW4gY29udGFpbmluZyBpbmZvcm1hdGlvbiBpbiB3aGljaCBjb25kaXRpb24gdGhlIGNvcnJlc3BvbmRpbmcgVEYgCiAgIyBpcyB1cHJlZ3VsYXRlZAogIG11dGF0ZShjb25kaXRpb24gPSBjYXNlX3doZW4oZ2VuZSAlaW4lIHRyZWF0bWVudF91cCB+ICJ1cHJlZ3VsYXRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZW5lICVpbiUgdHJlYXRtZW50X2Rvd24gfiAiZG93bnJlZ3VsYXRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gIk5BIikpICU+JQogICMgYWRkIGEgY29sdW1uIGNvbmFpbmluZyB0aGUgbGFiZWxzIGZvciB0aGUgcGxvdAogICMgSSBvbmx5IHdhbnQgdG8gbGFiZWwgY2VsbHMgd2hpY2ggYXJlIGFsc28gZm91bmQgYnkgU2NlbmljCiAgI211dGF0ZShsYWJlbCA9IGlmZWxzZShnZW5lICVpbiUgYyh1cF9pbmYkZ2VuZSwgZG93bl9pbmYkZ2VuZSksIGdlbmUsIE5BKSkgJT4lIAogIGdncGxvdChhZXMoeCA9IGF2Z19sb2cyRkMsCiAgICAgICAgICAgICB5ID0gLWxvZzEwKHBfdmFsX2FkaiksCiAgICAgICAgICAgICBjb2wgPSBjb25kaXRpb24sIAogICAgICAgICAgICAgbGFiZWwgPSBnZW5lKSkgKwogIGdlb21fcG9pbnQoKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gLWxvZzEwKDFlLTEwKSwgY29sID0gInJlZCIpICsKICBnZW9tX3RleHQobnVkZ2VfeCA9IC4wNSwgbnVkZ2VfeSA9IDIpICsKICBsYWJzKHRpdGxlID0gIlRvcCAyMCBHZW5lcyB3aGljaCBhcmUgdXAvZG93bnJlZ3VsYXRlZCBpbiB0cmVhdG1lbnQgdnMuIG5vIHRyZWF0bWVudCwgVW5pbmYgY2VsbHMiKQpgYGAKCi0tLQo8L2RldGFpbHM+CgojIEluZmVjdGlvbiAmIHRyZWF0bWVudCBnZW5lIHNpZ25hdHVyZQoKCkNoZWNraW5nIHRoZSBkaWZmZXJlbnRpYWxseSBleHByZXNzZWQgZ2VuZXMgYW5kIHRyeWluZyB0byBpZGVudGlmeSBhbiBpbmZlY3Rpb24gc2lnbmF0dXJlIHRocm91Z2ggbGl0ZXJhdHVyZSBzZWFyY2ggdHVybmVkIG91dCB0byBiZSB2ZXJ5IGRpZmZpY3VsdC4gVGhlcmVmb3JlLCAKYSBkaWZmZXJlbnQgYXBwcm9hY2ggd2FzIHVzZWQuIFRoZSB0b3AgdHdlbnR5IHVwLSBhbmQgZG93bnJlZ3VsYXRlZCBnZW5lcyBpbiAKSW5mK0VGWiB2cyBVbmluZitFRlogd2VyZSBjb21wdXRlZC4gVXNpbmcgdGhlc2UgZ2VuZXMgYXMgYW4gImluZmVjdGlvbiBzaWduYXR1cmUiIAp3ZSB3aWxsIGNoZWNrIGlmIHNvbWUgb2YgdGhlIE15ZWxvaWQyIGNlbGxzIGZyb20gdGhlIENTRiBzYW1wbGVzIHNob3cgYSBzaW1pbGFyIApzaWduYXR1cmUuCiAgCgpgYGB7cn0KIyBzZWxlY3Qgb25seSBnZW5lcyB3aGljaCBhcmUgYWxzbyBmb3VuZCBpbiB0aGUgc2MtUk5Bc2VxIGRhdGFzZXQKdXBfaW5mX2ZpbHQgPC0gdXBfaW5mX2FydCRnZW5lW3VwX2luZl9hcnQkZ2VuZSAlaW4lIHJvd25hbWVzKGhpdm15MkBhc3NheXMkUk5BQGNvdW50cyldCmRvd25faW5mX2ZpbHQgPC0gZG93bl9pbmZfYXJ0JGdlbmVbZG93bl9pbmZfYXJ0JGdlbmUgJWluJSByb3duYW1lcyhoaXZteTJAYXNzYXlzJFJOQUBjb3VudHMpXQpgYGAKCgojIyBHZW5lIHNpZ25hdHVyZSBzY29yaW5nIGluIE15ZWxvaWQyIGNlbGxzCgpVc2luZyB0aGUgc2lnbmF0dXJlIGdlbmVzIGZyb20gZGlmZmVyZW50aWFsIGdlbmUgZXhwcmVzc2lvbiBhbmFseXNpcyBiZXR3ZWVuCkluZitFRlogYW5kIFVuaW5mK0VGWiB3ZSBjYW4gY29tcHV0ZSBhIHNjb3JlIG9mIGFjdGl2aXR5IG9mIHRoZXNlIGdlbmUgc2V0cyBpbiAKdGhlIE15ZWxvaWQyIGNsdXN0ZXIgb2YgQ1NGIHNhbXBsZXMuIFdlIGNhbiBwbG90IHRoZXNlIHNjb3JlcyBpbiBhIFRTTkUgCnJlcHJlc2VudGF0aW9uLCBidXQgd2UgY2FuIGFsc28gZ2V0IHRoZSBzY29yZXMgZnJvbSB0aGUgbWV0YWRhdGEgYW5kIHVzZSB0aGVtIApmb3Igb3RoZXIgdmlzdWFsaXphdGlvbnMgCgpJZiB0aGUgSW5mK0VGWiBzaWduYXR1cmUgY2FuIGJlIGZvdW5kIGluIHNvbWUgb2YgdGhlIE15ZWxvaWQyIGNlbGxzIGZyb20gdGhlIENTRiBzYW1wbGVzIHRoaXMgbWlndGggcHJvdmlkZSBhZGRpdGlvbmFsIGluc2lnaHRzIGFib3V0IHRoZSBpbmZlY3Rpb24gc3RhdHVzIG9mIHRoZXNlIAptaWNyb2dsaWEtbGlrZSBjZWxscy4KCiMjIyMgU2NvcmVzIG9mIGdlbmUgc2lnbmF0dXJlIHVwcmVndWxhdGVkIGluIEluZitFRlogaU1nIGluIE15ZWxvaWQyIGNlbGxzCgpJbiB0aGUgcGxvdCBiZWxvdyB0aGVyZSBhcmUgc29tZSBjZWxscyB2aXNpYmxlIHdoaWNoIGhhdmUgYSBoaWdoIHNjb3JlIGZvciB0aGUgc2lnbmF0dXJlIGNvbXBvc2VkIG9mIGdlbmVzIHVwcmVndWxhdGVkIGluIEluZitFRlogbWljcm9nbGlhLiBUbyBiZSBwcmVjaXNlLAplbGV2ZW4gcGVyY2VudCBvZiB0aGUgTXllbG9pZDIgY2VsbHMgaGF2ZSBhIHBvc2l0aXZlIHNjb3JlICgxNyBvdXQgb2YgMTQ1IGNlbGxzKS4KVGhlc2UgaGlnaCBzY3JvaW5nIGNlbGxzIGRvLCBob3dldmVyLCBub3QgY29ycmVzcG9uZCB0byB0aGUgdHdvIGNsdXN0ZXJzIChjMSwgYzIpIG9idGFpbmVkIGZyb20gYW5hbHlzaXMgb2YgVEYgYWN0aXZpdHkgKFNDRU5JQykuCgoKCmBgYHtyLCBmaWcud2lkdGg9MTV9CnVwX3NpZ24gPC0gQWRkTW9kdWxlU2NvcmUoaGl2bXkyLAogICAgICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJlcyA9IHVwX2luZl9maWx0KQoKcDEgPC0gRmVhdHVyZVBsb3Qoc3Vic2V0KHVwX3NpZ24sIGh0X2NsdXN0ZXIgPT0gImMxIiksCiAgICAgICAgICAgICAgICAgIGZlYXR1cmVzID0gIkNsdXN0ZXIxIiwgcHQuc2l6ZSA9IDEpICsjLCBzcGxpdC5ieSA9ICJodF9jbHVzdGVyIikgKwogIHNjYWxlX2NvbG91cl9ncmFkaWVudG4oY29sb3VycyA9IHJldihicmV3ZXIucGFsKG4gPSAxMSwgbmFtZSA9ICJSZEJ1IikpKSArCiAgbGFicyh0aXRsZSA9ICJNeWVsb2lkMiBDbHVzdGVyIGMxIikKCnAyIDwtIEZlYXR1cmVQbG90KHN1YnNldCh1cF9zaWduLCBodF9jbHVzdGVyID09ICJjMiIpLAogICAgICAgICAgICAgICAgICBmZWF0dXJlcyA9ICJDbHVzdGVyMSIsIHB0LnNpemUgPSAxKSArIywgc3BsaXQuYnkgPSAiaHRfY2x1c3RlciIpICsKICBzY2FsZV9jb2xvdXJfZ3JhZGllbnRuKGNvbG91cnMgPSByZXYoYnJld2VyLnBhbChuID0gMTEsIG5hbWUgPSAiUmRCdSIpKSkgKwogIGxhYnModGl0bGUgPSAiTXllbG9pZDIgQ2x1c3RlciBjMiIpCgpmaWd1cmUgPC0gZ2dhcnJhbmdlKHAxLCBwMiwgbmNvbCA9IDIpIywgbnJvdyA9IDIpIAphbm5vdGF0ZV9maWd1cmUoZmlndXJlLCB0b3AgPSB0ZXh0X2dyb2IoIlNpZ25hdHVyZSBzY29yZSBvZiBnZW5lcyB1cHJlZ3VsYXRlZCBpbiBJbmYrRUZaIGlNZyBhcHBsaWVkIHRvIENTRiBNeWVsb2lkMiBjZWxscyIsIAogICAgICAgICAgICAgICBjb2xvciA9ICJibGFjayIsIGZhY2UgPSAiYm9sZCIsIHNpemUgPSAyMCkpCgpgYGAKCgo8ZGV0YWlscz4KPHN1bW1hcnk+KipFeGFjdCBzY29yZXMgZm9yIGVhY2ggY2VsbCoqPC9zdW1tYXJ5PgoKYGBge3IsIHJlc3VsdHMgPSAiYXNpcyJ9CiMgZGl2aWRlIHRoZSBudW1iZXIgb2Ygcm93cyhjZWxscykgd2l0aCBwb3NpdGl2ZSBjY29yZXMgYnkgdGhlIG51bWJlciBvZiB0b3RhbCAKIyByb3dzKGNlbGxzKSB0byBnZXQgdGhlIHBlcmNlbnRhZ2Ugb2YgY2VsbHMgd2l0aCBwb3NpdGl2ZSBzY29yZXMuCnBlcmNlbnRhZ2VfaW5mIDwtIGRpbSgodXBfc2lnbkBtZXRhLmRhdGFbIkNsdXN0ZXIxIl0gJT4lIAogICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyKENsdXN0ZXIxID4gMCkpKVsxXSAvIAogIGRpbSh1cF9zaWduQG1ldGEuZGF0YVsiQ2x1c3RlcjEiXSlbMV0KCiMgc2hvdyB0aGUgcG9zaXRpdmUgc2NvcmVzLgp1cF9zaWduQG1ldGEuZGF0YVsiQ2x1c3RlcjEiXSAlPiUgCiAgZmlsdGVyKENsdXN0ZXIxID4gMCkgJT4lIAogIHJlbmFtZSgiU2NvcmUiID0gIkNsdXN0ZXIxIikgJT4lIAogIGthYmxlKCkKYGBgCgotLS0KPC9kZXRhaWxzPgoKIyMjIyBEZWZpbmluZyBhIHNpZ25hdHVyZSBjb21wb3NlZCBvZiBkb3ducmVndWxhdGVkIGdlbmVzCgpEZWZpbmluZyBhIGdlbmUgc2lnbmF0dXJlIGNvbXBvc2VkIG9mIGJvdGggdXAtIGFuZCBkb3ducmVndWxhdGVkIGdlbmVzIHR1cm5lZCAKb3V0IHRvIGJlIG1vcmUgZGlmZmljdWx0IHRoYW4gZXhwZWN0ZWQuIE9uZSBpZGVhIHdhcyB0byBzZXBhcmF0ZWx5IGludmVzdGlnYXRlIAp1cHJlZ3VsYXRlZCB2ZXJzdXMgZG93bnJlZ3VsYXRlZCBnZW5lcy4gQWJvdmUgdGhlIHVwcmVndWxhdGVkIGdlbmUgc2lnbmF0dXJlIApzY29yZXMgaW4gTXllbG9pZDIgY2VsbHMgd2VyZSBzaG93bi4gCgpXZSB3aWxsIG5vdyBoYXZlIGEgY2xvc2VyIGxvb2sgYXQgdGhlIHByb2JsZW1zIHRoYXQgYXJpc2Ugd2hlbiBpbnZlc3RpZ2F0aW5nCmRvd25yZWd1bGF0ZWQgZ2VuZXMuIEFzc3VtaW5nIHRoYXQgb3VyIE15ZWxvaWQyIGNlbGxzIGFyZSBjb21wb3NlZCBvZiB0d28gCmRpc3RpbmN0IHBvcHVsYXRpb25zLCBvbmUgaW5mZWN0ZWQgYW5kIG9uZSB1bmluZmVjdGVkLCB3ZSB3b3VsZCBleHBlY3QgYSAKYmltb2RhbCBkaXN0cmlidXRpb24gb2YgZ2VuZSBleHByZXNzaW9uIGZvciBnZW5lcyB1cHJlZ3VsYXRlZCBpbiB0aGUgaW5mZWN0ZWQKY29uZGl0aW9uLiBUaGVyZSBzaG91bGQgYmUgb25lIHBlYWsgd2l0aCBiYXNlIGxldmVsIGdlbmUgZXhwcmVzc2lvbiBjb3JyZXNwb25kaW5nCnRvIHVuaW5mZWN0ZWQgY2VsbHMgYW5kIGEgc2Vjb25kIHBlYWsgd2l0aCBoaWdoZXIgbGV2ZWxzIG9mIGdlbmUgZXhwcmVzc2lvbiAKY29ycmVzcG9uZGluZyB0byBpbmZlY3RlZCBjZWxscy4gCgpJbiB0aGUgaGlzdG9ncmFtcyBiZWxvdyB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBzdW0gb2YgbG9nLW5vcm1hbGl6ZWQgZmVhdHVyZSBjb3VudHMgb2YgZ2VuZXMgdXByZWd1bGF0ZWQgb3IgZG93bnJlZ3VsYXRlZCAgcmVzcGVjdGl2ZWx5IGNhbiBiZSBzZWVuLiAKCkZvciB0aGUgdXByZWd1bGF0ZWQgZ2VuZXMgKGdyZWVuKSBhIGJpbW9kYWwgZGlzdHJpYnV0aW9uIGlzIG5vdCBldmlkZW50IGZyb20gCnRoZSBoaXN0b2dyYW0gYmVsb3cuIE5vIGNsZWFyIGNvbmNsdXNpb25zIGNhbiBiZSBkcmF3biwgc2luY2UgdGhlIG51bWJlciBvZgpjZWxscyBpcyBwcm9iYWJseSB0b28gbG93LgoKRm9yIHRoZSBkb3ducmVndWxhdGVkIGdlbmVzIHRoZXJlIHNlZW0gdG8gYmUgYSBsYXJnZSBudW1iZXIgb2YgY2VsbHMgd2hpY2ggZG8gCm5vdCBleHByZXNzIHRoZXNlIGdlbmVzIGF0IGFsbC4gVGhpcyBncm91cCBvZiBjZWxscyBjb3VsZCBpbmNsdWRlIGluZmVjdGVkIGNlbGxzLApob3dldmVyIHRoaXMgaXMgYSBkYW5nZXJvdXMgYXNzdW1wdGlvbiwgc2luY2UgaW4gZ2VuZXJhbCB0aGVyZSBtaWdodCBiZSBjZWxscwp3aXRoIGxvdyBvciBub25lIGV4cHJlc3Npb24gb2YgdGhlc2UgZ2VuZXMuIFRoZXJlIGlzIG5vIHdheSB0byBrbm93IGlmIHRoZXNlIApjZWxscyBhcmUgYWN0dWFsbHkgaW5mZWN0ZWQgY2VsbHMuCgpgYGB7cn0KI25vcm1hbGl6ZSBjb3VudHMgb2YgdXByZWd1bGF0ZWQgZ2VuZXMKY291bnRzX3VwIDwtIChoaXZteTJAYXNzYXlzJFJOQUBkYXRhKQpjb3VudHNfdXAgPC0gdCh0KGNvdW50c191cCkpIC8gY29sU3Vtcyhjb3VudHNfdXApCmNvdW50c191cCA8LSBsb2cxcChjb3VudHNfdXApCmNvdW50c191cCA8LSBjb3VudHNfdXBbdXBfaW5mX2ZpbHQsIF0KCiMgY29tcHV0ZSBhdmVyYWdlIGV4cHJlc3Npb24gb2YgdGhlIDIwIHNpZ25hdHVyZSBnZW5lcwpwMSA8LSBhcy5kYXRhLmZyYW1lKHJvd1N1bXModChjb3VudHNfdXApKSkgJT4lIAogIHJvd25hbWVzX3RvX2NvbHVtbigiY2VsbCIpICU+JSAKICByZW5hbWUoImNvdW50IiA9ICJyb3dTdW1zKHQoY291bnRzX3VwKSkiKSAlPiUgCiAgYXJyYW5nZShkZXNjKGNvdW50KSkgJT4lIAogIGdncGxvdChhZXMoeCAgPSBjb3VudCkpICsKICBnZW9tX2hpc3RvZ3JhbShiaW5zID0gNzAsIGNvbG9yID0gIm9saXZlZHJhYjQiLCBmaWxsID0gIm9saXZlZHJhYjQiKSArCiAgeGxhYigibm9ybWFsaXplZCBmZWF0dXJlIGNvdW50cyIpICsKICB5bGFiKCJudW1iZXIgb2YgY2VsbHMiKSArCiAgeWxpbSgwLDEwMCkgKwogIGxhYnModGl0bGUgPSAiU3VtIG9mIGZlYXR1cmUgY291bnRzIG9mIGdlbmVzIHVwcmVndWxhdGVkIGluIEluZitFRlogdnMuIFVuaW5mK0VGWiIpCgojbm9ybWFsaXplIGNvdW50cyBvZiBkb3ducmVndWxhdGVkIGdlbmVzCmNvdW50c19kb3duIDwtIChoaXZteTJAYXNzYXlzJFJOQUBkYXRhKQpjb3VudHNfZG93biA8LSB0KHQoY291bnRzX2Rvd24pKSAvIGNvbFN1bXMoY291bnRzX2Rvd24pCmNvdW50c19kb3duIDwtIGxvZzFwKGNvdW50c19kb3duKQpjb3VudHNfZG93biA8LSBjb3VudHNfZG93bltkb3duX2luZl9maWx0LCBdCgojIGNvbXB1dGUgYXZlcmFnZSBleHByZXNzaW9uIG9mIHRoZSAyMCBzaWduYXR1cmUgZ2VuZXMKcDIgPC0gYXMuZGF0YS5mcmFtZShyb3dTdW1zKHQoY291bnRzX2Rvd24pKSkgJT4lIAogIHJvd25hbWVzX3RvX2NvbHVtbigiY2VsbCIpICU+JSAKICByZW5hbWUoImNvdW50IiA9ICJyb3dTdW1zKHQoY291bnRzX2Rvd24pKSIpICU+JSAKICBhcnJhbmdlKGRlc2MoY291bnQpKSAlPiUgCiAgZ2dwbG90KGFlcyh4ICA9IGNvdW50KSkgKwogIGdlb21faGlzdG9ncmFtKGJpbnMgPSA3MCwgY29sb3IgPSAicmVkNCIsIGZpbGwgPSAicmVkNCIpICsKICB4bGFiKCJub3JtYWxpemVkIGZlYXR1cmUgY291bnRzIikgKwogIHlsYWIoIm51bWJlciBvZiBjZWxscyIpICsKICBsYWJzKHRpdGxlID0gIlN1bSBvZiBmZWF0dXJlIGNvdW50IG9mIGdlbmVzIGRvd25yZWd1bGF0ZWQgaW4gSW5mK0VGWiB2cy4gVW5pbmYrRUZaIikKYGBgCgpgYGB7ciwgZmlnLndpZHRoPTE1fQpwMSArIHAyCmBgYAoKIyMjIyBTY29yZXMgb2YgZ2VuZSBzaWduYXR1cmUgdXByZWd1bGF0ZWQgaW4gY2VsbHMgdHJlYXRlZCB3aXRoIEVGWiBpbmRlcGVuZGVudGx5IG9mIGluZmVjdGlvbiBjb25kaXRpb24uCgpgYGB7ciwgZmlnLndpZHRoPTE1fQp1cF90cmVhdCA8LSBBZGRNb2R1bGVTY29yZShoaXZteTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzID0gdHJlYXRtZW50X3VwKQoKcDEgPC0gRmVhdHVyZVBsb3Qoc3Vic2V0KHVwX3RyZWF0LCBodF9jbHVzdGVyID09ICJjMSIpLAogICAgICAgICAgICAgICAgICBmZWF0dXJlcyA9ICJDbHVzdGVyMSIsIHB0LnNpemUgPSAxKSArIywgc3BsaXQuYnkgPSAiaHRfY2x1c3RlciIpICsKICBzY2FsZV9jb2xvdXJfZ3JhZGllbnRuKGNvbG91cnMgPSByZXYoYnJld2VyLnBhbChuID0gMTEsIG5hbWUgPSAiUmRCdSIpKSkgKwogIGxhYnModGl0bGUgPSAiTXllbG9pZDIgQ2x1c3RlciBjMSIpCgpwMiA8LSBGZWF0dXJlUGxvdChzdWJzZXQodXBfdHJlYXQsIGh0X2NsdXN0ZXIgPT0gImMyIiksCiAgICAgICAgICAgICAgICAgIGZlYXR1cmVzID0gIkNsdXN0ZXIxIiwgcHQuc2l6ZSA9IDEpICsjLCBzcGxpdC5ieSA9ICJodF9jbHVzdGVyIikgKwogIHNjYWxlX2NvbG91cl9ncmFkaWVudG4oY29sb3VycyA9IHJldihicmV3ZXIucGFsKG4gPSAxMSwgbmFtZSA9ICJSZEJ1IikpKSArCiAgbGFicyh0aXRsZSA9ICJNeWVsb2lkMiBDbHVzdGVyIGMyIikKCmZpZ3VyZSA8LSBnZ2FycmFuZ2UocDEsIHAyLCBuY29sID0gMikjLCBucm93ID0gMikgCmFubm90YXRlX2ZpZ3VyZShmaWd1cmUsIHRvcCA9IHRleHRfZ3JvYigiU2lnbmF0dXJlIHNjb3JlIG9mIGdlbmVzIHVwcmVndWxhdGVkIGluIEVGWiB0cmVhdG1lbnQiLCAKICAgICAgICAgICAgICAgY29sb3IgPSAiYmxhY2siLCBmYWNlID0gImJvbGQiLCBzaXplID0gMjApKQoKYGBgCgoKCiMjIE92ZXJsYXkgSW5mK0VGWiBzaWduYXR1cmUgd2l0aCB0aGUgVEYgYWN0aXZpdHkgaGVhdG1hcCBvZiBNeWVsb2lkMiBjZWxscyB7LnRhYnNldH0KClRoZXJlIGFyZSBhIGZldyBjZWxscyB3aGljaCBleHByZXNzIHRoZSBJbmYrRUZaIHNpZ25hdHVyZSBhbmQgdGhleSBhcmUgaGlnaGxpZ2h0ZWQKd2l0aCBhbiBvcmFuZ2UgY29sb3VyIGluIHRoZSBoZWF0bWFwIGJlbG93LiBIb3dldmVyLCB0aGV5IGFyZSBzcHJlYWQKYWNyb3NzIGFsbCBjbHVzdGVycyBhbmQgcGF0aWVudHMgYW5kIHNpbmNlIHRoZXJlIGFyZSBzbyBmZXcgY2VsbHMgZHJhd2luZyBhIApjb25jbHVzaW9uIG9yIGZpbmRpbmcgYSBwYXR0ZXJuIGlzIG5vdCBmZWFzaWJsZS4KCiMjIyBrID0gMyBoaWVyYXJjaGljYWwgY2x1c3RlcmluZwoKYGBge3J9CiMgY2FsY3VsYXRlIHNjb3JlcyBmb3IgZ2VuZXMgdXByZWd1YWx0ZWQgaW4gSW5mK0VGWiBpTWcKdXBfc2lnbiA8LSBBZGRNb2R1bGVTY29yZShoaXZteTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzID0gdXBfaW5mX2ZpbHQpCgojIGV4dHJhY3QgdGhlIE15ZWxvaWQyIGNlbGxzIHdoaWNoIGhhdmUgYSBwb3NpdGl2ZSBzY29yZSBmb3IgdGhlIEluZitFRlogc2lnbmF0dXJlCmluZl9lZnpfY2VsbHMgPC0gcm93bmFtZXModXBfc2lnbkBtZXRhLmRhdGEgJT4lIGZpbHRlcihDbHVzdGVyMSA+IDApKQojdW5pbmZfZWZ6X2NlbGxzIDwtIHJvd25hbWVzKGhpdm15Ml91bmluZl9lZnpfc2lnbkBtZXRhLmRhdGEgJT4lIGZpbHRlcihDbHVzdGVyMSA+IDApKQojdW5pbmZfY2VsbHMgPC0gcm93bmFtZXMoaGl2bXkyX3VuaW5mX3NpZ25AbWV0YS5kYXRhICU+JSBmaWx0ZXIoQ2x1c3RlcjEgPiAwKSkKYGBgCgoKYGBge3IsZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTIwfQojIHJlYWQgaW4gU2V1cmF0IG9iamVjdCBjb250aWFuaW5nIGFsbHMgc2FtcGxlcyBhbmQgY29uZGl0aW9ucwpoaXY3IDwtIHJlYWRSRFMoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvUmVwcm9kdWNlX0ZhcmhhZGlhbl9QYXBlci9TZXVyYXRfb2JqZWN0cy90b3RhbF83X3NhbXBsZXNfbGFiZWxfdHJhbnNmZXIucmRzIikKIyBpbXBvcnQgVEYgYWN0aXZpdHkgbWF0cml4IG9mICBNeWVsb2lkMiBjZWxscwphdWNfbXR4IDwtIHJlYWQudGFibGUoImRhdGFfZmlsZXMvYXVjZWxsX21hdHJpeF8xMGtfaHZnLnRzdiIsIHNlcCA9ICJcdCIpCgoKIyAzIGhlYXRtYXBzIHdpdGggYWxsIFNjZW5pYyBURnMKaHRfbGlzdCA8LSBtYXAoc2VxLmludCgxOjMpLCBmdW5jdGlvbihuKSB7CiAgcGF0aWVudHMgPC0gYyAoIkhJVjFfQ1NGIiwgIkhJVjJfQ1NGIiwgIkhJVjNfQ1NGIikgIyAzIGRpZmZlcmVudCBwYXRpZW50cwogICMgZmlsdGVyIHRoZSBkYXRhc2V0IGZvciBvbmx5IE15ZWxvaWQyIGNlbGxzIGFuZCBpdGVyYXRpdmVseSBvbmUgb2YgdGhlIHBhdGllbnRzCiAgZGYgPC0gaGl2N0BtZXRhLmRhdGEgJT4lIGZpbHRlcihjZWxsX3R5cGUgPT0gIk15ZWxvaWQyIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnLmlkZW50ID09IHBhdGllbnRzW25dKQogICMgc2VsZWN0IG9ubHkgdGhlIGNlbGxzIG9mIHRoZSBhY3Rpdml0eSBtYXRyaXggd2hpY2ggYXJlIG15ZWxvaWQyIGFuZCB0aGUgY29ycmVjdCBwYXRpZW50CiAgbXR4IDwtIGF1Y19tdHhbcm93bmFtZXMoYXVjX210eCkgJWluJSByb3duYW1lcyhkZiksXQogICMgaGVhdG1hcAogIGh0IDwtIEhlYXRtYXAodChtdHgpLCAKICAgICAgICAgICAgICAgY29sdW1uX3RpdGxlID0gcGFzdGUwKCJwYXRpZW50OiAiLCBwYXRpZW50c1tuXSksIAogICAgICAgICAgICAgICB0b3BfYW5ub3RhdGlvbiA9IEhlYXRtYXBBbm5vdGF0aW9uKHNpZ25hdHVyZSA9IGNhc2Vfd2hlbigKICAgICAgICAgICAgICAgICByb3duYW1lcyhtdHgpICVpbiUgaW5mX2Vmel9jZWxscyB+ICJJbmZfRUZaX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgICAgI3Jvd25hbWVzKG10eCkgJWluJSB1bmluZl9lZnpfY2VsbHMgfiAiVW5pbmZfRUZaX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgICAgI3Jvd25hbWVzKG10eCkgJWluJSB1bmluZl9jZWxscyB+ICJVbmluZl9zaWduYXR1cmUiLAogICAgICAgICAgICAgICAgIFRSVUUgfiAibm9fc2lnbmF0dXJlIiksCiAgICAgICAgICAgICAgICAgbmFtZSA9ICJzaWduYXR1cmUiLAogICAgICAgICAgICAgICAgIGNvbCA9IGxpc3Qoc2lnbmF0dXJlID0gYygiSW5mX0VGWl9zaWduYXR1cmUiID0gIm9yYW5nZTIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIlVuaW5mX0VGWl9zaWduYXR1cmUiID0gImxpZ2h0Ymx1ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMiVW5pbmZfc2lnbmF0dXJlIiA9ICJvcmFuZ2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibm9fc2lnbmF0dXJlIiA9ICJuYXZ5IikpKSwKICAgICAgICAgICAgICAgY29sdW1uX2ttID0gMywKICAgICAgICAgICAgICAgI3Jvd19rbSA9IG4sIAogICAgICAgICAgICAgICBzaG93X2NvbHVtbl9uYW1lcyA9IEZBTFNFLAogICAgICAgICAgICAgICBjb2wgPWNvbG9yUmFtcFBhbGV0dGUocmV2KGJyZXdlci5wYWwobiA9IDcsIG5hbWUgPSAiUmRZbEJ1IikpKSgxMDApLAogICAgICAgICAgICAgICBzaG93X3Jvd19uYW1lcyA9IFRSVUUKICAgICAgICAgICAgICAgKSAKICAgICAgICAgICAgICAgI3RvcF9hbm5vdGF0aW9uID0gY29sdW1uX2Fubm90YXRpb24pIAogIGxpc3QobmFtZSA9IHBhdGllbnRzW25dLCBoZWF0bWFwID0gaHQpCn0pCgpodF9saXN0W1sxXV0kaGVhdG1hcCArIGh0X2xpc3RbWzJdXSRoZWF0bWFwICsgaHRfbGlzdFtbM11dJGhlYXRtYXAgCmBgYAoKLS0tCgojIyMgZ3JvdXAgYWNjb3JkaW5nIHRvIGluZmVjdGlvbiBjb25kaXRpb24KCldoZW4geW91IGdyb3VwIHRoZSBjZWxscyBhY2NvcmRpbmcgdG8gdGhlaXIgZGlmZmVyZW50IGdlbmUgc2lnbmF0dXJlcyBhcyBpbiB0aGUgCmhlYXRtYXAgYmVsb3csIHlvdSBkbyBub3QgcmVhbGx5IHNlZSBhIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgZ3JvdXBzLiAKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MjB9CiMgZmlsdGVyIHRoZSBkYXRhc2V0IGZvciBvbmx5IE15ZWxvaWQyIGNlbGxzIApkZiA8LSBoaXY3QG1ldGEuZGF0YSAlPiUgZmlsdGVyKGNlbGxfdHlwZSA9PSAiTXllbG9pZDIiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnLmlkZW50ICVpbiUgYyAoIkhJVjFfQ1NGIiwgIkhJVjJfQ1NGIiwgIkhJVjNfQ1NGIikpCiMgc2VsZWN0IG9ubHkgdGhlIGNlbGxzIG9mIHRoZSBhY3Rpdml0eSBtYXRyaXggd2hpY2ggYXJlIG15ZWxvaWQyIGFuZCB0aGUgY29ycmVjdCBwYXRpZW50Cm10eCA8LSBhdWNfbXR4W3Jvd25hbWVzKGF1Y19tdHgpICVpbiUgcm93bmFtZXMoZGYpLF0KCiMgYWRkIHNpZ25hdHVyZSBjb2x1bW4gdG8gZGF0YWZyYW1lCnNpZ25hdHVyZSA8LSBkZiAlPiUKICByb3duYW1lc190b19jb2x1bW4oImNlbGwiKSAlPiUgCiAgbXV0YXRlKHNpZ25hdHVyZSA9IGNhc2Vfd2hlbihjZWxsICVpbiUgaW5mX2Vmel9jZWxscyB+ICJJbmZfc2lnbmF0dXJlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjY2VsbCAlaW4lIHVuaW5mX2Vmel9jZWxscyB+IlVuaW5mX0VGWl9zaWduYXR1cmUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNjZWxsICVpbiUgdW5pbmZfY2VsbHMgfiAiVW5pbmZfc2lnbmF0dXJlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRSVUUgfiAibm9fc2lnbmF0dXJlIikpCgoKaHQgPC0gZHJhdyhIZWF0bWFwKHQobXR4KSwgCiAgICAgICAgICAgICBjb2x1bW5fdGl0bGUgPSAiQWxsIHBhdGllbnRzIHNwbGl0IGFjY29yZGluZyB0byBnZW5lIHNpZ25hdHVyZSBzY29yZXMiLCAKICAgICAgICAgICAgIHRvcF9hbm5vdGF0aW9uID0gSGVhdG1hcEFubm90YXRpb24oc2lnbmF0dXJlID0gY2FzZV93aGVuKAogICAgICAgICAgICAgICByb3duYW1lcyhtdHgpICVpbiUgaW5mX2Vmel9jZWxscyB+ICJJbmZfc2lnbmF0dXJlIiwKICAgICAgICAgICAgICAgI3Jvd25hbWVzKG10eCkgJWluJSB1bmluZl9lZnpfY2VsbHMgfiAiVW5pbmZfRUZaX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgICNyb3duYW1lcyhtdHgpICVpbiUgdW5pbmZfY2VsbHMgfiAiVW5pbmZfc2lnbmF0dXJlIiwKICAgICAgICAgICAgICAgVFJVRSB+ICJub19zaWduYXR1cmUiKSwKICAgICAgICAgICAgICAgbmFtZSA9ICJzaWduYXR1cmUiLAogICAgICAgICAgICAgICBjb2wgPSBsaXN0KHNpZ25hdHVyZSA9IGMoIkluZl9zaWduYXR1cmUiID0gIm9yYW5nZTIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyJVbmluZl9FRlpfc2lnbmF0dXJlIiA9ICJsaWdodGJsdWUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyJVbmluZl9zaWduYXR1cmUiID0gIm9yYW5nZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibm9fc2lnbmF0dXJlIiA9ICJuYXZ5IikpKSwgICAgICAgCiAgICAgICAgICAgICBjb2x1bW5fc3BsaXQgPSBzaWduYXR1cmUkc2lnbmF0dXJlLAogICAgICAgICAgICAgc2hvd19jb2x1bW5fbmFtZXMgPSBGQUxTRSwKICAgICAgICAgICAgIGNvbCA9Y29sb3JSYW1wUGFsZXR0ZShyZXYoYnJld2VyLnBhbChuID0gNywgbmFtZSA9ICJSZFlsQnUiKSkpKDEwMCksCiAgICAgICAgICAgICBzaG93X3Jvd19uYW1lcyA9IFRSVUUKICAgICAgICAgICAgICkpCmBgYAoKLS0tCgoKIyMgT3ZlcmxheSBFRlogdHJlYXRtZW50IHNpZ25hdHVyZSB3aXRoIHRoZSBURiBhY3Rpdml0eSBoZWF0bWFwIG9mIE15ZWxvaWQyIGNlbGxzIHsudGFic2V0fQoKYGBge3J9CiMgZXh0cmFjdCB0aGUgTXllbG9pZDIgY2VsbHMgd2hpY2ggaGF2ZSBhIHBvc2l0aXZlIHNjb3JlIGZvciB0aGUgdHJlYXRtZW50IHNpZ25hdHVyZQp0cmVhdF9jZWxscyA8LSByb3duYW1lcyh1cF90cmVhdEBtZXRhLmRhdGEgJT4lIGZpbHRlcihDbHVzdGVyMSA+IDApKQpgYGAKCiMjIyBrID0gMyBoaWVyYXJjaGljYWwgY2x1c3RlcmluZwoKYGBge3IsZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTIwfQoKIyAzIGhlYXRtYXBzIHdpdGggYWxsIFNjZW5pYyBURnMKaHRfbGlzdCA8LSBtYXAoc2VxLmludCgxOjMpLCBmdW5jdGlvbihuKSB7CiAgcGF0aWVudHMgPC0gYyAoIkhJVjFfQ1NGIiwgIkhJVjJfQ1NGIiwgIkhJVjNfQ1NGIikgIyAzIGRpZmZlcmVudCBwYXRpZW50cwogICMgZmlsdGVyIHRoZSBkYXRhc2V0IGZvciBvbmx5IE15ZWxvaWQyIGNlbGxzIGFuZCBpdGVyYXRpdmVseSBvbmUgb2YgdGhlIHBhdGllbnRzCiAgZGYgPC0gaGl2N0BtZXRhLmRhdGEgJT4lIGZpbHRlcihjZWxsX3R5cGUgPT0gIk15ZWxvaWQyIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnLmlkZW50ID09IHBhdGllbnRzW25dKQogICMgc2VsZWN0IG9ubHkgdGhlIGNlbGxzIG9mIHRoZSBhY3Rpdml0eSBtYXRyaXggd2hpY2ggYXJlIG15ZWxvaWQyIGFuZCB0aGUgY29ycmVjdCBwYXRpZW50CiAgbXR4IDwtIGF1Y19tdHhbcm93bmFtZXMoYXVjX210eCkgJWluJSByb3duYW1lcyhkZiksXQogICMgaGVhdG1hcAogIGh0IDwtIEhlYXRtYXAodChtdHgpLCAKICAgICAgICAgICAgICAgY29sdW1uX3RpdGxlID0gcGFzdGUwKCJwYXRpZW50OiAiLCBwYXRpZW50c1tuXSksIAogICAgICAgICAgICAgICB0b3BfYW5ub3RhdGlvbiA9IEhlYXRtYXBBbm5vdGF0aW9uKHNpZ25hdHVyZSA9IGNhc2Vfd2hlbigKICAgICAgICAgICAgICAgICByb3duYW1lcyhtdHgpICVpbiUgdHJlYXRfY2VsbHMgfiAiRUZaX3RyZWF0bWVudF9zaWduYXR1cmUiLAogICAgICAgICAgICAgICAgICNyb3duYW1lcyhtdHgpICVpbiUgdW5pbmZfZWZ6X2NlbGxzIH4gIlVuaW5mX0VGWl9zaWduYXR1cmUiLAogICAgICAgICAgICAgICAgICNyb3duYW1lcyhtdHgpICVpbiUgdW5pbmZfY2VsbHMgfiAiVW5pbmZfc2lnbmF0dXJlIiwKICAgICAgICAgICAgICAgICBUUlVFIH4gIm5vX3NpZ25hdHVyZSIpLAogICAgICAgICAgICAgICAgIG5hbWUgPSAic2lnbmF0dXJlIiwKICAgICAgICAgICAgICAgICBjb2wgPSBsaXN0KHNpZ25hdHVyZSA9IGMoIkVGWl90cmVhdG1lbnRfc2lnbmF0dXJlIiA9ICJvbGl2ZWRyYWIzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyJVbmluZl9FRlpfc2lnbmF0dXJlIiA9ICJsaWdodGJsdWUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIlVuaW5mX3NpZ25hdHVyZSIgPSAib3JhbmdlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm5vX3NpZ25hdHVyZSIgPSAibmF2eSIpKSksCiAgICAgICAgICAgICAgIGNvbHVtbl9rbSA9IDMsCiAgICAgICAgICAgICAgICNyb3dfa20gPSBuLCAKICAgICAgICAgICAgICAgc2hvd19jb2x1bW5fbmFtZXMgPSBGQUxTRSwKICAgICAgICAgICAgICAgY29sID1jb2xvclJhbXBQYWxldHRlKHJldihicmV3ZXIucGFsKG4gPSA3LCBuYW1lID0gIlJkWWxCdSIpKSkoMTAwKSwKICAgICAgICAgICAgICAgc2hvd19yb3dfbmFtZXMgPSBUUlVFCiAgICAgICAgICAgICAgICkgCiAgICAgICAgICAgICAgICN0b3BfYW5ub3RhdGlvbiA9IGNvbHVtbl9hbm5vdGF0aW9uKSAKICBsaXN0KG5hbWUgPSBwYXRpZW50c1tuXSwgaGVhdG1hcCA9IGh0KQp9KQoKaHRfbGlzdFtbMV1dJGhlYXRtYXAgKyBodF9saXN0W1syXV0kaGVhdG1hcCArIGh0X2xpc3RbWzNdXSRoZWF0bWFwIApgYGAKCi0tLQoKIyMjIEdyb3VwIGJ5IHRyZWF0bWVudCBjb25kaXRpb24KCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MjB9CiMgZmlsdGVyIHRoZSBkYXRhc2V0IGZvciBvbmx5IE15ZWxvaWQyIGNlbGxzIApkZiA8LSBoaXY3QG1ldGEuZGF0YSAlPiUgZmlsdGVyKGNlbGxfdHlwZSA9PSAiTXllbG9pZDIiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnLmlkZW50ICVpbiUgYyAoIkhJVjFfQ1NGIiwgIkhJVjJfQ1NGIiwgIkhJVjNfQ1NGIikpCiMgc2VsZWN0IG9ubHkgdGhlIGNlbGxzIG9mIHRoZSBhY3Rpdml0eSBtYXRyaXggd2hpY2ggYXJlIG15ZWxvaWQyIGFuZCB0aGUgY29ycmVjdCBwYXRpZW50Cm10eCA8LSBhdWNfbXR4W3Jvd25hbWVzKGF1Y19tdHgpICVpbiUgcm93bmFtZXMoZGYpLF0KCiMgYWRkIHNpZ25hdHVyZSBjb2x1bW4gdG8gZGF0YWZyYW1lCnNpZ25hdHVyZSA8LSBkZiAlPiUKICByb3duYW1lc190b19jb2x1bW4oImNlbGwiKSAlPiUgCiAgbXV0YXRlKHNpZ25hdHVyZSA9IGNhc2Vfd2hlbihjZWxsICVpbiUgdHJlYXRfY2VsbHMgfiAiRUZaX3RyZWF0bWVudF9zaWduYXR1cmUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNjZWxsICVpbiUgdW5pbmZfZWZ6X2NlbGxzIH4iVW5pbmZfRUZaX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI2NlbGwgJWluJSB1bmluZl9jZWxscyB+ICJVbmluZl9zaWduYXR1cmUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+ICJub19zaWduYXR1cmUiKSkKCgpodCA8LSBkcmF3KEhlYXRtYXAodChtdHgpLCAKICAgICAgICAgICAgIGNvbHVtbl90aXRsZSA9ICJBbGwgcGF0aWVudHMgc3BsaXQgYWNjb3JkaW5nIHRvIGdlbmUgc2lnbmF0dXJlIHNjb3JlcyIsIAogICAgICAgICAgICAgdG9wX2Fubm90YXRpb24gPSBIZWF0bWFwQW5ub3RhdGlvbihzaWduYXR1cmUgPSBjYXNlX3doZW4oCiAgICAgICAgICAgICAgIHJvd25hbWVzKG10eCkgJWluJSB0cmVhdF9jZWxscyB+ICJFRlpfdHJlYXRtZW50X3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgICNyb3duYW1lcyhtdHgpICVpbiUgdW5pbmZfZWZ6X2NlbGxzIH4gIlVuaW5mX0VGWl9zaWduYXR1cmUiLAogICAgICAgICAgICAgICAjcm93bmFtZXMobXR4KSAlaW4lIHVuaW5mX2NlbGxzIH4gIlVuaW5mX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgIFRSVUUgfiAibm9fc2lnbmF0dXJlIiksCiAgICAgICAgICAgICAgIG5hbWUgPSAic2lnbmF0dXJlIiwKICAgICAgICAgICAgICAgY29sID0gbGlzdChzaWduYXR1cmUgPSBjKCJFRlpfdHJlYXRtZW50X3NpZ25hdHVyZSIgPSAib2xpdmVkcmFiMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIlVuaW5mX0VGWl9zaWduYXR1cmUiID0gImxpZ2h0Ymx1ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIlVuaW5mX3NpZ25hdHVyZSIgPSAib3JhbmdlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJub19zaWduYXR1cmUiID0gIm5hdnkiKSkpLCAgICAgICAKICAgICAgICAgICAgIGNvbHVtbl9zcGxpdCA9IHNpZ25hdHVyZSRzaWduYXR1cmUsCiAgICAgICAgICAgICBzaG93X2NvbHVtbl9uYW1lcyA9IEZBTFNFLAogICAgICAgICAgICAgY29sID1jb2xvclJhbXBQYWxldHRlKHJldihicmV3ZXIucGFsKG4gPSA3LCBuYW1lID0gIlJkWWxCdSIpKSkoMTAwKSwKICAgICAgICAgICAgIHNob3dfcm93X25hbWVzID0gVFJVRQogICAgICAgICAgICAgKSkKYGBgCgotLS0KCiMgRGlmZmVyZW50aWFsIFRGIGFjdGl2aXR5IHsudGFic2V0fQoKQWZ0ZXIgaGF2aW5nIGlkZW50aWZpZWQgYSBmZXcgY2VsbHMgd2l0aCBhIGhpZ2ggc2NvcmVzIGZvciB0aGUgaW5mZWN0aW9uIHNpZ25hdHVyZQooSW5mK0VGWiksIGFzIHdlbGwgYXMgY2VsbHMgd2l0aCBhIGhpZ2ggc2NvcmUgZm9yIHRoZSBFRlogdHJlYXRtZW50IHNpZ25hdHVyZXMsCndlIGNhbiBub3cgY2hlY2sgaWYgc29tZSBvZiB0aGUgVEZzIHNob3cgc2lnbmlmaWNhbnRseSBkaWZmZXJlbnQgYWN0aXZpdHkgYmV0d2Vlbgp0aGUgdHdvIGNvbmRpdGlvbnMuIEZvciB0aGlzIHdlIGNhbiB1c2UgYSBwYWlyd2lzZSBXaWxjb3ggVGVzdC4gCgojIyBCZXR3ZWVuIGluZmVjdGlvbiBjb25kaXRpb25zCgpBcmUgc29tZSBURnMgaW4gTXllbG9pZDIgZGlmZmVyZW50aWFsbHkgYWN0aXZlIGJldHdlZW4gdGhlIGluZmVjdGlvbiBjb25kaXRpb25zPwoKVGhlcmUgYXJlIG5vIHNpZ25pZmljYW50IGRpZmZlcmVuY2VzIGluIFRGIGFjdGl2aXR5IGJldHdlZW4gdGhlIGNlbGxzIHdpdGggCmhpZ2ggc2NvcmVzIGZvciB0aGUgSW5mK0VGWiBzaWduYXR1cmUgY29tcGFyZWQgdG8gY2VsbHMgd2l0aG91dCB0aGUgc2lnbmF0dXJlLgpTaW5jZSBubyBzaWduaWZpY2FudCBkaWZmZXJlbmNlcyB3ZXJlIGZvdW5kIHdpdGggdGhlIEtydXNrYWwtV2FsbGlzIHRlc3QsIG5vIApmdXJ0aGVyIHBvc3Rob2MgYW5hbHlzaXMgd2FzIHBlcmZvcm1lZC4KCmBgYHtyfQpoaXZteTJfc2NlbmljIDwtIEFkZE1ldGFEYXRhKGhpdm15MiwgCiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEgPSBhdWNfbXR4LCAKICAgICAgICAgICAgICAgICAgICBjb2wubmFtZSA9IGNvbG5hbWVzKGF1Y19tdHgpKQoKaW5mX3NpZ25fZGYgPC0gaGl2bXkyX3NjZW5pY0BtZXRhLmRhdGEgJT4lIAogIHJvd25hbWVzX3RvX2NvbHVtbigiY2VsbCIpICU+JSAKICBtdXRhdGUoc2lnbmF0dXJlID0gY2FzZV93aGVuKGNlbGwgJWluJSBpbmZfZWZ6X2NlbGxzIH4gIkluZl9FRlpfc2lnbmF0dXJlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gIm5vX3NpZ25hdHVyZSIpKQoKIyBjaGVjayBhbGwgVEZzIApwX3ZhbHVlcyA8LSBtYXAoc2VxLmludCgxOjEyNSksIGZ1bmN0aW9uKG4pewogIHRmIDwtIGNvbG5hbWVzKGF1Y19tdHgpW25dCiAgcF92YWx1ZXMgPC0gdW5saXN0KGtydXNrYWwudGVzdChwdWxsKGluZl9zaWduX2RmW3RmXSkgfiBzaWduYXR1cmUsIGluZl9zaWduX2RmKSlbInAudmFsdWUiXQp9KQoKIyBhZGp1c3QgZm9yIG11bHRpcGxlIHRlc3Rpbmcgd2l0aCBGRFIKYWRqX3BfdmFsdWVzIDwtIHAuYWRqdXN0KGFzLm51bWVyaWModW5uYW1lKHVubGlzdChwX3ZhbHVlcykpKSwgbWV0aG9kID0gImZkciIpCgojIGhvdyBtYW55IHRyYW5zY3JpcHRpb24gZmFjdG9ycyBhcmUgc2lnbmlmaWNhbnRseSBkaWZmZXJlbnQgYmV0d2VlbiB0aGUgY2x1c3RlcnM/CnNpZ24gPC0gYWRqX3BfdmFsdWVzW2Fkal9wX3ZhbHVlcyA8IDAuMDVdCmBgYAoKLS0tCgojIyBCZXR3ZWVuIHRyZWF0bWVudCBjb25kaXRpb25zCgpBcmUgc29tZSBURnMgaW4gTXllbG9pZDIgZGlmZmVyZW50aWFsbHkgYWN0aXZlIGJldHdlZW4gdGhlIHRyZWF0bWVudCBjb25kaXRpb25zPwoKVGhlcmUgYXJlIG5vIHNpZ25pZmljYW50IGRpZmZlcmVuY2VzIGluIFRGIGFjdGl2aXR5IGJldHdlZW4gdGhlIGNlbGxzIHdpdGggCmhpZ2ggc2NvcmVzIGZvciBFRlogdHJlYXRtZW50IHNpZ25hdHVyZSBjb21wYXJlZCB0byBjZWxscyB3aXRob3V0IHRoZSBzaWduYXR1cmUuClRoZXJlZm9yZSwgbm8gcG9zdGhvYyBhbmFseXNpcyB3YXMgcGVyZm9ybWVkLgoKCmBgYHtyfQpkZiA8LSBoaXZteTJfc2NlbmljQG1ldGEuZGF0YSAlPiUgCiAgcm93bmFtZXNfdG9fY29sdW1uKCJjZWxsIikgJT4lIAogICAgICAgICMgZmlsdGVyKGNlbGwgJWluJSBjKGluZl9lZnpfY2VsbHMsIHVuaW5mX2Vmel9jZWxscywgdW5pbmZfY2VsbHMpKSAlPiUgCiAgbXV0YXRlKHNpZ25hdHVyZSA9IGNhc2Vfd2hlbihjZWxsICVpbiUgdHJlYXRfY2VsbHMgfiAidHJlYXRtZW50X3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVFJVRSB+ICJub19zaWduYXR1cmUiKSkKCiMgY2hlY2sgYWxsIFRGcyAKcF92YWx1ZXMgPC0gbWFwKHNlcS5pbnQoMToxMjUpLCBmdW5jdGlvbihuKXsKICB0ZiA8LSBjb2xuYW1lcyhhdWNfbXR4KVtuXQogIHBfdmFsdWVzIDwtIHVubGlzdChrcnVza2FsLnRlc3QocHVsbChkZlt0Zl0pIH4gc2lnbmF0dXJlLCBkZikpWyJwLnZhbHVlIl0KfSkKCiMgYWRqdXN0IGZvciBtdWx0aXBsZSB0ZXN0aW5nIHdpdGggRkRSCmFkal9wX3ZhbHVlcyA8LSBwLmFkanVzdChhcy5udW1lcmljKHVubmFtZSh1bmxpc3QocF92YWx1ZXMpKSksIG1ldGhvZCA9ICJmZHIiKQoKIyBob3cgbWFueSB0cmFuc2NyaXB0aW9uIGZhY3RvcnMgYXJlIHNpZ25pZmljYW50bHkgZGlmZmVyZW50IGJldHdlZW4gdGhlIGNsdXN0ZXJzPwpzaWduIDwtIGFkal9wX3ZhbHVlc1thZGpfcF92YWx1ZXMgPCAwLjA1XQpgYGAKCi0tLQoKIyMgR2VuZSBleHByZXNzaW9uIG9mIGluZmxhbW1hdG9yeSBnZW5lcyAKCltAUnlhbl0gc2hvd2VkIHRoYXQgdHdvIHBhdGh3YXlzIGFyZSBzcGVjaWZpY2FsbHkgYWN0aXZhdGVkIGluIHRoZSBJbmYrRUZaIApjb25kaXRpb24sIG5hbWVseSBSaG9HREkgc2lnbmFsaW5nIGFuZCBDRDQwIHNpZ25hbGluZy4gVGhpcyBlZmZlY3Qgd2FzIG5vdCBzZWVuIAppbiBVbmluZitFRlosIHNvIGl0IGRvZXMgbm90IHNlZW0gdG8gYmUgY2F1c2VkIGJ5IEVGWiBhbG9uZSwgCmJ1dCByYXRoZXIgYSBjb21iaW5hdGlvbiBvZiBpbmZlY3Rpb24gYW5kIEVGWiB0cmVhdG1lbnQgW0BSeWFuXS4KCiogUmhvR0RJIHNpZ25hbGluZzoKICArIFBQMVIxMkEgd2FzIHVwcmVndWxhdGVkIAogICsgUk5EMywgQ0Q0NCwgQUNURzEgd2VyZSBkb3ducmVndWxhdGVkCiogQ0Q0MCBzaWduYWxpbmc6CiAgKyBGT1Mgd2FzIHVwcmVndWxhdGVkCiAgKyBORktCSUEsIElDQU0xLCBURk5BSVAzIHdlcmUgZG93bnJlZ3VsYXRlZCAKICAKSGVyZSwgd2Ugd291bGQgbGlrZSB0byBzZWUgaWYgY2VsbCB3aXRoIGhpZ2ggc2NvcmVzIGZvciB0aGUgSW5mK0VGWiBzaWduYXR1cmUKc2hvdyBnZW5lIGV4cHJlc3Npb24gcGF0dGVybnMgdGhhdCBhcmUgaW4gbGluZSB3aXRoIHRoZSBmaW5kaW5ncyBieSBbQFJ5YW5dLiAKVGhlIGdlbmUgZXhwcmVzc2lvbiBmb3IgZWFjaCBnZW5lIGlzIHNob3duIGluIHRoZSBmaWd1cmUgYmVsb3cuCldlIHdvdWxkIGV4cGVjdCBvbmx5IFBQMVIxMkEgYW5kIEZPUyB0byBiZSBtb3JlIGhpZ2hseSBleHByZXNzZWQgaW4gdGhlIGNlbGxzCndpdGggSW5mK0VGWiBzaWduYXR1cmUsIHdoaWxlIGFsbCBvdGhlciBnZW5lcyBzaG91bGQgYmUgbGVzcyBoaWdobHkgZXhwcmVzc2VkLgpUaGlzIHBhdHRlcm4gaW4gZ2VuZSBleHByZXNzaW9uIGlzLCBob3dldmVyLCBub3Qgb2JzZXJ2ZWQuIAoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD04fQojIHJlYWQgaW4gU2V1cmF0IG9iamVjdCBjb250YWluaW5nIE15ZWxvaWQyIGNlbGxzCmhpdm15Ml9zY2VuaWMgPC0gQWRkTWV0YURhdGEoaGl2bXkyX3NjZW5pYywgbWV0YWRhdGEgPSBpbmZfc2lnbl9kZiRzaWduYXR1cmUsIGNvbC5uYW1lID0gInNpZ25hdHVyZSIpCgojIFJob0dESSBzaWduYWxpbmcgaW4gbXllbG9pZDIKcDEgPC0gVmxuUGxvdChoaXZteTJfc2NlbmljLCBmZWF0dXJlcyA9IGMoIlJORDMiLCAiQ0Q0NCIsICJBQ1RHMSIsICJQUFAxUjEyQSIpLCAKICAgICAgICAgICAgICBncm91cC5ieSA9ICJzaWduYXR1cmUiLCBuY29sID0gMikKCiMgQ0Q0MCBzaWduYWxpbmcgaW4gbXllbG9pZDIKcDIgPC0gVmxuUGxvdChoaXZteTJfc2NlbmljLCBmZWF0dXJlcyA9YygiTkZLQklBIiwgIklDQU0xIiwgIlRORkFJUDMiLCAiRk9TIiksIAogICAgICAgICAgICAgIGdyb3VwLmJ5ID0gInNpZ25hdHVyZSIsIG5jb2wgPSAyKQoKIyBSaG9HREkgc2lnbmFsaW5nIGluIGlNZwpwMyA8LSBWbG5QbG90KG1pY3JvZ2xpYSwgZmVhdHVyZXMgPSBjKCJSTkQzIiwgIkNENDQiLCAiQUNURzEiLCAiUFBQMVIxMkEiKSwgCiAgICAgICAgbmNvbCA9IDIsIHB0LnNpemUgPSAwLCBncm91cC5ieSA9ICJvcmlnLmlkZW50IikKCiMgQ0Q0MCBzaWduYWxpbmcgaW4gaU1nCnA0IDwtIFZsblBsb3QobWljcm9nbGlhLCBmZWF0dXJlcyA9IGMoIk5GS0JJQSIsICJJQ0FNMSIsICJUTkZBSVAzIiwgIkZPUyIpLCAKICAgICAgICBuY29sID0gMiwgcHQuc2l6ZSA9IDAsIGdyb3VwLmJ5ID0gIm9yaWcuaWRlbnQiKQoKZmlnIDwtIGdnYXJyYW5nZShwMSwgcDMsIG5jb2wgPSAyLCBucm93ID0gMSkKYW5ub3RhdGVfZmlndXJlKGZpZywgdG9wID0gdGV4dF9ncm9iKCJFeHByZXNzaW9uIG9mIGZvdXIgZ2VuZXMgb2YgdGhlIFJob0dESSBzaWduYWxpbmcgcGF0aHdheSBpbiBNeWVsb2lkMiAobGVmdCBjb2x1bW4pIGFuZCBpTWcgKHJpZ2h0IGNvbHVtbikiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IDIwICwgZmFjZSA9ICJib2xkIikpCgpmaWcgPC0gZ2dhcnJhbmdlKHAyLCBwNCwgbmNvbCA9IDIsIG5yb3cgPSAxKQphbm5vdGF0ZV9maWd1cmUoZmlnLCB0b3AgPSB0ZXh0X2dyb2IoIkV4cHJlc3Npb24gb2YgZm91ciBnZW5lcyBvZiB0aGUgQ0Q0MCBzaWduYWxpbmcgcGF0aHdheSBpbiBNeWVsb2lkMiAobGVmdCBjb2x1bW4pIGFuZCBpTWcgKHJpZ2h0IGNvbHVtbikiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IDIwICwgZmFjZSA9ICJib2xkIikpCgpgYGAKCk9ubHkgRk9TIHdoaWNoIGVuY29kZXMgYSBURiBpcyBmb3VuZCBpbiB0aGUgVEYgYWN0aXZpdHkgbWF0cml4LCBzbyBmb3IgRk9TIAp0aGUgVEYgYWNpdml0eSBpcyBzaG93biBhcyB3ZWxsLiBKdWRnaW5nIGZyb20gdGhlIGZpZ3VyZSBiZWxvdyBGT1Mgc2VlbXMgdG8gYmUgCm1vcmUgYWN0aXZlIGluIGNlbGxzIHdpdGggaGlnaCBzY29yZSBmb3IgSW5mK0VGWiBzaWduYXR1cmUsIGJ1dCB0aGlzIGRpZmZlcmVuY2UKaXMgbm90IHN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQuCgpgYGB7cn0KaW5mX3NpZ25fZGYgJT4lIGdncGxvdChhZXMoeCA9IHNpZ25hdHVyZSwgeSA9IEZPUykpICsKICBnZW9tX3Zpb2xpbihhZXMoZmlsbCA9IHNpZ25hdHVyZSwgYWxwaGEgPSAuNikpICsKICBnZW9tX2JveHBsb3QoYWxwaGEgPSAwKSArCiAgc3RhdF9wdmFsdWVfbWFudWFsKGluZl9zaWduX2RmICU+JSAKICAgICAgICAgICAgICAgICAgICAgICBwYWlyd2lzZV93aWxjb3hfdGVzdChGT1MgfiBzaWduYXR1cmUpICU+JSAKICBhZGRfeHlfcG9zaXRpb24oKSkKCmBgYAoKLS0tCgojIEFwcGVuZGl4CgojIyBJbmZsYW1tYXRvcnkgUGF0aHdheXMKCkFzIGFscmVhZHkgbWVudGlvbmVkIGFib3ZlIFtAUnlhbl0gc2hvd2VkIHRoYXQgdHdvIHBhdGh3YXlzIGFyZSBzcGVjaWZpY2FsbHkgYWN0aXZhdGVkIGluIHRoZSBJbmYrRUZaIApjb25kaXRpb24sIG5hbWVseSBSaG9HREkgc2lnbmFsaW5nIGFuZCBDRDQwIHNpZ25hbGluZy4gVGhpcyBlZmZlY3Qgd2FzIG5vdCBzZWVuIAppbiBVbmluZitFRlosIHNvIGl0IGRvZXMgbm90IHNlZW0gdG8gYmUgY2F1c2VkIGJ5IEVGWiBhbG9uZSwgCmJ1dCByYXRoZXIgYSBjb21iaW5hdGlvbiBvZiBpbmZlY3Rpb24gYW5kIEVGWiB0cmVhdG1lbnQgW0BSeWFuXS4KCiogUmhvR0RJIHNpZ25hbGluZzoKICArIFBQMVIxMkEgd2FzIHVwcmVndWxhdGVkIAogICsgUk5EMywgQ0Q0NCwgQUNURzEgd2VyZSBkb3ducmVndWxhdGVkCiogQ0Q0MCBzaWduYWxpbmc6CiAgKyBGT1Mgd2FzIHVwcmVndWxhdGVkCiAgKyBORktCSUEsIElDQU0xLCBURk5BSVAzIHdlcmUgZG93bnJlZ3VsYXRlZCAKICAKVG8gYW5zd2VyIHRoZSBxdWVzdGlvbiB3aGV0aGVyIHdlIGNvdWxkIGZpbmQgc2ltaWxhciBwYXR0ZXJucyBpbiB0aGUgdHdvIE15ZWxvaWQyIGNsdXN0ZXJzCndpdGggZGlmZmVyZW50IFRGIGFjdGl2aXR5LCB3ZSBoYWQgYSBsb29rIGF0IHRoZSBnZW5lIGV4cHJlc3Npb24uCgojIyMjIyBNeWVsb2lkMiBjZWxscyAKClR3byBnZW5lcyBvZiB0aGUgUmhvR0RJIHNpZ25hbGluZyBwYXRod2F5IHdlcmUgZm91bmQgYW1vbmcgdGhlIGRpZmZlcmVudGlhbGx5CmV4cHJlc3NlZCBnZW5lcyBiZXR3ZWVuIEluZitFRlogYW5kIFVuaW5mK0VGWi4gQm90aCBvZiB0aGVtIHdlcmUgZG93bnJlZ3VsYXRlZAppbiBJbmYrRUZaIGNvbXBhcmVkIHRvIFVuaW5mK0VGWiBpTWcgYXMgY2FuIGJlIHNlZW4gaW4gdGhlIHRhYmxlIGJlbG93LgoKYGBge3IsIHJlc3VsdHMgPSAiYXNpcyJ9CmluZl91bmluZl9hcnRfbWFya2VyICU+JSAKICByb3duYW1lc190b19jb2x1bW4oImdlbmUiKSAlPiUKICBmaWx0ZXIoZ2VuZSAlaW4lIGMoIlJORDMiLCAiQ0Q0NCIsICJBQ1RHMSIsICJQUFAxUjEyQSIpKSAlPiUKICBrYWJsZShjYXB0aW9uID0gIkdlbmVzIG9mIHRoZSBSaG9HREkgc2lnbmFsaW5nIHBhdGh3YXkgZm91bmQgYW1vbmcgZ2VuZXMgZGlmZmVyZW50aWFsbHkgZXhwcmVzc2VkIGJldHdlZW4gSW5mK0VGWiBhbmQgVW5pbmYrRUZaIikKYGBgCgpBbGwgZm91ciBnZW5lcyBvZiB0aGUgQ0Q0MCBzaWduYWxpbmcgd2VyZSBmb3VuZCBhbW9uZyB0aGUgZGlmZmVyZW50aWFsbHkgZXhwcmVzc2VkCmdlbmVzIGJldHdlZW4gSW5mK0VGWiBhbmQgVW5pbmYrRUZaLiBGT1Mgd2FzIHVwcmVndWxhdGVkLCB3aGlsZSBORktCSUEsIElDQU0xIGFuZCAKVEZOQUlQMyB3ZXJlIGRvd25yZWd1bGF0ZWQgaW4gSW5mK0VGWiBjb21wYXJlZCB0byBVbmluZitFRlogYXMgY2FuIGJlIHNlZW4gaW4gdGhlCnRhYmxlIGJlbG93LiAKCmBgYHtyLCByZXN1bHRzID0gImFzaXMifQppbmZfdW5pbmZfYXJ0X21hcmtlciAlPiUgCiAgcm93bmFtZXNfdG9fY29sdW1uKHZhciA9ICJnZW5lIikgJT4lCiAgZmlsdGVyKGdlbmUgJWluJSBjKCJGT1MiLCAiTkZLQklBIiwgIklDQU0xIiwgIlRORkFJUDMiKSkgJT4lIGthYmxlKCkKCmBgYAoKClRoZSBjaGFuZ2VzIGluIGdlbmUgZXhwcmVzc2lvbiBvZiBib3RoIHBhdGh3YXlzIGFyZSBpbiBsaW5lIHdpdGggdGhlIGZpbmRpbmdzIApieSBbQFJ5YW5dLiAKCkFkZGl0aW9uYWxseSwgd2Ugd2VyZSBpbnRlcmVzdGVkIHdoZXRoZXIgdGhpcyBwYXR0ZXJuIGluIGdlbmUgZXhwcmVzc2lvbiAKY29ycmVsYXRlZCB3aXRoIHRoZSB0d28gY2x1c3RlcnMgaWRlbnRpZmllZCBpbiBNeWVsb2lkMiB3aGljaCBleGhpYml0IGRpZmZlcmVudApURiBhY3Rpdml0aWVzLiBUaGUgZmlndXJlIGJlbG93IHNob3cgdGhlIGdlbmUgZXhwcmVzc2lvbiBvZiB0aGUgZm91ciBnZW5lcyBvZiAKdGhlIHJlc3BlY3RpdmUgcGF0aHdheXMgYm90aCBpbiBNeWVsb2lkMiBjZWxscyAobGVmdCBjb2x1bW4pIGFuZCBpbiBpTWcgKHJpZ2h0IApjb2x1bW4pLgoKRk9TIGlzIHRoZSBvbmx5IGdlbmUgd2hpY2ggc2hvd3MgYSBoaWdoIGV4cHJlc3Npb24gaW4gTXllbG9pZDIgY2x1c3RlciBjMS4gClRoaXMgc3VwcG9ydHMgb3VyIGh5cG90aGVzaXMgdGhhdCBjMSBtaWdodCBiZSBhIGxhdGVudGx5IGluZmVjdGVkIHJlYWN0aXZlIG1pY3JvZ2xpYSAKY2VsbCBzdGF0ZS4gSG93ZXZlciB0aGVuIHdlIHdvdWxkIGV4cGVjdCB0byBzZWUgYSBzaW1pbGFyIHBhdHRlcm4gZm9yIHRoZSBSaG9HREkKc2lnbmFsaW5nLCBtZWFuaW5nIFBQUDFSMTJBIHNob3VsZCBiZSB0aGUgb25seSBnZW5lIHdoaWNoIGlzCmhpZ2hseSBleHByZXNzZWQgaW4gYzEuIFRoaXMgaXMgbm90IHRoZSBjYXNlLCBidXQgcmF0aGVyIENENDQgYW5kIEFDVEcxIGFsc28gCnNob3cgaGlnaGVyIGV4cHJlc3Npb24gaW4gYzEgY29tcGFyZWQgdG8gYzIuIENvbnNlcXVlbnRseSwgb3VyIGh5cG90aGVzaXMgaXMgbm90IApjbGVhcmx5IHN1cHBvcnRlZCBieSB0aGUgZXhwcmVzc2lvbiBwYXR0ZXJucyBvZiB0aGVzZSBpbmZsYW1tYXRvcnkgZ2VuZXMuCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTZ9CiMgaXNvbGF0ZSBtaWNyb2dsaWEgY2VsbHMKbWljcm9nbGlhIDwtIHN1YnNldChjb21iaW5lZCwgY2VsbF90eXBlID09ICJpTWciKQoKIyByZWFkIGluIFNldXJhdCBvYmplY3QgY29udGFpbmluZyBNeWVsb2lkMiBjZWxscwpoaXZteTIgPC0gcmVhZFJEUygiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL2RhdGEvaGl2X215ZWxvaWQyX3N1YmNsdXN0ZXJzIikKCgpwMSA8LSBWbG5QbG90KGhpdm15MiwgZmVhdHVyZXMgPSBjKCJSTkQzIiwgIkNENDQiLCAiQUNURzEiLCAiUFBQMVIxMkEiKSwgCiAgICAgICAgICAgICAgZ3JvdXAuYnkgPSAiaHRfY2x1c3RlciIsIG5jb2wgPSAyKQoKcDIgPC0gVmxuUGxvdChoaXZteTIsIGZlYXR1cmVzID1jKCJORktCSUEiLCAiSUNBTTEiLCAiVE5GQUlQMyIsICJGT1MiKSwgCiAgICAgICAgICAgICAgZ3JvdXAuYnkgPSAiaHRfY2x1c3RlciIsIG5jb2wgPSAyKQoKcDMgPC0gVmxuUGxvdChtaWNyb2dsaWEsIGZlYXR1cmVzID0gYygiUk5EMyIsICJDRDQ0IiwgIkFDVEcxIiwgIlBQUDFSMTJBIiksIAogICAgICAgIG5jb2wgPSAyLCBwdC5zaXplID0gMCwgZ3JvdXAuYnkgPSAib3JpZy5pZGVudCIpCgpwNCA8LSBWbG5QbG90KG1pY3JvZ2xpYSwgZmVhdHVyZXMgPSBjKCJORktCSUEiLCAiSUNBTTEiLCAiVE5GQUlQMyIsICJGT1MiKSwgCiAgICAgICAgbmNvbCA9IDIsIHB0LnNpemUgPSAwLCBncm91cC5ieSA9ICJvcmlnLmlkZW50IikKCmZpZyA8LSBnZ2FycmFuZ2UocDEsIHAzLCBuY29sID0gMiwgbnJvdyA9IDEpCmFubm90YXRlX2ZpZ3VyZShmaWcsIHRvcCA9IHRleHRfZ3JvYigiRXhwcmVzc2lvbiBvZiBmb3VyIGdlbmVzIG9mIHRoZSBSaG9HREkgc2lnbmFsaW5nIHBhdGh3YXkgaW4gTXllbG9pZDIgKGxlZnQgY29sdW1uKSBhbmQgaU1nIChyaWdodCBjb2x1bW4pIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemUgPSAyMCAsIGZhY2UgPSAiYm9sZCIpKQoKZmlnIDwtIGdnYXJyYW5nZShwMiwgcDQsIG5jb2wgPSAyLCBucm93ID0gMSkKYW5ub3RhdGVfZmlndXJlKGZpZywgdG9wID0gdGV4dF9ncm9iKCJFeHByZXNzaW9uIG9mIGZvdXIgZ2VuZXMgb2YgdGhlIENENDAgc2lnbmFsaW5nIHBhdGh3YXkgaW4gTXllbG9pZDIgKGxlZnQgY29sdW1uKSBhbmQgaU1nIChyaWdodCBjb2x1bW4pIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemUgPSAyMCAsIGZhY2UgPSAiYm9sZCIpKQpgYGAKCgo8ZGV0YWlscz4KPHN1bW1hcnk+U2FtZSB0d28gcGF0aHdheXMgaW4gTXllbG9pZDUgY2VsbHM8L3N1bW1hcnk+CgpNeWVsb2lkNSBjZWxscwoKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MTJ9CgojIGlzb2xhdGUgdGhlIE15ZWxvaWQ1IGNsdXN0ZXIKaGl2bXk1IDwtIHN1YnNldChoaXY3LCBjZWxsX3R5cGUgPT0gIk15ZWxvaWQ1IiAmIG9yaWcuaWRlbnQgJWluJSBjKCJISVYxX0NTRiIsICJISVYyX0NTRiIsICJISVYzX0NTRiIpKQoKIyBwcm9jZXNzIE15ZWxvaWQgNSBTZXVyYXQgb2JqZWN0Cmhpdm15NSA8LSBTY2FsZURhdGEoaGl2bXk1LCB2ZXJib3NlID0gRkFMU0UpCmhpdm15NSA8LSBOb3JtYWxpemVEYXRhKGhpdm15NSwgdmVyYm9zZSA9IEZBTFNFKQpoaXZteTUgPC0gU2NhbGVEYXRhKGhpdm15NSwgdmVyYm9zZSA9IEZBTFNFKQpoaXZteTUgPC0gRmluZFZhcmlhYmxlRmVhdHVyZXMoaGl2bXk1LCB2ZXJib3NlID0gRkFMU0UpCmhpdm15NSA8LSBSdW5QQ0EoaGl2bXk1LCBmZWF0dXJlcyA9IFZhcmlhYmxlRmVhdHVyZXMoaGl2bXk1KSwgdmVyYm9zZSA9IEZBTFNFKQojRWxib3dQbG90KGhpdm15NSkKaGl2bXk1IDwtIFJ1blRTTkUoaGl2bXk1LCBkaW1zPSAxOjEwLCB2ZXJib3NlID0gRkFMU0UpCmBgYAoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMn0KCnAxIDwtIFZsblBsb3QoaGl2bXk1LCBmZWF0dXJlcyA9IGMoIlJORDMiLCAiQ0Q0NCIsICJBQ1RHMSIsICJQUFAxUjEyQSIpLCAKICAgICAgICAgICAgICBncm91cC5ieSA9ICJvcmlnLmlkZW50IixuY29sID0gMikKCnAyIDwtIFZsblBsb3QoaGl2bXk1LCBmZWF0dXJlcyA9YygiTkZLQklBIiwgIklDQU0xIiwgIlRORkFJUDMiLCAiRk9TIiksIAogICAgICAgICAgICAgIGdyb3VwLmJ5ID0gIm9yaWcuaWRlbnQiLCBuY29sID0gMikKCnAzIDwtIFZsblBsb3QobWljcm9nbGlhLCBmZWF0dXJlcyA9IGMoIlJORDMiLCAiQ0Q0NCIsICJBQ1RHMSIsICJQUFAxUjEyQSIpLCAKICAgICAgICBuY29sID0gMiwgcHQuc2l6ZSA9IDAsIGdyb3VwLmJ5ID0gIm9yaWcuaWRlbnQiKQoKcDQgPC0gVmxuUGxvdChtaWNyb2dsaWEsIGZlYXR1cmVzID0gYygiTkZLQklBIiwgIklDQU0xIiwgIlRORkFJUDMiLCAiRk9TIiksIAogICAgICAgIG5jb2wgPSAyLCBwdC5zaXplID0gMCwgZ3JvdXAuYnkgPSAib3JpZy5pZGVudCIpCgpnZ2FycmFuZ2UocDIsIHA0LCBwMSwgcDMsIG5jb2wgPSAyLCBucm93ID0gMikKYGBgCgo8L2RldGFpbHM+CgojIFJlZmVyZW5jZXMKCg==</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Triculture_dataset_analysis_and_integration_Farhadian_dataset.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
