<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="kmikulik" />


<title>Analysis of HIV CSF/Blood dataset</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Report</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Introduction.html">Introduction</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Results
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="HIV_CSF_dataset_analysis.html">1. CSF/Blood samples</a>
    </li>
    <li>
      <a href="TF_activity_analysis_of_myeloid2_cluster.html">2. TF activity Myeloid2</a>
    </li>
    <li>
      <a href="Triculture_dataset_analysis_and_integration_Farhadian_dataset.html">3. Integration CSF/Blood &amp; triculture</a>
    </li>
    <li>
      <a href="Triculture_dataset_GRN_with_Scenic.html">4. TF activity iMg</a>
    </li>
  </ul>
</li>
<li>
  <a href="Discussion.html">Discussion</a>
</li>
<li>
  <a href="Methods.html">Methods</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Katharina782/report">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Analysis of HIV CSF/Blood dataset</h1>
<h4 class="author">kmikulik</h4>
<h4 class="date">3 12 2021</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#visualization-of-sample-quality-in-tsne-plot">Visualization of sample quality in tSNE plot</a></li>
<li><a href="#marker-genes-cell-type-annotation">Marker genes &amp; Cell type annotation</a>
<ul>
<li><a href="#top-marker-genes">Top marker genes</a></li>
<li><a href="#cell-type-annotation-with-canonical-marker-genes">Cell type annotation with canonical marker genes</a></li>
<li><a href="#b-cell-markers">B cell markers</a></li>
<li><a href="#nk-cells">NK cells</a></li>
<li><a href="#cd4-cd8-t-cells">CD4+ &amp; CD8+ T cells</a></li>
<li><a href="#plasma-cells">plasma cells</a></li>
<li><a href="#myeloid-cells">Myeloid cells</a></li>
<li><a href="#myeloid-5">Myeloid 5</a></li>
<li><a href="#myeloid-2">Myeloid 2</a></li>
<li><a href="#section"></a></li>
</ul></li>
<li><a href="#visualization-of-cell-types-conditions-samples-and-sequencing-quality">Visualization of cell types, conditions, samples and sequencing quality</a></li>
<li><a href="#frequency-of-cell-types-in-csf-and-blood-samples">Frequency of cell types in CSF and blood samples</a>
<ul>
<li><a href="#how-big-are-myeloid2-and-myeloid5-clusters-and-where-do-cells-come-from">How big are Myeloid2 and Myeloid5 clusters and where do cells come from?</a></li>
<li><a href="#which-genes-are-upregulated-in-myeloid-2-compared-to-the-four-other-myeloid-subsets">Which genes are upregulated in Myeloid-2 compared to the four other myeloid subsets?</a></li>
<li><a href="#expression-of-the-60-genes-identified-in-the-paper-as-myeloid-2-markers">Expression of the 60 genes identified in the paper as Myeloid 2 markers</a></li>
<li><a href="#percentage-of-myeloid2-transcripts-per-cell-in-blood-csf-and-uninfected-samples">Percentage of Myeloid2 transcripts per Cell in Blood, CSF and Uninfected samples</a></li>
</ul></li>
<li><a href="#label-transfer">Label Transfer</a>
<ul>
<li><a href="#check-the-gene-expression-levels-of-the-predicted-cell-types">Check the gene expression levels of the predicted cell types</a>
<ul>
<li><a href="#myeloid2-marker-genes">Myeloid2 marker genes</a></li>
<li><a href="#myeloid5-marker-genes">Myeloid5 marker genes</a></li>
<li><a href="#plasma-cell-marker-genes">Plasma cell marker genes</a></li>
<li><a href="#cd8-t-cell-marker-genes">CD8 T cell marker genes</a></li>
<li><a href="#t-cell-marker-genes">T cell marker genes</a></li>
<li><a href="#nk-cell-marker-genes">NK cell marker genes</a></li>
<li><a href="#b-cell-marker-genes">B cell marker genes</a></li>
</ul></li>
<li><a href="#section-1">###</a>
<ul>
<li><a href="#umap-projection-of-additional-samples">UMAP projection of additional samples</a></li>
</ul></li>
<li><a href="#frequency-of-cell-types-in-csf-and-blood-samples-1">Frequency of cell types in CSF and blood samples</a></li>
</ul></li>
<li><a href="#appendix">Appendix</a>
<ul>
<li><a href="#independent-annotation-of-myeloid2-and-myeloid5-clusters-as-microglia-like-cells">Independent annotation of Myeloid2 and Myeloid5 clusters as Microglia-like cells</a>
<ul>
<li><a href="#function-add-module-score">Function Add Module Score</a></li>
</ul></li>
<li><a href="#different-gene-signatures-found-in-the-literature">Different gene signatures found in the literature</a>
<ul>
<li><a href="#farhadian-et-al.">Farhadian et al.</a></li>
<li><a href="#gosselin-et-al.">Gosselin et al. </a></li>
<li><a href="#hand-signature">HAND signature</a></li>
<li><a href="#grassivaro-et-al.">Grassivaro et al.</a></li>
<li><a href="#keren-shaul-et-al.-kraseman-et-al.">Keren-Shaul et al. &amp; Kraseman et al.</a></li>
<li><a href="#esaulova-et-al.">Esaulova et al.</a></li>
<li><a href="#sankowski-et-al.">Sankowski et al.</a>
<ul>
<li><a href="#clusters-across-the-transcriptional-spectrum-of-microglia">Clusters across the transcriptional spectrum of microglia</a></li>
</ul></li>
</ul></li>
<li><a href="#section-2"></a></li>
<li><a href="#genes-which-are-upregulated-in-myeloid2-compared-to-all-other-myeloid-clusters">Genes which are upregulated in Myeloid2 compared to all other Myeloid clusters</a></li>
<li><a href="#conclusions-on-myloid2-cell-type">Conclusions on Myloid2 cell type</a></li>
<li><a href="#quality-of-different-samples-before-quality-control">Quality of different samples before quality control</a>
<ul>
<li><a href="#number-of-features">Number of Features</a></li>
<li><a href="#library-size">Library Size</a></li>
<li><a href="#percentage-of-mitochondrial-genes">Percentage of Mitochondrial genes</a></li>
</ul></li>
<li><a href="#section-3"></a></li>
<li><a href="#quality-of-the-different-samples-after-quality-control">Quality of the different samples after quality control</a>
<ul>
<li><a href="#number-of-features-1">Number of features</a></li>
<li><a href="#library-size-1">Library size</a></li>
<li><a href="#percentage-of-mitochondrial-genes-1">Percentage of Mitochondrial genes</a></li>
</ul></li>
<li><a href="#section-4">##</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-12-20
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>report/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20211203code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20211203)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20211203code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20211203)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongabsolute"> <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> <strong>File paths:</strong> absolute </a>
</p>
</div>
<div id="strongFilepathsstrongabsolute" class="panel-collapse collapse">
<div class="panel-body">
<p>
Using absolute paths to the files within your workflowr project makes it difficult for you and others to run your code on a different machine. Change the absolute path(s) below to the suggested relative path(s) to make your code more reproducible.
</p>
<table class="table table-condensed table-hover">
<thead>
<tr>
<th style="text-align:left;">
absolute
</th>
<th style="text-align:left;">
relative
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
/media/ag-cherrmann/kmikulik/HIV_microglia/src/report/
</td>
<td style="text-align:left;">
.
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKatharina782reporttreeea7e899746b03ca612d93ad003c875fc101d2329targetblankea7e899a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/Katharina782/report/tree/ea7e899746b03ca612d93ad003c875fc101d2329" target="_blank">ea7e899</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKatharina782reporttreeea7e899746b03ca612d93ad003c875fc101d2329targetblankea7e899a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/Katharina782/report/tree/ea7e899746b03ca612d93ad003c875fc101d2329" target="_blank">ea7e899</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    analysis/Independent_cell_type_identification_Farhadian_dataset_cache/
    Ignored:    analysis/TF_activity_analysis_of_myeloid2_cluster_cache/
    Ignored:    analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset_cache/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/HIV_CSF_dataset_analysis.Rmd</code>) and HTML (<code>docs/HIV_CSF_dataset_analysis.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/ea7e899746b03ca612d93ad003c875fc101d2329/analysis/HIV_CSF_dataset_analysis.Rmd" target="_blank">ea7e899</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/ddc1413fb4fcbe015c6ce373c3a27efbd6924674/analysis/HIV_CSF_dataset_analysis.Rmd" target="_blank">ddc1413</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
resolve merge conflicts
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/HIV_CSF_dataset_analysis.html" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/f7243f8882ef1868800d5f0e420f83d5e4ba39bb/analysis/HIV_CSF_dataset_analysis.Rmd" target="_blank">f7243f8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/f7243f8882ef1868800d5f0e420f83d5e4ba39bb/docs/HIV_CSF_dataset_analysis.html" target="_blank">f7243f8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/813ec51c3741eb1435e1daafde4dd0294bedd5e3/analysis/HIV_CSF_dataset_analysis.Rmd" target="_blank">813ec51</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-19
</td>
<td>
wflow_publish(“analysis/HIV_CSF_dataset_analysis.Rmd”)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/HIV_CSF_dataset_analysis.html" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/HIV_CSF_dataset_analysis.html" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/9591a5f95e1c4ab7b8385a71d4d720ee51590f26/analysis/HIV_CSF_dataset_analysis.Rmd" target="_blank">9591a5f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
wflow_publish(“analysis/HIV_CSF_dataset_analysis.Rmd”)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/HIV_CSF_dataset_analysis.html" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/ca459b400362711f3ba362318af3d2a456f569b4/docs/HIV_CSF_dataset_analysis.html" target="_blank">ca459b4</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-17
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/04f675329bc4ccf704fe3326b6e562264c9dbbd3/analysis/HIV_CSF_dataset_analysis.Rmd" target="_blank">04f6753</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-17
</td>
<td>
wflow_publish(files = rmd)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/HIV_CSF_dataset_analysis.html" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/3ba29868e10097faef3f8ff84c501c88bf93da86/analysis/HIV_CSF_dataset_analysis.Rmd" target="_blank">3ba2986</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
<td>
wflow_publish(“analysis/HIV_CSF_dataset_analysis.Rmd”)
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/analysis/HIV_CSF_dataset_analysis.Rmd" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
<td>
recent updates
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/dde10972b37ffd997474921968223514c8cb1b1f/docs/HIV_CSF_dataset_analysis.html" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
<td>
recent updates
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<style>
body {
text-align: justify}
</style>
<pre class="r"><code>setwd(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/report/&quot;)</code></pre>
<pre class="r"><code>library(tidyverse)
library(Seurat)
library(edgeR)
library(Matrix)
library(data.table)
library(ggplot2)
library(dplyr)
library(ggrepel)
library(RColorBrewer)
library(pheatmap)
library(ggcorrplot)
library(ComplexHeatmap)
library(circlize)
library(ggpubr)
library(gridExtra)
library(corrplot)
library(rstatix)
library(knitr)
library(metap)
library(multtest)
library(readxl)
library(harmony)
library(SeuratDisk)
library(patchwork)</code></pre>
<p>First, the analysis done by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> was reproduced and then more extended analysis of the dataset was performed. The microglia-like cell cluster identified by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> was of particular interest.</p>
<p>The dataset included three CSF samples from HIV infected patients, two blood samples from HIV infected patients, as well as, two CSF samples from uninfected patients. <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> first used two CSF and two bloods samples from infected patients for clustering and cell type annotation. After having identified a novel subcluster of myeloid cells, which they propose are microglia-like, they then confirm their results using the third CSF samples from an infected patient. Additionally, they compare the number of Myeloid2-specific transcripts to the CSF samples from uninfected patients. They show that the percentage of Myeloid2 transcripts was higher in CSF from infected patients than in CSF from uninfected patients and higher in CSF than in blood in general.</p>
<p>Blood and CSF were processed separately for scRNAseq using SeqWell. The seven samples were sequenced separately, one SeqWell array per CSF or PBMC sample <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>.</p>
<p>For more details see <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>.</p>
<p>First, the following analysis steps were performed similar as in the paper:</p>
</details>
<details>
<summary>
Importing files &amp; creating Seurat objects
</summary>
<p><strong>Read in data(count matrices)</strong> The data is available under <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE117397" class="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE117397</a>. There is one count matrix for each of the 7 samples.</p>
<pre><code>path &lt;- &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/GSE117397_RAW (1)/&quot;
all_files &lt;- list.files(path)

#Function to create a sparse matrix from each of the dataframes
sparse_matrix_from_df &lt;- function(df) {
  #print(df)
  #class(df)
  genes &lt;- df$GENE
  df_minus &lt;- df[,-1]
  #matrix &lt;- as.matrix(df_minus)
  sparse_matrix &lt;- as.sparse(df_minus)
  rownames(sparse_matrix) &lt;- genes
  return(sparse_matrix)
}

hiv_object_list &lt;- map(seq.int(2,6), function(n) {
  file &lt;- all_files[grepl(paste0(&quot;GSM329382&quot;, n), all_files)]
  name &lt;- str_extract(file, &quot;HIV[1-3]_\\w{3}&quot;)
  df &lt;- read_delim(paste0(path, file), delim = &quot;\t&quot;)
  sparse_matrix &lt;- sparse_matrix_from_df(df)
  seurat_ob &lt;- CreateSeuratObject(sparse_matrix, project = name, 
                     assay = &quot;RNA&quot;, min.cells = 1,
                     min.features = 1)
  list(df=df, sparse_matrix = sparse_matrix, seurat_ob = seurat_ob, name=name)
})

uninfected_list &lt;- map(seq.int(7,8), function(n) {
  file &lt;- all_files[grepl(paste0(&quot;GSM329382&quot;, n), all_files)]
  name &lt;- str_extract(file, &quot;Uninfected[12]_CSF&quot;)
  df &lt;- read_delim(paste0(path, file), delim = &quot;\t&quot;)
  sparse_matrix &lt;- sparse_matrix_from_df(df)
  seurat_ob &lt;- CreateSeuratObject(sparse_matrix, project = name, 
                     assay = &quot;RNA&quot;, min.cells = 1,
                     min.features = 1, verbose = FALSE)
  list(df=df, sparse_matrix = sparse_matrix, seurat_ob = seurat_ob, name=name)
})

#write.table(uninfected_list[[1]]$sparse_matrix,
 #           &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/job_test.tsv&quot;, 
  #          sep = &quot;\t&quot;)</code></pre>
<p><strong>Create one Seurat object with all samples</strong></p>
<pre><code>
hiv &lt;- merge(hiv_object_list[[1]]$seurat_ob, 
                   c(hiv_object_list[[2]]$seurat_ob,
                     hiv_object_list[[3]]$seurat_ob,
                     hiv_object_list[[4]]$seurat_ob,
                     hiv_object_list[[5]]$seurat_ob, 
                     uninfected_list[[1]]$seurat_ob,
                     uninfected_list[[2]]$seurat_ob), 
                   project = &quot;hiv_total&quot;,
                   add.cell.ids = c(&quot;1B&quot;, &quot;1C&quot;, &quot;2B&quot;, &quot;2C&quot;, &quot;3C&quot;, &quot;U1&quot;, &quot;U2&quot;))

# add percentage of mitochondrial genes to the metadata
hiv[[&quot;percent_mt&quot;]] &lt;- PercentageFeatureSet(hiv, pattern = &quot;^MT-&quot;)
#saveRDS(hiv, &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/hiv_unprocessed&quot;)</code></pre>
<hr />
</details>
</details>
<details>
<summary>
Importing files &amp; creating Seurat objects
</summary>
<p><strong>Quality control was performed on every individual object.</strong></p>
<p>Quality control was performed as described in <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>. The 10% of cells with the highest percentage of mitochondrial genes was removed, as well as features which are expressed in less than 3 cells. Also, cells with number of features below 500 or above 2500 were removed. Quality control was done for each sample separately and then the samples were combined again before normalization.</p>
<pre class="r"><code># read in unprocessed seurat object containing all 7 samples
hiv &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/hiv_unprocessed&quot;)

# FUNCTION:
# to remove features that are expressed in less than three cells
# returns a list of feature names to keep

remove_features &lt;- function(seurat_ob) {
  count_matrix &lt;- seurat_ob@assays$RNA@counts 
  ncells &lt;- rowSums(count_matrix != 0) # how many cells are expressing a 
  #certain gene? 
  names(ncells[ncells &gt; 3]) #extract gene names of genes expressed in more 
  #than 3 cells
}


# FUNCTION:
# to remove 10% of cell with highest mitochondrial gene expression:
#returns a list of cell names to keep
remove_mt_genes &lt;- function(seurat_ob){
  thr &lt;- quantile(seurat_ob@meta.data$percent_mt, .9)
  seurat_ob@meta.data %&gt;% 
    filter(percent_mt &lt; thr) %&gt;%
    rownames()
}



# SOME THOUGHTS:

# When doing the quality control how important is the order of the operations?
# If you first remove nFeatures &gt; 500 and then the features exppressed in more than
# 3 cells, then the nFeatures might be below 500.

separate_objects &lt;- SplitObject(hiv, split.by = &quot;orig.ident&quot;)#[-c(5,6,7)] 
# only keep two blood samples and two csf samples

qc &lt;- lapply(X = separate_objects, FUN = function(x) {
    #x[[&quot;percent_mt&quot;]] &lt;- PercentageFeatureSet(x, pattern = &quot;^MT-&quot;) 
    # add percentage of mitochondrial genes to the metadata
    x &lt;- subset(x, features = remove_features(x)) 
    #create a list of cells excluding the 10% of cells with the highest mt gene expression
    x &lt;- subset(x, nFeature_RNA &lt; 2500 &amp; nFeature_RNA &gt; 500)
    x &lt;- subset(x, cells = remove_mt_genes(x)) 
    # remove 10% of cells with highest mitochondrial gene expression
    #x &lt;- NormalizeData(x)
    #x &lt;- ScaleData(x)
})

hiv_filt &lt;- merge(qc[[1]],
                        c(qc[[2]],
                        qc[[3]],
                        qc[[4]],
                        qc[[5]],
                        qc[[6]],
                        qc[[7]]),
                        project = &quot;hiv_filt&quot;)#,
                        #add.cell.ids = c(&quot;1B&quot;, &quot;1C&quot;, &quot;2B&quot;, &quot;2C&quot;, &quot;3C&quot;, &quot;U1&quot;, &quot;U2&quot;))</code></pre>
</details>
<details>
**
<summary>
Code for Dimensionality reduction &amp; Clustering
</summary>
<p>**</p>
<p>Use blood and CSF samples from two patients (HIV1_CSF/Bld, HIV2_CSF/Bld) for further analysis like in the paper.</p>
<ul>
<li><strong>Subset Seurat object</strong></li>
</ul>
<pre class="r"><code>hiv4 &lt;- subset(hiv_filt, orig.ident %in% c(&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;, &quot;HIV1_Bld&quot;, &quot;HIV2_Bld&quot;))</code></pre>
<ul>
<li><strong>Normalize, Scale and find variable features</strong></li>
</ul>
<pre class="r"><code>hiv4 &lt;- NormalizeData(hiv4, verbose = FALSE)
hiv4 &lt;- ScaleData(hiv4, verbose = FALSE)
hiv4 &lt;- FindVariableFeatures(hiv4, verbose = FALSE)</code></pre>
<ul>
<li><strong>Dimensionality reduction</strong></li>
</ul>
<p><strong>PCA</strong></p>
<p>Compute PCA for highly variable genes: The first 10 dimensions seem to account for most of the variance (see elbow plot). The plots seem to indicate that the blood samples and csf samples are different.</p>
<pre class="r"><code>hiv4 &lt;- RunPCA(hiv4, features = VariableFeatures(hiv4), verbose = FALSE)

# elbow plot to determine which PCs account for most of the variance
ElbowPlot(hiv4)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-6-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>#pca plots
pca_plots &lt;- comprehenr::to_list(for (i in 1:13)
  DimPlot(hiv4, reduction = &quot;pca&quot;, dims = i : (i+1)) +
    theme())
do.call(gridExtra::grid.arrange, c(pca_plots, ncol=3, nrow = 5))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-7-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-7-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-7-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-7-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Clustering &amp; tSNE embedding</strong></p>
<ul>
<li>compute KNN-graph</li>
<li>find clusters based on KNN-graph with Louvian algorithm</li>
</ul>
<pre class="r"><code>hiv4 &lt;- FindNeighbors(hiv4, verbose = FALSE)
hiv4 &lt;- FindClusters(hiv4, verbose = FALSE)

table(hiv4$seurat_clusters)

   0    1    2    3    4    5    6    7    8    9   10   11   12   13   14 
1301 1119  948  868  742  687  677  415  308  301  132  106  105   72   56 </code></pre>
<pre class="r"><code>hiv4 &lt;- RunTSNE(hiv4, dims = 1:10, verbose = FALSE)</code></pre>
<hr />
</details>
<div id="visualization-of-sample-quality-in-tsne-plot" class="section level1">
<h1>Visualization of sample quality in tSNE plot</h1>
<p>After performing quality control and removing cells with low number of features and high percentage of mitochondrial genes it does not seem that there is any batch effect, but rather the samples separate according to their origin (CSF or Blood). More detailed plots and statistical summaries of feature number, library size and percentage of mitochondrial can be found in the Appendix.</p>
<pre class="r"><code>tsne_coord &lt;- Embeddings(hiv4[[&quot;tsne&quot;]]) # tsne coordinates
meta &lt;- hiv4@meta.data # metadata
cm &lt;- hiv4@assays$RNA@counts # count matrix

# UMAP with number of features detected per cell
p1 &lt;- cbind(meta, tsne_coord) %&gt;%
  ggplot() +
  geom_point(aes(x=tSNE_1, y=tSNE_2, col=nFeature_RNA), size=.5) +
  scale_color_viridis_c() +
  labs(title = &quot;Number of features&quot;)

# percentage of mitochondrial genes per cell
p2 &lt;- cbind(meta, tsne_coord) %&gt;% 
  ggplot() +
  geom_point(aes(x = tSNE_1, y = tSNE_2, col = percent_mt ), size = .5) +
  scale_color_viridis_c() +
  labs(title = &quot;Percentage of mitochondrial genes&quot;)

# UMAP indicating the sample where each cell came from
p3 &lt;- cbind(meta, tsne_coord) %&gt;% 
  ggplot() +
  geom_point(aes(x = tSNE_1, y = tSNE_2, col = orig.ident ), size = .5) +
  labs(title = &quot;Sample origin&quot;)

# UMAP labeled according to clusters
p4 &lt;- cbind(meta, tsne_coord) %&gt;% 
  ggplot() +
  geom_point(aes(x = tSNE_1, y = tSNE_2, col = seurat_clusters ), size = .5) +
  labs(title = &quot;Clusters&quot;)

ggarrange(p1, p2, p3, p4, ncol = 2, nrow = 2)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-10-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-10-1">
Past versions of unnamed-chunk-10-1.png
</button>
</p>
<div id="fig-unnamed-chunk-10-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-10-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-10-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="marker-genes-cell-type-annotation" class="section level1">
<h1>Marker genes &amp; Cell type annotation</h1>
<pre><code>marker_genes &lt;- FindAllMarkers(hiv4, logfc.threshold = .01, min.pct = .01)</code></pre>
<div id="top-marker-genes" class="section level3">
<h3>Top marker genes</h3>
<p>The function <code>FindAllMarkers()</code> identifies differentially expressed genes between two groups of cells, in this case I compared one group of cells at a time against the rest of cells using a Wilcoxon Rank Sum test. The table below lists the two most highly differentially expressed genes for each clusters.</p>
<pre class="r"><code># filter for significant marker genes
#sign_marker_genes &lt;- marker_genes %&gt;% filter(p_val_adj &lt;= .1)

sign_marker_genes &lt;- read.table(file = &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/sign_marker_genes.tsv&quot;)

#show the top 10 differentially expressed genes for each cluster
#sign_marker_genes %&gt;% group_by(cluster) %&gt;% top_n(n = 2, wt = avg_logFC ) #%&gt;%
  #kable(caption = &quot;Top two differentially expressed genes for each cluster&quot;)#, digits = c(3, format.args = list(scientific = TRUE)) #= TRUE))</code></pre>
</div>
<div id="cell-type-annotation-with-canonical-marker-genes" class="section level3 tabset">
<h3 class="tabset">Cell type annotation with canonical marker genes</h3>
</div>
<div id="b-cell-markers" class="section level3">
<h3>B cell markers</h3>
<p>B cell markers are found primarily in cluster 7.</p>
<pre class="r"><code>p1 &lt;- VlnPlot(hiv4, features = c(&quot;MS4A1&quot;, &quot;CD79A&quot;, &quot;TCL1A&quot;), pt.size = .01)
p2 &lt;- RidgePlot(hiv4, features =  c(&quot;MS4A1&quot;, &quot;CD79A&quot;, &quot;TCL1A&quot;), sort = &quot;decreasing&quot; )
ggarrange(p1,p2, nrow = 2, ncol = 1)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-12-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-12-1">
Past versions of unnamed-chunk-12-1.png
</button>
</p>
<div id="fig-unnamed-chunk-12-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-12-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-12-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-12-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="nk-cells" class="section level3">
<h3>NK cells</h3>
<p>NK cells are primarily found in cluster 5 and 9. GZMB, a NK cell marker is also found in cluster 14.</p>
<pre class="r"><code>p1 &lt;- VlnPlot(hiv4, features = c(&quot;NKG7&quot;, &quot;GNLY&quot;, &quot;GZMB&quot;),
        pt.size = .01, ncol = 3)#, stack = TRUE)
p2 &lt;- RidgePlot(hiv4, features = c(&quot;NKG7&quot;, &quot;GNLY&quot;, &quot;GZMB&quot;), sort = &quot;decreasing&quot;)

ggarrange(p1,p2, nrow = 2, ncol = 1)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-13-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-13-1">
Past versions of unnamed-chunk-13-1.png
</button>
</p>
<div id="fig-unnamed-chunk-13-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-13-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cd4-cd8-t-cells" class="section level3">
<h3>CD4+ &amp; CD8+ T cells</h3>
<p><strong>CD4+ T cells:</strong></p>
<ul>
<li>A general T cell marker CD3E is expressed in cluster 0,1,3,4,5,6.</li>
<li>IL7R in clusters 0-6</li>
<li>TRAC in clusters 0-6, excluding 2</li>
<li>CCR7 in 0,6,7</li>
<li>LDHB not very clear, but 0,1,3,4,6</li>
<li>LTB in 0-7</li>
<li>CD2 in 1,3,4,5,9</li>
</ul>
<p>Tcells1/2/3 are numbered arbitrarily, because they are not used for further analysis.</p>
<p><strong>CD8+ T cells:</strong></p>
<ul>
<li>CD8A is expressed in decreasing order in 1,5,3</li>
</ul>
<pre class="r"><code># general T cell marker for CD4+ and CD8+ Tcells
p1 &lt;- VlnPlot(hiv4, features = c(&quot;CD8A&quot;,&quot;CD3E&quot;), pt.size = .01, ncol = 2)
p2 &lt;- RidgePlot(hiv4, features = c(&quot;CD8A&quot;,&quot;CD3E&quot;), sort = &quot;decreasing&quot;)


p3 &lt;- VlnPlot(hiv4, features = c(&quot;IL7R&quot;, &quot;TRAC&quot;), pt.size = 0.01)
p4 &lt;- RidgePlot(hiv4, features = c(&quot;IL7R&quot;, &quot;TRAC&quot;), sort = &quot;decreasing&quot;)

# helper T cells
p5 &lt;- VlnPlot(hiv4, features = c(&quot;LTB&quot;, &quot;CD2&quot;), pt.size = .01, ncol = 2)
p6 &lt;- RidgePlot(hiv4, features = c(&quot;LTB&quot;, &quot;CD2&quot;), sort = &quot;decreasing&quot;)

# CD4+ naive T cells
p7 &lt;- VlnPlot(hiv4, features = c(&quot;LDHB&quot;, &quot;CCR7&quot;), pt.size = .01, ncol = 2)
p8 &lt;- RidgePlot(hiv4, features = c(&quot;LDHB&quot;, &quot;CCR7&quot;), sort = &quot;decreasing&quot;)


ggarrange(p1, p2,p3, p4, p5, p6, p7,p8, ncol = 2, nrow = 4)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-14-1.png" width="1440" style="display: block; margin: auto;" /></p>
</div>
<div id="plasma-cells" class="section level3">
<h3>plasma cells</h3>
<p>Cluster 14 seems to contain plasma cells.</p>
<pre class="r"><code>p1 &lt;- VlnPlot(hiv4, features = c(&quot;IGJ&quot;), pt.size = .01, ncol = 2)
p2 &lt;- RidgePlot(hiv4, features = c(&quot;IGJ&quot;), sort = &quot;decreasing&quot;)
ggarrange(p1,p2, nrow = 1, ncol = 2)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-15-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-15-1">
Past versions of unnamed-chunk-15-1.png
</button>
</p>
<div id="fig-unnamed-chunk-15-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-15-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-15-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="myeloid-cells" class="section level3">
<h3>Myeloid cells</h3>
<p>Myeloid cells encompass</p>
<ul>
<li>granulocytes</li>
<li>monocytes</li>
<li>macrophages</li>
<li>dendritic cells</li>
</ul>
<p>The clusters 8, 10, 11, 12, 13 are myeloid cells</p>
<p>Myeloid1, 3, 4 are assigned arbitrarily, because they are not of interest.</p>
<pre class="r"><code>p1 &lt;- VlnPlot(hiv4, features = c(&quot;LYZ&quot;, &quot;FCER1A&quot;, &quot;CD14&quot;, &quot;FCGR3A&quot;), # FCG3A is also expressed in cluster 9 (NK cells)
        pt.size = .01, ncol = 2)
p2 &lt;- RidgePlot(hiv4, features = c(&quot;LYZ&quot;, &quot;FCER1A&quot;),
          sort = &quot;decreasing&quot;, ncol = 2) # DC markers
p3 &lt;- RidgePlot(hiv4, features = c(&quot;CD14&quot;, &quot;FCGR3A&quot;), 
          sort = &quot;decreasing&quot;, ncol = 2) # monocytes (LYC also in monocytes)
ggarrange(p1,p2,p3, nrow = 3, ncol = 1)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-16-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-16-1">
Past versions of unnamed-chunk-16-1.png
</button>
</p>
<div id="fig-unnamed-chunk-16-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-16-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="myeloid-5" class="section level3">
<h3>Myeloid 5</h3>
<p>Cluster 12 are Myeloid5 cells, which were characterized by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> with the markers FCER1A, CD1C</p>
<pre class="r"><code># Myeloid 5 in the paper
p1 &lt;- VlnPlot(hiv4, features = c( &quot;FCER1A&quot;, &quot;CD1C&quot;), pt.size = .01, ncol = 2)
p2 &lt;- RidgePlot(hiv4, features = c(&quot;FCER1A&quot;, &quot;CD1C&quot;), sort = &quot;decreasing&quot;, ncol = 2)
ggarrange(p1, p2, nrow = 2, ncol = 1)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-17-1.png" width="1440" style="display: block; margin: auto;" /></p>
</div>
<div id="myeloid-2" class="section level3">
<h3>Myeloid 2</h3>
<p>Cluster 11 is the Myeloid2 clusters with expression of AXL, APOE, TREM2. These genes are enriched in neurodegenerative disease-associated microglia <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>. CTSB, APOC1, MSR1, C1QA-C are expressed more highly in Myeloid2 compared to other myeloid clusters <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>.</p>
<pre class="r"><code># Myeloid 2
p1 &lt;- VlnPlot(hiv4, features = c(&quot;AXL&quot;, &quot;APOE&quot;, &quot;TREM2&quot;), pt.size = .01, ncol = 3)
p2 &lt;- RidgePlot(hiv4, features = c(&quot;AXL&quot;, &quot;APOE&quot;, &quot;TREM2&quot;), sort = &quot;decreasing&quot;)
p3 &lt;- VlnPlot(hiv4, features = c(&quot;CTSB&quot;, &quot;APOC1&quot;, &quot;MSR1&quot;, &quot;C1QA&quot;), 
              pt.size = .01, ncol = 4)
p4 &lt;- RidgePlot(hiv4, features = c(&quot;CTSB&quot;, &quot;APOC1&quot;, &quot;MSR1&quot;, &quot;C1QA&quot;),
                sort = &quot;decreasing&quot;, ncol = 4)

ggarrange(p1, p2, p3, p4, ncol = 1, nrow = 4)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-18-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-18-1">
Past versions of unnamed-chunk-18-1.png
</button>
</p>
<div id="fig-unnamed-chunk-18-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-18-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-18-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-18-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="section" class="section level2 unnumbered">
<h2 class="unnumbered"></h2>
<hr />
<ul>
<li>Why is the mixed population primarily composed of cells from HIV1 patient blood sample?</li>
<li>Why are T cells primarily from CSF samples and CD8 T cells primarily from blood?</li>
</ul>
</details>
<details>
**
<summary>
Table of annotation of cell types to clusters
</summary>
<p>**</p>
<pre class="r"><code>Idents(hiv4) &lt;- &quot;seurat_clusters&quot;
cell_types &lt;- c(&quot;Tcell2&quot;, &quot;CD8&quot;, &quot;mixed&quot;, &quot;CD81&quot;, &quot;Tcell3&quot;, &quot;NKcell1&quot;,
                &quot;Tcell1&quot;, &quot;Bcell&quot;, &quot;Myeloid1&quot;, &quot;NKcell2&quot;, &quot;Myeloid3&quot;, &quot;Myeloid2&quot;
                , &quot;Myeloid5&quot;, &quot;Myeloid4&quot;, &quot;plasma cell&quot; )

names(cell_types) &lt;- levels(hiv4)
hiv4 &lt;- RenameIdents(hiv4, cell_types)
as.data.frame(cell_types) %&gt;%  rownames_to_column(&quot;cluster&quot;) %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">cluster</th>
<th align="left">cell_types</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">Tcell2</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">CD8</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">mixed</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">CD81</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">Tcell3</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">NKcell1</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">Tcell1</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">Bcell</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">Myeloid1</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">NKcell2</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left">Myeloid3</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="left">Myeloid2</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">Myeloid5</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="left">Myeloid4</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="left">plasma cell</td>
</tr>
</tbody>
</table>
<pre class="r"><code>
# add cell types to metadata
hiv4 &lt;- AddMetaData(hiv4, metadata = Idents(hiv4), col.name = &quot;cell_type&quot;)


# add condition blood or csf to metadata
Idents(hiv4) &lt;- &quot;orig.ident&quot;
conditions &lt;- c(&quot;Blood&quot;, &quot;Blood&quot;, &quot;CSF&quot;, &quot;CSF&quot;)
names(conditions) &lt;- c(&quot;HIV1_Bld&quot;, &quot;HIV2_Bld&quot;, &quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;)
hiv4 &lt;- RenameIdents(hiv4, conditions)

hiv4 &lt;- AddMetaData(hiv4, col.name = &quot;Condition&quot;, metadata = Idents(hiv4))
</code></pre>
</details>
<p><strong>Overview of some of the most important marker genes:</strong></p>
<pre class="r"><code>
DotPlot(object = hiv4, features = c(&quot;MS4A1&quot;, # B cells
                                    &quot;TRAC&quot;, &quot;IL7R&quot;, 
                                    &quot;CD8A&quot;, # CD8 T cells
                                    &quot;NKG7&quot;, &quot;GNLY&quot;, # NK cells
                                    &quot;CD3E&quot;, # T cells
                                    &quot;CD14&quot;,&quot;FCGR3A&quot;, &quot;LYZ&quot;, # myeloid cells
                                    &quot;IGJ&quot;, # plasma cells
                                    &quot;AXL&quot;, &quot;APOE&quot;, &quot;TREM2&quot;, # myeloid 2
                                     &quot;FCER1A&quot;, &quot;CD1C&quot;) , # myeloid 5
        group.by = &quot;cell_type&quot;) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-20-1">
Past versions of unnamed-chunk-20-1.png
</button>
</p>
<div id="fig-unnamed-chunk-20-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-20-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-20-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-20-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="visualization-of-cell-types-conditions-samples-and-sequencing-quality" class="section level1">
<h1>Visualization of cell types, conditions, samples and sequencing quality</h1>
<p>The tSNE embedding with the annotated cell types resembles the results by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>. There are two clusters, Myeloid2 and Myeloid5 which mainly contain cells from CSF. These two clusters were termed microglia-like by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>. In the following analysis I will try to confirm this and investigate the Myeloid2 cluster in more detail.</p>
<pre class="r"><code>p1 &lt;- DimPlot(hiv4, reduction = &quot;tsne&quot;, label = TRUE, 
              group.by = &quot;cell_type&quot;, pt.size = 0.1) +
  NoLegend() +
  labs(title = &quot;Cell types&quot;)
p2 &lt;- DimPlot(hiv4, reduction = &quot;tsne&quot;, group.by =  &quot;Condition&quot;, pt.size = 0.1) +
  labs(title = &quot;CSF or Blood origin&quot;)
p3 &lt;- DimPlot(hiv4, reduction = &quot;tsne&quot;, group.by = &quot;orig.ident&quot;, pt.size = 0.1) +
  labs(title = &quot;Sample origin - patient&quot;)
p4 &lt;- FeaturePlot(hiv4, features= &quot;nCount_RNA&quot;, pt.size = 0.1) + 
    scale_color_viridis_c() +
  labs(title= &quot;number of counts&quot;)
ggarrange(p1,p2,p3,p4, ncol = 2, nrow = 2)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-21-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-21-1">
Past versions of unnamed-chunk-21-1.png
</button>
</p>
<div id="fig-unnamed-chunk-21-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-21-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-21-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-21-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>#p1 + p2 + p3 + p4</code></pre>
</div>
<div id="frequency-of-cell-types-in-csf-and-blood-samples" class="section level1">
<h1>Frequency of cell types in CSF and blood samples</h1>
<p>The histogram below shows that Myeloid2 and Myeloid5 are predominantly composed of CSF cells, while Myeloid1, Myeloid3 and Myeloid4 are predominantly composed of Blood cells. This reflects the findings of <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> very nicely.</p>
<pre class="r"><code>
custom_color &lt;- c(&quot;#C3D7A4&quot;, &quot;#4E84C4&quot;, &quot;#52854C&quot;, &quot;#293352&quot;)

#plot a barplot of the proportions of samples and cell types
ggplot(hiv4@meta.data) +
  geom_bar(aes(x = cell_type, fill = orig.ident)) +
  scale_fill_manual( values = custom_color) +
  ylab(&quot;Number of cells in each cluster&quot;) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1)) +
  labs(title = &quot;Relative contribution of CSF and blood samples to each cluster&quot;)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-22-1">
Past versions of unnamed-chunk-22-1.png
</button>
</p>
<div id="fig-unnamed-chunk-22-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-22-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-22-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-22-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Question</strong>: Myeloid1, Myeloid2 are mainly found in Blood cells, Myeloid4 is only found in Blood cells from HIV1 patient. What does that mean?</p>
<div id="how-big-are-myeloid2-and-myeloid5-clusters-and-where-do-cells-come-from" class="section level3">
<h3>How big are Myeloid2 and Myeloid5 clusters and where do cells come from?</h3>
<p>Myeloid2 cells originate from the CSF samples of HIV infected patients, while a few cells (thirteen) classified as Myeloid5 cells originate from Blood samples.</p>
<pre class="r"><code>hiv4@meta.data %&gt;% 
  filter(cell_type %in% c(&quot;Myeloid2&quot;, &quot;Myeloid5&quot;)) %&gt;% 
  group_by(cell_type, orig.ident) %&gt;% 
  summarize(n = n()) %&gt;%
  kable(caption = &quot;Number of Myeloid2 &amp; Myeloid5 cells from different patients/samples&quot;)</code></pre>
<table>
<caption>Number of Myeloid2 &amp; Myeloid5 cells from different patients/samples</caption>
<thead>
<tr class="header">
<th align="left">cell_type</th>
<th align="left">orig.ident</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Myeloid2</td>
<td align="left">HIV1_CSF</td>
<td align="right">71</td>
</tr>
<tr class="even">
<td align="left">Myeloid2</td>
<td align="left">HIV2_CSF</td>
<td align="right">35</td>
</tr>
<tr class="odd">
<td align="left">Myeloid5</td>
<td align="left">HIV1_Bld</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Myeloid5</td>
<td align="left">HIV1_CSF</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="left">Myeloid5</td>
<td align="left">HIV2_Bld</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">Myeloid5</td>
<td align="left">HIV2_CSF</td>
<td align="right">68</td>
</tr>
</tbody>
</table>
</div>
<div id="which-genes-are-upregulated-in-myeloid-2-compared-to-the-four-other-myeloid-subsets" class="section level3">
<h3>Which genes are upregulated in Myeloid-2 compared to the four other myeloid subsets?</h3>
<p>In the paper they find 60 genes that are upregulated compared to the other 4 myeloid subsets. (FDR &lt; 0.01)</p>
<p>Compare the genes upregulated in myeloid-2 to the four other myeloid subsets. <code>FindAllMarkers()</code> will compare one cluster to all other clusters. <code>FindMarkers()</code> will compare an indicated cluster with a second indicated cluster. Therefore, the difference will not be diluted, which might be the case if we compare one cluster to many other clusters.</p>
<pre class="r"><code>#import the 60 genes that were upregulated in Myeloid-2 in the paper compared to the four other myeloid subsets
paper &lt;- read.table(file = &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/Myeloid-2_genes_paper.csv&quot;, sep = &quot;\t&quot;,
                    header = FALSE, skipNul = TRUE)#, n_max = 60)
paper[1,] &lt;- &quot;APOC1&quot;
colnames(paper) &lt;- &quot;&quot;
paper &lt;- as.vector(paper[,1])

Idents(hiv4) &lt;- &quot;cell_type&quot;
all.comp &lt;- purrr::map(c(1,3,4,5), function(n){
  markers &lt;- FindMarkers(hiv4,
              ident.1 = &quot;Myeloid2&quot;,
              ident.2 = paste0(&quot;Myeloid&quot;, n),
              only.pos = TRUE, 
              verbose = FALSE)
  markers &lt;- rownames_to_column(markers, var = &quot;gene&quot;)
  name &lt;- paste0(&quot;Comparison Myeloid 2 vs Myeloid &quot;, n)
  list(df = markers, name = name)
})

my2_genes &lt;- map(seq.int(1,4), function(n) {
  name &lt;- all.comp[[]]$name
  my2_genes &lt;- all.comp[[n]]$df %&gt;% 
  filter(p_val_adj &lt;= .2) %&gt;%
  filter(gene %in% paper)
  my2_genes &lt;- my2_genes[,&quot;gene&quot;]
})</code></pre>
</div>
<div id="expression-of-the-60-genes-identified-in-the-paper-as-myeloid-2-markers" class="section level3">
<h3>Expression of the 60 genes identified in the paper as Myeloid 2 markers</h3>
<p>The genes show the highest expression in Myeloid2 and for some genes like CD74 and genes of the HLA family are also highly expressed in Myeloid5 cells. However, there are a few genes, like FAU, TPT1, TMSB10 and MIR4426 which do not show expression specific to the Myeloid2 cluster. It is unclear why <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> chose these genes as signature genes.</p>
<pre class="r"><code>DotPlot(hiv4, features = c(paper)) + 
  coord_flip() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1))
Warning in FetchData(object = object, vars = features, cells = cells): The
following requested variables were not found: SELENOP</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-25-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-25-1">
Past versions of unnamed-chunk-25-1.png
</button>
</p>
<div id="fig-unnamed-chunk-25-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-25-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-25-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-25-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-25-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="percentage-of-myeloid2-transcripts-per-cell-in-blood-csf-and-uninfected-samples" class="section level3">
<h3>Percentage of Myeloid2 transcripts per Cell in Blood, CSF and Uninfected samples</h3>
<p>First, it is important to mention, that after quality control the number of cells is significantly lower in the two uninfected CSF samples, 216 and 340 respectively, compared to all other samples which contain between 932 and 2520 cells. However, also the CSF sample from patient1 (HIV1_CSF) with 932 cells contains much fewer cells compared to all other samples.</p>
<p>The results shown by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> are controversial, because when they compare the percentage of Myeloid2 transcripts between the three conditions, they pool 1770 cells for the uninfected condition, which is a lot more than we find here. Yet, they do not mention that they used different thresholds for quality control of the uninfected samples. Therefore, I was not able to reproduce their findings. Below, I will describe the percentage of Myeloid2 transcripts when comparing the conditions with the number of cells obtained when using the same thresholds for quality control as described in the paper.</p>
<p>The interpretability of the comparison probably suffers from the fact that the number of cells in the uninfected conditions is so much smaller.</p>
<pre class="r"><code>hiv7 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/total_7_samples_filtered_seurat_object.rds&quot;)

hiv7@meta.data %&gt;% group_by(orig.ident) %&gt;% 
  summarise(number_of_cells = n()) %&gt;% 
  kable(caption = &quot;Number of cells per sample&quot;)</code></pre>
<table>
<caption>Number of cells per sample</caption>
<thead>
<tr class="header">
<th align="left">orig.ident</th>
<th align="right">number_of_cells</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HIV1_Bld</td>
<td align="right">2076</td>
</tr>
<tr class="even">
<td align="left">HIV1_CSF</td>
<td align="right">932</td>
</tr>
<tr class="odd">
<td align="left">HIV2_Bld</td>
<td align="right">2520</td>
</tr>
<tr class="even">
<td align="left">HIV2_CSF</td>
<td align="right">2309</td>
</tr>
<tr class="odd">
<td align="left">HIV3_CSF</td>
<td align="right">1384</td>
</tr>
<tr class="even">
<td align="left">Uninfected1_CSF</td>
<td align="right">216</td>
</tr>
<tr class="odd">
<td align="left">Uninfected2_CSF</td>
<td align="right">340</td>
</tr>
</tbody>
</table>
<pre class="r"><code>hiv7 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/total_7_samples_filtered_seurat_object.rds&quot;)

# create a list for the 3 different conditons
subset.list &lt;- list(infected_blood = c(&quot;HIV1_Bld&quot;, &quot;HIV2_Bld&quot;), 
                    infected_csf = c(&quot;HIV1_CSF&quot;, &quot;HIV2_CSF&quot;, &quot;HIV3_CSF&quot;),
                    uninfected_csf = c(&quot;Uninfected1_CSF&quot;, &quot;Uninfected2_CSF&quot;))

# for each cell of each condition calculate a percentage of Myeloid2 transcripts
# and combine to a dataframe
percentage_my2_transcripts &lt;- map2_dfr(subset.list, names(subset.list), function(n, name) {
  count_m &lt;- subset(hiv7, orig.ident %in% n)@assays$RNA@counts
  total_transcripts &lt;- colSums(count_m) # number of transcripts per cell
  my2_matrix &lt;- count_m[rownames(count_m) %in% paper, ] # get only myeloid2 genes 
  my2_transcripts &lt;- colSums(my2_matrix) # sum of myeloid2 transcripts
  tibble(percentage =  my2_transcripts/total_transcripts, condition = name)
})</code></pre>
<p><strong>Is there a significant difference in percentage of Myeloid2 transcripts between the three conditions?</strong></p>
<pre class="r"><code>percentage_my2_transcripts %&gt;% 
  group_by(condition) %&gt;% 
  summarise(n = n(), q25 = quantile(percentage, .25),
            q50 = quantile(percentage, .5), 
            q75 = quantile(percentage, .75), 
            mean = mean(percentage),
            median = median(percentage)) %&gt;% 
  kable(digits = 4, 
        caption = &quot;Summary statistics of percentage of Myeloid2 transcripts for different conditions&quot;)</code></pre>
<table>
<caption>Summary statistics of percentage of Myeloid2 transcripts for different conditions</caption>
<thead>
<tr class="header">
<th align="left">condition</th>
<th align="right">n</th>
<th align="right">q25</th>
<th align="right">q50</th>
<th align="right">q75</th>
<th align="right">mean</th>
<th align="right">median</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">infected_blood</td>
<td align="right">4596</td>
<td align="right">0.0155</td>
<td align="right">0.0189</td>
<td align="right">0.0224</td>
<td align="right">0.0192</td>
<td align="right">0.0189</td>
</tr>
<tr class="even">
<td align="left">infected_csf</td>
<td align="right">4625</td>
<td align="right">0.0151</td>
<td align="right">0.0183</td>
<td align="right">0.0218</td>
<td align="right">0.0203</td>
<td align="right">0.0183</td>
</tr>
<tr class="odd">
<td align="left">uninfected_csf</td>
<td align="right">556</td>
<td align="right">0.0120</td>
<td align="right">0.0151</td>
<td align="right">0.0287</td>
<td align="right">0.0216</td>
<td align="right">0.0151</td>
</tr>
</tbody>
</table>
<p>To see if there is a difference between the three conditions a Kruskal-Wallis-Test was performed. We get a p-value of 4.88 * 10^-9. Therefore, we will perform a pairwise Wilcox test to see which condtions are different from each other.</p>
<pre class="r"><code>percentage_my2_transcripts %&gt;% 
  rstatix::kruskal_test(percentage ~ condition) %&gt;%
  kable(caption = &quot;Kruskal Wallis Test&quot;)</code></pre>
<table>
<caption>Kruskal Wallis Test</caption>
<thead>
<tr class="header">
<th align="left">.y.</th>
<th align="right">n</th>
<th align="right">statistic</th>
<th align="right">df</th>
<th align="right">p</th>
<th align="left">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">percentage</td>
<td align="right">9777</td>
<td align="right">38.27649</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="left">Kruskal-Wallis</td>
</tr>
</tbody>
</table>
<p><strong>Pairwise Wilcox test:</strong></p>
<p>In the table and boxplot below we can see that all three conditions are significantly different from each other. As mentioned above, the sample size is much smaller for the uninfected condition. P-values are listed in the table below.</p>
<p>Only the p-value for the comparison between infected CSF vs uninfected CSF is the same as in the paper, where they state that the Myeloid2 transcripts were found at lower levels in the uninfected samples compared to the infected samples. Otherwise, the results contradict the results found by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>. Contradictory to what is claimed in the paper, it is not evident that both infected and uninfected CSF samples have higher rates of Myeloid2 transcripts, rather the Blood samples seem to have the highest rate of Myeloid2 transcripts.</p>
<p>The comparison drawn is questionable in general, because what the boxplots below show is that there is some level of Myeloid2 transcript expression in all conditions. However, there are more outliers with very high percentage of Myeloid2 transcripts in both CSF samples. This might be a hint that in the CSF samples there is a outlier population representing the Myeloid2 cluster, which cannot be seen in the blood sample. Since the median is rather robust to outliers, even if in CSF samples there are some cells which have much higher frequencies of transcripts, it might be that the median is still lower than in blood samples.</p>
<p>Therefore, comparing the overall percentage of Myeloid2 transcripts might not provide any insights on the number of Myeloid2 cells in a particular sample.</p>
<pre class="r"><code>p1 &lt;- percentage_my2_transcripts %&gt;% ggplot() +
  geom_boxplot(aes(x = condition, y = percentage, fill = condition)) +
  xlab(&quot;Sample origin&quot;) +
  ylab(&quot;Frequency of myeloid2 transcripts per cell&quot;) +
  labs(title = &quot;All cells&quot;) +
  stat_pvalue_manual(percentage_my2_transcripts %&gt;% 
    rstatix::pairwise_wilcox_test(percentage ~ condition) %&gt;% 
      rstatix::add_xy_position()) +
  NoLegend()

p2 &lt;- percentage_my2_transcripts %&gt;% ggplot() +
  geom_boxplot(aes(x = condition, y = percentage, fill = condition), 
               outlier.shape = NA) +
  xlab(&quot;Sample origin&quot;) +
  ylab(&quot;Frequency of myeloid2 transcripts per cell&quot;) +
  labs(title = &quot;Remove outliers to see difference&quot;) +
  NoLegend()

ggarrange(p1, p2, ncol = 2, nrow = 1)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-30-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-30-1">
Past versions of unnamed-chunk-30-1.png
</button>
</p>
<div id="fig-unnamed-chunk-30-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-30-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-30-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-30-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-30-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>percentage_my2_transcripts %&gt;% 
  rstatix::wilcox_test(percentage ~ condition) %&gt;% kable(caption = &quot;Pairwise Wilcox Test&quot;)</code></pre>
<table>
<caption>Pairwise Wilcox Test</caption>
<thead>
<tr class="header">
<th align="left">.y.</th>
<th align="left">group1</th>
<th align="left">group2</th>
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">statistic</th>
<th align="right">p</th>
<th align="right">p.adj</th>
<th align="left">p.adj.signif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">percentage</td>
<td align="left">infected_blood</td>
<td align="left">infected_csf</td>
<td align="right">4596</td>
<td align="right">4625</td>
<td align="right">11090858</td>
<td align="right">2.95e-04</td>
<td align="right">2.95e-04</td>
<td align="left">***</td>
</tr>
<tr class="even">
<td align="left">percentage</td>
<td align="left">infected_blood</td>
<td align="left">uninfected_csf</td>
<td align="right">4596</td>
<td align="right">556</td>
<td align="right">1441190</td>
<td align="right">8.00e-07</td>
<td align="right">1.60e-06</td>
<td align="left">****</td>
</tr>
<tr class="odd">
<td align="left">percentage</td>
<td align="left">infected_csf</td>
<td align="left">uninfected_csf</td>
<td align="right">4625</td>
<td align="right">556</td>
<td align="right">1456760</td>
<td align="right">3.00e-07</td>
<td align="right">9.00e-07</td>
<td align="left">****</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="label-transfer" class="section level1">
<h1>Label Transfer</h1>
<p>For reference see: <a href="https://satijalab.org/seurat/articles/integration_mapping.html" class="uri">https://satijalab.org/seurat/articles/integration_mapping.html</a></p>
<p>After reproducing the results from <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> the next step was to transfer the labels from the four HIV+ Blood and CSF samples (reference) to the remaining samples (query):</p>
<ul>
<li>1 CSF smaple from HIV-1 infected patient</li>
<li>2 CSF samples from uninfected patients</li>
</ul>
<p>Myeloid1, Myeloid3 and Myeloid4 are not or hardly present in the CSF samples, because they originated exclusively from the blood samples in the reference dataset. However, there are 132 cells annotated as Myeloid2 and 43 cells annotated as Myeloid5.</p>
<pre class="r"><code># Seurat objects with annotated cell types
hiv4 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/non_integrated_HIV1_HIV2_4samples_seurat_object.rds&quot;)</code></pre>
<pre class="r"><code># read in the dataset after quality control
hiv_filt &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/total_7_samples_filtered_seurat_object.rds&quot;)
hiv_list &lt;- SplitObject(hiv_filt, split.by = &quot;orig.ident&quot;)</code></pre>
<pre class="r"><code># merge the 3 query Seurat objects
query &lt;- merge(hiv_list[[&quot;Uninfected1_CSF&quot;]], 
               c(hiv_list[[&quot;Uninfected2_CSF&quot;]], hiv_list[[&quot;HIV3_CSF&quot;]]))

# find transfer anchors between the 3 query samples and the 4 samples we have 
# analyzed previously
hiv4_transfer_anchors &lt;- FindTransferAnchors(reference = hiv4,
                                             query = query, 
                                             dims = 1:15,
                                             normalization.method = &quot;LogNormalize&quot;,
                                             reference.reduction = &quot;pca&quot;,
                                             reduction = &quot;pcaproject&quot;,
                                             verbose = FALSE)

predictions &lt;- TransferData(anchorset = hiv4_transfer_anchors, 
                            refdata = hiv4$cell_type, 
                            dims = 1:15,
                            verbose = FALSE)
#predictions %&gt;% head %&gt;% kable()

query &lt;- AddMetaData(query, metadata = predictions)
#saveRDS(query, &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/query_seurat_object_label_transfer&quot;)
table(query$predicted.id) %&gt;% kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Var1</th>
<th align="right">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bcell</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">CD8</td>
<td align="right">137</td>
</tr>
<tr class="odd">
<td align="left">CD81</td>
<td align="right">271</td>
</tr>
<tr class="even">
<td align="left">mixed</td>
<td align="right">57</td>
</tr>
<tr class="odd">
<td align="left">Myeloid1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Myeloid2</td>
<td align="right">132</td>
</tr>
<tr class="odd">
<td align="left">Myeloid4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Myeloid5</td>
<td align="right">43</td>
</tr>
<tr class="odd">
<td align="left">NKcell1</td>
<td align="right">55</td>
</tr>
<tr class="even">
<td align="left">plasma cell</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">Tcell1</td>
<td align="right">153</td>
</tr>
<tr class="even">
<td align="left">Tcell2</td>
<td align="right">732</td>
</tr>
<tr class="odd">
<td align="left">Tcell4</td>
<td align="right">341</td>
</tr>
</tbody>
</table>
<div id="check-the-gene-expression-levels-of-the-predicted-cell-types" class="section level3 tabset">
<h3 class="tabset">Check the gene expression levels of the predicted cell types</h3>
<p>The Label Transfer seems to work nicely, judging from the correct expression of common cell type markers for the individual cell types.</p>
<div id="myeloid2-marker-genes" class="section level4">
<h4>Myeloid2 marker genes</h4>
<pre class="r"><code># ceck the Myeloid2 markers
p1 &lt;- VlnPlot(query,
              features =  c(&quot;AXL&quot;, &quot;APOE&quot;, &quot;TREM2&quot;), 
              group.by = &quot;predicted.id&quot;, 
              pt.size = .01, ncol = 3)
p2 &lt;- VlnPlot(query, 
              features =  c(&quot;CTSB&quot;, &quot;MSR1&quot;, &quot;C1QA&quot;), 
              group.by = &quot;predicted.id&quot;,
              pt.size = .01, ncol = 4)

figure &lt;- ggarrange(p1, p2, ncol = 1, nrow = 2)
annotate_figure(figure, top = text_grob(&quot;Myeloid2 marker genes&quot;))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-35-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="myeloid5-marker-genes" class="section level4">
<h4>Myeloid5 marker genes</h4>
<pre class="r"><code>
# Myeloid 5 markers
p1 &lt;- VlnPlot(query, c(&quot;FCER1A&quot;, &quot;CD1C&quot;),
        group.by = &quot;predicted.id&quot;, pt.size = .01, ncol = 2) 
p1</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-36-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-36-1">
Past versions of unnamed-chunk-36-1.png
</button>
</p>
<div id="fig-unnamed-chunk-36-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-36-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="plasma-cell-marker-genes" class="section level4">
<h4>Plasma cell marker genes</h4>
<pre class="r"><code># plasma cell markers
p2 &lt;- VlnPlot(query, features = c(&quot;IGJ&quot;), 
        group.by = &quot;predicted.id&quot;, pt.size = .01, ncol = 2) 
p2</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-37-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cd8-t-cell-marker-genes" class="section level4">
<h4>CD8 T cell marker genes</h4>
<pre class="r"><code># CD8 T Cells
p3 &lt;- VlnPlot(query, features = c(&quot;CD8A&quot;),
        group.by = &quot;predicted.id&quot;, pt.size = .01, ncol = 2) + NoLegend()
p3</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-38-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="t-cell-marker-genes" class="section level4">
<h4>T cell marker genes</h4>
<pre class="r"><code># T cells 
VlnPlot(query, features = c(&quot;IL7R&quot;, &quot;TRAC&quot;),
        group.by = &quot;predicted.id&quot;, pt.size = .01, ncol = 2)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-39-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="nk-cell-marker-genes" class="section level4">
<h4>NK cell marker genes</h4>
<pre class="r"><code># NK cells
VlnPlot(query, features = c(&quot;NKG7&quot;, &quot;GNLY&quot;, &quot;GZMB&quot;), 
        group.by = &quot;predicted.id&quot;, pt.size = .01, ncol = 3)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-40-1.png" width="1440" style="display: block; margin: auto;" /></p>
</div>
<div id="b-cell-marker-genes" class="section level4">
<h4>B cell marker genes</h4>
<pre class="r"><code># B cells
VlnPlot(query, features = c(&quot;MS4A1&quot;, &quot;CD79A&quot;, &quot;TCL1A&quot;), 
        group.by = &quot;predicted.id&quot;, pt.size = .01, ncol = 3)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-41-1.png" width="1440" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="section-1" class="section level2 unnumbered">
<h2 class="unnumbered">###</h2>
<div id="umap-projection-of-additional-samples" class="section level3">
<h3>UMAP projection of additional samples</h3>
<p>A UMAP embedding of the four reference samples was calculated (figure below, left) and the annotated qery sample is shown in embedded in the same space (figure below, right. Now that we have annotated the cell types of all seven samples we can use them for further analysis.</p>
<pre class="r"><code>hiv4_test &lt;- RunUMAP(hiv4, dims = 1:15, 
                     reduction = &quot;pca&quot;, 
                     return.model = TRUE, 
                     verbose = FALSE)
Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
To use Python UMAP via reticulate, set umap.method to &#39;umap-learn&#39; and metric to &#39;correlation&#39;
This message will be shown once per session

hiv3csf &lt;- MapQuery(anchorset = hiv4_transfer_anchors,
                    reference = hiv4_test, query = query,
                    refdata = list(celltype = &quot;cell_type&quot;),
                    reference.reduction = &quot;pca&quot;,
                    reduction.model = &quot;umap&quot;, 
                    verbose = FALSE)
Warning: Keys should be one or more alphanumeric characters followed by an
underscore, setting key from ref.pca_ to refpca_
Warning: UNRELIABLE VALUE: One of the &#39;future.apply&#39; iterations
(&#39;future_lapply-1&#39;) unexpectedly generated random numbers without declaring so.
There is a risk that those random numbers are not statistically sound and the
overall results might be invalid. To fix this, specify &#39;future.seed=TRUE&#39;. This
ensures that proper, parallel-safe random numbers are produced via the L&#39;Ecuyer-
CMRG method. To disable this check, use &#39;future.seed = NULL&#39;, or set option
&#39;future.rng.onMisuse&#39; to &quot;ignore&quot;.
Warning: Keys should be one or more alphanumeric characters followed by an
underscore, setting key from ref.pca_ to refpca_
Warning: All keys should be one or more alphanumeric characters followed by an
underscore &#39;_&#39;, setting key to refpca_
Warning: No assay specified, setting assay as RNA by default.




query &lt;- TransferData(anchorset = hiv4_transfer_anchors,
                               reference = hiv4_test,
                               query = query,
                               refdata = list(celltype = &quot;cell_type&quot;), 
                      verbose = FALSE)

query &lt;- IntegrateEmbeddings(anchorset = hiv4_transfer_anchors,
                                      reference = hiv4_test,
                                      query = query,
                               new.reduction.name = &quot;ref.pca&quot;,
                             verbose = FALSE)
Warning: Keys should be one or more alphanumeric characters followed by an
underscore, setting key from ref.pca_ to refpca_
Warning: UNRELIABLE VALUE: One of the &#39;future.apply&#39; iterations
(&#39;future_lapply-1&#39;) unexpectedly generated random numbers without declaring so.
There is a risk that those random numbers are not statistically sound and the
overall results might be invalid. To fix this, specify &#39;future.seed=TRUE&#39;. This
ensures that proper, parallel-safe random numbers are produced via the L&#39;Ecuyer-
CMRG method. To disable this check, use &#39;future.seed = NULL&#39;, or set option
&#39;future.rng.onMisuse&#39; to &quot;ignore&quot;.
Warning: Keys should be one or more alphanumeric characters followed by an
underscore, setting key from ref.pca_ to refpca_
Warning: All keys should be one or more alphanumeric characters followed by an
underscore &#39;_&#39;, setting key to refpca_

query &lt;- ProjectUMAP(query = query,
                       query.reduction = &quot;ref.pca&quot;,
                       reference = hiv4_test,
                       reference.reduction = &quot;pca&quot;,
                       reduction.model = &quot;umap&quot;, verbose = FALSE)
Warning: No assay specified, setting assay as RNA by default.</code></pre>
<pre class="r"><code># Visualize the query cells alongside the reference
p1 &lt;- DimPlot(hiv4_test,
              reduction = &quot;umap&quot;,
              group.by = &quot;cell_type&quot;,
              label = TRUE,
              label.size = 5,
              repel = TRUE, 
              pt.size = .1) + NoLegend() +
  ggtitle(&quot;Reference anntoations&quot;)

p2 &lt;- DimPlot(query, 
              reduction = &quot;ref.umap&quot;,
              group.by = &quot;predicted.celltype&quot;, 
              label = TRUE,
              label.size = 5,
              pt.size = .1,
              repel = TRUE) + NoLegend() +
   ggtitle(&quot;Transferred Labels&quot;)

p1 + p2</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-43-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-43-1">
Past versions of unnamed-chunk-43-1.png
</button>
</p>
<div id="fig-unnamed-chunk-43-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-43-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>#save this new Seurat obejct including the SCTransformatin

#saveRDS(hiv_label_transfer, file = &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/total_7_samples_label_transfer.rds&quot;)</code></pre>
</div>
</div>
<div id="frequency-of-cell-types-in-csf-and-blood-samples-1" class="section level2">
<h2>Frequency of cell types in CSF and blood samples</h2>
<p>How are cell types distributed across samples, considering also the additional HIV+ CSF sample and the two uninfected samples which were annotated using label transfer.</p>
<pre class="r"><code>hiv7 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/total_7_samples_label_transfer.rds&quot;)

custom_color &lt;- c(&quot;#C3D7A4&quot;, &quot;#4E84C4&quot;, &quot;#52854C&quot;, &quot;#293352&quot;, &quot;lightskyblue&quot;, &quot;orangered2&quot;, &quot;orange2&quot;)

#plot a barplot of the proportions of samples and cell types
p2 &lt;- ggplot(hiv7@meta.data) +
  geom_bar(aes(x = cell_type, fill = orig.ident)) +
  scale_fill_manual( values = custom_color) +
  ylab(&quot;Number of cells in each cluster&quot;) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1)) +
  labs(title = &quot;Frequency of cell types from each sample after label transfer&quot;)

custom_color &lt;- c(&quot;#C3D7A4&quot;, &quot;#4E84C4&quot;, &quot;#52854C&quot;, &quot;#293352&quot;)

#plot a barplot of the proportions of samples and cell types
p1 &lt;- ggplot(hiv4@meta.data) +
  geom_bar(aes(x = cell_type, fill = orig.ident)) +
  scale_fill_manual( values = custom_color) +
  ylab(&quot;Number of cells in each cluster&quot;) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1)) +
  labs(title = &quot;Frequecy of cell types from each sample after label transfer&quot;)

ggarrange(p1, p2, ncol = 2, nrow = 1)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-45-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-45-1">
Past versions of unnamed-chunk-45-1.png
</button>
</p>
<div id="fig-unnamed-chunk-45-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-45-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-45-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-45-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-45-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-45-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="independent-annotation-of-myeloid2-and-myeloid5-clusters-as-microglia-like-cells" class="section level2">
<h2>Independent annotation of Myeloid2 and Myeloid5 clusters as Microglia-like cells</h2>
<p>In the following part I tried to confirm that the Myeloid2 (and maybe the Myeloid5) cluster are microglia-like cells. <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> used 60 genes to characterize Myeloid2 cells, some of which are found in disease-associated microglia. Searching the literature for additional microglia signatures we might be able to independently confirm this microglia-like signature.</p>
<p>Below you can click on the tabs to see the results of using different gene signatures to confirm the microglia-like signature of Myeloid2 and Myeloid5. The function used to calculate the gene signature score in different cells is <code>AddModuleScore()</code>.</p>
<div id="function-add-module-score" class="section level4">
<h4>Function Add Module Score</h4>
<p>This Function calculates the average expression levels of each cluster on single cell level, subtracted by the aggregated expression of control feature sets. The analyzed features are binned based on averaged expression and the control features are randomly selected from each bin.</p>
<pre class="r"><code># read in Seurat object
hiv4 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/non_integrated_HIV1_HIV2_4samples_seurat_object.rds&quot;)</code></pre>
</div>
</div>
<div id="different-gene-signatures-found-in-the-literature" class="section level2 tabset">
<h2 class="tabset">Different gene signatures found in the literature</h2>
<div id="farhadian-et-al." class="section level3">
<h3>Farhadian et al.</h3>
<p>60 genes were used by Farhadian et al. to distinguish the Myeloid2 cell type. 28 of the 60 genes used as microglia signature in the <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> Paper are also found in the 881 microglia signature genes defined by <span class="citation">(<a href="#ref-Gosselin" role="doc-biblioref">David Gosselin 2020</a>)</span>.</p>
<pre class="r"><code>## Read in list of microglia signature genes found in the Gosselin paper
## which are also found in the HIV1 and HIV2 samples:
microglia_genes &lt;- read.table(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/Microglia_gene_signatur_found_in_HIV1_HIV2_samples&quot;)</code></pre>
<pre class="r"><code># Are there any genes overlapping between Farhadian and Glass paper?
#import the 60 genes that were upregulated in Myeloid-2 in the paper compared to the four other myeloid subsets
paper &lt;- read.table(file = &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/Myeloid-2_genes_paper.csv&quot;, sep = &quot;\t&quot;, header = FALSE, skipNul = TRUE)#, n_max = 60)
paper[1,] &lt;- &quot;APOC1&quot;
colnames(paper) &lt;- &quot;&quot;
paper &lt;- as.vector(paper[,1])

# Are there any genes overlapping between Farhadian and Glass paper?
#paper %in% as.vector(microglia_genes[[&quot;gene_name&quot;]])

overlap &lt;- as.vector(microglia_genes[[&quot;gene_name&quot;]]) [as.vector(microglia_genes[[&quot;gene_name&quot;]]) %in% paper]
#length(overlap)
#overlap %&gt;% kable()</code></pre>
<pre class="r"><code># get only genes present in the HIV1 and HIV2 samples!
paper &lt;- paper[paper %in% rownames(hiv4@assays$RNA@counts)]


hiv_farhadian &lt;- AddModuleScore(hiv4, 
                           features = paper)

Idents(hiv_farhadian) &lt;- &quot;cell_type&quot;
FeaturePlot(hiv_farhadian, features = &quot;Cluster1&quot; , pt.size = .5, label = TRUE, repel = TRUE) +
    scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;Farhadian et al., 2018: Microglia signature genes&quot;)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-49-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-49-1">
Past versions of unnamed-chunk-49-1.png
</button>
</p>
<div id="fig-unnamed-chunk-49-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-49-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-49-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-49-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-49-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="gosselin-et-al." class="section level3">
<h3>Gosselin et al. </h3>
<p>Here, I will first use the 881 microglia marker genes and then also try the list of TFs provided by <span class="citation">(<a href="#ref-Gosselin" role="doc-biblioref">David Gosselin 2020</a>)</span>.</p>
<p>The Transcription Factors mentioned in the paper do not seem to be specific for the Myeloid2 cluster. Interestingly, there is a very low score<br />
of these microglia genes in Myeloid5, while there is a higher score in Myeloid1 and Myeloid4 cells.</p>
<pre class="r"><code>gosselin_tfs &lt;- read.table( &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/TFs_microglia_Glass_paper.txt&quot;)


hiv4_glass &lt;- AddModuleScore(hiv4, 
                           features = as.vector(gosselin_tfs))
Warning: The following features are not present in the object: MEF2B, SALL1, not
searching for symbol synonyms

Idents(hiv4_glass) &lt;- &quot;cell_type&quot;
FeaturePlot(hiv4_glass, features = &quot;Cluster1&quot;, label = TRUE, repel = TRUE, pt.size = .7) +
    scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;Gosselin D. et al., 2017: Microglia Transcription Factors&quot;) </code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-50-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-50-1">
Past versions of unnamed-chunk-50-1.png
</button>
</p>
<div id="fig-unnamed-chunk-50-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-50-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="hand-signature" class="section level3">
<h3>HAND signature</h3>
<p>(HAND = HIV-associated neurodegenerative disease)</p>
<p><span class="citation">(<a href="#ref-Gosselin" role="doc-biblioref">David Gosselin 2020</a>)</span> defined a group of genes upregulated in microglia from patients with HAND.</p>
<p>This gene signature can, however not be detected in any of the Myeloid clusters.</p>
<pre class="r"><code>hand_genes &lt;- read.table(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/HAND_upregulated_microglia_signature_genes&quot;)
hand_genes &lt;- as.vector(hand_genes[[&quot;genes&quot;]])

hiv_hand &lt;- AddModuleScore(hiv4,
                           features = hand_genes)

Idents(hiv_hand) &lt;- &quot;cell_type&quot;
FeaturePlot(hiv_hand, features = &quot;Cluster1&quot;, pt.size = .01) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;microglia signature genes upregulated in HAND&quot;)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-51-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-51-1">
Past versions of unnamed-chunk-51-1.png
</button>
</p>
<div id="fig-unnamed-chunk-51-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-51-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-51-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/5830d4f67d499d645db8566d2cbfe280298bfdae/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-51-1.png" target="_blank">5830d4f</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/dde10972b37ffd997474921968223514c8cb1b1f/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-51-1.png" target="_blank">dde1097</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="grassivaro-et-al." class="section level3">
<h3>Grassivaro et al.</h3>
<p><span class="citation">(<a href="#ref-Grassivaro" role="doc-biblioref">Francesca Grassivaro and Martino 2018</a>)</span> identified features related to convergence of microglia and macrophages. They identified 14 genes that are conserved in microglia throughout development, but not expressed in myeloid-derived monocytes (MDM). Only in the context of neuroinflammation are the 14 genes expressed in macrophages as well.</p>
<pre class="r"><code>tfs &lt;- c(&quot;CRYBB1&quot;, &quot;GARNL3&quot;, &quot;GPR34&quot;, &quot;LAG3&quot;, &quot;NUAK1&quot;, &quot;OLFML3&quot;, &quot;RTN1&quot;,  &quot;SALL3&quot;,  &quot;SLC1A3&quot;, &quot;SPARC&quot;, &quot;TNFRSF17&quot;)

tfs %in% rownames(hiv4@assays$RNA@counts)
 [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE


hivt &lt;- AddModuleScore(hiv4,
                           features = tfs)

Idents(hivt) &lt;- &quot;cell_type&quot;
FeaturePlot(hivt, features = &quot;Cluster2&quot;,
            label = TRUE, 
            repel = TRUE, pt.size = .1) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;14 genes expressed in microglia &amp; macrophages in neuroinfl.&quot;)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-52-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-52-1">
Past versions of unnamed-chunk-52-1.png
</button>
</p>
<div id="fig-unnamed-chunk-52-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-52-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="keren-shaul-et-al.-kraseman-et-al." class="section level3">
<h3>Keren-Shaul et al. &amp; Kraseman et al.</h3>
<p>The marker genes mentioned by <span class="citation">(<a href="#ref-Keren-Shaul" role="doc-biblioref">Hadas Keren-Shaul 2017</a>)</span> and <span class="citation">(<a href="#ref-Kraseman" role="doc-biblioref">Susanne Krasemann 2017</a>)</span> were referred to by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> and used as marker genes for microglia associated with neurodegenerative disease.</p>
<p><span class="citation">(<a href="#ref-Keren-Shaul" role="doc-biblioref">Hadas Keren-Shaul 2017</a>)</span> defined a signature consisting of genes upregulated in disease-associated microglia.</p>
<p><span class="citation">(<a href="#ref-Kraseman" role="doc-biblioref">Susanne Krasemann 2017</a>)</span> defined a signature of 28 inflammatory genes upregulated in disease-assocaited microglia.</p>
<p>Neither of these signatures show a high score for the Myeloid2/5 clusters.</p>
<ul>
<li>The signature genes defined by <span class="citation">(<a href="#ref-Keren-Shaul" role="doc-biblioref">Hadas Keren-Shaul 2017</a>)</span> are expressed to some level in all myeloid clusters</li>
<li>The signature defined by <span class="citation">(<a href="#ref-Kraseman" role="doc-biblioref">Susanne Krasemann 2017</a>)</span> is also mainly expressed in the Myeloid clusters</li>
<li>CD9 and SPP1 might be added to the list of microglia marker genes expressed in Myeloid2 cluster</li>
</ul>
<p>It is not clear why <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span> used these genes as marker genes.</p>
<pre class="r"><code># upregulated in disease associated microglia (Keren-Shaul)
disease &lt;- c(&quot;SPP1&quot;, &quot;ITGAX&quot;, &quot;AXL&quot;, &quot;LILRB4&quot;, &quot;CLEC7A&quot;, &quot;CCL2&quot;, &quot;CSF1&quot;) 

#28 inflammatory molecules upregulated in disease associated microglia (Krasemann)
mgnd &lt;- c(&quot;APOE&quot;, &quot;AXL&quot;, &quot;CCL2&quot;, &quot;TLR2&quot;, &quot;SPP1&quot;, &quot;CYBB&quot;, &quot;MSR1&quot;, &quot;ITGAX&quot;,
          &quot;CLEC7A&quot;, &quot;CHI3L3&quot;, &quot;ARG1&quot;, &quot;SIGLEC1&quot;, &quot;CFP&quot;, &quot;CXCL10&quot;, &quot;ALCAM&quot;, 
          &quot;FER1L3&quot;, &quot;LILRB4&quot;, &quot;GPX3&quot;, &quot;GAS7&quot;, &quot;CCRL2&quot;,&quot;CXCL16&quot;, &quot;CXCR4&quot;,
          &quot;GPNMB&quot;, &quot;LGALS3&quot;, &quot;IFI202B&quot;, &quot;CSF1&quot;, &quot;LIRB4&quot;, &quot;LAG3&quot;)
# only APOE, AXL and MSR1 overlap, but these are the most important genes

# remove the genes that are also used by the Farhadian Paper
mgnd &lt;- c(&quot;CCL2&quot;, &quot;TLR2&quot;, &quot;SPP1&quot;, &quot;CYBB&quot;,  &quot;ITGAX&quot;,
          &quot;CLEC7A&quot;, &quot;CHI3L3&quot;, &quot;ARG1&quot;, &quot;SIGLEC1&quot;, &quot;CFP&quot;, &quot;CXCL10&quot;, &quot;ALCAM&quot;, 
          &quot;FER1L3&quot;, &quot;LILRB4&quot;, &quot;GPX3&quot;, &quot;GAS7&quot;, &quot;CCRL2&quot;,&quot;CXCL16&quot;, &quot;CXCR4&quot;,
          &quot;GPNMB&quot;, &quot;LGALS3&quot;, &quot;IFI202B&quot;, &quot;CSF1&quot;, &quot;LIRB4&quot;, &quot;LAG3&quot;)

#hiv4 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/non_integrated_HIV1_HIV2_4samples_seurat_object.rds&quot;)

#get genes also present in the HIV samples
mgnd &lt;- mgnd[mgnd %in% rownames(hiv4@assays$RNA@counts)]


hiv_disease &lt;- AddModuleScore(hiv4,
                           features = disease)

keren &lt;- FeaturePlot(hiv_disease, features = &quot;Cluster1&quot;, pt.size = .01) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;Keren-Shaul et al., disease-associated microglia&quot;)



hiv_mgnd &lt;- AddModuleScore(hiv4,
                           features = mgnd)

kraseman &lt;- FeaturePlot(hiv_mgnd, features = &quot;Cluster1&quot;, pt.size = .01) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
  labs(title = &quot;Kraseman et al., disease associated microglia&quot;)

ggarrange(keren, kraseman, ncol = 2, nrow = 1)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-53-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-53-1">
Past versions of unnamed-chunk-53-1.png
</button>
</p>
<div id="fig-unnamed-chunk-53-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-53-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-53-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Keren Shaul et al. signature
p1 &lt;- DotPlot(hiv4, features = disease, group.by = &quot;cell_type&quot;) + 
  coord_flip() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1)) +
    labs(title = &quot;Keren-Shaul et al., disease-associated microglia&quot;)

# Kraseman et al. signature
p2 &lt;- DotPlot(hiv4, features = mgnd, group.by = &quot;cell_type&quot;) + 
  coord_flip() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1)) +
    labs(title = &quot;Kraseman et al., disease associated microglia&quot;)


# some genes that might be markers for Myeloid2
p3 &lt;- DotPlot(hiv4, features = c(&quot;CD9&quot;, &quot;APOE&quot;, &quot;AXL&quot;, &quot;CTSL&quot;, &quot;SPP1&quot;), group.by = &quot;cell_type&quot;) + 
  coord_flip() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1)) +
  labs(title = &quot;Genes that might be used as markers for Myeloid2&quot;)

ggarrange(p1, p2, p3, ncol = 2, nrow = 2)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-54-1.png" width="1440" style="display: block; margin: auto;" /></p>
</div>
<div id="esaulova-et-al." class="section level3">
<h3>Esaulova et al.</h3>
<p>Gene signature defined by <span class="citation">(<a href="#ref-Esaulova" role="doc-biblioref">Ekaterina Esaulova 2020</a>)</span></p>
<div id="homeostatic-genes" class="section level5">
<h5>Homeostatic genes:</h5>
<ul>
<li>the homeostatic microglia gene signature is found in all myeloid clusters, not only in the Myeloid 2 (except for SLC2A5 which was also included in the Farhadian paper)</li>
<li>NK cell cluster also exhibits high scores for this gene signature</li>
</ul>
<pre class="r"><code>#homeostatic microglia gene signature
microglia &lt;- c(&quot;CX3CR1&quot;,&quot;CSF1R&quot;, &quot;SLC2A5&quot;, &quot;MARCKS&quot;, &quot;P2RY13&quot;)
FeaturePlot(hiv4, features = microglia, ncol = 3)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-55-1.png" width="1440" style="display: block; margin: auto;" /></p>
<pre class="r"><code>dotplot &lt;- DotPlot(hiv4, features = microglia, group.by = &quot;cell_type&quot;) + 
  coord_flip() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1))

hivt &lt;- AddModuleScore(hiv4, features = microglia)
Idents(hivt) &lt;- &quot;cell_type&quot;
tsne &lt;- FeaturePlot(hivt, features = &quot;Cluster1&quot;, label =TRUE, repel = TRUE, pt.size = .7) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
    labs(title = &quot;Homeostatic microglia signature from Esaulova paper&quot;)

ggarrange(dotplot, tsne, ncol =2, nrow = 1)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-56-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-56-1">
Past versions of unnamed-chunk-56-1.png
</button>
</p>
<div id="fig-unnamed-chunk-56-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-56-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="microglia-specific-genes" class="section level5">
<h5>Microglia-specific genes:</h5>
<ul>
<li><strong>GPR34</strong>, <strong>TMEM119</strong> supports the hypothesis that myeloid2 are microglia-like, since they are expressed at higher levels in the Myeloid2 cluster</li>
<li>they use 10 genes to discriminate microglia, four of which have not been inlcuded by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>: <strong>CLEC9A</strong>, <strong>TIMD4</strong>, <strong>TNFSF18</strong>, <strong>CXCL12</strong></li>
<li>the genes <strong>CLEC9A</strong>, <strong>TIMD4</strong>, <strong>TNFSF18</strong>, <strong>CXCL12</strong> are not included in the 60 genes used by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>, but they do not show specific expression for Myeloid2 cells</li>
</ul>
<pre class="r"><code># 10 genes that discriminate microglia
microglia &lt;- c(&quot;C1QC&quot;, &quot;C1QB&quot;, &quot;C1QA&quot;, &quot;TREM2&quot;, &quot;TIMD4&quot;, &quot;APOC1&quot;, 
               &quot;APOE&quot;, &quot;TNFSF18&quot;, &quot;CLEC9A&quot;, &quot;CXCL12&quot;)
#FeaturePlot(hiv4, features = microglia, ncol = 3)

#microglia %in% paper

Idents(hiv4) &lt;- &quot;cell_type&quot;

#  two genes whcih might support that myeloid2 cluster contains microglia-like cells
#FeaturePlot(hiv4, features = c(&quot;GPR34&quot;, &quot;TMEM119&quot;), label = TRUE, pt.size = .7,
       #     repel = TRUE)
#DotPlot(hiv4, features = c(&quot;TMEM119&quot;, &quot;GPR34&quot;), group.by = &quot;cell_type&quot;) + 
  #   coord_flip() +
   #  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1))

# these are not inlcuded in the Farhadian gene signature
FeaturePlot(hiv4, features = c(&quot;CLEC9A&quot;, &quot;TIMD4&quot;, &quot;TNFSF18&quot;, &quot;CXCL12&quot;, 
                               &quot;GPR34&quot;, &quot;TMEM119&quot;),
            pt.size = .7, label = TRUE, repel = TRUE, ncol= 2)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-57-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-57-1">
Past versions of unnamed-chunk-57-1.png
</button>
</p>
<div id="fig-unnamed-chunk-57-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-57-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-57-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-57-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="sankowski-et-al." class="section level3">
<h3>Sankowski et al.</h3>
<p><span class="citation">(<a href="#ref-Sankowski" role="doc-biblioref">Roman Sankowski 2019</a>)</span> describe different states of microglia cells from the human brain.</p>
<p>In the paper microglia cells were obtained through brain surgery. Microglia were defined by a core signature called “microglia signature” below. <span class="citation">(<a href="#ref-Sankowski" role="doc-biblioref">Roman Sankowski 2019</a>)</span> performed unsupervised clustering using Race ID3 which resulted in 9 major subclusters of the microglia cells. The authors suggested that these subclusters represent the wide spectrum of transcriptional states in human microglia.</p>
<p><strong>RaceID:</strong> RaceID is a clustering algorithm for the identification of cell types from scRNA-seq data. It was designed to work particularly well for the detection of rare cells. See for more details: <a href="https://github.com/dgrun/RaceID3_StemID2_package" class="uri">https://github.com/dgrun/RaceID3_StemID2_package</a></p>
<ul>
<li>The microglia signature is most pronounced in Myeloid2 cluster which supports the hypothesis that Myeoid2 are microglia-like cells.</li>
<li>The monocyte signature is less pronounced in Myeloid2 cluster and more pronounced in the other Myeloid clusters which is in line with the assumption that the cells in blood and CSF are monocytes or monocyte-derived macrophages rather than microglia-like cells.</li>
<li>Homeostatic microglia gene signature (core signature genes expressed by all clusters in the paper) is found in all Myeloid cluster as well as NK cells, with high expression also in Myeloid2. It is not clear why NK cells would express a homeostatic microglia signature. The reason why all Myeloid cluster express this signature might be that homeostatic microlglia have some overlap in gene expression with peripheral macrophages.</li>
</ul>
<p>Two potential markers for Myeloid2 are <strong>CSF1R</strong> and <strong>MARCKS</strong> which are most highly expressed in Myeloid2 cells.</p>
<pre class="r"><code># microglia gene signature from supplementary table 3a
microglia &lt;- c(&quot;P2RY12&quot;, &quot;CX3CR1&quot;, &quot;CSF1R&quot;, &quot;TMEM119&quot;, &quot;SLC2A5&quot; )

# monocyte gene signature from supplementary table 3a 
monocyte &lt;- c(&quot;CCR2&quot;, &quot;CLEC12A&quot;, &quot;PLAC8&quot;, &quot;FCN1&quot;, &quot;S100A9&quot;)

# homeostatic microlgia gene siganture
homeostatic &lt;- c(&quot;CX3CR1&quot;, &quot;TMEM119&quot;, &quot;CSF1R&quot;, &quot;P2RY12&quot;,
                 &quot;P2RY13&quot;,&quot;SELPLG&quot;, &quot;MARCKS&quot;)


tsne_list &lt;- map(seq.int(1:3), function(n){
  names &lt;- c(&quot;microglia&quot;, &quot;monocyte&quot;, &quot;homeostatic&quot;)
  feature_list &lt;- list(microglia, monocyte, homeostatic)
  features = feature_list[[n]]
  hiv &lt;- AddModuleScore(hiv4, features = features)
  # feature plot
  Idents(hiv) &lt;- &quot;cell_type&quot;
  FeaturePlot(hiv, features = &quot;Cluster1&quot;, pt.size = .5, label = TRUE, repel=TRUE)+
    scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
    labs(title = paste0(names[n],&quot; microglia gene signature&quot;))
})
  
dotplot_list &lt;- map(seq.int(1:3), function(n){
  names &lt;- c(&quot;microglia&quot;, &quot;monocyte&quot;, &quot;homeostatic&quot;)
  feature_list &lt;- list(microglia, monocyte, homeostatic)
  features = feature_list[[n]] 
  # dot plot
  DotPlot(hiv4, features = features, group.by = &quot;cell_type&quot;) +
    coord_flip() +
        theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1)) +
  labs(title = paste0(names[n],&quot; gene signature&quot;))
})
  
do.call(grid.arrange, c(append(tsne_list, dotplot_list), ncol = 2, nrow = 3))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-58-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-58-1">
Past versions of unnamed-chunk-58-1.png
</button>
</p>
<div id="fig-unnamed-chunk-58-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-58-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-58-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-58-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="clusters-across-the-transcriptional-spectrum-of-microglia" class="section level4">
<h4>Clusters across the transcriptional spectrum of microglia</h4>
<p><span class="citation">(<a href="#ref-Sankowski" role="doc-biblioref">Roman Sankowski 2019</a>)</span> defined 9 subclusters within the microglia cell population. Can we find these gene signatures in the CSF-derived Myeloid cells? This could further confirm that Myeloid2 and Myeloid5 are microglia-like cells.</p>
<ul>
<li><strong>homeostatic clusters</strong>
<ul>
<li>C2: strong expresssion of MCH-II and antiviral immunity genes (HLA-DRA, CD74, IFI44L)</li>
<li>C3: high expression of microglial core genes CX3CR1, TMEM119<br />
</li>
</ul></li>
<li><strong>antigen processing and peptide antigen presentation</strong> C6 and C7 were characterized by low expression of CX3CR1 and high expression of integrin-receptor binding protein and metabolism genes (SPP1, APOE, LPL).</li>
<li>** proinflammatory clusters:** C1, C5, C8, C9 were characterized by expression of chemokine and cytokine genes (CCL2, IL1B).</li>
</ul>
<p>Since Cluster C2 was characterized as a homeostati microglia cluster and showed expression of MHC-II and antivrial immunity genes like IFI44L, HLA-DRA, CD74, this supports the microglia-like identity of Myeloid2 and Myeloid5. However, there is also some expression of this signature in Meloid1 and Myeloid3 which mainly originate from Blood samples and also in B cells.</p>
<p>There is also a high score for C5 and C8 signature genes, which are both proinflammatory gene signatures.</p>
<pre class="r"><code># get differentially expressed genes per cluster across the transcriptional 
# spectrum of microglia 
excel_sheets(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/2019_Sankowski_Mapping_microgliastates_in_the_human_brain_Supplementary_tables.xlsx&quot;)
 [1] &quot;Suppl. table 1&quot;  &quot;Suppl. table 2&quot;  &quot;Suppl. table 3&quot;  &quot;Suppl. table 4&quot; 
 [5] &quot;Suppl. table 5&quot;  &quot;Suppl. table 6&quot;  &quot;Suppl. table 7&quot;  &quot;Suppl. table 8&quot; 
 [9] &quot;Suppl. table 9&quot;  &quot;Suppl. table 10&quot; &quot;Suppl. table 11&quot; &quot;Suppl. table 12&quot;
cluster_genes &lt;- read_excel(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/2019_Sankowski_Mapping_microgliastates_in_the_human_brain_Supplementary_tables.xlsx&quot;, sheet = &quot;Suppl. table 3&quot;)
#names(microglia_sign_df) [1] &lt;- &quot;gene_name&quot;
#microglia_sign &lt;- microglia_sign_df[,&quot;gene_name&quot;]

# C3

cluster_list &lt;- map(seq.int(1:8), function(n) {
  names &lt;- c(&quot;c1&quot;, &quot;c2&quot;, &quot;c3&quot;, &quot;c5&quot;, &quot;c6&quot;, &quot;c7&quot;, &quot;c8&quot;, &quot;c9&quot;)
  name &lt;- names[n]
  cluster &lt;- c(1,2,3,5,6,7,8,9)
  cluster_number &lt;- cluster[n]
  c &lt;- pull(cluster_genes %&gt;% filter(Cluster == cluster_number), GENEID)
  c &lt;- c[c %in% rownames(hiv4@assays$RNA@counts)]
  cluster_list &lt;- list(name = name, cluster = c)
})


cluster_plots &lt;- map(seq.int(1:8), function(n){
  c &lt;- cluster_list[[n]]$cluster
  name &lt;- cluster_list[[n]]$name
  hivc &lt;- AddModuleScore(hiv4, features = c)
  Idents(hivc) &lt;- &quot;cell_type&quot;
  FeaturePlot(hivc, features = &quot;Cluster1&quot;, pt.size = .5, label = TRUE,
              repel = TRUE) +
      scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
    labs(title = paste0(&quot;Signature cluster &quot;, name))
})

do.call(grid.arrange, c(cluster_plots, ncol = 2, nrow = 4))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-59-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-59-1">
Past versions of unnamed-chunk-59-1.png
</button>
</p>
<div id="fig-unnamed-chunk-59-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-59-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-59-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-59-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>
#map(seq.int(1:8), function(n){
 # c &lt;- cluster_list[[n]]$cluster
  #name &lt;- cluster_list[[n]]$name
  #DotPlot(hiv4, features = c, group.by = &quot;cell_type&quot;) +
  #coord_flip() +
  #      theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust=1)) +
  #labs(title = paste0(&quot;Differentially expressed genes of cluster &quot;, name))
#})</code></pre>
</div>
</div>
</div>
<div id="section-2" class="section level2 unnumbered">
<h2 class="unnumbered"></h2>
<hr />
</div>
<div id="genes-which-are-upregulated-in-myeloid2-compared-to-all-other-myeloid-clusters" class="section level2">
<h2>Genes which are upregulated in Myeloid2 compared to all other Myeloid clusters</h2>
<ul>
<li><p>overlap of 5 genes with Kraseman microglia -&gt; inflammatory molecules upregulated in disease associated microglia (Krasemann)</p></li>
<li><p>overlap of 3 genes with disease-associated microglia (Keren-Shaul)</p></li>
<li><p>Sankowski signature</p>
<ul>
<li>4 genes overlap with microglia signature</li>
<li><strong>zero overlap with monocyte gene signature</strong></li>
<li>4 genes overlap with homeostatic microglia signature</li>
</ul></li>
<li><p>Esaulova paper -&gt; 8 of 10 genes that discriminate microglia are found upregulated in Myeloid2 cluster</p></li>
<li><p>Glass paper -&gt; 132 of the microglia signature are found in the genes upregulated in Myeloid2, 28 of these are also included in the Farhadian Paper signature, 104 are new marekr genes</p></li>
</ul>
<pre class="r"><code>Idents(hiv4) &lt;- &quot;cell_type&quot;
# Find Markers that distinguish My2 from the other Myeloid clusters
my2_markers &lt;- FindMarkers(hiv4, ident.1  = &quot;Myeloid2&quot;,
            ident.2  = c(&quot;Myeloid1&quot;, &quot;Myeloid3&quot;, &quot;Myeloid4&quot;, &quot;Myeloid5&quot;))
my2_markers &lt;- my2_markers %&gt;% rownames_to_column(var = &quot;gene&quot;)
# Can we find mgnd genes? (Krasemann)
my2_markers %&gt;% filter(gene %in% mgnd &amp; avg_log2FC &gt; 0)
    gene        p_val avg_log2FC pct.1 pct.2    p_val_adj
1   SPP1 3.626442e-14  2.2989596 0.103 0.002 9.018961e-10
2 CXCL16 8.438072e-11  1.0379235 0.439 0.172 2.098549e-06
3   GPX3 3.358479e-10  0.4856146 0.112 0.010 8.352537e-06
4   CYBB 1.267019e-09  0.9216583 0.860 0.728 3.151077e-05
5 LILRB4 4.108097e-08  0.6611217 0.271 0.089 1.021684e-03
# genes in disease-assocaited microglia (Keren-Shaul)
my2_markers %&gt;% filter(gene %in% disease &amp; avg_log2FC &gt; 0)
    gene        p_val avg_log2FC pct.1 pct.2    p_val_adj
1    AXL 7.682308e-19  1.0183192 0.252 0.029 1.910590e-14
2   SPP1 3.626442e-14  2.2989596 0.103 0.002 9.018961e-10
3 LILRB4 4.108097e-08  0.6611217 0.271 0.089 1.021684e-03

# Sankowski
# microglia gene signature
microglia &lt;- c(&quot;P2RY12&quot;, &quot;CX3CR1&quot;, &quot;CSF1R&quot;, &quot;TMEM119&quot;, &quot;SLC2A5&quot; )

# monocyte gene signature
monocyte &lt;- c(&quot;CCR2&quot;, &quot;CLEC12A&quot;, &quot;PLAC8&quot;, &quot;FCN1&quot;, &quot;S100A9&quot;)

# homeostatic microlgia gene siganture
homeostatic &lt;- c(&quot;CX3CR1&quot;, &quot;TMEM119&quot;, &quot;CSF1R&quot;, &quot;P2RY12&quot;,
                 &quot;P2RY13&quot;,&quot;SELPLG&quot;, &quot;MARCKS&quot;)


my2_markers %&gt;% filter(gene %in% microglia &amp; avg_log2FC &gt; 0)
    gene        p_val avg_log2FC pct.1 pct.2    p_val_adj
1 SLC2A5 1.038249e-50  1.3177001 0.346 0.000 2.582126e-46
2 P2RY12 1.971868e-11  0.5465335 0.140 0.015 4.904036e-07
3  CSF1R 2.060436e-11  1.2036520 0.664 0.407 5.124303e-07
4 CX3CR1 1.359952e-04  0.5885714 0.439 0.271 1.000000e+00
my2_markers %&gt;% filter(gene %in% monocyte &amp; avg_log2FC &gt; 0)
[1] gene       p_val      avg_log2FC pct.1      pct.2      p_val_adj 
&lt;0 rows&gt; (or 0-length row.names)
my2_markers %&gt;% filter(gene %in% homeostatic &amp; avg_log2FC &gt; 0)
    gene        p_val avg_log2FC pct.1 pct.2    p_val_adj
1 MARCKS 3.672024e-12  1.1346931 0.664 0.363 9.132325e-08
2 P2RY12 1.971868e-11  0.5465335 0.140 0.015 4.904036e-07
3  CSF1R 2.060436e-11  1.2036520 0.664 0.407 5.124303e-07
4 CX3CR1 1.359952e-04  0.5885714 0.439 0.271 1.000000e+00


# Esaulova
# 10 genes that discriminate microglia
microglia &lt;- c(&quot;C1QC&quot;, &quot;C1QB&quot;, &quot;C1QA&quot;, &quot;TREM2&quot;, &quot;TIMD4&quot;, &quot;APOC1&quot;, 
               &quot;APOE&quot;, &quot;TNFSF18&quot;, &quot;CLEC9A&quot;, &quot;CXCL12&quot;)
# Can we find these 10 genes in the Myeloid2 upregulated genes?
my2_markers %&gt;% filter(gene %in% microglia &amp; avg_log2FC &gt; 0)
    gene         p_val avg_log2FC pct.1 pct.2     p_val_adj
1   C1QC 1.891156e-120  4.1160497 0.794 0.002 4.703305e-116
2   C1QB 8.023728e-114  4.1322588 0.860 0.026 1.995501e-109
3   APOE 4.641643e-108  3.5767082 0.720 0.002 1.154377e-103
4   C1QA  3.455807e-92  3.1390482 0.785 0.039  8.594593e-88
5  APOC1  2.142095e-53  2.0205009 0.402 0.006  5.327391e-49
6  TREM2  1.158412e-51  1.5152244 0.374 0.003  2.880971e-47
7  TIMD4  5.003322e-18  0.5471981 0.131 0.002  1.244326e-13
8 CLEC9A  1.921500e-06  0.4152332 0.112 0.021  4.778770e-02


# Glass
# 84 of the microglia signature genes are more highly expressed in the 
microglia_genes &lt;- read.table(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/Microglia_gene_signatur_found_in_HIV1_HIV2_samples&quot;)
m1 &lt;- my2_markers %&gt;% filter(gene %in% microglia_genes [[&quot;gene_name&quot;]] &amp; avg_log2FC &gt;0)
# remove the genes that were already used by the Farhadian paper
m1 &lt;- m1[[&quot;gene&quot;]][m1[[&quot;gene&quot;]] %in% paper == FALSE]

hiv_new &lt;- AddModuleScore(hiv4, features = m1)
FeaturePlot(hiv_new, features = &quot;Cluster1&quot;) +
  scale_colour_gradientn(colours = rev(brewer.pal(n = 11, name = &quot;RdBu&quot;))) +
    labs(title = &quot;Selected signature genes from the Glass paper&quot;)</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-60-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-60-1">
Past versions of unnamed-chunk-60-1.png
</button>
</p>
<div id="fig-unnamed-chunk-60-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-60-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-60-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-60-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="conclusions-on-myloid2-cell-type" class="section level2">
<h2>Conclusions on Myloid2 cell type</h2>
<p>Taken together the results above do not provide a clear picture on whether the Myeloid2 cluster consists of microglia-like cells. There are several genes which are associated with microglia and disease-associated microglia, several of which referred to by <span class="citation">(<a href="#ref-Farhadian" role="doc-biblioref">Shelli F. Farhadian and Spudich 2018</a>)</span>. Nevertheless, there are also many genes which are described to be microglia markers in the literature, but do not show a significantly higher expression in Myeloid2 than in the other Myeloid clusters. Therefore, the cluster will be considered microglia-like for now and the following analysis will provide additional insights on the identity and characteristics of this cluster.</p>
</div>
<div id="quality-of-different-samples-before-quality-control" class="section level2 tabset">
<h2 class="tabset">Quality of different samples before quality control</h2>
<div id="number-of-features" class="section level3">
<h3>Number of Features</h3>
<pre class="r"><code>
#have a look at the number of detected features
p1 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_boxplot(aes(x = orig.ident, y = nFeature_RNA, fill = orig.ident)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

p2 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_histogram(aes(x = nFeature_RNA, fill = orig.ident), bins = 100) +
  facet_wrap(~ orig.ident, ncol = 4) +
  NoLegend()

p3 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_violin(aes(x = orig.ident, y = nFeature_RNA, fill = orig.ident)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

p4 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_violin(aes(x = orig.ident, y = nFeature_RNA, fill = orig.ident)) +
  scale_y_log10() +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

figure &lt;- ggarrange(p1, p3, p4, p2, ncol = 2, nrow = 2)
annotate_figure(figure, top = text_grob(&quot;Number of Features&quot;,
                                        size = 25,  face = &quot;bold&quot;))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-61-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-61-1">
Past versions of unnamed-chunk-61-1.png
</button>
</p>
<div id="fig-unnamed-chunk-61-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-61-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-61-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-61-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>

hiv@meta.data %&gt;%
  rename(sample = orig.ident) %&gt;% 
  group_by(sample) %&gt;% 
  summarise(n = n(), q25 = quantile(nFeature_RNA, .25),
            q50 = quantile(nFeature_RNA, .5), 
            q75 = quantile(nFeature_RNA, .75), 
            mean = mean(nFeature_RNA)) %&gt;%
    kable(caption = &quot;Number of Features per sample&quot;)</code></pre>
<table>
<caption>Number of Features per sample</caption>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">n</th>
<th align="right">q25</th>
<th align="right">q50</th>
<th align="right">q75</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HIV1_Bld</td>
<td align="right">4998</td>
<td align="right">128</td>
<td align="right">458.0</td>
<td align="right">1021</td>
<td align="right">654.7989</td>
</tr>
<tr class="even">
<td align="left">HIV1_CSF</td>
<td align="right">4995</td>
<td align="right">16</td>
<td align="right">32.0</td>
<td align="right">341</td>
<td align="right">315.3642</td>
</tr>
<tr class="odd">
<td align="left">HIV2_Bld</td>
<td align="right">5000</td>
<td align="right">360</td>
<td align="right">581.0</td>
<td align="right">987</td>
<td align="right">738.4262</td>
</tr>
<tr class="even">
<td align="left">HIV2_CSF</td>
<td align="right">4996</td>
<td align="right">126</td>
<td align="right">584.5</td>
<td align="right">1087</td>
<td align="right">697.9960</td>
</tr>
<tr class="odd">
<td align="left">HIV3_CSF</td>
<td align="right">5000</td>
<td align="right">175</td>
<td align="right">309.0</td>
<td align="right">666</td>
<td align="right">542.9580</td>
</tr>
<tr class="even">
<td align="left">Uninfected1_CSF</td>
<td align="right">4994</td>
<td align="right">22</td>
<td align="right">44.0</td>
<td align="right">114</td>
<td align="right">151.0993</td>
</tr>
<tr class="odd">
<td align="left">Uninfected2_CSF</td>
<td align="right">4990</td>
<td align="right">31</td>
<td align="right">79.0</td>
<td align="right">206</td>
<td align="right">205.2401</td>
</tr>
</tbody>
</table>
</div>
<div id="library-size" class="section level3">
<h3>Library Size</h3>
<pre class="r"><code># have a look at the library size
p1 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_boxplot(aes(x = orig.ident, y = nCount_RNA, fill = orig.ident)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

p2 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_histogram(aes(x = nCount_RNA, fill = orig.ident), bins = 100) +
  facet_wrap(~ orig.ident, ncol = 4) +
  NoLegend()

p3 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_violin(aes(x = orig.ident, y = nCount_RNA, fill = orig.ident)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

p4 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_violin(aes(x = orig.ident, y = nCount_RNA, fill = orig.ident)) +
  scale_y_log10() +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()
  
figure &lt;- ggarrange(p1, p3, p4, p2, ncol = 2, nrow = 2)
annotate_figure(figure, top = text_grob(&quot;Library size (number of counts)&quot;,
                                        size = 25,  face = &quot;bold&quot;))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-62-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-62-1">
Past versions of unnamed-chunk-62-1.png
</button>
</p>
<div id="fig-unnamed-chunk-62-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-62-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-62-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-62-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>hiv@meta.data %&gt;%
  rename(sample = orig.ident) %&gt;% 
  group_by(sample) %&gt;% 
  summarise(n = n(), q25 = quantile( nCount_RNA, .25),
            q50 = quantile(nCount_RNA, .5), 
            q75 = quantile(nCount_RNA, .75), 
            mean = mean(nCount_RNA)) %&gt;% 
    kable(caption = &quot;Library size per sample&quot;)</code></pre>
<table>
<caption>Library size per sample</caption>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">n</th>
<th align="right">q25</th>
<th align="right">q50</th>
<th align="right">q75</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HIV1_Bld</td>
<td align="right">4998</td>
<td align="right">196</td>
<td align="right">772.0</td>
<td align="right">2098.00</td>
<td align="right">1424.6823</td>
</tr>
<tr class="even">
<td align="left">HIV1_CSF</td>
<td align="right">4995</td>
<td align="right">19</td>
<td align="right">39.0</td>
<td align="right">517.00</td>
<td align="right">648.8895</td>
</tr>
<tr class="odd">
<td align="left">HIV2_Bld</td>
<td align="right">5000</td>
<td align="right">577</td>
<td align="right">1006.0</td>
<td align="right">1970.50</td>
<td align="right">1523.0344</td>
</tr>
<tr class="even">
<td align="left">HIV2_CSF</td>
<td align="right">4996</td>
<td align="right">173</td>
<td align="right">929.0</td>
<td align="right">2053.25</td>
<td align="right">1369.0498</td>
</tr>
<tr class="odd">
<td align="left">HIV3_CSF</td>
<td align="right">5000</td>
<td align="right">238</td>
<td align="right">473.5</td>
<td align="right">1280.50</td>
<td align="right">1216.9344</td>
</tr>
<tr class="even">
<td align="left">Uninfected1_CSF</td>
<td align="right">4994</td>
<td align="right">26</td>
<td align="right">53.0</td>
<td align="right">146.00</td>
<td align="right">269.5036</td>
</tr>
<tr class="odd">
<td align="left">Uninfected2_CSF</td>
<td align="right">4990</td>
<td align="right">37</td>
<td align="right">96.5</td>
<td align="right">272.00</td>
<td align="right">356.2377</td>
</tr>
</tbody>
</table>
</div>
<div id="percentage-of-mitochondrial-genes" class="section level3">
<h3>Percentage of Mitochondrial genes</h3>
<pre class="r"><code># have a look at the percentage of mitochondrial genes
p1 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_boxplot(aes(x = orig.ident, y = percent_mt, fill = orig.ident)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

p2 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_histogram(aes(x = percent_mt, fill = orig.ident), bins = 100) +
  facet_wrap(~ orig.ident, ncol = 4) +
  NoLegend()

p3 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_violin(aes(x = orig.ident, y = percent_mt, fill = orig.ident)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

p4 &lt;- hiv@meta.data %&gt;% 
  ggplot() +
  geom_violin(aes(x = orig.ident, y = percent_mt, fill = orig.ident)) +
  scale_y_log10() +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()
  
figure &lt;- ggarrange(p1, p3, p4, p2, ncol = 2, nrow = 2)
Warning: Transformation introduced infinite values in continuous y-axis
Warning: Removed 2014 rows containing non-finite values (stat_ydensity).
annotate_figure(figure, top = text_grob(&quot;Percentage of Mitochondrial gene&quot;,
                                        size = 25,  face = &quot;bold&quot;))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-63-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-63-1">
Past versions of unnamed-chunk-63-1.png
</button>
</p>
<div id="fig-unnamed-chunk-63-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-63-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-63-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-63-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>
hiv@meta.data %&gt;%
  rename(sample = orig.ident) %&gt;% 
  group_by(sample) %&gt;% 
  summarise(n = n(), q25 = quantile( percent_mt, .25),
            q50 = quantile(percent_mt, .5), 
            q75 = quantile(percent_mt, .75), 
            mean = mean(percent_mt)) %&gt;% 
    kable(caption = &quot;Percentage of mitochondrial genes per sample&quot;)</code></pre>
<table>
<caption>Percentage of mitochondrial genes per sample</caption>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">n</th>
<th align="right">q25</th>
<th align="right">q50</th>
<th align="right">q75</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HIV1_Bld</td>
<td align="right">4998</td>
<td align="right">6.140696</td>
<td align="right">10.314638</td>
<td align="right">16.83490</td>
<td align="right">13.746867</td>
</tr>
<tr class="even">
<td align="left">HIV1_CSF</td>
<td align="right">4995</td>
<td align="right">4.000000</td>
<td align="right">8.522727</td>
<td align="right">15.38462</td>
<td align="right">12.092172</td>
</tr>
<tr class="odd">
<td align="left">HIV2_Bld</td>
<td align="right">5000</td>
<td align="right">9.558731</td>
<td align="right">14.370956</td>
<td align="right">20.53664</td>
<td align="right">16.562072</td>
</tr>
<tr class="even">
<td align="left">HIV2_CSF</td>
<td align="right">4996</td>
<td align="right">7.387619</td>
<td align="right">11.188337</td>
<td align="right">16.68489</td>
<td align="right">13.814837</td>
</tr>
<tr class="odd">
<td align="left">HIV3_CSF</td>
<td align="right">5000</td>
<td align="right">2.590861</td>
<td align="right">4.413543</td>
<td align="right">7.26931</td>
<td align="right">5.785039</td>
</tr>
<tr class="even">
<td align="left">Uninfected1_CSF</td>
<td align="right">4994</td>
<td align="right">4.165372</td>
<td align="right">8.333333</td>
<td align="right">14.70588</td>
<td align="right">10.832587</td>
</tr>
<tr class="odd">
<td align="left">Uninfected2_CSF</td>
<td align="right">4990</td>
<td align="right">3.675874</td>
<td align="right">7.462687</td>
<td align="right">12.73541</td>
<td align="right">9.618704</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-3" class="section level2 unnumbered">
<h2 class="unnumbered"></h2>
</div>
<div id="quality-of-the-different-samples-after-quality-control" class="section level2 tabset">
<h2 class="tabset">Quality of the different samples after quality control</h2>
<p>It seems that the CSF1 samples, as well as the two uninfected samples have very few cells with nFeature_RNA &gt; 500, so we are left with less cells from these samples</p>
<div id="number-of-features-1" class="section level3">
<h3>Number of features</h3>
<pre class="r"><code>
# Have a look at the number of Feature RNA
p1 &lt;- hiv_filt@meta.data %&gt;%
  ggplot() +
  geom_boxplot(aes(x = orig.ident, y = nFeature_RNA, fill = orig.ident)) +
  NoLegend()

p2 &lt;- hiv_filt@meta.data %&gt;% 
  ggplot()+
  geom_violin(aes(x = orig.ident, y = nFeature_RNA, fill = orig.ident)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

p3 &lt;- hiv_filt@meta.data %&gt;% 
  ggplot() +
  geom_histogram(aes(x = nFeature_RNA, fill = orig.ident)) +
  facet_wrap(~orig.ident, ncol = 4) +
  NoLegend()

figure &lt;- ggarrange(p1, p2, p3, ncol = 2, nrow = 2)
annotate_figure(figure, top = text_grob(&quot;Number of features after quality control&quot;,
                                        size = 25,  face = &quot;bold&quot;))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-64-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-64-1">
Past versions of unnamed-chunk-64-1.png
</button>
</p>
<div id="fig-unnamed-chunk-64-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-64-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-64-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-64-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>
hiv_filt@meta.data %&gt;% 
  rename(sample = orig.ident) %&gt;% 
  group_by(sample) %&gt;%
  summarise(n = n(), q25 = quantile(nFeature_RNA, .25),
            q50 = quantile(nFeature_RNA, .5),
            q75 = quantile(nFeature_RNA, .75),
            mean = mean(nFeature_RNA)) %&gt;%
    kable(caption = &quot;Number of Features per sample after quality control&quot;)</code></pre>
<table>
<caption>Number of Features per sample after quality control</caption>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">n</th>
<th align="right">q25</th>
<th align="right">q50</th>
<th align="right">q75</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HIV1_Bld</td>
<td align="right">2076</td>
<td align="right">786.75</td>
<td align="right">1053.0</td>
<td align="right">1413.25</td>
<td align="right">1140.157</td>
</tr>
<tr class="even">
<td align="left">HIV1_CSF</td>
<td align="right">932</td>
<td align="right">800.00</td>
<td align="right">1077.0</td>
<td align="right">1395.00</td>
<td align="right">1142.855</td>
</tr>
<tr class="odd">
<td align="left">HIV2_Bld</td>
<td align="right">2520</td>
<td align="right">672.00</td>
<td align="right">914.0</td>
<td align="right">1277.00</td>
<td align="right">1023.094</td>
</tr>
<tr class="even">
<td align="left">HIV2_CSF</td>
<td align="right">2309</td>
<td align="right">809.00</td>
<td align="right">1063.0</td>
<td align="right">1359.00</td>
<td align="right">1129.844</td>
</tr>
<tr class="odd">
<td align="left">HIV3_CSF</td>
<td align="right">1384</td>
<td align="right">703.00</td>
<td align="right">1091.0</td>
<td align="right">1492.25</td>
<td align="right">1153.576</td>
</tr>
<tr class="even">
<td align="left">Uninfected1_CSF</td>
<td align="right">216</td>
<td align="right">672.50</td>
<td align="right">887.5</td>
<td align="right">1526.00</td>
<td align="right">1133.796</td>
</tr>
<tr class="odd">
<td align="left">Uninfected2_CSF</td>
<td align="right">340</td>
<td align="right">670.50</td>
<td align="right">1066.5</td>
<td align="right">1606.00</td>
<td align="right">1155.576</td>
</tr>
</tbody>
</table>
</div>
<div id="library-size-1" class="section level3">
<h3>Library size</h3>
<pre class="r"><code>p1 &lt;- hiv_filt@meta.data %&gt;%
  ggplot() +
  geom_boxplot(aes(x = orig.ident, y = nCount_RNA, fill = orig.ident)) +
  NoLegend()

p2 &lt;- hiv_filt@meta.data %&gt;% 
  ggplot()+
  geom_violin(aes(x = orig.ident, y = nCount_RNA, fill = orig.ident)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

p3 &lt;- hiv_filt@meta.data %&gt;% 
  ggplot() +
  geom_histogram(aes(x = nCount_RNA, fill = orig.ident)) +
  facet_wrap(~orig.ident, ncol = 4) +
  NoLegend()

figure &lt;- ggarrange(p1, p2, p3, ncol = 2, nrow = 2)
annotate_figure(figure, top = text_grob(&quot;Library size (number of counts) after quality control&quot;,
                                        size = 25,  face = &quot;bold&quot;))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-65-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-65-1">
Past versions of unnamed-chunk-65-1.png
</button>
</p>
<div id="fig-unnamed-chunk-65-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-65-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-65-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-65-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>
hiv_filt@meta.data %&gt;% 
  rename(sample = orig.ident) %&gt;% 
  group_by(sample) %&gt;%
  summarise(n = n(), q25 = quantile(nCount_RNA, .25),
            q50 = quantile(nCount_RNA, .5),
            q75 = quantile(nCount_RNA, .75),
            mean = mean(nCount_RNA)) %&gt;%
  kable(caption = &quot;Library size per sample after quality control&quot;)</code></pre>
<table>
<caption>Library size per sample after quality control</caption>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">n</th>
<th align="right">q25</th>
<th align="right">q50</th>
<th align="right">q75</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HIV1_Bld</td>
<td align="right">2076</td>
<td align="right">1458.75</td>
<td align="right">2179.5</td>
<td align="right">3264.25</td>
<td align="right">2522.768</td>
</tr>
<tr class="even">
<td align="left">HIV1_CSF</td>
<td align="right">932</td>
<td align="right">1410.75</td>
<td align="right">2102.5</td>
<td align="right">3066.75</td>
<td align="right">2378.643</td>
</tr>
<tr class="odd">
<td align="left">HIV2_Bld</td>
<td align="right">2520</td>
<td align="right">1187.50</td>
<td align="right">1779.5</td>
<td align="right">2822.25</td>
<td align="right">2158.089</td>
</tr>
<tr class="even">
<td align="left">HIV2_CSF</td>
<td align="right">2309</td>
<td align="right">1374.00</td>
<td align="right">1984.0</td>
<td align="right">2745.00</td>
<td align="right">2222.453</td>
</tr>
<tr class="odd">
<td align="left">HIV3_CSF</td>
<td align="right">1384</td>
<td align="right">1377.25</td>
<td align="right">2381.5</td>
<td align="right">3845.25</td>
<td align="right">2842.006</td>
</tr>
<tr class="even">
<td align="left">Uninfected1_CSF</td>
<td align="right">216</td>
<td align="right">1063.25</td>
<td align="right">1491.5</td>
<td align="right">2968.75</td>
<td align="right">2177.278</td>
</tr>
<tr class="odd">
<td align="left">Uninfected2_CSF</td>
<td align="right">340</td>
<td align="right">1063.50</td>
<td align="right">1876.0</td>
<td align="right">3399.50</td>
<td align="right">2328.871</td>
</tr>
</tbody>
</table>
</div>
<div id="percentage-of-mitochondrial-genes-1" class="section level3">
<h3>Percentage of Mitochondrial genes</h3>
<pre class="r"><code>p1 &lt;- hiv_filt@meta.data %&gt;%
  ggplot() +
  geom_boxplot(aes(x = orig.ident, y = percent_mt, fill = orig.ident)) +
  NoLegend()

p2 &lt;- hiv_filt@meta.data %&gt;% 
  ggplot()+
  geom_violin(aes(x = orig.ident, y = percent_mt, fill = orig.ident)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.8, hjust = 1)) +
  NoLegend()

p3 &lt;- hiv_filt@meta.data %&gt;% 
  ggplot() +
  geom_histogram(aes(x = percent_mt, fill = orig.ident)) +
  facet_wrap(~orig.ident, ncol = 4) +
  NoLegend()

figure &lt;- ggarrange(p1, p2, p3, ncol = 2, nrow = 2)
annotate_figure(figure, top = text_grob(&quot;Percentage of Mitochondrial genes after quality control&quot;,
                                        size = 25,  face = &quot;bold&quot;))</code></pre>
<p><img src="figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-66-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-66-1">
Past versions of unnamed-chunk-66-1.png
</button>
</p>
<div id="fig-unnamed-chunk-66-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-66-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/2be0932ddfed52b8d9f4a4086763fe9eeb4602b0/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-66-1.png" target="_blank">2be0932</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/b315085a0df3faa48f8d2e2a07393671e6e80b97/docs/figure/HIV_CSF_dataset_analysis.Rmd/unnamed-chunk-66-1.png" target="_blank">b315085</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>
hiv_filt@meta.data %&gt;% 
  rename(sample = orig.ident) %&gt;% 
  group_by(sample) %&gt;%
  summarise(n = n(), q25 = quantile(percent_mt, .25),
            q50 = quantile(percent_mt, .5),
            q75 = quantile(percent_mt, .75),
            mean = mean(percent_mt)) %&gt;% 
    kable(caption = &quot;Percentage of mitochondrial genes per sample after quality control&quot;)</code></pre>
<table>
<caption>Percentage of mitochondrial genes per sample after quality control</caption>
<thead>
<tr class="header">
<th align="left">sample</th>
<th align="right">n</th>
<th align="right">q25</th>
<th align="right">q50</th>
<th align="right">q75</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HIV1_Bld</td>
<td align="right">2076</td>
<td align="right">5.659778</td>
<td align="right">8.616470</td>
<td align="right">12.057771</td>
<td align="right">9.006083</td>
</tr>
<tr class="even">
<td align="left">HIV1_CSF</td>
<td align="right">932</td>
<td align="right">5.067679</td>
<td align="right">7.526483</td>
<td align="right">10.327807</td>
<td align="right">7.820102</td>
</tr>
<tr class="odd">
<td align="left">HIV2_Bld</td>
<td align="right">2520</td>
<td align="right">8.428856</td>
<td align="right">12.017682</td>
<td align="right">15.653130</td>
<td align="right">12.183780</td>
</tr>
<tr class="even">
<td align="left">HIV2_CSF</td>
<td align="right">2309</td>
<td align="right">7.420091</td>
<td align="right">10.051282</td>
<td align="right">13.119900</td>
<td align="right">10.296168</td>
</tr>
<tr class="odd">
<td align="left">HIV3_CSF</td>
<td align="right">1384</td>
<td align="right">2.045621</td>
<td align="right">3.169997</td>
<td align="right">4.804080</td>
<td align="right">3.582988</td>
</tr>
<tr class="even">
<td align="left">Uninfected1_CSF</td>
<td align="right">216</td>
<td align="right">4.339334</td>
<td align="right">5.927984</td>
<td align="right">8.122936</td>
<td align="right">6.373704</td>
</tr>
<tr class="odd">
<td align="left">Uninfected2_CSF</td>
<td align="right">340</td>
<td align="right">3.683668</td>
<td align="right">5.999618</td>
<td align="right">8.409969</td>
<td align="right">6.088557</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-4" class="section level2 unnumbered">
<h2 class="unnumbered">##</h2>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gosselin" class="csl-entry">
David Gosselin, Nicole G. Coufal, Dylan Skola. 2020. <em>Single-Cell RNA Sequencing Reveals Microglia-Like Cells in Cerebrospinal Fluid During Virologically Suppressed HIV</em>. <em>JNEUROSCI</em>. Vol. 356, 1248. <a href="https://DOI: 10.1126/science.aal3222">DOI: 10.1126/science.aal3222</a>.
</div>
<div id="ref-Esaulova" class="csl-entry">
Ekaterina Esaulova, Irina Shchukina, Claudia Cantoni. 2020. <em>Single-Cell RNA-Seq Analysis of Human CSF Microglia and Myeloid Cells in Neuroinflammation</em>. <em>Nat Neurosci</em>. Vol. 7:e732. <a href="https://doi:10.1212/NXI.0000000000000732">doi:10.1212/NXI.0000000000000732</a>.
</div>
<div id="ref-Grassivaro" class="csl-entry">
Francesca Grassivaro, Massimo Acquaviva, Ramesh Menon, and Gianvito Martino. 2018. <em>Convergence Between Microglia and Peripheral Macrophages Phenotype During Development and Neuroinflammation</em>. <em>JCI Insight</em>. Vol. 40 (4). <a href="https://doi.org/10.1523/JNEUROSCI.1523-19.2019">https://doi.org/10.1523/JNEUROSCI.1523-19.2019</a>.
</div>
<div id="ref-Keren-Shaul" class="csl-entry">
Hadas Keren-Shaul, Assaf Weiner, Amit Spinrad. 2017. <em>A Unique Microglia Type Associated with Restricting Development of Alzheimer’s Disease</em>. <em>Cell</em>. Vol. 169. <a href="http://dx.doi.org/10.1016/j.cell.2017.05.018">http://dx.doi.org/10.1016/j.cell.2017.05.018</a>.
</div>
<div id="ref-Sankowski" class="csl-entry">
Roman Sankowski, Takahiro Masuda, Chotima Böttcher. 2019. <em>Mapping Microglia States in the Human Brain Through the Integration of High-Dimensional Techniques.</em> <em>Nat. Neurosci.</em> Vol. 22. <a href="https://doi.org/10.1038/s41593-019-0532-y">https://doi.org/10.1038/s41593-019-0532-y</a>.
</div>
<div id="ref-Farhadian" class="csl-entry">
Shelli F. Farhadian, Chrysoula Zografou, Sameet S. Mehta, and Serena S. Spudich. 2018. <em>Single-Cell RNA Sequencing Reveals Microglia-Like Cells in Cerebrospinal Fluid During Virologically Suppressed HIV</em>. <em>JCI Insight</em>. Vol. 3(18):e121718. <a href="https://doi.org/10.1172/jci.insight.121718">https://doi.org/10.1172/jci.insight.121718</a>.
</div>
<div id="ref-Kraseman" class="csl-entry">
Susanne Krasemann, Ron Cialic, Charlotte Madore. 2017. <em>The Trem2-APOE Pathway Drives the Transcriptional Phenotype of Dysfunctional Microglia in Neurodegenerative Diseases</em>. <em>Immunity</em>. Vol. 47. <a href="http://dx.doi.org/10.1016/j.immuni.2017.08.008">http://dx.doi.org/10.1016/j.immuni.2017.08.008</a>.
</div>
</div>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()
R version 4.0.2 (2020-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.3.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] parallel  grid      stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] patchwork_1.1.1       SeuratDisk_0.0.0.9019 harmony_0.1.0        
 [4] Rcpp_1.0.7            readxl_1.3.1          multtest_2.46.0      
 [7] Biobase_2.50.0        BiocGenerics_0.36.1   metap_1.6            
[10] knitr_1.30            rstatix_0.6.0         corrplot_0.92        
[13] gridExtra_2.3         ggpubr_0.4.0          circlize_0.4.13      
[16] ComplexHeatmap_2.9.4  ggcorrplot_0.1.3      pheatmap_1.0.12      
[19] RColorBrewer_1.1-2    ggrepel_0.9.1         data.table_1.14.2    
[22] Matrix_1.3-4          edgeR_3.32.0          limma_3.46.0         
[25] SeuratObject_4.0.3    Seurat_4.0.5          forcats_0.5.0        
[28] stringr_1.4.0         dplyr_1.0.7           purrr_0.3.4          
[31] readr_1.4.0           tidyr_1.1.2           tibble_3.1.6         
[34] ggplot2_3.3.5         tidyverse_1.3.0       workflowr_1.6.2      

loaded via a namespace (and not attached):
  [1] utf8_1.2.2            reticulate_1.22       tidyselect_1.1.1     
  [4] htmlwidgets_1.5.4     Rtsne_0.15            munsell_0.5.0        
  [7] mutoss_0.1-12         codetools_0.2-18      ica_1.0-2            
 [10] future_1.23.0         miniUI_0.1.1.1        withr_2.4.3          
 [13] colorspace_2.0-2      highr_0.8             rstudioapi_0.13      
 [16] stats4_4.0.2          ROCR_1.0-11           ggsignif_0.6.0       
 [19] tensor_1.5            listenv_0.8.0         labeling_0.4.2       
 [22] Rdpack_2.1.2          git2r_0.27.1          mnormt_2.0.2         
 [25] polyclip_1.10-0       farver_2.1.0          bit64_4.0.5          
 [28] rprojroot_2.0.2       TH.data_1.0-10        parallelly_1.29.0    
 [31] vctrs_0.3.8           generics_0.1.1        xfun_0.29            
 [34] R6_2.5.1              doParallel_1.0.16     clue_0.3-60          
 [37] locfit_1.5-9.4        hdf5r_1.3.3           spatstat.utils_2.2-0 
 [40] assertthat_0.2.1      promises_1.2.0.1      scales_1.1.1         
 [43] multcomp_1.4-15       gtable_0.3.0          globals_0.14.0       
 [46] goftest_1.2-3         sandwich_3.0-0        rlang_0.4.12         
 [49] GlobalOptions_0.1.2   splines_4.0.2         lazyeval_0.2.2       
 [52] spatstat.geom_2.3-0   broom_0.7.2           yaml_2.2.1           
 [55] reshape2_1.4.4        abind_1.4-5           modelr_0.1.8         
 [58] backports_1.2.0       httpuv_1.6.3          tools_4.0.2          
 [61] ellipsis_0.3.2        spatstat.core_2.3-1   ggridges_0.5.2       
 [64] TFisher_0.2.0         plyr_1.8.6            comprehenr_0.6.10    
 [67] rpart_4.1-15          deldir_1.0-6          pbapply_1.5-0        
 [70] GetoptLong_1.0.5      cowplot_1.1.1         S4Vectors_0.28.1     
 [73] zoo_1.8-9             haven_2.3.1           cluster_2.1.0        
 [76] fs_1.5.1              magrittr_2.0.1        RSpectra_0.16-0      
 [79] scattermore_0.7       openxlsx_4.2.3        lmtest_0.9-39        
 [82] reprex_0.3.0          RANN_2.6.1            tmvnsim_1.0-2        
 [85] mvtnorm_1.1-1         whisker_0.4           fitdistrplus_1.1-6   
 [88] matrixStats_0.61.0    hms_1.1.1             mime_0.12            
 [91] evaluate_0.14         xtable_1.8-4          rio_0.5.16           
 [94] IRanges_2.24.1        shape_1.4.6           compiler_4.0.2       
 [97] KernSmooth_2.23-18    crayon_1.4.2          htmltools_0.5.2      
[100] mgcv_1.8-33           later_1.3.0           lubridate_1.7.9.2    
[103] DBI_1.1.1             dbplyr_2.0.0          MASS_7.3-53          
[106] car_3.0-10            cli_3.1.0             rbibutils_2.2.4      
[109] igraph_1.2.9          pkgconfig_2.0.3       sn_2.0.1             
[112] numDeriv_2016.8-1.1   foreign_0.8-80        plotly_4.9.2.1       
[115] spatstat.sparse_2.0-0 xml2_1.3.2            foreach_1.5.1        
[118] rvest_0.3.6           digest_0.6.29         sctransform_0.3.2    
[121] RcppAnnoy_0.0.19      spatstat.data_2.1-0   rmarkdown_2.6        
[124] cellranger_1.1.0      leiden_0.3.5          uwot_0.1.10          
[127] curl_4.3.2            shiny_1.7.1           rjson_0.2.20         
[130] lifecycle_1.0.1       nlme_3.1-150          jsonlite_1.7.2       
[133] carData_3.0-4         viridisLite_0.4.0     fansi_0.5.0          
[136] pillar_1.6.4          lattice_0.20-41       plotrix_3.8-2        
[139] fastmap_1.1.0         httr_1.4.2            survival_3.2-7       
[142] glue_1.5.1            zip_2.1.1             png_0.1-7            
[145] iterators_1.0.13      bit_4.0.4             stringi_1.7.6        
[148] mathjaxr_1.4-0        irlba_2.3.3           future.apply_1.8.1   </code></pre>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQW5hbHlzaXMgb2YgSElWIENTRi9CbG9vZCBkYXRhc2V0IgphdXRob3I6ICJrbWlrdWxpayIKZGF0ZTogIjMgMTIgMjAyMSIKYmlibGlvZ3JhcGh5OiByZWZlcmVuY2VzLmJpYgpsaW5rLWNpdGF0aW9uczogeWVzCi0tLQoKPHN0eWxlPgpib2R5IHsKdGV4dC1hbGlnbjoganVzdGlmeX0KPC9zdHlsZT4KCgpgYGB7ciBzZXR1cCwgaW5jbHVkZSA9IEZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoY2FjaGUgPSBGQUxTRSwgYXV0b2RlcCA9IFRSVUUsIAogICAgICAgICAgICAgICAgICAgICAgY29sbGFwc2UgPSBUUlVFLCBtZXNzYWdlID0gRkFMU0UpCgpzZXQuc2VlZCg0MikKYGBgCgpgYGB7cn0Kc2V0d2QoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvcmVwb3J0LyIpCmBgYAoKCmBgYHtyfQpsaWJyYXJ5KHRpZHl2ZXJzZSkKbGlicmFyeShTZXVyYXQpCmxpYnJhcnkoZWRnZVIpCmxpYnJhcnkoTWF0cml4KQpsaWJyYXJ5KGRhdGEudGFibGUpCmxpYnJhcnkoZ2dwbG90MikKbGlicmFyeShkcGx5cikKbGlicmFyeShnZ3JlcGVsKQpsaWJyYXJ5KFJDb2xvckJyZXdlcikKbGlicmFyeShwaGVhdG1hcCkKbGlicmFyeShnZ2NvcnJwbG90KQpsaWJyYXJ5KENvbXBsZXhIZWF0bWFwKQpsaWJyYXJ5KGNpcmNsaXplKQpsaWJyYXJ5KGdncHVicikKbGlicmFyeShncmlkRXh0cmEpCmxpYnJhcnkoY29ycnBsb3QpCmxpYnJhcnkocnN0YXRpeCkKbGlicmFyeShrbml0cikKbGlicmFyeShtZXRhcCkKbGlicmFyeShtdWx0dGVzdCkKbGlicmFyeShyZWFkeGwpCmxpYnJhcnkoaGFybW9ueSkKbGlicmFyeShTZXVyYXREaXNrKQpsaWJyYXJ5KHBhdGNod29yaykKYGBgCgpGaXJzdCwgdGhlIGFuYWx5c2lzIGRvbmUgYnkgW0BGYXJoYWRpYW5dIHdhcyByZXByb2R1Y2VkIGFuZCB0aGVuIG1vcmUgZXh0ZW5kZWQKYW5hbHlzaXMgb2YgdGhlIGRhdGFzZXQgd2FzIHBlcmZvcm1lZC4gVGhlIG1pY3JvZ2xpYS1saWtlIGNlbGwgY2x1c3RlciBpZGVudGlmaWVkCmJ5IFtARmFyaGFkaWFuXSB3YXMgb2YgcGFydGljdWxhciBpbnRlcmVzdC4KClRoZSBkYXRhc2V0IGluY2x1ZGVkIHRocmVlIENTRiBzYW1wbGVzIGZyb20gSElWIGluZmVjdGVkIHBhdGllbnRzLCB0d28gYmxvb2QgCnNhbXBsZXMgZnJvbSBISVYgaW5mZWN0ZWQgcGF0aWVudHMsIGFzIHdlbGwgYXMsIHR3byBDU0Ygc2FtcGxlcyBmcm9tIHVuaW5mZWN0ZWQKcGF0aWVudHMuIFtARmFyaGFkaWFuXSBmaXJzdCB1c2VkIHR3byBDU0YgYW5kIHR3byBibG9vZHMgc2FtcGxlcyBmcm9tIGluZmVjdGVkCnBhdGllbnRzIGZvciBjbHVzdGVyaW5nIGFuZCBjZWxsIHR5cGUgYW5ub3RhdGlvbi4gQWZ0ZXIgaGF2aW5nIGlkZW50aWZpZWQgYSAKbm92ZWwgc3ViY2x1c3RlciBvZiBteWVsb2lkIGNlbGxzLCB3aGljaCB0aGV5IHByb3Bvc2UgYXJlIG1pY3JvZ2xpYS1saWtlLCB0aGV5IAp0aGVuIGNvbmZpcm0gdGhlaXIgcmVzdWx0cyB1c2luZyB0aGUgdGhpcmQgQ1NGIHNhbXBsZXMgZnJvbSBhbiBpbmZlY3RlZCBwYXRpZW50LgpBZGRpdGlvbmFsbHksIHRoZXkgY29tcGFyZSB0aGUgbnVtYmVyIG9mIE15ZWxvaWQyLXNwZWNpZmljIHRyYW5zY3JpcHRzIHRvIAp0aGUgQ1NGIHNhbXBsZXMgZnJvbSB1bmluZmVjdGVkIHBhdGllbnRzLiBUaGV5IHNob3cgdGhhdCB0aGUgcGVyY2VudGFnZSBvZiBNeWVsb2lkMgp0cmFuc2NyaXB0cyB3YXMgaGlnaGVyIGluIENTRiBmcm9tIGluZmVjdGVkIHBhdGllbnRzIHRoYW4gaW4gQ1NGIGZyb20gdW5pbmZlY3RlZApwYXRpZW50cyBhbmQgaGlnaGVyIGluIENTRiB0aGFuIGluIGJsb29kIGluIGdlbmVyYWwuIAoKQmxvb2QgYW5kIENTRiB3ZXJlIHByb2Nlc3NlZCBzZXBhcmF0ZWx5IGZvciBzY1JOQXNlcSB1c2luZyBTZXFXZWxsLiBUaGUgc2V2ZW4Kc2FtcGxlcyB3ZXJlIHNlcXVlbmNlZCBzZXBhcmF0ZWx5LCBvbmUgU2VxV2VsbCBhcnJheSBwZXIgQ1NGIG9yIFBCTUMgc2FtcGxlCltARmFyaGFkaWFuXS4KCkZvciBtb3JlIGRldGFpbHMgc2VlIFtARmFyaGFkaWFuXS4KCkZpcnN0LCB0aGUgZm9sbG93aW5nIGFuYWx5c2lzIHN0ZXBzIHdlcmUgcGVyZm9ybWVkIHNpbWlsYXIgYXMgaW4gdGhlIHBhcGVyOgoKPC9kZXRhaWxzPgoKPGRldGFpbHM+IAo8c3VtbWFyeT5JbXBvcnRpbmcgZmlsZXMgJiBjcmVhdGluZyBTZXVyYXQgb2JqZWN0czwvc3VtbWFyeT4KCioqUmVhZCBpbiBkYXRhKGNvdW50IG1hdHJpY2VzKSoqClRoZSBkYXRhIGlzIGF2YWlsYWJsZSB1bmRlciBodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L2dlby9xdWVyeS9hY2MuY2dpP2FjYz1HU0UxMTczOTcuClRoZXJlIGlzIG9uZSBjb3VudCBtYXRyaXggZm9yIGVhY2ggb2YgdGhlIDcgc2FtcGxlcy4KCmBgYApwYXRoIDwtICIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvZGF0YS9HU0UxMTczOTdfUkFXICgxKS8iCmFsbF9maWxlcyA8LSBsaXN0LmZpbGVzKHBhdGgpCgojRnVuY3Rpb24gdG8gY3JlYXRlIGEgc3BhcnNlIG1hdHJpeCBmcm9tIGVhY2ggb2YgdGhlIGRhdGFmcmFtZXMKc3BhcnNlX21hdHJpeF9mcm9tX2RmIDwtIGZ1bmN0aW9uKGRmKSB7CiAgI3ByaW50KGRmKQogICNjbGFzcyhkZikKICBnZW5lcyA8LSBkZiRHRU5FCiAgZGZfbWludXMgPC0gZGZbLC0xXQogICNtYXRyaXggPC0gYXMubWF0cml4KGRmX21pbnVzKQogIHNwYXJzZV9tYXRyaXggPC0gYXMuc3BhcnNlKGRmX21pbnVzKQogIHJvd25hbWVzKHNwYXJzZV9tYXRyaXgpIDwtIGdlbmVzCiAgcmV0dXJuKHNwYXJzZV9tYXRyaXgpCn0KCmhpdl9vYmplY3RfbGlzdCA8LSBtYXAoc2VxLmludCgyLDYpLCBmdW5jdGlvbihuKSB7CiAgZmlsZSA8LSBhbGxfZmlsZXNbZ3JlcGwocGFzdGUwKCJHU00zMjkzODIiLCBuKSwgYWxsX2ZpbGVzKV0KICBuYW1lIDwtIHN0cl9leHRyYWN0KGZpbGUsICJISVZbMS0zXV9cXHd7M30iKQogIGRmIDwtIHJlYWRfZGVsaW0ocGFzdGUwKHBhdGgsIGZpbGUpLCBkZWxpbSA9ICJcdCIpCiAgc3BhcnNlX21hdHJpeCA8LSBzcGFyc2VfbWF0cml4X2Zyb21fZGYoZGYpCiAgc2V1cmF0X29iIDwtIENyZWF0ZVNldXJhdE9iamVjdChzcGFyc2VfbWF0cml4LCBwcm9qZWN0ID0gbmFtZSwgCiAgICAgICAgICAgICAgICAgICAgIGFzc2F5ID0gIlJOQSIsIG1pbi5jZWxscyA9IDEsCiAgICAgICAgICAgICAgICAgICAgIG1pbi5mZWF0dXJlcyA9IDEpCiAgbGlzdChkZj1kZiwgc3BhcnNlX21hdHJpeCA9IHNwYXJzZV9tYXRyaXgsIHNldXJhdF9vYiA9IHNldXJhdF9vYiwgbmFtZT1uYW1lKQp9KQoKdW5pbmZlY3RlZF9saXN0IDwtIG1hcChzZXEuaW50KDcsOCksIGZ1bmN0aW9uKG4pIHsKICBmaWxlIDwtIGFsbF9maWxlc1tncmVwbChwYXN0ZTAoIkdTTTMyOTM4MiIsIG4pLCBhbGxfZmlsZXMpXQogIG5hbWUgPC0gc3RyX2V4dHJhY3QoZmlsZSwgIlVuaW5mZWN0ZWRbMTJdX0NTRiIpCiAgZGYgPC0gcmVhZF9kZWxpbShwYXN0ZTAocGF0aCwgZmlsZSksIGRlbGltID0gIlx0IikKICBzcGFyc2VfbWF0cml4IDwtIHNwYXJzZV9tYXRyaXhfZnJvbV9kZihkZikKICBzZXVyYXRfb2IgPC0gQ3JlYXRlU2V1cmF0T2JqZWN0KHNwYXJzZV9tYXRyaXgsIHByb2plY3QgPSBuYW1lLCAKICAgICAgICAgICAgICAgICAgICAgYXNzYXkgPSAiUk5BIiwgbWluLmNlbGxzID0gMSwKICAgICAgICAgICAgICAgICAgICAgbWluLmZlYXR1cmVzID0gMSwgdmVyYm9zZSA9IEZBTFNFKQogIGxpc3QoZGY9ZGYsIHNwYXJzZV9tYXRyaXggPSBzcGFyc2VfbWF0cml4LCBzZXVyYXRfb2IgPSBzZXVyYXRfb2IsIG5hbWU9bmFtZSkKfSkKCiN3cml0ZS50YWJsZSh1bmluZmVjdGVkX2xpc3RbWzFdXSRzcGFyc2VfbWF0cml4LAogIyAgICAgICAgICAgIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvam9iX3Rlc3QudHN2IiwgCiAgIyAgICAgICAgICBzZXAgPSAiXHQiKQpgYGAKCioqQ3JlYXRlIG9uZSBTZXVyYXQgb2JqZWN0IHdpdGggYWxsIHNhbXBsZXMqKgoKYGBgCgpoaXYgPC0gbWVyZ2UoaGl2X29iamVjdF9saXN0W1sxXV0kc2V1cmF0X29iLCAKICAgICAgICAgICAgICAgICAgIGMoaGl2X29iamVjdF9saXN0W1syXV0kc2V1cmF0X29iLAogICAgICAgICAgICAgICAgICAgICBoaXZfb2JqZWN0X2xpc3RbWzNdXSRzZXVyYXRfb2IsCiAgICAgICAgICAgICAgICAgICAgIGhpdl9vYmplY3RfbGlzdFtbNF1dJHNldXJhdF9vYiwKICAgICAgICAgICAgICAgICAgICAgaGl2X29iamVjdF9saXN0W1s1XV0kc2V1cmF0X29iLCAKICAgICAgICAgICAgICAgICAgICAgdW5pbmZlY3RlZF9saXN0W1sxXV0kc2V1cmF0X29iLAogICAgICAgICAgICAgICAgICAgICB1bmluZmVjdGVkX2xpc3RbWzJdXSRzZXVyYXRfb2IpLCAKICAgICAgICAgICAgICAgICAgIHByb2plY3QgPSAiaGl2X3RvdGFsIiwKICAgICAgICAgICAgICAgICAgIGFkZC5jZWxsLmlkcyA9IGMoIjFCIiwgIjFDIiwgIjJCIiwgIjJDIiwgIjNDIiwgIlUxIiwgIlUyIikpCgojIGFkZCBwZXJjZW50YWdlIG9mIG1pdG9jaG9uZHJpYWwgZ2VuZXMgdG8gdGhlIG1ldGFkYXRhCmhpdltbInBlcmNlbnRfbXQiXV0gPC0gUGVyY2VudGFnZUZlYXR1cmVTZXQoaGl2LCBwYXR0ZXJuID0gIl5NVC0iKQojc2F2ZVJEUyhoaXYsICIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL1JlcHJvZHVjZV9GYXJoYWRpYW5fUGFwZXIvU2V1cmF0X29iamVjdHMvaGl2X3VucHJvY2Vzc2VkIikKYGBgCi0tLQo8L2RldGFpbHM+Cgo8L2RldGFpbHM+Cgo8ZGV0YWlscz4gCjxzdW1tYXJ5PkltcG9ydGluZyBmaWxlcyAmIGNyZWF0aW5nIFNldXJhdCBvYmplY3RzPC9zdW1tYXJ5PgoKKipRdWFsaXR5IGNvbnRyb2wgd2FzIHBlcmZvcm1lZCBvbiBldmVyeSBpbmRpdmlkdWFsIG9iamVjdC4qKgoKUXVhbGl0eSBjb250cm9sIHdhcyBwZXJmb3JtZWQgYXMgZGVzY3JpYmVkIGluIFtARmFyaGFkaWFuXS4gVGhlIDEwJSBvZiBjZWxscyAKd2l0aCB0aGUgaGlnaGVzdCBwZXJjZW50YWdlIG9mIG1pdG9jaG9uZHJpYWwgZ2VuZXMgd2FzIHJlbW92ZWQsCmFzIHdlbGwgYXMgZmVhdHVyZXMgd2hpY2ggYXJlIGV4cHJlc3NlZCBpbiBsZXNzIHRoYW4gMyBjZWxscy4gQWxzbywgY2VsbHMgd2l0aCAKbnVtYmVyIG9mIGZlYXR1cmVzIGJlbG93IDUwMCBvciBhYm92ZSAyNTAwIHdlcmUgcmVtb3ZlZC4gUXVhbGl0eSBjb250cm9sIHdhcyAKZG9uZSBmb3IgZWFjaCBzYW1wbGUgc2VwYXJhdGVseSBhbmQgdGhlbiB0aGUgc2FtcGxlcyB3ZXJlCmNvbWJpbmVkIGFnYWluIGJlZm9yZSBub3JtYWxpemF0aW9uLgoKYGBge3J9IAojIHJlYWQgaW4gdW5wcm9jZXNzZWQgc2V1cmF0IG9iamVjdCBjb250YWluaW5nIGFsbCA3IHNhbXBsZXMKaGl2IDwtIHJlYWRSRFMoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvUmVwcm9kdWNlX0ZhcmhhZGlhbl9QYXBlci9TZXVyYXRfb2JqZWN0cy9oaXZfdW5wcm9jZXNzZWQiKQoKIyBGVU5DVElPTjoKIyB0byByZW1vdmUgZmVhdHVyZXMgdGhhdCBhcmUgZXhwcmVzc2VkIGluIGxlc3MgdGhhbiB0aHJlZSBjZWxscwojIHJldHVybnMgYSBsaXN0IG9mIGZlYXR1cmUgbmFtZXMgdG8ga2VlcAoKcmVtb3ZlX2ZlYXR1cmVzIDwtIGZ1bmN0aW9uKHNldXJhdF9vYikgewogIGNvdW50X21hdHJpeCA8LSBzZXVyYXRfb2JAYXNzYXlzJFJOQUBjb3VudHMgCiAgbmNlbGxzIDwtIHJvd1N1bXMoY291bnRfbWF0cml4ICE9IDApICMgaG93IG1hbnkgY2VsbHMgYXJlIGV4cHJlc3NpbmcgYSAKICAjY2VydGFpbiBnZW5lPyAKICBuYW1lcyhuY2VsbHNbbmNlbGxzID4gM10pICNleHRyYWN0IGdlbmUgbmFtZXMgb2YgZ2VuZXMgZXhwcmVzc2VkIGluIG1vcmUgCiAgI3RoYW4gMyBjZWxscwp9CgoKIyBGVU5DVElPTjoKIyB0byByZW1vdmUgMTAlIG9mIGNlbGwgd2l0aCBoaWdoZXN0IG1pdG9jaG9uZHJpYWwgZ2VuZSBleHByZXNzaW9uOgojcmV0dXJucyBhIGxpc3Qgb2YgY2VsbCBuYW1lcyB0byBrZWVwCnJlbW92ZV9tdF9nZW5lcyA8LSBmdW5jdGlvbihzZXVyYXRfb2IpewogIHRociA8LSBxdWFudGlsZShzZXVyYXRfb2JAbWV0YS5kYXRhJHBlcmNlbnRfbXQsIC45KQogIHNldXJhdF9vYkBtZXRhLmRhdGEgJT4lIAogICAgZmlsdGVyKHBlcmNlbnRfbXQgPCB0aHIpICU+JQogICAgcm93bmFtZXMoKQp9CgoKCiMgU09NRSBUSE9VR0hUUzoKCiMgV2hlbiBkb2luZyB0aGUgcXVhbGl0eSBjb250cm9sIGhvdyBpbXBvcnRhbnQgaXMgdGhlIG9yZGVyIG9mIHRoZSBvcGVyYXRpb25zPwojIElmIHlvdSBmaXJzdCByZW1vdmUgbkZlYXR1cmVzID4gNTAwIGFuZCB0aGVuIHRoZSBmZWF0dXJlcyBleHBwcmVzc2VkIGluIG1vcmUgdGhhbgojIDMgY2VsbHMsIHRoZW4gdGhlIG5GZWF0dXJlcyBtaWdodCBiZSBiZWxvdyA1MDAuCgpzZXBhcmF0ZV9vYmplY3RzIDwtIFNwbGl0T2JqZWN0KGhpdiwgc3BsaXQuYnkgPSAib3JpZy5pZGVudCIpI1stYyg1LDYsNyldIAojIG9ubHkga2VlcCB0d28gYmxvb2Qgc2FtcGxlcyBhbmQgdHdvIGNzZiBzYW1wbGVzCgpxYyA8LSBsYXBwbHkoWCA9IHNlcGFyYXRlX29iamVjdHMsIEZVTiA9IGZ1bmN0aW9uKHgpIHsKICAgICN4W1sicGVyY2VudF9tdCJdXSA8LSBQZXJjZW50YWdlRmVhdHVyZVNldCh4LCBwYXR0ZXJuID0gIl5NVC0iKSAKICAgICMgYWRkIHBlcmNlbnRhZ2Ugb2YgbWl0b2Nob25kcmlhbCBnZW5lcyB0byB0aGUgbWV0YWRhdGEKICAgIHggPC0gc3Vic2V0KHgsIGZlYXR1cmVzID0gcmVtb3ZlX2ZlYXR1cmVzKHgpKSAKICAgICNjcmVhdGUgYSBsaXN0IG9mIGNlbGxzIGV4Y2x1ZGluZyB0aGUgMTAlIG9mIGNlbGxzIHdpdGggdGhlIGhpZ2hlc3QgbXQgZ2VuZSBleHByZXNzaW9uCiAgICB4IDwtIHN1YnNldCh4LCBuRmVhdHVyZV9STkEgPCAyNTAwICYgbkZlYXR1cmVfUk5BID4gNTAwKQogICAgeCA8LSBzdWJzZXQoeCwgY2VsbHMgPSByZW1vdmVfbXRfZ2VuZXMoeCkpIAogICAgIyByZW1vdmUgMTAlIG9mIGNlbGxzIHdpdGggaGlnaGVzdCBtaXRvY2hvbmRyaWFsIGdlbmUgZXhwcmVzc2lvbgogICAgI3ggPC0gTm9ybWFsaXplRGF0YSh4KQogICAgI3ggPC0gU2NhbGVEYXRhKHgpCn0pCgpoaXZfZmlsdCA8LSBtZXJnZShxY1tbMV1dLAogICAgICAgICAgICAgICAgICAgICAgICBjKHFjW1syXV0sCiAgICAgICAgICAgICAgICAgICAgICAgIHFjW1szXV0sCiAgICAgICAgICAgICAgICAgICAgICAgIHFjW1s0XV0sCiAgICAgICAgICAgICAgICAgICAgICAgIHFjW1s1XV0sCiAgICAgICAgICAgICAgICAgICAgICAgIHFjW1s2XV0sCiAgICAgICAgICAgICAgICAgICAgICAgIHFjW1s3XV0pLAogICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0ID0gImhpdl9maWx0IikjLAogICAgICAgICAgICAgICAgICAgICAgICAjYWRkLmNlbGwuaWRzID0gYygiMUIiLCAiMUMiLCAiMkIiLCAiMkMiLCAiM0MiLCAiVTEiLCAiVTIiKSkKCmBgYAoKPC9kZXRhaWxzPgoKPGRldGFpbHM+IAoqKjxzdW1tYXJ5PkNvZGUgZm9yIERpbWVuc2lvbmFsaXR5IHJlZHVjdGlvbiAmIENsdXN0ZXJpbmc8L3N1bW1hcnk+KioKClVzZSBibG9vZCBhbmQgQ1NGIHNhbXBsZXMgZnJvbSB0d28gcGF0aWVudHMgKEhJVjFfQ1NGL0JsZCwgSElWMl9DU0YvQmxkKSBmb3IKZnVydGhlciBhbmFseXNpcyBsaWtlIGluIHRoZSBwYXBlci4KCiogKipTdWJzZXQgU2V1cmF0IG9iamVjdCoqCgpgYGB7cn0KaGl2NCA8LSBzdWJzZXQoaGl2X2ZpbHQsIG9yaWcuaWRlbnQgJWluJSBjKCJISVYxX0NTRiIsICJISVYyX0NTRiIsICJISVYxX0JsZCIsICJISVYyX0JsZCIpKQpgYGAKCiogKipOb3JtYWxpemUsIFNjYWxlIGFuZCBmaW5kIHZhcmlhYmxlIGZlYXR1cmVzKioKCmBgYHtyfQpoaXY0IDwtIE5vcm1hbGl6ZURhdGEoaGl2NCwgdmVyYm9zZSA9IEZBTFNFKQpoaXY0IDwtIFNjYWxlRGF0YShoaXY0LCB2ZXJib3NlID0gRkFMU0UpCmhpdjQgPC0gRmluZFZhcmlhYmxlRmVhdHVyZXMoaGl2NCwgdmVyYm9zZSA9IEZBTFNFKQpgYGAKCgoqICoqRGltZW5zaW9uYWxpdHkgcmVkdWN0aW9uKioKCioqUENBKioKCkNvbXB1dGUgUENBIGZvciBoaWdobHkgdmFyaWFibGUgZ2VuZXM6ClRoZSBmaXJzdCAxMCBkaW1lbnNpb25zIHNlZW0gdG8gYWNjb3VudCBmb3IgbW9zdCBvZiB0aGUgdmFyaWFuY2UgKHNlZSBlbGJvdyBwbG90KS4KVGhlIHBsb3RzIHNlZW0gdG8gaW5kaWNhdGUgdGhhdCB0aGUgYmxvb2Qgc2FtcGxlcyBhbmQgY3NmIHNhbXBsZXMgYXJlIGRpZmZlcmVudC4KCmBgYHtyfQpoaXY0IDwtIFJ1blBDQShoaXY0LCBmZWF0dXJlcyA9IFZhcmlhYmxlRmVhdHVyZXMoaGl2NCksIHZlcmJvc2UgPSBGQUxTRSkKCiMgZWxib3cgcGxvdCB0byBkZXRlcm1pbmUgd2hpY2ggUENzIGFjY291bnQgZm9yIG1vc3Qgb2YgdGhlIHZhcmlhbmNlCkVsYm93UGxvdChoaXY0KQpgYGAKCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTE1fQojcGNhIHBsb3RzCnBjYV9wbG90cyA8LSBjb21wcmVoZW5yOjp0b19saXN0KGZvciAoaSBpbiAxOjEzKQogIERpbVBsb3QoaGl2NCwgcmVkdWN0aW9uID0gInBjYSIsIGRpbXMgPSBpIDogKGkrMSkpICsKICAgIHRoZW1lKCkpCmRvLmNhbGwoZ3JpZEV4dHJhOjpncmlkLmFycmFuZ2UsIGMocGNhX3Bsb3RzLCBuY29sPTMsIG5yb3cgPSA1KSkKCmBgYAoKKipDbHVzdGVyaW5nICYgdFNORSBlbWJlZGRpbmcqKgoKKiBjb21wdXRlIEtOTi1ncmFwaCAKKiBmaW5kIGNsdXN0ZXJzIGJhc2VkIG9uIEtOTi1ncmFwaCB3aXRoIExvdXZpYW4gYWxnb3JpdGhtCgpgYGB7cn0KaGl2NCA8LSBGaW5kTmVpZ2hib3JzKGhpdjQsIHZlcmJvc2UgPSBGQUxTRSkKaGl2NCA8LSBGaW5kQ2x1c3RlcnMoaGl2NCwgdmVyYm9zZSA9IEZBTFNFKQoKdGFibGUoaGl2NCRzZXVyYXRfY2x1c3RlcnMpCmBgYAoKYGBge3J9CmhpdjQgPC0gUnVuVFNORShoaXY0LCBkaW1zID0gMToxMCwgdmVyYm9zZSA9IEZBTFNFKQpgYGAKCi0tLQo8L2RldGFpbHM+CgoKIyBWaXN1YWxpemF0aW9uIG9mIHNhbXBsZSBxdWFsaXR5IGluIHRTTkUgcGxvdAoKQWZ0ZXIgcGVyZm9ybWluZyBxdWFsaXR5IGNvbnRyb2wgYW5kIHJlbW92aW5nIGNlbGxzIHdpdGggbG93IG51bWJlciBvZiBmZWF0dXJlcyBhbmQKaGlnaCBwZXJjZW50YWdlIG9mIG1pdG9jaG9uZHJpYWwgZ2VuZXMgaXQgZG9lcyBub3Qgc2VlbSB0aGF0IHRoZXJlIGlzIGFueSAKYmF0Y2ggZWZmZWN0LCBidXQgcmF0aGVyIHRoZSBzYW1wbGVzIHNlcGFyYXRlIAphY2NvcmRpbmcgdG8gdGhlaXIgb3JpZ2luIChDU0Ygb3IgQmxvb2QpLiBNb3JlIGRldGFpbGVkIHBsb3RzIGFuZCBzdGF0aXN0aWNhbCAKc3VtbWFyaWVzIG9mIGZlYXR1cmUgbnVtYmVyLCBsaWJyYXJ5IHNpemUgYW5kIHBlcmNlbnRhZ2Ugb2YgCm1pdG9jaG9uZHJpYWwgY2FuIGJlIGZvdW5kIGluIHRoZSBBcHBlbmRpeC4KCmBgYHtyLCBmaWcuaGVpZ2h0PTEyLCBmaWcud2lkdGg9MTV9CnRzbmVfY29vcmQgPC0gRW1iZWRkaW5ncyhoaXY0W1sidHNuZSJdXSkgIyB0c25lIGNvb3JkaW5hdGVzCm1ldGEgPC0gaGl2NEBtZXRhLmRhdGEgIyBtZXRhZGF0YQpjbSA8LSBoaXY0QGFzc2F5cyRSTkFAY291bnRzICMgY291bnQgbWF0cml4CgojIFVNQVAgd2l0aCBudW1iZXIgb2YgZmVhdHVyZXMgZGV0ZWN0ZWQgcGVyIGNlbGwKcDEgPC0gY2JpbmQobWV0YSwgdHNuZV9jb29yZCkgJT4lCiAgZ2dwbG90KCkgKwogIGdlb21fcG9pbnQoYWVzKHg9dFNORV8xLCB5PXRTTkVfMiwgY29sPW5GZWF0dXJlX1JOQSksIHNpemU9LjUpICsKICBzY2FsZV9jb2xvcl92aXJpZGlzX2MoKSArCiAgbGFicyh0aXRsZSA9ICJOdW1iZXIgb2YgZmVhdHVyZXMiKQoKIyBwZXJjZW50YWdlIG9mIG1pdG9jaG9uZHJpYWwgZ2VuZXMgcGVyIGNlbGwKcDIgPC0gY2JpbmQobWV0YSwgdHNuZV9jb29yZCkgJT4lIAogIGdncGxvdCgpICsKICBnZW9tX3BvaW50KGFlcyh4ID0gdFNORV8xLCB5ID0gdFNORV8yLCBjb2wgPSBwZXJjZW50X210ICksIHNpemUgPSAuNSkgKwogIHNjYWxlX2NvbG9yX3ZpcmlkaXNfYygpICsKICBsYWJzKHRpdGxlID0gIlBlcmNlbnRhZ2Ugb2YgbWl0b2Nob25kcmlhbCBnZW5lcyIpCgojIFVNQVAgaW5kaWNhdGluZyB0aGUgc2FtcGxlIHdoZXJlIGVhY2ggY2VsbCBjYW1lIGZyb20KcDMgPC0gY2JpbmQobWV0YSwgdHNuZV9jb29yZCkgJT4lIAogIGdncGxvdCgpICsKICBnZW9tX3BvaW50KGFlcyh4ID0gdFNORV8xLCB5ID0gdFNORV8yLCBjb2wgPSBvcmlnLmlkZW50ICksIHNpemUgPSAuNSkgKwogIGxhYnModGl0bGUgPSAiU2FtcGxlIG9yaWdpbiIpCgojIFVNQVAgbGFiZWxlZCBhY2NvcmRpbmcgdG8gY2x1c3RlcnMKcDQgPC0gY2JpbmQobWV0YSwgdHNuZV9jb29yZCkgJT4lIAogIGdncGxvdCgpICsKICBnZW9tX3BvaW50KGFlcyh4ID0gdFNORV8xLCB5ID0gdFNORV8yLCBjb2wgPSBzZXVyYXRfY2x1c3RlcnMgKSwgc2l6ZSA9IC41KSArCiAgbGFicyh0aXRsZSA9ICJDbHVzdGVycyIpCgpnZ2FycmFuZ2UocDEsIHAyLCBwMywgcDQsIG5jb2wgPSAyLCBucm93ID0gMikKYGBgCgojIE1hcmtlciBnZW5lcyAmIENlbGwgdHlwZSBhbm5vdGF0aW9uCgpgYGAKbWFya2VyX2dlbmVzIDwtIEZpbmRBbGxNYXJrZXJzKGhpdjQsIGxvZ2ZjLnRocmVzaG9sZCA9IC4wMSwgbWluLnBjdCA9IC4wMSkKYGBgCiMjIyBUb3AgbWFya2VyIGdlbmVzCgpUaGUgZnVuY3Rpb24gYEZpbmRBbGxNYXJrZXJzKClgIGlkZW50aWZpZXMgZGlmZmVyZW50aWFsbHkgZXhwcmVzc2VkIGdlbmVzIGJldHdlZW4KdHdvIGdyb3VwcyBvZiBjZWxscywgaW4gdGhpcyBjYXNlIEkgY29tcGFyZWQgb25lIGdyb3VwIG9mIGNlbGxzIGF0IGEgdGltZSBhZ2FpbnN0CnRoZSByZXN0IG9mIGNlbGxzIHVzaW5nIGEgV2lsY294b24gUmFuayBTdW0gdGVzdC4gClRoZSB0YWJsZSBiZWxvdyBsaXN0cyB0aGUgdHdvIG1vc3QgaGlnaGx5IGRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZCBnZW5lcyBmb3IgCmVhY2ggY2x1c3RlcnMuIAoKYGBge3IsIHJlc3VsdHMgPSAiYXNpcyJ9CiMgZmlsdGVyIGZvciBzaWduaWZpY2FudCBtYXJrZXIgZ2VuZXMKI3NpZ25fbWFya2VyX2dlbmVzIDwtIG1hcmtlcl9nZW5lcyAlPiUgZmlsdGVyKHBfdmFsX2FkaiA8PSAuMSkKCnNpZ25fbWFya2VyX2dlbmVzIDwtIHJlYWQudGFibGUoZmlsZSA9ICIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL1JlcHJvZHVjZV9GYXJoYWRpYW5fUGFwZXIvc2lnbl9tYXJrZXJfZ2VuZXMudHN2IikKCiNzaG93IHRoZSB0b3AgMTAgZGlmZmVyZW50aWFsbHkgZXhwcmVzc2VkIGdlbmVzIGZvciBlYWNoIGNsdXN0ZXIKI3NpZ25fbWFya2VyX2dlbmVzICU+JSBncm91cF9ieShjbHVzdGVyKSAlPiUgdG9wX24obiA9IDIsIHd0ID0gYXZnX2xvZ0ZDICkgIyU+JQogICNrYWJsZShjYXB0aW9uID0gIlRvcCB0d28gZGlmZmVyZW50aWFsbHkgZXhwcmVzc2VkIGdlbmVzIGZvciBlYWNoIGNsdXN0ZXIiKSMsIGRpZ2l0cyA9IGMoMywgZm9ybWF0LmFyZ3MgPSBsaXN0KHNjaWVudGlmaWMgPSBUUlVFKSkgIz0gVFJVRSkpCmBgYAoKCiMjIyBDZWxsIHR5cGUgYW5ub3RhdGlvbiB3aXRoIGNhbm9uaWNhbCBtYXJrZXIgZ2VuZXMgey50YWJzZXR9CgoKIyMjIEIgY2VsbCBtYXJrZXJzCkIgY2VsbCBtYXJrZXJzIGFyZSBmb3VuZCBwcmltYXJpbHkgaW4gY2x1c3RlciA3LgoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMn0KcDEgPC0gVmxuUGxvdChoaXY0LCBmZWF0dXJlcyA9IGMoIk1TNEExIiwgIkNENzlBIiwgIlRDTDFBIiksIHB0LnNpemUgPSAuMDEpCnAyIDwtIFJpZGdlUGxvdChoaXY0LCBmZWF0dXJlcyA9ICBjKCJNUzRBMSIsICJDRDc5QSIsICJUQ0wxQSIpLCBzb3J0ID0gImRlY3JlYXNpbmciICkKZ2dhcnJhbmdlKHAxLHAyLCBucm93ID0gMiwgbmNvbCA9IDEpCmBgYAoKIyMjIE5LIGNlbGxzCk5LIGNlbGxzIGFyZSBwcmltYXJpbHkgZm91bmQgaW4gY2x1c3RlciA1IGFuZCA5LiAKR1pNQiwgYSBOSyBjZWxsIG1hcmtlciBpcyBhbHNvIGZvdW5kIGluIGNsdXN0ZXIgMTQuCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTEyfQpwMSA8LSBWbG5QbG90KGhpdjQsIGZlYXR1cmVzID0gYygiTktHNyIsICJHTkxZIiwgIkdaTUIiKSwKICAgICAgICBwdC5zaXplID0gLjAxLCBuY29sID0gMykjLCBzdGFjayA9IFRSVUUpCnAyIDwtIFJpZGdlUGxvdChoaXY0LCBmZWF0dXJlcyA9IGMoIk5LRzciLCAiR05MWSIsICJHWk1CIiksIHNvcnQgPSAiZGVjcmVhc2luZyIpCgpnZ2FycmFuZ2UocDEscDIsIG5yb3cgPSAyLCBuY29sID0gMSkKYGBgCgojIyMgQ0Q0KyAmIENEOCsgVCBjZWxscyAKCioqQ0Q0KyBUIGNlbGxzOioqCgoqIEEgZ2VuZXJhbCBUIGNlbGwgbWFya2VyIENEM0UgaXMgZXhwcmVzc2VkIGluIGNsdXN0ZXIgMCwxLDMsNCw1LDYuCiogSUw3UiBpbiBjbHVzdGVycyAwLTYKKiBUUkFDIGluIGNsdXN0ZXJzIDAtNiwgZXhjbHVkaW5nIDIKKiBDQ1I3IGluIDAsNiw3CiogTERIQiBub3QgdmVyeSBjbGVhciwgYnV0IDAsMSwzLDQsNgoqIExUQiBpbiAwLTcKKiBDRDIgaW4gMSwzLDQsNSw5CgpUY2VsbHMxLzIvMyBhcmUgbnVtYmVyZWQgYXJiaXRyYXJpbHksIGJlY2F1c2UgdGhleSBhcmUgbm90IHVzZWQgZm9yIGZ1cnRoZXIgYW5hbHlzaXMuCgoqKkNEOCsgVCBjZWxsczoqKgoKKiBDRDhBIGlzIGV4cHJlc3NlZCBpbiBkZWNyZWFzaW5nIG9yZGVyIGluIDEsNSwzCgpgYGB7ciwgZmlnLmhlaWdodD0yMCwgZmlnLndpZHRoPTE1fQojIGdlbmVyYWwgVCBjZWxsIG1hcmtlciBmb3IgQ0Q0KyBhbmQgQ0Q4KyBUY2VsbHMKcDEgPC0gVmxuUGxvdChoaXY0LCBmZWF0dXJlcyA9IGMoIkNEOEEiLCJDRDNFIiksIHB0LnNpemUgPSAuMDEsIG5jb2wgPSAyKQpwMiA8LSBSaWRnZVBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKCJDRDhBIiwiQ0QzRSIpLCBzb3J0ID0gImRlY3JlYXNpbmciKQoKCnAzIDwtIFZsblBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKCJJTDdSIiwgIlRSQUMiKSwgcHQuc2l6ZSA9IDAuMDEpCnA0IDwtIFJpZGdlUGxvdChoaXY0LCBmZWF0dXJlcyA9IGMoIklMN1IiLCAiVFJBQyIpLCBzb3J0ID0gImRlY3JlYXNpbmciKQoKIyBoZWxwZXIgVCBjZWxscwpwNSA8LSBWbG5QbG90KGhpdjQsIGZlYXR1cmVzID0gYygiTFRCIiwgIkNEMiIpLCBwdC5zaXplID0gLjAxLCBuY29sID0gMikKcDYgPC0gUmlkZ2VQbG90KGhpdjQsIGZlYXR1cmVzID0gYygiTFRCIiwgIkNEMiIpLCBzb3J0ID0gImRlY3JlYXNpbmciKQoKIyBDRDQrIG5haXZlIFQgY2VsbHMKcDcgPC0gVmxuUGxvdChoaXY0LCBmZWF0dXJlcyA9IGMoIkxESEIiLCAiQ0NSNyIpLCBwdC5zaXplID0gLjAxLCBuY29sID0gMikKcDggPC0gUmlkZ2VQbG90KGhpdjQsIGZlYXR1cmVzID0gYygiTERIQiIsICJDQ1I3IiksIHNvcnQgPSAiZGVjcmVhc2luZyIpCgoKZ2dhcnJhbmdlKHAxLCBwMixwMywgcDQsIHA1LCBwNiwgcDcscDgsIG5jb2wgPSAyLCBucm93ID0gNCkKYGBgCgojIyMgcGxhc21hIGNlbGxzCgpDbHVzdGVyIDE0IHNlZW1zIHRvIGNvbnRhaW4gcGxhc21hIGNlbGxzLgoKYGBge3IsIGZpZy53aWR0aD0xMiwgZmlnLmhlaWdodD01fQpwMSA8LSBWbG5QbG90KGhpdjQsIGZlYXR1cmVzID0gYygiSUdKIiksIHB0LnNpemUgPSAuMDEsIG5jb2wgPSAyKQpwMiA8LSBSaWRnZVBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKCJJR0oiKSwgc29ydCA9ICJkZWNyZWFzaW5nIikKZ2dhcnJhbmdlKHAxLHAyLCBucm93ID0gMSwgbmNvbCA9IDIpCmBgYAoKIyMjIE15ZWxvaWQgY2VsbHMKCk15ZWxvaWQgY2VsbHMgZW5jb21wYXNzCgoqIGdyYW51bG9jeXRlcwoqIG1vbm9jeXRlcwoqIG1hY3JvcGhhZ2VzCiogZGVuZHJpdGljIGNlbGxzCgpUaGUgY2x1c3RlcnMgOCwgMTAsIDExLCAxMiwgMTMgYXJlIG15ZWxvaWQgY2VsbHMKCk15ZWxvaWQxLCAzLCA0IGFyZSBhc3NpZ25lZCBhcmJpdHJhcmlseSwgYmVjYXVzZSB0aGV5IGFyZSBub3Qgb2YgaW50ZXJlc3QuIAoKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MTV9CnAxIDwtIFZsblBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKCJMWVoiLCAiRkNFUjFBIiwgIkNEMTQiLCAiRkNHUjNBIiksICMgRkNHM0EgaXMgYWxzbyBleHByZXNzZWQgaW4gY2x1c3RlciA5IChOSyBjZWxscykKICAgICAgICBwdC5zaXplID0gLjAxLCBuY29sID0gMikKcDIgPC0gUmlkZ2VQbG90KGhpdjQsIGZlYXR1cmVzID0gYygiTFlaIiwgIkZDRVIxQSIpLAogICAgICAgICAgc29ydCA9ICJkZWNyZWFzaW5nIiwgbmNvbCA9IDIpICMgREMgbWFya2VycwpwMyA8LSBSaWRnZVBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKCJDRDE0IiwgIkZDR1IzQSIpLCAKICAgICAgICAgIHNvcnQgPSAiZGVjcmVhc2luZyIsIG5jb2wgPSAyKSAjIG1vbm9jeXRlcyAoTFlDIGFsc28gaW4gbW9ub2N5dGVzKQpnZ2FycmFuZ2UocDEscDIscDMsIG5yb3cgPSAzLCBuY29sID0gMSkKYGBgCgojIyMgTXllbG9pZCA1CiAKIENsdXN0ZXIgMTIgYXJlIE15ZWxvaWQ1IGNlbGxzLCB3aGljaCB3ZXJlIGNoYXJhY3Rlcml6ZWQgYnkgW0BGYXJoYWRpYW5dIHdpdGggCiB0aGUgbWFya2VycyBGQ0VSMUEsIENEMUMgIAoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMn0KIyBNeWVsb2lkIDUgaW4gdGhlIHBhcGVyCnAxIDwtIFZsblBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKCAiRkNFUjFBIiwgIkNEMUMiKSwgcHQuc2l6ZSA9IC4wMSwgbmNvbCA9IDIpCnAyIDwtIFJpZGdlUGxvdChoaXY0LCBmZWF0dXJlcyA9IGMoIkZDRVIxQSIsICJDRDFDIiksIHNvcnQgPSAiZGVjcmVhc2luZyIsIG5jb2wgPSAyKQpnZ2FycmFuZ2UocDEsIHAyLCBucm93ID0gMiwgbmNvbCA9IDEpCmBgYAoKIyMjIE15ZWxvaWQgMiAKCkNsdXN0ZXIgMTEgaXMgdGhlIE15ZWxvaWQyIGNsdXN0ZXJzIHdpdGggZXhwcmVzc2lvbiBvZiBBWEwsIEFQT0UsIFRSRU0yLiBUaGVzZSBnZW5lcyBhcmUgZW5yaWNoZWQgaW4gbmV1cm9kZWdlbmVyYXRpdmUgCmRpc2Vhc2UtYXNzb2NpYXRlZCBtaWNyb2dsaWEgW0BGYXJoYWRpYW5dLiBDVFNCLCBBUE9DMSwgTVNSMSwgQzFRQS1DIGFyZSAKZXhwcmVzc2VkIG1vcmUgaGlnaGx5IGluIE15ZWxvaWQyIGNvbXBhcmVkIHRvIG90aGVyIG15ZWxvaWQgY2x1c3RlcnMgW0BGYXJoYWRpYW5dLgoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0yMH0KIyBNeWVsb2lkIDIKcDEgPC0gVmxuUGxvdChoaXY0LCBmZWF0dXJlcyA9IGMoIkFYTCIsICJBUE9FIiwgIlRSRU0yIiksIHB0LnNpemUgPSAuMDEsIG5jb2wgPSAzKQpwMiA8LSBSaWRnZVBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKCJBWEwiLCAiQVBPRSIsICJUUkVNMiIpLCBzb3J0ID0gImRlY3JlYXNpbmciKQpwMyA8LSBWbG5QbG90KGhpdjQsIGZlYXR1cmVzID0gYygiQ1RTQiIsICJBUE9DMSIsICJNU1IxIiwgIkMxUUEiKSwgCiAgICAgICAgICAgICAgcHQuc2l6ZSA9IC4wMSwgbmNvbCA9IDQpCnA0IDwtIFJpZGdlUGxvdChoaXY0LCBmZWF0dXJlcyA9IGMoIkNUU0IiLCAiQVBPQzEiLCAiTVNSMSIsICJDMVFBIiksCiAgICAgICAgICAgICAgICBzb3J0ID0gImRlY3JlYXNpbmciLCBuY29sID0gNCkKCmdnYXJyYW5nZShwMSwgcDIsIHAzLCBwNCwgbmNvbCA9IDEsIG5yb3cgPSA0KQoKYGBgCgojIyB7LX0KCi0tLQoKKiBXaHkgaXMgdGhlIG1peGVkIHBvcHVsYXRpb24gcHJpbWFyaWx5IGNvbXBvc2VkIG9mIGNlbGxzIGZyb20gSElWMSAKcGF0aWVudCBibG9vZCBzYW1wbGU/CiogV2h5IGFyZSBUIGNlbGxzIHByaW1hcmlseSBmcm9tIENTRiBzYW1wbGVzIGFuZCBDRDggVCBjZWxscyBwcmltYXJpbHkgZnJvbSBibG9vZD8KCgo8L2RldGFpbHM+Cgo8ZGV0YWlscz4gCioqPHN1bW1hcnk+VGFibGUgb2YgYW5ub3RhdGlvbiBvZiBjZWxsIHR5cGVzIHRvIGNsdXN0ZXJzPC9zdW1tYXJ5PioqCgpgYGB7cn0KSWRlbnRzKGhpdjQpIDwtICJzZXVyYXRfY2x1c3RlcnMiCmNlbGxfdHlwZXMgPC0gYygiVGNlbGwyIiwgIkNEOCIsICJtaXhlZCIsICJDRDgxIiwgIlRjZWxsMyIsICJOS2NlbGwxIiwKICAgICAgICAgICAgICAgICJUY2VsbDEiLCAiQmNlbGwiLCAiTXllbG9pZDEiLCAiTktjZWxsMiIsICJNeWVsb2lkMyIsICJNeWVsb2lkMiIKICAgICAgICAgICAgICAgICwgIk15ZWxvaWQ1IiwgIk15ZWxvaWQ0IiwgInBsYXNtYSBjZWxsIiApCgpuYW1lcyhjZWxsX3R5cGVzKSA8LSBsZXZlbHMoaGl2NCkKaGl2NCA8LSBSZW5hbWVJZGVudHMoaGl2NCwgY2VsbF90eXBlcykKYXMuZGF0YS5mcmFtZShjZWxsX3R5cGVzKSAlPiUgIHJvd25hbWVzX3RvX2NvbHVtbigiY2x1c3RlciIpICU+JSBrbml0cjo6a2FibGUoKQoKIyBhZGQgY2VsbCB0eXBlcyB0byBtZXRhZGF0YQpoaXY0IDwtIEFkZE1ldGFEYXRhKGhpdjQsIG1ldGFkYXRhID0gSWRlbnRzKGhpdjQpLCBjb2wubmFtZSA9ICJjZWxsX3R5cGUiKQoKCiMgYWRkIGNvbmRpdGlvbiBibG9vZCBvciBjc2YgdG8gbWV0YWRhdGEKSWRlbnRzKGhpdjQpIDwtICJvcmlnLmlkZW50Igpjb25kaXRpb25zIDwtIGMoIkJsb29kIiwgIkJsb29kIiwgIkNTRiIsICJDU0YiKQpuYW1lcyhjb25kaXRpb25zKSA8LSBjKCJISVYxX0JsZCIsICJISVYyX0JsZCIsICJISVYxX0NTRiIsICJISVYyX0NTRiIpCmhpdjQgPC0gUmVuYW1lSWRlbnRzKGhpdjQsIGNvbmRpdGlvbnMpCgpoaXY0IDwtIEFkZE1ldGFEYXRhKGhpdjQsIGNvbC5uYW1lID0gIkNvbmRpdGlvbiIsIG1ldGFkYXRhID0gSWRlbnRzKGhpdjQpKQoKCmBgYAoKPC9kZXRhaWxzPgoKKipPdmVydmlldyBvZiBzb21lIG9mIHRoZSBtb3N0IGltcG9ydGFudCBtYXJrZXIgZ2VuZXM6KioKCmBgYHtyfQoKRG90UGxvdChvYmplY3QgPSBoaXY0LCBmZWF0dXJlcyA9IGMoIk1TNEExIiwgIyBCIGNlbGxzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUUkFDIiwgIklMN1IiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNEOEEiLCAjIENEOCBUIGNlbGxzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOS0c3IiwgIkdOTFkiLCAjIE5LIGNlbGxzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJDRDNFIiwgIyBUIGNlbGxzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJDRDE0IiwiRkNHUjNBIiwgIkxZWiIsICMgbXllbG9pZCBjZWxscwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSUdKIiwgIyBwbGFzbWEgY2VsbHMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkFYTCIsICJBUE9FIiwgIlRSRU0yIiwgIyBteWVsb2lkIDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJGQ0VSMUEiLCAiQ0QxQyIpICwgIyBteWVsb2lkIDUKICAgICAgICBncm91cC5ieSA9ICJjZWxsX3R5cGUiKSArCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgdmp1c3QgPSAwLjgsIGhqdXN0PTEpKQoKYGBgCgojIFZpc3VhbGl6YXRpb24gb2YgY2VsbCB0eXBlcywgY29uZGl0aW9ucywgc2FtcGxlcyBhbmQgc2VxdWVuY2luZyBxdWFsaXR5CgpUaGUgdFNORSBlbWJlZGRpbmcgd2l0aCB0aGUgYW5ub3RhdGVkIGNlbGwgdHlwZXMgcmVzZW1ibGVzIHRoZSByZXN1bHRzIGJ5CltARmFyaGFkaWFuXS4gVGhlcmUgYXJlIHR3byBjbHVzdGVycywgTXllbG9pZDIgYW5kIE15ZWxvaWQ1IHdoaWNoIG1haW5seSBjb250YWluCmNlbGxzIGZyb20gQ1NGLiBUaGVzZSB0d28gY2x1c3RlcnMgd2VyZSB0ZXJtZWQgbWljcm9nbGlhLWxpa2UgYnkgW0BGYXJoYWRpYW5dLiAKSW4gdGhlIGZvbGxvd2luZyBhbmFseXNpcyBJIHdpbGwgdHJ5IHRvIGNvbmZpcm0gdGhpcyBhbmQgaW52ZXN0aWdhdGUgdGhlIE15ZWxvaWQyCmNsdXN0ZXIgaW4gbW9yZSBkZXRhaWwuCgpgYGB7ciwgIGZpZy5oZWlnaHQ9MTIsIGZpZy53aWR0aD0xNX0KcDEgPC0gRGltUGxvdChoaXY0LCByZWR1Y3Rpb24gPSAidHNuZSIsIGxhYmVsID0gVFJVRSwgCiAgICAgICAgICAgICAgZ3JvdXAuYnkgPSAiY2VsbF90eXBlIiwgcHQuc2l6ZSA9IDAuMSkgKwogIE5vTGVnZW5kKCkgKwogIGxhYnModGl0bGUgPSAiQ2VsbCB0eXBlcyIpCnAyIDwtIERpbVBsb3QoaGl2NCwgcmVkdWN0aW9uID0gInRzbmUiLCBncm91cC5ieSA9ICAiQ29uZGl0aW9uIiwgcHQuc2l6ZSA9IDAuMSkgKwogIGxhYnModGl0bGUgPSAiQ1NGIG9yIEJsb29kIG9yaWdpbiIpCnAzIDwtIERpbVBsb3QoaGl2NCwgcmVkdWN0aW9uID0gInRzbmUiLCBncm91cC5ieSA9ICJvcmlnLmlkZW50IiwgcHQuc2l6ZSA9IDAuMSkgKwogIGxhYnModGl0bGUgPSAiU2FtcGxlIG9yaWdpbiAtIHBhdGllbnQiKQpwNCA8LSBGZWF0dXJlUGxvdChoaXY0LCBmZWF0dXJlcz0gIm5Db3VudF9STkEiLCBwdC5zaXplID0gMC4xKSArIAogICAgc2NhbGVfY29sb3JfdmlyaWRpc19jKCkgKwogIGxhYnModGl0bGU9ICJudW1iZXIgb2YgY291bnRzIikKZ2dhcnJhbmdlKHAxLHAyLHAzLHA0LCBuY29sID0gMiwgbnJvdyA9IDIpCiNwMSArIHAyICsgcDMgKyBwNApgYGAKCgojIEZyZXF1ZW5jeSBvZiBjZWxsIHR5cGVzIGluIENTRiBhbmQgYmxvb2Qgc2FtcGxlcwoKClRoZSBoaXN0b2dyYW0gYmVsb3cgc2hvd3MgdGhhdCBNeWVsb2lkMiBhbmQgTXllbG9pZDUgYXJlIHByZWRvbWluYW50bHkgY29tcG9zZWQgb2YgQ1NGCmNlbGxzLCB3aGlsZSBNeWVsb2lkMSwgTXllbG9pZDMgYW5kIE15ZWxvaWQ0IGFyZSBwcmVkb21pbmFudGx5IGNvbXBvc2VkIG9mIEJsb29kCmNlbGxzLiBUaGlzIHJlZmxlY3RzIHRoZSBmaW5kaW5ncyBvZiBbQEZhcmhhZGlhbl0gdmVyeSBuaWNlbHkuIAoKYGBge3J9CgpjdXN0b21fY29sb3IgPC0gYygiI0MzRDdBNCIsICIjNEU4NEM0IiwgIiM1Mjg1NEMiLCAiIzI5MzM1MiIpCgojcGxvdCBhIGJhcnBsb3Qgb2YgdGhlIHByb3BvcnRpb25zIG9mIHNhbXBsZXMgYW5kIGNlbGwgdHlwZXMKZ2dwbG90KGhpdjRAbWV0YS5kYXRhKSArCiAgZ2VvbV9iYXIoYWVzKHggPSBjZWxsX3R5cGUsIGZpbGwgPSBvcmlnLmlkZW50KSkgKwogIHNjYWxlX2ZpbGxfbWFudWFsKCB2YWx1ZXMgPSBjdXN0b21fY29sb3IpICsKICB5bGFiKCJOdW1iZXIgb2YgY2VsbHMgaW4gZWFjaCBjbHVzdGVyIikgKwogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIHZqdXN0ID0gMC44LCBoanVzdD0xKSkgKwogIGxhYnModGl0bGUgPSAiUmVsYXRpdmUgY29udHJpYnV0aW9uIG9mIENTRiBhbmQgYmxvb2Qgc2FtcGxlcyB0byBlYWNoIGNsdXN0ZXIiKQpgYGAKCgoqKlF1ZXN0aW9uKio6IE15ZWxvaWQxLCBNeWVsb2lkMiBhcmUgbWFpbmx5IGZvdW5kIGluIEJsb29kIGNlbGxzLCAKTXllbG9pZDQgaXMgb25seSBmb3VuZCBpbiBCbG9vZCBjZWxscyBmcm9tIEhJVjEgcGF0aWVudC4gV2hhdCBkb2VzIHRoYXQgbWVhbj8KCgojIyMgSG93IGJpZyBhcmUgTXllbG9pZDIgYW5kIE15ZWxvaWQ1IGNsdXN0ZXJzIGFuZCB3aGVyZSBkbyBjZWxscyBjb21lIGZyb20/CgpNeWVsb2lkMiBjZWxscyBvcmlnaW5hdGUgZnJvbSB0aGUgQ1NGIHNhbXBsZXMgb2YgSElWIGluZmVjdGVkIHBhdGllbnRzLCB3aGlsZQphIGZldyBjZWxscyAodGhpcnRlZW4pIGNsYXNzaWZpZWQgYXMgTXllbG9pZDUgY2VsbHMgb3JpZ2luYXRlIGZyb20gQmxvb2Qgc2FtcGxlcy4gCgpgYGB7ciwgcmVzdWx0cyA9ICJhc2lzIn0KaGl2NEBtZXRhLmRhdGEgJT4lIAogIGZpbHRlcihjZWxsX3R5cGUgJWluJSBjKCJNeWVsb2lkMiIsICJNeWVsb2lkNSIpKSAlPiUgCiAgZ3JvdXBfYnkoY2VsbF90eXBlLCBvcmlnLmlkZW50KSAlPiUgCiAgc3VtbWFyaXplKG4gPSBuKCkpICU+JQogIGthYmxlKGNhcHRpb24gPSAiTnVtYmVyIG9mIE15ZWxvaWQyICYgTXllbG9pZDUgY2VsbHMgZnJvbSBkaWZmZXJlbnQgcGF0aWVudHMvc2FtcGxlcyIpCmBgYAoKIyMjIFdoaWNoIGdlbmVzIGFyZSB1cHJlZ3VsYXRlZCBpbiBNeWVsb2lkLTIgY29tcGFyZWQgdG8gdGhlIGZvdXIgb3RoZXIgbXllbG9pZCBzdWJzZXRzPwoKSW4gdGhlIHBhcGVyIHRoZXkgZmluZCA2MCBnZW5lcyB0aGF0IGFyZSB1cHJlZ3VsYXRlZCBjb21wYXJlZCB0byB0aGUgb3RoZXIgNCAKbXllbG9pZCBzdWJzZXRzLiAoRkRSIDwgMC4wMSkKCkNvbXBhcmUgdGhlIGdlbmVzIHVwcmVndWxhdGVkIGluIG15ZWxvaWQtMiB0byB0aGUgZm91ciBvdGhlciBteWVsb2lkIHN1YnNldHMuIApgRmluZEFsbE1hcmtlcnMoKWAgd2lsbCBjb21wYXJlIG9uZSBjbHVzdGVyIHRvIGFsbCBvdGhlciBjbHVzdGVycy4gCmBGaW5kTWFya2VycygpYCB3aWxsIGNvbXBhcmUgYW4gaW5kaWNhdGVkIGNsdXN0ZXIgd2l0aCBhIHNlY29uZCBpbmRpY2F0ZWQgY2x1c3Rlci4gClRoZXJlZm9yZSwgdGhlIGRpZmZlcmVuY2Ugd2lsbCBub3QgYmUgZGlsdXRlZCwgd2hpY2ggbWlnaHQgYmUgdGhlIGNhc2UgaWYgd2UKY29tcGFyZSBvbmUgY2x1c3RlciB0byBtYW55IG90aGVyIGNsdXN0ZXJzLiAKCmBgYHtyLCByZXN1bHRzID0gImFzaXMifQojaW1wb3J0IHRoZSA2MCBnZW5lcyB0aGF0IHdlcmUgdXByZWd1bGF0ZWQgaW4gTXllbG9pZC0yIGluIHRoZSBwYXBlciBjb21wYXJlZCB0byB0aGUgZm91ciBvdGhlciBteWVsb2lkIHN1YnNldHMKcGFwZXIgPC0gcmVhZC50YWJsZShmaWxlID0gIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9kYXRhL015ZWxvaWQtMl9nZW5lc19wYXBlci5jc3YiLCBzZXAgPSAiXHQiLAogICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IEZBTFNFLCBza2lwTnVsID0gVFJVRSkjLCBuX21heCA9IDYwKQpwYXBlclsxLF0gPC0gIkFQT0MxIgpjb2xuYW1lcyhwYXBlcikgPC0gIiIKcGFwZXIgPC0gYXMudmVjdG9yKHBhcGVyWywxXSkKCklkZW50cyhoaXY0KSA8LSAiY2VsbF90eXBlIgphbGwuY29tcCA8LSBwdXJycjo6bWFwKGMoMSwzLDQsNSksIGZ1bmN0aW9uKG4pewogIG1hcmtlcnMgPC0gRmluZE1hcmtlcnMoaGl2NCwKICAgICAgICAgICAgICBpZGVudC4xID0gIk15ZWxvaWQyIiwKICAgICAgICAgICAgICBpZGVudC4yID0gcGFzdGUwKCJNeWVsb2lkIiwgbiksCiAgICAgICAgICAgICAgb25seS5wb3MgPSBUUlVFLCAKICAgICAgICAgICAgICB2ZXJib3NlID0gRkFMU0UpCiAgbWFya2VycyA8LSByb3duYW1lc190b19jb2x1bW4obWFya2VycywgdmFyID0gImdlbmUiKQogIG5hbWUgPC0gcGFzdGUwKCJDb21wYXJpc29uIE15ZWxvaWQgMiB2cyBNeWVsb2lkICIsIG4pCiAgbGlzdChkZiA9IG1hcmtlcnMsIG5hbWUgPSBuYW1lKQp9KQoKbXkyX2dlbmVzIDwtIG1hcChzZXEuaW50KDEsNCksIGZ1bmN0aW9uKG4pIHsKICBuYW1lIDwtIGFsbC5jb21wW1tdXSRuYW1lCiAgbXkyX2dlbmVzIDwtIGFsbC5jb21wW1tuXV0kZGYgJT4lIAogIGZpbHRlcihwX3ZhbF9hZGogPD0gLjIpICU+JQogIGZpbHRlcihnZW5lICVpbiUgcGFwZXIpCiAgbXkyX2dlbmVzIDwtIG15Ml9nZW5lc1ssImdlbmUiXQp9KQoKYGBgCgojIyMgRXhwcmVzc2lvbiBvZiB0aGUgNjAgZ2VuZXMgaWRlbnRpZmllZCBpbiB0aGUgcGFwZXIgYXMgTXllbG9pZCAyIG1hcmtlcnMKClRoZSBnZW5lcyBzaG93IHRoZSBoaWdoZXN0IGV4cHJlc3Npb24gaW4gTXllbG9pZDIgYW5kIGZvciBzb21lIGdlbmVzIGxpa2UgQ0Q3NCAKYW5kIGdlbmVzIG9mIHRoZSBITEEgZmFtaWx5IGFyZSBhbHNvIGhpZ2hseSBleHByZXNzZWQgaW4gTXllbG9pZDUgY2VsbHMuIEhvd2V2ZXIsIHRoZXJlIAphcmUgYSBmZXcgZ2VuZXMsIGxpa2UgRkFVLCBUUFQxLCBUTVNCMTAgYW5kIE1JUjQ0MjYgd2hpY2ggZG8gbm90IHNob3cgZXhwcmVzc2lvbiAKc3BlY2lmaWMgdG8gdGhlIE15ZWxvaWQyIGNsdXN0ZXIuIEl0IGlzIHVuY2xlYXIgd2h5IFtARmFyaGFkaWFuXSBjaG9zZSB0aGVzZSAKZ2VuZXMgYXMgc2lnbmF0dXJlIGdlbmVzLgoKYGBge3IsIGZpZy5oZWlnaHQgPTE1LCBmaWcud2lkdGg9MTJ9CkRvdFBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKHBhcGVyKSkgKyAKICBjb29yZF9mbGlwKCkgKwogICAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgdmp1c3QgPSAwLjgsIGhqdXN0PTEpKQpgYGAKCgoKIyMjIFBlcmNlbnRhZ2Ugb2YgTXllbG9pZDIgdHJhbnNjcmlwdHMgcGVyIENlbGwgaW4gQmxvb2QsIENTRiBhbmQgVW5pbmZlY3RlZCBzYW1wbGVzCgpGaXJzdCwgaXQgaXMgaW1wb3J0YW50IHRvIG1lbnRpb24sIHRoYXQgYWZ0ZXIgcXVhbGl0eSBjb250cm9sIHRoZSBudW1iZXIgb2YgY2VsbHMKaXMgc2lnbmlmaWNhbnRseSBsb3dlciBpbiB0aGUgdHdvIHVuaW5mZWN0ZWQgQ1NGIHNhbXBsZXMsIDIxNiBhbmQgMzQwIHJlc3BlY3RpdmVseSwKY29tcGFyZWQgdG8gYWxsIG90aGVyIHNhbXBsZXMgd2hpY2ggY29udGFpbiBiZXR3ZWVuIDkzMiBhbmQgMjUyMCBjZWxscy4gSG93ZXZlciwgCmFsc28gdGhlIENTRiBzYW1wbGUgZnJvbSBwYXRpZW50MSAoSElWMV9DU0YpIHdpdGggOTMyIGNlbGxzIGNvbnRhaW5zIG11Y2ggZmV3ZXIgCmNlbGxzIGNvbXBhcmVkIHRvIGFsbCBvdGhlciBzYW1wbGVzLiAKClRoZSByZXN1bHRzIHNob3duIGJ5IFtARmFyaGFkaWFuXSBhcmUgY29udHJvdmVyc2lhbCwgYmVjYXVzZSB3aGVuIHRoZXkgY29tcGFyZQp0aGUgcGVyY2VudGFnZSBvZiBNeWVsb2lkMiB0cmFuc2NyaXB0cyBiZXR3ZWVuIHRoZSB0aHJlZSBjb25kaXRpb25zLCB0aGV5CnBvb2wgMTc3MCBjZWxscyBmb3IgdGhlIHVuaW5mZWN0ZWQgY29uZGl0aW9uLCB3aGljaCBpcyBhIGxvdCBtb3JlIHRoYW4gd2UgZmluZApoZXJlLiBZZXQsIHRoZXkgZG8gbm90IG1lbnRpb24gdGhhdCB0aGV5IHVzZWQgZGlmZmVyZW50IHRocmVzaG9sZHMgZm9yIHF1YWxpdHkgCmNvbnRyb2wgb2YgdGhlIHVuaW5mZWN0ZWQgc2FtcGxlcy4gVGhlcmVmb3JlLCBJIHdhcyBub3QgYWJsZSB0byByZXByb2R1Y2UgdGhlaXIKZmluZGluZ3MuIEJlbG93LCBJIHdpbGwgZGVzY3JpYmUgdGhlIHBlcmNlbnRhZ2Ugb2YgTXllbG9pZDIgdHJhbnNjcmlwdHMgd2hlbgpjb21wYXJpbmcgdGhlIGNvbmRpdGlvbnMgd2l0aCB0aGUgbnVtYmVyIG9mIGNlbGxzIG9idGFpbmVkIHdoZW4gdXNpbmcgdGhlIApzYW1lIHRocmVzaG9sZHMgZm9yIHF1YWxpdHkgY29udHJvbCBhcyBkZXNjcmliZWQgaW4gdGhlIHBhcGVyLgoKVGhlIGludGVycHJldGFiaWxpdHkgb2YgdGhlIGNvbXBhcmlzb24gcHJvYmFibHkgc3VmZmVycyBmcm9tIHRoZSBmYWN0IHRoYXQgdGhlIApudW1iZXIgb2YgY2VsbHMgaW4gdGhlIHVuaW5mZWN0ZWQgY29uZGl0aW9ucyBpcyBzbyBtdWNoIHNtYWxsZXIuIAoKYGBge3IsIHJlc3VsdHMgPSAiYXNpcyJ9CmhpdjcgPC0gcmVhZFJEUygiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9SZXByb2R1Y2VfRmFyaGFkaWFuX1BhcGVyL1NldXJhdF9vYmplY3RzL3RvdGFsXzdfc2FtcGxlc19maWx0ZXJlZF9zZXVyYXRfb2JqZWN0LnJkcyIpCgpoaXY3QG1ldGEuZGF0YSAlPiUgZ3JvdXBfYnkob3JpZy5pZGVudCkgJT4lIAogIHN1bW1hcmlzZShudW1iZXJfb2ZfY2VsbHMgPSBuKCkpICU+JSAKICBrYWJsZShjYXB0aW9uID0gIk51bWJlciBvZiBjZWxscyBwZXIgc2FtcGxlIikKYGBgCgoKYGBge3J9CmhpdjcgPC0gcmVhZFJEUygiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9SZXByb2R1Y2VfRmFyaGFkaWFuX1BhcGVyL1NldXJhdF9vYmplY3RzL3RvdGFsXzdfc2FtcGxlc19maWx0ZXJlZF9zZXVyYXRfb2JqZWN0LnJkcyIpCgojIGNyZWF0ZSBhIGxpc3QgZm9yIHRoZSAzIGRpZmZlcmVudCBjb25kaXRvbnMKc3Vic2V0Lmxpc3QgPC0gbGlzdChpbmZlY3RlZF9ibG9vZCA9IGMoIkhJVjFfQmxkIiwgIkhJVjJfQmxkIiksIAogICAgICAgICAgICAgICAgICAgIGluZmVjdGVkX2NzZiA9IGMoIkhJVjFfQ1NGIiwgIkhJVjJfQ1NGIiwgIkhJVjNfQ1NGIiksCiAgICAgICAgICAgICAgICAgICAgdW5pbmZlY3RlZF9jc2YgPSBjKCJVbmluZmVjdGVkMV9DU0YiLCAiVW5pbmZlY3RlZDJfQ1NGIikpCgojIGZvciBlYWNoIGNlbGwgb2YgZWFjaCBjb25kaXRpb24gY2FsY3VsYXRlIGEgcGVyY2VudGFnZSBvZiBNeWVsb2lkMiB0cmFuc2NyaXB0cwojIGFuZCBjb21iaW5lIHRvIGEgZGF0YWZyYW1lCnBlcmNlbnRhZ2VfbXkyX3RyYW5zY3JpcHRzIDwtIG1hcDJfZGZyKHN1YnNldC5saXN0LCBuYW1lcyhzdWJzZXQubGlzdCksIGZ1bmN0aW9uKG4sIG5hbWUpIHsKICBjb3VudF9tIDwtIHN1YnNldChoaXY3LCBvcmlnLmlkZW50ICVpbiUgbilAYXNzYXlzJFJOQUBjb3VudHMKICB0b3RhbF90cmFuc2NyaXB0cyA8LSBjb2xTdW1zKGNvdW50X20pICMgbnVtYmVyIG9mIHRyYW5zY3JpcHRzIHBlciBjZWxsCiAgbXkyX21hdHJpeCA8LSBjb3VudF9tW3Jvd25hbWVzKGNvdW50X20pICVpbiUgcGFwZXIsIF0gIyBnZXQgb25seSBteWVsb2lkMiBnZW5lcyAKICBteTJfdHJhbnNjcmlwdHMgPC0gY29sU3VtcyhteTJfbWF0cml4KSAjIHN1bSBvZiBteWVsb2lkMiB0cmFuc2NyaXB0cwogIHRpYmJsZShwZXJjZW50YWdlID0gIG15Ml90cmFuc2NyaXB0cy90b3RhbF90cmFuc2NyaXB0cywgY29uZGl0aW9uID0gbmFtZSkKfSkKYGBgCgoqKklzIHRoZXJlIGEgc2lnbmlmaWNhbnQgZGlmZmVyZW5jZSBpbiBwZXJjZW50YWdlIG9mIE15ZWxvaWQyIHRyYW5zY3JpcHRzCmJldHdlZW4gdGhlIHRocmVlIGNvbmRpdGlvbnM/KioKCmBgYHtyfQpwZXJjZW50YWdlX215Ml90cmFuc2NyaXB0cyAlPiUgCiAgZ3JvdXBfYnkoY29uZGl0aW9uKSAlPiUgCiAgc3VtbWFyaXNlKG4gPSBuKCksIHEyNSA9IHF1YW50aWxlKHBlcmNlbnRhZ2UsIC4yNSksCiAgICAgICAgICAgIHE1MCA9IHF1YW50aWxlKHBlcmNlbnRhZ2UsIC41KSwgCiAgICAgICAgICAgIHE3NSA9IHF1YW50aWxlKHBlcmNlbnRhZ2UsIC43NSksIAogICAgICAgICAgICBtZWFuID0gbWVhbihwZXJjZW50YWdlKSwKICAgICAgICAgICAgbWVkaWFuID0gbWVkaWFuKHBlcmNlbnRhZ2UpKSAlPiUgCiAga2FibGUoZGlnaXRzID0gNCwgCiAgICAgICAgY2FwdGlvbiA9ICJTdW1tYXJ5IHN0YXRpc3RpY3Mgb2YgcGVyY2VudGFnZSBvZiBNeWVsb2lkMiB0cmFuc2NyaXB0cyBmb3IgZGlmZmVyZW50IGNvbmRpdGlvbnMiKQpgYGAKClRvIHNlZSBpZiB0aGVyZSBpcyBhIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgdGhyZWUgY29uZGl0aW9ucyBhIEtydXNrYWwtV2FsbGlzLVRlc3QKd2FzIHBlcmZvcm1lZC4gV2UgZ2V0IGEgcC12YWx1ZSBvZiA0Ljg4ICogMTBeLTkuIFRoZXJlZm9yZSwgd2Ugd2lsbCBwZXJmb3JtIAphIHBhaXJ3aXNlIFdpbGNveCB0ZXN0IHRvIHNlZSB3aGljaCBjb25kdGlvbnMgYXJlIGRpZmZlcmVudCBmcm9tIGVhY2ggb3RoZXIuCgpgYGB7cn0KcGVyY2VudGFnZV9teTJfdHJhbnNjcmlwdHMgJT4lIAogIHJzdGF0aXg6OmtydXNrYWxfdGVzdChwZXJjZW50YWdlIH4gY29uZGl0aW9uKSAlPiUKICBrYWJsZShjYXB0aW9uID0gIktydXNrYWwgV2FsbGlzIFRlc3QiKQpgYGAKCioqUGFpcndpc2UgV2lsY294IHRlc3Q6KioKCkluIHRoZSB0YWJsZSBhbmQgYm94cGxvdCBiZWxvdyB3ZSBjYW4gc2VlIHRoYXQgYWxsIHRocmVlIGNvbmRpdGlvbnMgYXJlIHNpZ25pZmljYW50bHkgCmRpZmZlcmVudCBmcm9tIGVhY2ggb3RoZXIuIEFzIG1lbnRpb25lZCBhYm92ZSwgdGhlIHNhbXBsZSBzaXplIGlzIG11Y2ggc21hbGxlcgpmb3IgdGhlIHVuaW5mZWN0ZWQgY29uZGl0aW9uLiBQLXZhbHVlcyBhcmUgbGlzdGVkIGluIHRoZSB0YWJsZSBiZWxvdy4KCk9ubHkgdGhlIHAtdmFsdWUgZm9yIHRoZSBjb21wYXJpc29uIGJldHdlZW4gaW5mZWN0ZWQgQ1NGIHZzIHVuaW5mZWN0ZWQgQ1NGIGlzCnRoZSBzYW1lIGFzIGluIHRoZSBwYXBlciwgd2hlcmUgdGhleSBzdGF0ZSB0aGF0IHRoZSBNeWVsb2lkMiB0cmFuc2NyaXB0cyB3ZXJlCmZvdW5kIGF0IGxvd2VyIGxldmVscyBpbiB0aGUgdW5pbmZlY3RlZCBzYW1wbGVzIGNvbXBhcmVkIHRvIHRoZSBpbmZlY3RlZCBzYW1wbGVzLgpPdGhlcndpc2UsIHRoZSByZXN1bHRzIGNvbnRyYWRpY3QgdGhlIHJlc3VsdHMgZm91bmQKYnkgW0BGYXJoYWRpYW5dLiBDb250cmFkaWN0b3J5IHRvIHdoYXQgaXMgY2xhaW1lZCBpbiB0aGUgcGFwZXIsIGl0IGlzIG5vdCBldmlkZW50CnRoYXQgYm90aCBpbmZlY3RlZCBhbmQgdW5pbmZlY3RlZCBDU0Ygc2FtcGxlcyBoYXZlIGhpZ2hlciByYXRlcyBvZiBNeWVsb2lkMiAKdHJhbnNjcmlwdHMsIHJhdGhlciB0aGUgQmxvb2Qgc2FtcGxlcyBzZWVtIHRvIGhhdmUgdGhlIGhpZ2hlc3QgcmF0ZSBvZiBNeWVsb2lkMiAKdHJhbnNjcmlwdHMuIAoKVGhlIGNvbXBhcmlzb24gZHJhd24gaXMgcXVlc3Rpb25hYmxlIGluIGdlbmVyYWwsIGJlY2F1c2Ugd2hhdCB0aGUgYm94cGxvdHMgYmVsb3cKc2hvdyBpcyB0aGF0IHRoZXJlIGlzIHNvbWUgbGV2ZWwgb2YgTXllbG9pZDIgdHJhbnNjcmlwdCBleHByZXNzaW9uIGluIGFsbCBjb25kaXRpb25zLiAKSG93ZXZlciwgdGhlcmUgYXJlIG1vcmUgb3V0bGllcnMgd2l0aCB2ZXJ5IGhpZ2ggcGVyY2VudGFnZSBvZiBNeWVsb2lkMiB0cmFuc2NyaXB0cyBpbgpib3RoIENTRiBzYW1wbGVzLiBUaGlzIG1pZ2h0IGJlIGEgaGludCB0aGF0IGluIHRoZSBDU0Ygc2FtcGxlcyB0aGVyZSBpcyBhIApvdXRsaWVyIHBvcHVsYXRpb24gcmVwcmVzZW50aW5nIHRoZSBNeWVsb2lkMiBjbHVzdGVyLCB3aGljaCBjYW5ub3QgYmUgc2VlbiAKaW4gdGhlIGJsb29kIHNhbXBsZS4gU2luY2UgdGhlIG1lZGlhbiBpcyByYXRoZXIgcm9idXN0CnRvIG91dGxpZXJzLCBldmVuIGlmIGluIENTRiBzYW1wbGVzIHRoZXJlIGFyZSBzb21lIGNlbGxzIHdoaWNoIGhhdmUgbXVjaCBoaWdoZXIKZnJlcXVlbmNpZXMgb2YgdHJhbnNjcmlwdHMsIGl0IG1pZ2h0IGJlIHRoYXQgdGhlIG1lZGlhbiBpcyBzdGlsbCBsb3dlciB0aGFuIAppbiBibG9vZCBzYW1wbGVzLgoKVGhlcmVmb3JlLCBjb21wYXJpbmcgdGhlIG92ZXJhbGwgcGVyY2VudGFnZSBvZiAKTXllbG9pZDIgdHJhbnNjcmlwdHMgbWlnaHQgbm90IHByb3ZpZGUgYW55IGluc2lnaHRzIG9uIHRoZSBudW1iZXIgb2YgCk15ZWxvaWQyIGNlbGxzIGluIGEgcGFydGljdWxhciBzYW1wbGUuCgpgYGB7ciwgZmlnLndpZHRoID0gMTAsIGZpZy5oZWlnaHQ9Nn0KcDEgPC0gcGVyY2VudGFnZV9teTJfdHJhbnNjcmlwdHMgJT4lIGdncGxvdCgpICsKICBnZW9tX2JveHBsb3QoYWVzKHggPSBjb25kaXRpb24sIHkgPSBwZXJjZW50YWdlLCBmaWxsID0gY29uZGl0aW9uKSkgKwogIHhsYWIoIlNhbXBsZSBvcmlnaW4iKSArCiAgeWxhYigiRnJlcXVlbmN5IG9mIG15ZWxvaWQyIHRyYW5zY3JpcHRzIHBlciBjZWxsIikgKwogIGxhYnModGl0bGUgPSAiQWxsIGNlbGxzIikgKwogIHN0YXRfcHZhbHVlX21hbnVhbChwZXJjZW50YWdlX215Ml90cmFuc2NyaXB0cyAlPiUgCiAgICByc3RhdGl4OjpwYWlyd2lzZV93aWxjb3hfdGVzdChwZXJjZW50YWdlIH4gY29uZGl0aW9uKSAlPiUgCiAgICAgIHJzdGF0aXg6OmFkZF94eV9wb3NpdGlvbigpKSArCiAgTm9MZWdlbmQoKQoKcDIgPC0gcGVyY2VudGFnZV9teTJfdHJhbnNjcmlwdHMgJT4lIGdncGxvdCgpICsKICBnZW9tX2JveHBsb3QoYWVzKHggPSBjb25kaXRpb24sIHkgPSBwZXJjZW50YWdlLCBmaWxsID0gY29uZGl0aW9uKSwgCiAgICAgICAgICAgICAgIG91dGxpZXIuc2hhcGUgPSBOQSkgKwogIHhsYWIoIlNhbXBsZSBvcmlnaW4iKSArCiAgeWxhYigiRnJlcXVlbmN5IG9mIG15ZWxvaWQyIHRyYW5zY3JpcHRzIHBlciBjZWxsIikgKwogIGxhYnModGl0bGUgPSAiUmVtb3ZlIG91dGxpZXJzIHRvIHNlZSBkaWZmZXJlbmNlIikgKwogIE5vTGVnZW5kKCkKCmdnYXJyYW5nZShwMSwgcDIsIG5jb2wgPSAyLCBucm93ID0gMSkKYGBgCgoKYGBge3J9CnBlcmNlbnRhZ2VfbXkyX3RyYW5zY3JpcHRzICU+JSAKICByc3RhdGl4Ojp3aWxjb3hfdGVzdChwZXJjZW50YWdlIH4gY29uZGl0aW9uKSAlPiUga2FibGUoY2FwdGlvbiA9ICJQYWlyd2lzZSBXaWxjb3ggVGVzdCIpCmBgYAoKCiMgTGFiZWwgVHJhbnNmZXIKCkZvciByZWZlcmVuY2Ugc2VlOgpodHRwczovL3NhdGlqYWxhYi5vcmcvc2V1cmF0L2FydGljbGVzL2ludGVncmF0aW9uX21hcHBpbmcuaHRtbAoKQWZ0ZXIgcmVwcm9kdWNpbmcgdGhlIHJlc3VsdHMgZnJvbSBbQEZhcmhhZGlhbl0gdGhlIG5leHQgCnN0ZXAgd2FzIHRvIHRyYW5zZmVyIHRoZSBsYWJlbHMgZnJvbSB0aGUgZm91ciBISVYrIEJsb29kIGFuZCBDU0Ygc2FtcGxlcyAocmVmZXJlbmNlKSAKdG8gdGhlIHJlbWFpbmluZyBzYW1wbGVzIChxdWVyeSk6CgoqIDEgQ1NGIHNtYXBsZSBmcm9tIEhJVi0xIGluZmVjdGVkIHBhdGllbnQKKiAyIENTRiBzYW1wbGVzIGZyb20gdW5pbmZlY3RlZCBwYXRpZW50cwoKCgpNeWVsb2lkMSwgTXllbG9pZDMgYW5kIE15ZWxvaWQ0IGFyZSBub3Qgb3IgaGFyZGx5IHByZXNlbnQgaW4gdGhlIENTRiBzYW1wbGVzLCAKYmVjYXVzZSB0aGV5IG9yaWdpbmF0ZWQgZXhjbHVzaXZlbHkgZnJvbSB0aGUgYmxvb2Qgc2FtcGxlcyBpbiB0aGUgcmVmZXJlbmNlIApkYXRhc2V0LiBIb3dldmVyLCB0aGVyZSBhcmUgMTMyIGNlbGxzIGFubm90YXRlZCBhcyBNeWVsb2lkMiBhbmQgNDMgY2VsbHMgCmFubm90YXRlZCBhcyBNeWVsb2lkNS4gCgoKYGBge3J9CiMgU2V1cmF0IG9iamVjdHMgd2l0aCBhbm5vdGF0ZWQgY2VsbCB0eXBlcwpoaXY0IDwtIHJlYWRSRFMoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvUmVwcm9kdWNlX0ZhcmhhZGlhbl9QYXBlci9TZXVyYXRfb2JqZWN0cy9ub25faW50ZWdyYXRlZF9ISVYxX0hJVjJfNHNhbXBsZXNfc2V1cmF0X29iamVjdC5yZHMiKQpgYGAKCmBgYHtyfQojIHJlYWQgaW4gdGhlIGRhdGFzZXQgYWZ0ZXIgcXVhbGl0eSBjb250cm9sCmhpdl9maWx0IDwtIHJlYWRSRFMoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvUmVwcm9kdWNlX0ZhcmhhZGlhbl9QYXBlci9TZXVyYXRfb2JqZWN0cy90b3RhbF83X3NhbXBsZXNfZmlsdGVyZWRfc2V1cmF0X29iamVjdC5yZHMiKQpoaXZfbGlzdCA8LSBTcGxpdE9iamVjdChoaXZfZmlsdCwgc3BsaXQuYnkgPSAib3JpZy5pZGVudCIpCmBgYAoKCmBgYHtyLCByZXN1bHRzID0gImFzaXMifQojIG1lcmdlIHRoZSAzIHF1ZXJ5IFNldXJhdCBvYmplY3RzCnF1ZXJ5IDwtIG1lcmdlKGhpdl9saXN0W1siVW5pbmZlY3RlZDFfQ1NGIl1dLCAKICAgICAgICAgICAgICAgYyhoaXZfbGlzdFtbIlVuaW5mZWN0ZWQyX0NTRiJdXSwgaGl2X2xpc3RbWyJISVYzX0NTRiJdXSkpCgojIGZpbmQgdHJhbnNmZXIgYW5jaG9ycyBiZXR3ZWVuIHRoZSAzIHF1ZXJ5IHNhbXBsZXMgYW5kIHRoZSA0IHNhbXBsZXMgd2UgaGF2ZSAKIyBhbmFseXplZCBwcmV2aW91c2x5CmhpdjRfdHJhbnNmZXJfYW5jaG9ycyA8LSBGaW5kVHJhbnNmZXJBbmNob3JzKHJlZmVyZW5jZSA9IGhpdjQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaW1zID0gMToxNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXphdGlvbi5tZXRob2QgPSAiTG9nTm9ybWFsaXplIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlLnJlZHVjdGlvbiA9ICJwY2EiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWR1Y3Rpb24gPSAicGNhcHJvamVjdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcmJvc2UgPSBGQUxTRSkKCnByZWRpY3Rpb25zIDwtIFRyYW5zZmVyRGF0YShhbmNob3JzZXQgPSBoaXY0X3RyYW5zZmVyX2FuY2hvcnMsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZGF0YSA9IGhpdjQkY2VsbF90eXBlLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpbXMgPSAxOjE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyYm9zZSA9IEZBTFNFKQojcHJlZGljdGlvbnMgJT4lIGhlYWQgJT4lIGthYmxlKCkKCnF1ZXJ5IDwtIEFkZE1ldGFEYXRhKHF1ZXJ5LCBtZXRhZGF0YSA9IHByZWRpY3Rpb25zKQojc2F2ZVJEUyhxdWVyeSwgIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvUmVwcm9kdWNlX0ZhcmhhZGlhbl9QYXBlci9TZXVyYXRfb2JqZWN0cy9xdWVyeV9zZXVyYXRfb2JqZWN0X2xhYmVsX3RyYW5zZmVyIikKdGFibGUocXVlcnkkcHJlZGljdGVkLmlkKSAlPiUga2FibGUoKQpgYGAKCiMjIyBDaGVjayB0aGUgZ2VuZSBleHByZXNzaW9uIGxldmVscyBvZiB0aGUgcHJlZGljdGVkIGNlbGwgdHlwZXMgey50YWJzZXR9CgpUaGUgTGFiZWwgVHJhbnNmZXIgc2VlbXMgdG8gd29yayBuaWNlbHksIGp1ZGdpbmcgZnJvbSB0aGUgY29ycmVjdCBleHByZXNzaW9uIG9mCmNvbW1vbiBjZWxsIHR5cGUgbWFya2VycyBmb3IgdGhlIGluZGl2aWR1YWwgY2VsbCB0eXBlcy4KCiMjIyMgTXllbG9pZDIgbWFya2VyIGdlbmVzCgpgYGB7ciwgZmlnLndpZHRoPTEyLCBmaWcuaGVpZ2h0ID0gMTB9CiMgY2VjayB0aGUgTXllbG9pZDIgbWFya2VycwpwMSA8LSBWbG5QbG90KHF1ZXJ5LAogICAgICAgICAgICAgIGZlYXR1cmVzID0gIGMoIkFYTCIsICJBUE9FIiwgIlRSRU0yIiksIAogICAgICAgICAgICAgIGdyb3VwLmJ5ID0gInByZWRpY3RlZC5pZCIsIAogICAgICAgICAgICAgIHB0LnNpemUgPSAuMDEsIG5jb2wgPSAzKQpwMiA8LSBWbG5QbG90KHF1ZXJ5LCAKICAgICAgICAgICAgICBmZWF0dXJlcyA9ICBjKCJDVFNCIiwgIk1TUjEiLCAiQzFRQSIpLCAKICAgICAgICAgICAgICBncm91cC5ieSA9ICJwcmVkaWN0ZWQuaWQiLAogICAgICAgICAgICAgIHB0LnNpemUgPSAuMDEsIG5jb2wgPSA0KQoKZmlndXJlIDwtIGdnYXJyYW5nZShwMSwgcDIsIG5jb2wgPSAxLCBucm93ID0gMikKYW5ub3RhdGVfZmlndXJlKGZpZ3VyZSwgdG9wID0gdGV4dF9ncm9iKCJNeWVsb2lkMiBtYXJrZXIgZ2VuZXMiKSkKYGBgCgojIyMjIE15ZWxvaWQ1IG1hcmtlciBnZW5lcwpgYGB7cn0KCiMgTXllbG9pZCA1IG1hcmtlcnMKcDEgPC0gVmxuUGxvdChxdWVyeSwgYygiRkNFUjFBIiwgIkNEMUMiKSwKICAgICAgICBncm91cC5ieSA9ICJwcmVkaWN0ZWQuaWQiLCBwdC5zaXplID0gLjAxLCBuY29sID0gMikgCnAxCmBgYAoKCiMjIyMgUGxhc21hIGNlbGwgbWFya2VyIGdlbmVzCmBgYHtyfQojIHBsYXNtYSBjZWxsIG1hcmtlcnMKcDIgPC0gVmxuUGxvdChxdWVyeSwgZmVhdHVyZXMgPSBjKCJJR0oiKSwgCiAgICAgICAgZ3JvdXAuYnkgPSAicHJlZGljdGVkLmlkIiwgcHQuc2l6ZSA9IC4wMSwgbmNvbCA9IDIpIApwMgpgYGAKCiMjIyMgQ0Q4IFQgY2VsbCBtYXJrZXIgZ2VuZXMKCmBgYHtyfQojIENEOCBUIENlbGxzCnAzIDwtIFZsblBsb3QocXVlcnksIGZlYXR1cmVzID0gYygiQ0Q4QSIpLAogICAgICAgIGdyb3VwLmJ5ID0gInByZWRpY3RlZC5pZCIsIHB0LnNpemUgPSAuMDEsIG5jb2wgPSAyKSArIE5vTGVnZW5kKCkKcDMKYGBgCgojIyMjIFQgY2VsbCBtYXJrZXIgZ2VuZXMKCmBgYHtyfQojIFQgY2VsbHMgClZsblBsb3QocXVlcnksIGZlYXR1cmVzID0gYygiSUw3UiIsICJUUkFDIiksCiAgICAgICAgZ3JvdXAuYnkgPSAicHJlZGljdGVkLmlkIiwgcHQuc2l6ZSA9IC4wMSwgbmNvbCA9IDIpCmBgYAoKIyMjIyBOSyBjZWxsIG1hcmtlciBnZW5lcwoKYGBge3IsIGZpZy53aWR0aD0xNX0KIyBOSyBjZWxscwpWbG5QbG90KHF1ZXJ5LCBmZWF0dXJlcyA9IGMoIk5LRzciLCAiR05MWSIsICJHWk1CIiksIAogICAgICAgIGdyb3VwLmJ5ID0gInByZWRpY3RlZC5pZCIsIHB0LnNpemUgPSAuMDEsIG5jb2wgPSAzKQpgYGAKCgojIyMjIEIgY2VsbCBtYXJrZXIgZ2VuZXMKCmBgYHtyLCBmaWcud2lkdGg9MTV9CiMgQiBjZWxscwpWbG5QbG90KHF1ZXJ5LCBmZWF0dXJlcyA9IGMoIk1TNEExIiwgIkNENzlBIiwgIlRDTDFBIiksIAogICAgICAgIGdyb3VwLmJ5ID0gInByZWRpY3RlZC5pZCIsIHB0LnNpemUgPSAuMDEsIG5jb2wgPSAzKQoKCmBgYAoKCiMjIyB7LX0KLS0tCgoKIyMjIFVNQVAgcHJvamVjdGlvbiBvZiBhZGRpdGlvbmFsIHNhbXBsZXMKCkEgVU1BUCBlbWJlZGRpbmcgb2YgdGhlIGZvdXIgcmVmZXJlbmNlIHNhbXBsZXMgd2FzIGNhbGN1bGF0ZWQgKGZpZ3VyZSBiZWxvdywgbGVmdCkKYW5kIHRoZSBhbm5vdGF0ZWQgcWVyeSBzYW1wbGUgaXMgc2hvd24gaW4gZW1iZWRkZWQgaW4gdGhlIHNhbWUgc3BhY2UgKGZpZ3VyZSBiZWxvdywgcmlnaHQuCk5vdyB0aGF0IHdlIGhhdmUgYW5ub3RhdGVkIHRoZSBjZWxsIHR5cGVzIG9mIGFsbCBzZXZlbiBzYW1wbGVzIHdlIGNhbiB1c2UgdGhlbSAKZm9yIGZ1cnRoZXIgYW5hbHlzaXMuIAoKYGBge3IsIGZpZy53aWR0aD0xMCwgZmlnLmhlaWdodD04fQpoaXY0X3Rlc3QgPC0gUnVuVU1BUChoaXY0LCBkaW1zID0gMToxNSwgCiAgICAgICAgICAgICAgICAgICAgIHJlZHVjdGlvbiA9ICJwY2EiLCAKICAgICAgICAgICAgICAgICAgICAgcmV0dXJuLm1vZGVsID0gVFJVRSwgCiAgICAgICAgICAgICAgICAgICAgIHZlcmJvc2UgPSBGQUxTRSkKCmhpdjNjc2YgPC0gTWFwUXVlcnkoYW5jaG9yc2V0ID0gaGl2NF90cmFuc2Zlcl9hbmNob3JzLAogICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZSA9IGhpdjRfdGVzdCwgcXVlcnkgPSBxdWVyeSwKICAgICAgICAgICAgICAgICAgICByZWZkYXRhID0gbGlzdChjZWxsdHlwZSA9ICJjZWxsX3R5cGUiKSwKICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2UucmVkdWN0aW9uID0gInBjYSIsCiAgICAgICAgICAgICAgICAgICAgcmVkdWN0aW9uLm1vZGVsID0gInVtYXAiLCAKICAgICAgICAgICAgICAgICAgICB2ZXJib3NlID0gRkFMU0UpCgoKCgpxdWVyeSA8LSBUcmFuc2ZlckRhdGEoYW5jaG9yc2V0ID0gaGl2NF90cmFuc2Zlcl9hbmNob3JzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlID0gaGl2NF90ZXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBxdWVyeSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmRhdGEgPSBsaXN0KGNlbGx0eXBlID0gImNlbGxfdHlwZSIpLCAKICAgICAgICAgICAgICAgICAgICAgIHZlcmJvc2UgPSBGQUxTRSkKCnF1ZXJ5IDwtIEludGVncmF0ZUVtYmVkZGluZ3MoYW5jaG9yc2V0ID0gaGl2NF90cmFuc2Zlcl9hbmNob3JzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZSA9IGhpdjRfdGVzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LnJlZHVjdGlvbi5uYW1lID0gInJlZi5wY2EiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcmJvc2UgPSBGQUxTRSkKCnF1ZXJ5IDwtIFByb2plY3RVTUFQKHF1ZXJ5ID0gcXVlcnksCiAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkucmVkdWN0aW9uID0gInJlZi5wY2EiLAogICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZSA9IGhpdjRfdGVzdCwKICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2UucmVkdWN0aW9uID0gInBjYSIsCiAgICAgICAgICAgICAgICAgICAgICAgcmVkdWN0aW9uLm1vZGVsID0gInVtYXAiLCB2ZXJib3NlID0gRkFMU0UpCmBgYAoKYGBge3IsIGZpZy53aWR0aD0xMn0KIyBWaXN1YWxpemUgdGhlIHF1ZXJ5IGNlbGxzIGFsb25nc2lkZSB0aGUgcmVmZXJlbmNlCnAxIDwtIERpbVBsb3QoaGl2NF90ZXN0LAogICAgICAgICAgICAgIHJlZHVjdGlvbiA9ICJ1bWFwIiwKICAgICAgICAgICAgICBncm91cC5ieSA9ICJjZWxsX3R5cGUiLAogICAgICAgICAgICAgIGxhYmVsID0gVFJVRSwKICAgICAgICAgICAgICBsYWJlbC5zaXplID0gNSwKICAgICAgICAgICAgICByZXBlbCA9IFRSVUUsIAogICAgICAgICAgICAgIHB0LnNpemUgPSAuMSkgKyBOb0xlZ2VuZCgpICsKICBnZ3RpdGxlKCJSZWZlcmVuY2UgYW5udG9hdGlvbnMiKQoKcDIgPC0gRGltUGxvdChxdWVyeSwgCiAgICAgICAgICAgICAgcmVkdWN0aW9uID0gInJlZi51bWFwIiwKICAgICAgICAgICAgICBncm91cC5ieSA9ICJwcmVkaWN0ZWQuY2VsbHR5cGUiLCAKICAgICAgICAgICAgICBsYWJlbCA9IFRSVUUsCiAgICAgICAgICAgICAgbGFiZWwuc2l6ZSA9IDUsCiAgICAgICAgICAgICAgcHQuc2l6ZSA9IC4xLAogICAgICAgICAgICAgIHJlcGVsID0gVFJVRSkgKyBOb0xlZ2VuZCgpICsKICAgZ2d0aXRsZSgiVHJhbnNmZXJyZWQgTGFiZWxzIikKCnAxICsgcDIKYGBgCgpgYGB7cn0KI3NhdmUgdGhpcyBuZXcgU2V1cmF0IG9iZWpjdCBpbmNsdWRpbmcgdGhlIFNDVHJhbnNmb3JtYXRpbgoKI3NhdmVSRFMoaGl2X2xhYmVsX3RyYW5zZmVyLCBmaWxlID0gIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvUmVwcm9kdWNlX0ZhcmhhZGlhbl9QYXBlci9TZXVyYXRfb2JqZWN0cy90b3RhbF83X3NhbXBsZXNfbGFiZWxfdHJhbnNmZXIucmRzIikKYGBgCgoKCiMjIEZyZXF1ZW5jeSBvZiBjZWxsIHR5cGVzIGluIENTRiBhbmQgYmxvb2Qgc2FtcGxlcwoKSG93IGFyZSBjZWxsIHR5cGVzIGRpc3RyaWJ1dGVkIGFjcm9zcyBzYW1wbGVzLCBjb25zaWRlcmluZyBhbHNvIHRoZSBhZGRpdGlvbmFsCkhJVisgQ1NGIHNhbXBsZSBhbmQgdGhlIHR3byB1bmluZmVjdGVkIHNhbXBsZXMgd2hpY2ggd2VyZSBhbm5vdGF0ZWQgdXNpbmcgbGFiZWwgCnRyYW5zZmVyLgoKYGBge3IsIGZpZy53aWR0aCA9IDE1fQpoaXY3IDwtIHJlYWRSRFMoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvUmVwcm9kdWNlX0ZhcmhhZGlhbl9QYXBlci9TZXVyYXRfb2JqZWN0cy90b3RhbF83X3NhbXBsZXNfbGFiZWxfdHJhbnNmZXIucmRzIikKCmN1c3RvbV9jb2xvciA8LSBjKCIjQzNEN0E0IiwgIiM0RTg0QzQiLCAiIzUyODU0QyIsICIjMjkzMzUyIiwgImxpZ2h0c2t5Ymx1ZSIsICJvcmFuZ2VyZWQyIiwgIm9yYW5nZTIiKQoKI3Bsb3QgYSBiYXJwbG90IG9mIHRoZSBwcm9wb3J0aW9ucyBvZiBzYW1wbGVzIGFuZCBjZWxsIHR5cGVzCnAyIDwtIGdncGxvdChoaXY3QG1ldGEuZGF0YSkgKwogIGdlb21fYmFyKGFlcyh4ID0gY2VsbF90eXBlLCBmaWxsID0gb3JpZy5pZGVudCkpICsKICBzY2FsZV9maWxsX21hbnVhbCggdmFsdWVzID0gY3VzdG9tX2NvbG9yKSArCiAgeWxhYigiTnVtYmVyIG9mIGNlbGxzIGluIGVhY2ggY2x1c3RlciIpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3Q9MSkpICsKICBsYWJzKHRpdGxlID0gIkZyZXF1ZW5jeSBvZiBjZWxsIHR5cGVzIGZyb20gZWFjaCBzYW1wbGUgYWZ0ZXIgbGFiZWwgdHJhbnNmZXIiKQoKY3VzdG9tX2NvbG9yIDwtIGMoIiNDM0Q3QTQiLCAiIzRFODRDNCIsICIjNTI4NTRDIiwgIiMyOTMzNTIiKQoKI3Bsb3QgYSBiYXJwbG90IG9mIHRoZSBwcm9wb3J0aW9ucyBvZiBzYW1wbGVzIGFuZCBjZWxsIHR5cGVzCnAxIDwtIGdncGxvdChoaXY0QG1ldGEuZGF0YSkgKwogIGdlb21fYmFyKGFlcyh4ID0gY2VsbF90eXBlLCBmaWxsID0gb3JpZy5pZGVudCkpICsKICBzY2FsZV9maWxsX21hbnVhbCggdmFsdWVzID0gY3VzdG9tX2NvbG9yKSArCiAgeWxhYigiTnVtYmVyIG9mIGNlbGxzIGluIGVhY2ggY2x1c3RlciIpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3Q9MSkpICsKICBsYWJzKHRpdGxlID0gIkZyZXF1ZWN5IG9mIGNlbGwgdHlwZXMgZnJvbSBlYWNoIHNhbXBsZSBhZnRlciBsYWJlbCB0cmFuc2ZlciIpCgpnZ2FycmFuZ2UocDEsIHAyLCBuY29sID0gMiwgbnJvdyA9IDEpCgpgYGAKCgoKIyBBcHBlbmRpeAoKCiMjIEluZGVwZW5kZW50IGFubm90YXRpb24gb2YgTXllbG9pZDIgYW5kIE15ZWxvaWQ1IGNsdXN0ZXJzIGFzIE1pY3JvZ2xpYS1saWtlIGNlbGxzCgoKSW4gdGhlIGZvbGxvd2luZyBwYXJ0IEkgdHJpZWQgdG8gY29uZmlybSB0aGF0IHRoZSBNeWVsb2lkMiAoYW5kIG1heWJlIHRoZSAKTXllbG9pZDUpIGNsdXN0ZXIgYXJlIG1pY3JvZ2xpYS1saWtlIGNlbGxzLiBbQEZhcmhhZGlhbl0gdXNlZCA2MCBnZW5lcyB0byAKY2hhcmFjdGVyaXplIE15ZWxvaWQyIGNlbGxzLCBzb21lIG9mIHdoaWNoIGFyZSBmb3VuZCBpbiBkaXNlYXNlLWFzc29jaWF0ZWQgCm1pY3JvZ2xpYS4gU2VhcmNoaW5nIHRoZSBsaXRlcmF0dXJlIGZvciBhZGRpdGlvbmFsIG1pY3JvZ2xpYSBzaWduYXR1cmVzIHdlIG1pZ2h0CmJlIGFibGUgdG8gaW5kZXBlbmRlbnRseSBjb25maXJtIHRoaXMgbWljcm9nbGlhLWxpa2Ugc2lnbmF0dXJlLgoKQmVsb3cgeW91IGNhbiBjbGljayBvbiB0aGUgdGFicyB0byBzZWUgdGhlIHJlc3VsdHMgb2YgdXNpbmcgZGlmZmVyZW50IGdlbmUgCnNpZ25hdHVyZXMgdG8gY29uZmlybSB0aGUgbWljcm9nbGlhLWxpa2Ugc2lnbmF0dXJlIG9mIE15ZWxvaWQyIGFuZCBNeWVsb2lkNS4gClRoZSBmdW5jdGlvbiB1c2VkIHRvIGNhbGN1bGF0ZSB0aGUgZ2VuZSBzaWduYXR1cmUgc2NvcmUgaW4gZGlmZmVyZW50IGNlbGxzCmlzIGBBZGRNb2R1bGVTY29yZSgpYC4KCgojIyMjIEZ1bmN0aW9uIEFkZCBNb2R1bGUgU2NvcmUKClRoaXMgRnVuY3Rpb24gY2FsY3VsYXRlcyB0aGUgYXZlcmFnZSBleHByZXNzaW9uIGxldmVscyBvZiBlYWNoIGNsdXN0ZXIgb24gc2luZ2xlIApjZWxsIGxldmVsLCBzdWJ0cmFjdGVkIGJ5IHRoZSBhZ2dyZWdhdGVkIGV4cHJlc3Npb24gb2YgY29udHJvbCBmZWF0dXJlIHNldHMuIApUaGUgYW5hbHl6ZWQgZmVhdHVyZXMgYXJlIGJpbm5lZCBiYXNlZCBvbiBhdmVyYWdlZCBleHByZXNzaW9uIGFuZCB0aGUgY29udHJvbCBmZWF0dXJlcyBhcmUgCnJhbmRvbWx5IHNlbGVjdGVkIGZyb20gZWFjaCBiaW4uIAoKCmBgYHtyfQojIHJlYWQgaW4gU2V1cmF0IG9iamVjdApoaXY0IDwtIHJlYWRSRFMoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvUmVwcm9kdWNlX0ZhcmhhZGlhbl9QYXBlci9TZXVyYXRfb2JqZWN0cy9ub25faW50ZWdyYXRlZF9ISVYxX0hJVjJfNHNhbXBsZXNfc2V1cmF0X29iamVjdC5yZHMiKQpgYGAKCgoKIyMgRGlmZmVyZW50IGdlbmUgc2lnbmF0dXJlcyBmb3VuZCBpbiB0aGUgbGl0ZXJhdHVyZSB7LnRhYnNldH0KCiMjIyBGYXJoYWRpYW4gZXQgYWwuCgo2MCBnZW5lcyB3ZXJlIHVzZWQgYnkgRmFyaGFkaWFuIGV0IGFsLiB0byBkaXN0aW5ndWlzaCB0aGUgTXllbG9pZDIgY2VsbCB0eXBlLgoyOCBvZiB0aGUgNjAgZ2VuZXMgdXNlZCBhcyBtaWNyb2dsaWEgc2lnbmF0dXJlIGluIHRoZSBbQEZhcmhhZGlhbl0gUGFwZXIgYXJlIGFsc28gCmZvdW5kIGluIHRoZSA4ODEgbWljcm9nbGlhIHNpZ25hdHVyZSBnZW5lcyBkZWZpbmVkIGJ5IFtAR29zc2VsaW5dLgoKYGBge3J9CiMjIFJlYWQgaW4gbGlzdCBvZiBtaWNyb2dsaWEgc2lnbmF0dXJlIGdlbmVzIGZvdW5kIGluIHRoZSBHb3NzZWxpbiBwYXBlcgojIyB3aGljaCBhcmUgYWxzbyBmb3VuZCBpbiB0aGUgSElWMSBhbmQgSElWMiBzYW1wbGVzOgptaWNyb2dsaWFfZ2VuZXMgPC0gcmVhZC50YWJsZSgiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL2RhdGEvTWljcm9nbGlhX2dlbmVfc2lnbmF0dXJfZm91bmRfaW5fSElWMV9ISVYyX3NhbXBsZXMiKQpgYGAKCgpgYGB7ciwgcmVzdWx0cyA9ICJhc2lzIn0KIyBBcmUgdGhlcmUgYW55IGdlbmVzIG92ZXJsYXBwaW5nIGJldHdlZW4gRmFyaGFkaWFuIGFuZCBHbGFzcyBwYXBlcj8KI2ltcG9ydCB0aGUgNjAgZ2VuZXMgdGhhdCB3ZXJlIHVwcmVndWxhdGVkIGluIE15ZWxvaWQtMiBpbiB0aGUgcGFwZXIgY29tcGFyZWQgdG8gdGhlIGZvdXIgb3RoZXIgbXllbG9pZCBzdWJzZXRzCnBhcGVyIDwtIHJlYWQudGFibGUoZmlsZSA9ICIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvZGF0YS9NeWVsb2lkLTJfZ2VuZXNfcGFwZXIuY3N2Iiwgc2VwID0gIlx0IiwgaGVhZGVyID0gRkFMU0UsIHNraXBOdWwgPSBUUlVFKSMsIG5fbWF4ID0gNjApCnBhcGVyWzEsXSA8LSAiQVBPQzEiCmNvbG5hbWVzKHBhcGVyKSA8LSAiIgpwYXBlciA8LSBhcy52ZWN0b3IocGFwZXJbLDFdKQoKIyBBcmUgdGhlcmUgYW55IGdlbmVzIG92ZXJsYXBwaW5nIGJldHdlZW4gRmFyaGFkaWFuIGFuZCBHbGFzcyBwYXBlcj8KI3BhcGVyICVpbiUgYXMudmVjdG9yKG1pY3JvZ2xpYV9nZW5lc1tbImdlbmVfbmFtZSJdXSkKCm92ZXJsYXAgPC0gYXMudmVjdG9yKG1pY3JvZ2xpYV9nZW5lc1tbImdlbmVfbmFtZSJdXSkgW2FzLnZlY3RvcihtaWNyb2dsaWFfZ2VuZXNbWyJnZW5lX25hbWUiXV0pICVpbiUgcGFwZXJdCiNsZW5ndGgob3ZlcmxhcCkKI292ZXJsYXAgJT4lIGthYmxlKCkKYGBgCgpgYGB7cn0KIyBnZXQgb25seSBnZW5lcyBwcmVzZW50IGluIHRoZSBISVYxIGFuZCBISVYyIHNhbXBsZXMhCnBhcGVyIDwtIHBhcGVyW3BhcGVyICVpbiUgcm93bmFtZXMoaGl2NEBhc3NheXMkUk5BQGNvdW50cyldCgoKaGl2X2ZhcmhhZGlhbiA8LSBBZGRNb2R1bGVTY29yZShoaXY0LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMgPSBwYXBlcikKCklkZW50cyhoaXZfZmFyaGFkaWFuKSA8LSAiY2VsbF90eXBlIgpGZWF0dXJlUGxvdChoaXZfZmFyaGFkaWFuLCBmZWF0dXJlcyA9ICJDbHVzdGVyMSIgLCBwdC5zaXplID0gLjUsIGxhYmVsID0gVFJVRSwgcmVwZWwgPSBUUlVFKSArCiAgICBzY2FsZV9jb2xvdXJfZ3JhZGllbnRuKGNvbG91cnMgPSByZXYoYnJld2VyLnBhbChuID0gMTEsIG5hbWUgPSAiUmRCdSIpKSkgKwogIGxhYnModGl0bGUgPSAiRmFyaGFkaWFuIGV0IGFsLiwgMjAxODogTWljcm9nbGlhIHNpZ25hdHVyZSBnZW5lcyIpCgpgYGAKCiMjIyBHb3NzZWxpbiBldCBhbC4gCgoKSGVyZSwgSSB3aWxsIGZpcnN0IHVzZSB0aGUgODgxIG1pY3JvZ2xpYSBtYXJrZXIgZ2VuZXMgYW5kIHRoZW4gYWxzbyB0cnkgdGhlIGxpc3QKb2YgVEZzIHByb3ZpZGVkIGJ5IFtAR29zc2VsaW5dLgoKVGhlIFRyYW5zY3JpcHRpb24gRmFjdG9ycyBtZW50aW9uZWQgaW4gdGhlIHBhcGVyIGRvIG5vdCBzZWVtIHRvIGJlIApzcGVjaWZpYyBmb3IgdGhlIE15ZWxvaWQyIGNsdXN0ZXIuIEludGVyZXN0aW5nbHksIHRoZXJlIGlzIGEgdmVyeSBsb3cgc2NvcmUgIApvZiB0aGVzZSBtaWNyb2dsaWEgZ2VuZXMgaW4gTXllbG9pZDUsIHdoaWxlIHRoZXJlIGlzIGEgaGlnaGVyIHNjb3JlIGluIE15ZWxvaWQxIAphbmQgTXllbG9pZDQgY2VsbHMuIAoKYGBge3J9Cmdvc3NlbGluX3RmcyA8LSByZWFkLnRhYmxlKCAiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL2RhdGEvVEZzX21pY3JvZ2xpYV9HbGFzc19wYXBlci50eHQiKQoKCmhpdjRfZ2xhc3MgPC0gQWRkTW9kdWxlU2NvcmUoaGl2NCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzID0gYXMudmVjdG9yKGdvc3NlbGluX3RmcykpCgpJZGVudHMoaGl2NF9nbGFzcykgPC0gImNlbGxfdHlwZSIKRmVhdHVyZVBsb3QoaGl2NF9nbGFzcywgZmVhdHVyZXMgPSAiQ2x1c3RlcjEiLCBsYWJlbCA9IFRSVUUsIHJlcGVsID0gVFJVRSwgcHQuc2l6ZSA9IC43KSArCiAgICBzY2FsZV9jb2xvdXJfZ3JhZGllbnRuKGNvbG91cnMgPSByZXYoYnJld2VyLnBhbChuID0gMTEsIG5hbWUgPSAiUmRCdSIpKSkgKwogIGxhYnModGl0bGUgPSAiR29zc2VsaW4gRC4gZXQgYWwuLCAyMDE3OiBNaWNyb2dsaWEgVHJhbnNjcmlwdGlvbiBGYWN0b3JzIikgCgpgYGAKCiMjIyBIQU5EIHNpZ25hdHVyZQoKKEhBTkQgPSBISVYtYXNzb2NpYXRlZCBuZXVyb2RlZ2VuZXJhdGl2ZSBkaXNlYXNlKQoKW0BHb3NzZWxpbl0gZGVmaW5lZCBhIGdyb3VwIG9mIGdlbmVzIHVwcmVndWxhdGVkCmluIG1pY3JvZ2xpYSBmcm9tIHBhdGllbnRzIHdpdGggSEFORC4gCgpUaGlzIGdlbmUgc2lnbmF0dXJlIGNhbiwgaG93ZXZlciBub3QgYmUgZGV0ZWN0ZWQgaW4gYW55IG9mIHRoZSBNeWVsb2lkIGNsdXN0ZXJzLgoKYGBge3J9CmhhbmRfZ2VuZXMgPC0gcmVhZC50YWJsZSgiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL2RhdGEvSEFORF91cHJlZ3VsYXRlZF9taWNyb2dsaWFfc2lnbmF0dXJlX2dlbmVzIikKaGFuZF9nZW5lcyA8LSBhcy52ZWN0b3IoaGFuZF9nZW5lc1tbImdlbmVzIl1dKQoKaGl2X2hhbmQgPC0gQWRkTW9kdWxlU2NvcmUoaGl2NCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMgPSBoYW5kX2dlbmVzKQoKSWRlbnRzKGhpdl9oYW5kKSA8LSAiY2VsbF90eXBlIgpGZWF0dXJlUGxvdChoaXZfaGFuZCwgZmVhdHVyZXMgPSAiQ2x1c3RlcjEiLCBwdC5zaXplID0gLjAxKSArCiAgc2NhbGVfY29sb3VyX2dyYWRpZW50bihjb2xvdXJzID0gcmV2KGJyZXdlci5wYWwobiA9IDExLCBuYW1lID0gIlJkQnUiKSkpICsKICBsYWJzKHRpdGxlID0gIm1pY3JvZ2xpYSBzaWduYXR1cmUgZ2VuZXMgdXByZWd1bGF0ZWQgaW4gSEFORCIpCgoKYGBgCgoKIyMjIEdyYXNzaXZhcm8gZXQgYWwuCgpbQEdyYXNzaXZhcm9dIGlkZW50aWZpZWQgZmVhdHVyZXMgcmVsYXRlZCB0byBjb252ZXJnZW5jZSBvZiBtaWNyb2dsaWEgYW5kIAptYWNyb3BoYWdlcy4KVGhleSBpZGVudGlmaWVkIDE0IGdlbmVzIHRoYXQgYXJlIGNvbnNlcnZlZCBpbiBtaWNyb2dsaWEgdGhyb3VnaG91dCBkZXZlbG9wbWVudCwKYnV0IG5vdCBleHByZXNzZWQgaW4gbXllbG9pZC1kZXJpdmVkIG1vbm9jeXRlcyAoTURNKS4KT25seSBpbiB0aGUgY29udGV4dCBvZiBuZXVyb2luZmxhbW1hdGlvbiBhcmUgdGhlIDE0IGdlbmVzIGV4cHJlc3NlZCBpbiAKbWFjcm9waGFnZXMgYXMgd2VsbC4KCmBgYHtyfQp0ZnMgPC0gYygiQ1JZQkIxIiwgIkdBUk5MMyIsICJHUFIzNCIsICJMQUczIiwgIk5VQUsxIiwgIk9MRk1MMyIsICJSVE4xIiwgICJTQUxMMyIsICAiU0xDMUEzIiwgIlNQQVJDIiwgIlRORlJTRjE3IikKCnRmcyAlaW4lIHJvd25hbWVzKGhpdjRAYXNzYXlzJFJOQUBjb3VudHMpCgoKaGl2dCA8LSBBZGRNb2R1bGVTY29yZShoaXY0LAogICAgICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJlcyA9IHRmcykKCklkZW50cyhoaXZ0KSA8LSAiY2VsbF90eXBlIgpGZWF0dXJlUGxvdChoaXZ0LCBmZWF0dXJlcyA9ICJDbHVzdGVyMiIsCiAgICAgICAgICAgIGxhYmVsID0gVFJVRSwgCiAgICAgICAgICAgIHJlcGVsID0gVFJVRSwgcHQuc2l6ZSA9IC4xKSArCiAgc2NhbGVfY29sb3VyX2dyYWRpZW50bihjb2xvdXJzID0gcmV2KGJyZXdlci5wYWwobiA9IDExLCBuYW1lID0gIlJkQnUiKSkpICsKICBsYWJzKHRpdGxlID0gIjE0IGdlbmVzIGV4cHJlc3NlZCBpbiBtaWNyb2dsaWEgJiBtYWNyb3BoYWdlcyBpbiBuZXVyb2luZmwuIikKCgpgYGAKCgojIyMgS2VyZW4tU2hhdWwgZXQgYWwuICYgS3Jhc2VtYW4gZXQgYWwuCgpUaGUgbWFya2VyIGdlbmVzIG1lbnRpb25lZCBieSBbQEtlcmVuLVNoYXVsXSBhbmQgW0BLcmFzZW1hbl0gd2VyZSByZWZlcnJlZCB0byAKYnkgW0BGYXJoYWRpYW5dIGFuZCB1c2VkIGFzIG1hcmtlciBnZW5lcyBmb3IgbWljcm9nbGlhIGFzc29jaWF0ZWQgd2l0aCAKbmV1cm9kZWdlbmVyYXRpdmUgZGlzZWFzZS4KCltAS2VyZW4tU2hhdWxdIGRlZmluZWQgYSBzaWduYXR1cmUgY29uc2lzdGluZyBvZiBnZW5lcyB1cHJlZ3VsYXRlZCBpbiAKZGlzZWFzZS1hc3NvY2lhdGVkIG1pY3JvZ2xpYS4KCltAS3Jhc2VtYW5dIGRlZmluZWQgYSBzaWduYXR1cmUgb2YgMjggaW5mbGFtbWF0b3J5IGdlbmVzIHVwcmVndWxhdGVkIGluIApkaXNlYXNlLWFzc29jYWl0ZWQgbWljcm9nbGlhLgoKTmVpdGhlciBvZiB0aGVzZSBzaWduYXR1cmVzIHNob3cgYSBoaWdoIHNjb3JlIGZvciB0aGUgTXllbG9pZDIvNSBjbHVzdGVycy4gCgoqIFRoZSBzaWduYXR1cmUgZ2VuZXMgZGVmaW5lZCBieSBbQEtlcmVuLVNoYXVsXSBhcmUgZXhwcmVzc2VkIHRvIHNvbWUgbGV2ZWwgCmluIGFsbCBteWVsb2lkIGNsdXN0ZXJzCiogVGhlIHNpZ25hdHVyZSBkZWZpbmVkIGJ5IFtAS3Jhc2VtYW5dIGlzIGFsc28gbWFpbmx5IGV4cHJlc3NlZCBpbiB0aGUgCk15ZWxvaWQgY2x1c3RlcnMKKiBDRDkgYW5kIFNQUDEgbWlnaHQgYmUgYWRkZWQgdG8gdGhlIGxpc3Qgb2YgbWljcm9nbGlhIG1hcmtlciBnZW5lcyBleHByZXNzZWQKaW4gTXllbG9pZDIgY2x1c3RlcgoKSXQgaXMgbm90IGNsZWFyIHdoeSBbQEZhcmhhZGlhbl0gdXNlZCB0aGVzZSBnZW5lcyBhcyBtYXJrZXIgZ2VuZXMuCgpgYGB7ciwgZmlnLndpZHRoPTEwfQojIHVwcmVndWxhdGVkIGluIGRpc2Vhc2UgYXNzb2NpYXRlZCBtaWNyb2dsaWEgKEtlcmVuLVNoYXVsKQpkaXNlYXNlIDwtIGMoIlNQUDEiLCAiSVRHQVgiLCAiQVhMIiwgIkxJTFJCNCIsICJDTEVDN0EiLCAiQ0NMMiIsICJDU0YxIikgCgojMjggaW5mbGFtbWF0b3J5IG1vbGVjdWxlcyB1cHJlZ3VsYXRlZCBpbiBkaXNlYXNlIGFzc29jaWF0ZWQgbWljcm9nbGlhIChLcmFzZW1hbm4pCm1nbmQgPC0gYygiQVBPRSIsICJBWEwiLCAiQ0NMMiIsICJUTFIyIiwgIlNQUDEiLCAiQ1lCQiIsICJNU1IxIiwgIklUR0FYIiwKICAgICAgICAgICJDTEVDN0EiLCAiQ0hJM0wzIiwgIkFSRzEiLCAiU0lHTEVDMSIsICJDRlAiLCAiQ1hDTDEwIiwgIkFMQ0FNIiwgCiAgICAgICAgICAiRkVSMUwzIiwgIkxJTFJCNCIsICJHUFgzIiwgIkdBUzciLCAiQ0NSTDIiLCJDWENMMTYiLCAiQ1hDUjQiLAogICAgICAgICAgIkdQTk1CIiwgIkxHQUxTMyIsICJJRkkyMDJCIiwgIkNTRjEiLCAiTElSQjQiLCAiTEFHMyIpCiMgb25seSBBUE9FLCBBWEwgYW5kIE1TUjEgb3ZlcmxhcCwgYnV0IHRoZXNlIGFyZSB0aGUgbW9zdCBpbXBvcnRhbnQgZ2VuZXMKCiMgcmVtb3ZlIHRoZSBnZW5lcyB0aGF0IGFyZSBhbHNvIHVzZWQgYnkgdGhlIEZhcmhhZGlhbiBQYXBlcgptZ25kIDwtIGMoIkNDTDIiLCAiVExSMiIsICJTUFAxIiwgIkNZQkIiLCAgIklUR0FYIiwKICAgICAgICAgICJDTEVDN0EiLCAiQ0hJM0wzIiwgIkFSRzEiLCAiU0lHTEVDMSIsICJDRlAiLCAiQ1hDTDEwIiwgIkFMQ0FNIiwgCiAgICAgICAgICAiRkVSMUwzIiwgIkxJTFJCNCIsICJHUFgzIiwgIkdBUzciLCAiQ0NSTDIiLCJDWENMMTYiLCAiQ1hDUjQiLAogICAgICAgICAgIkdQTk1CIiwgIkxHQUxTMyIsICJJRkkyMDJCIiwgIkNTRjEiLCAiTElSQjQiLCAiTEFHMyIpCgojaGl2NCA8LSByZWFkUkRTKCIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL1JlcHJvZHVjZV9GYXJoYWRpYW5fUGFwZXIvU2V1cmF0X29iamVjdHMvbm9uX2ludGVncmF0ZWRfSElWMV9ISVYyXzRzYW1wbGVzX3NldXJhdF9vYmplY3QucmRzIikKCiNnZXQgZ2VuZXMgYWxzbyBwcmVzZW50IGluIHRoZSBISVYgc2FtcGxlcwptZ25kIDwtIG1nbmRbbWduZCAlaW4lIHJvd25hbWVzKGhpdjRAYXNzYXlzJFJOQUBjb3VudHMpXQoKCmhpdl9kaXNlYXNlIDwtIEFkZE1vZHVsZVNjb3JlKGhpdjQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzID0gZGlzZWFzZSkKCmtlcmVuIDwtIEZlYXR1cmVQbG90KGhpdl9kaXNlYXNlLCBmZWF0dXJlcyA9ICJDbHVzdGVyMSIsIHB0LnNpemUgPSAuMDEpICsKICBzY2FsZV9jb2xvdXJfZ3JhZGllbnRuKGNvbG91cnMgPSByZXYoYnJld2VyLnBhbChuID0gMTEsIG5hbWUgPSAiUmRCdSIpKSkgKwogIGxhYnModGl0bGUgPSAiS2VyZW4tU2hhdWwgZXQgYWwuLCBkaXNlYXNlLWFzc29jaWF0ZWQgbWljcm9nbGlhIikKCgoKaGl2X21nbmQgPC0gQWRkTW9kdWxlU2NvcmUoaGl2NCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMgPSBtZ25kKQoKa3Jhc2VtYW4gPC0gRmVhdHVyZVBsb3QoaGl2X21nbmQsIGZlYXR1cmVzID0gIkNsdXN0ZXIxIiwgcHQuc2l6ZSA9IC4wMSkgKwogIHNjYWxlX2NvbG91cl9ncmFkaWVudG4oY29sb3VycyA9IHJldihicmV3ZXIucGFsKG4gPSAxMSwgbmFtZSA9ICJSZEJ1IikpKSArCiAgbGFicyh0aXRsZSA9ICJLcmFzZW1hbiBldCBhbC4sIGRpc2Vhc2UgYXNzb2NpYXRlZCBtaWNyb2dsaWEiKQoKZ2dhcnJhbmdlKGtlcmVuLCBrcmFzZW1hbiwgbmNvbCA9IDIsIG5yb3cgPSAxKQpgYGAKCgpgYGB7ciwgZmlnLndpZHRoPTE1fQojIEtlcmVuIFNoYXVsIGV0IGFsLiBzaWduYXR1cmUKcDEgPC0gRG90UGxvdChoaXY0LCBmZWF0dXJlcyA9IGRpc2Vhc2UsIGdyb3VwLmJ5ID0gImNlbGxfdHlwZSIpICsgCiAgY29vcmRfZmxpcCgpICsKICAgIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIHZqdXN0ID0gMC44LCBoanVzdD0xKSkgKwogICAgbGFicyh0aXRsZSA9ICJLZXJlbi1TaGF1bCBldCBhbC4sIGRpc2Vhc2UtYXNzb2NpYXRlZCBtaWNyb2dsaWEiKQoKIyBLcmFzZW1hbiBldCBhbC4gc2lnbmF0dXJlCnAyIDwtIERvdFBsb3QoaGl2NCwgZmVhdHVyZXMgPSBtZ25kLCBncm91cC5ieSA9ICJjZWxsX3R5cGUiKSArIAogIGNvb3JkX2ZsaXAoKSArCiAgICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3Q9MSkpICsKICAgIGxhYnModGl0bGUgPSAiS3Jhc2VtYW4gZXQgYWwuLCBkaXNlYXNlIGFzc29jaWF0ZWQgbWljcm9nbGlhIikKCgojIHNvbWUgZ2VuZXMgdGhhdCBtaWdodCBiZSBtYXJrZXJzIGZvciBNeWVsb2lkMgpwMyA8LSBEb3RQbG90KGhpdjQsIGZlYXR1cmVzID0gYygiQ0Q5IiwgIkFQT0UiLCAiQVhMIiwgIkNUU0wiLCAiU1BQMSIpLCBncm91cC5ieSA9ICJjZWxsX3R5cGUiKSArIAogIGNvb3JkX2ZsaXAoKSArCiAgICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3Q9MSkpICsKICBsYWJzKHRpdGxlID0gIkdlbmVzIHRoYXQgbWlnaHQgYmUgdXNlZCBhcyBtYXJrZXJzIGZvciBNeWVsb2lkMiIpCgpnZ2FycmFuZ2UocDEsIHAyLCBwMywgbmNvbCA9IDIsIG5yb3cgPSAyKQpgYGAKCgojIyMgRXNhdWxvdmEgZXQgYWwuCgpHZW5lIHNpZ25hdHVyZSBkZWZpbmVkIGJ5IFtARXNhdWxvdmFdCgojIyMjIyBIb21lb3N0YXRpYyBnZW5lczogCgoqIHRoZSBob21lb3N0YXRpYyBtaWNyb2dsaWEgZ2VuZSBzaWduYXR1cmUgaXMgZm91bmQgaW4gYWxsIG15ZWxvaWQgY2x1c3RlcnMsIApub3Qgb25seSBpbiB0aGUgTXllbG9pZCAyIChleGNlcHQgZm9yIFNMQzJBNSB3aGljaCB3YXMgYWxzbyBpbmNsdWRlZCBpbiB0aGUgCkZhcmhhZGlhbiBwYXBlcikKKiBOSyBjZWxsIGNsdXN0ZXIgYWxzbyBleGhpYml0cyBoaWdoIHNjb3JlcyBmb3IgdGhpcyBnZW5lIHNpZ25hdHVyZQoKYGBge3IsIGZpZy53aWR0aD0xNX0KI2hvbWVvc3RhdGljIG1pY3JvZ2xpYSBnZW5lIHNpZ25hdHVyZQptaWNyb2dsaWEgPC0gYygiQ1gzQ1IxIiwiQ1NGMVIiLCAiU0xDMkE1IiwgIk1BUkNLUyIsICJQMlJZMTMiKQpGZWF0dXJlUGxvdChoaXY0LCBmZWF0dXJlcyA9IG1pY3JvZ2xpYSwgbmNvbCA9IDMpCmBgYAoKCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTEwfQpkb3RwbG90IDwtIERvdFBsb3QoaGl2NCwgZmVhdHVyZXMgPSBtaWNyb2dsaWEsIGdyb3VwLmJ5ID0gImNlbGxfdHlwZSIpICsgCiAgY29vcmRfZmxpcCgpICsKICAgIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIHZqdXN0ID0gMC44LCBoanVzdD0xKSkKCmhpdnQgPC0gQWRkTW9kdWxlU2NvcmUoaGl2NCwgZmVhdHVyZXMgPSBtaWNyb2dsaWEpCklkZW50cyhoaXZ0KSA8LSAiY2VsbF90eXBlIgp0c25lIDwtIEZlYXR1cmVQbG90KGhpdnQsIGZlYXR1cmVzID0gIkNsdXN0ZXIxIiwgbGFiZWwgPVRSVUUsIHJlcGVsID0gVFJVRSwgcHQuc2l6ZSA9IC43KSArCiAgc2NhbGVfY29sb3VyX2dyYWRpZW50bihjb2xvdXJzID0gcmV2KGJyZXdlci5wYWwobiA9IDExLCBuYW1lID0gIlJkQnUiKSkpICsKICAgIGxhYnModGl0bGUgPSAiSG9tZW9zdGF0aWMgbWljcm9nbGlhIHNpZ25hdHVyZSBmcm9tIEVzYXVsb3ZhIHBhcGVyIikKCmdnYXJyYW5nZShkb3RwbG90LCB0c25lLCBuY29sID0yLCBucm93ID0gMSkKYGBgCgojIyMjIyBNaWNyb2dsaWEtc3BlY2lmaWMgZ2VuZXM6CgoqICoqR1BSMzQqKiwgKipUTUVNMTE5Kiogc3VwcG9ydHMgdGhlIGh5cG90aGVzaXMgdGhhdCBteWVsb2lkMiBhcmUgbWljcm9nbGlhLWxpa2UsCnNpbmNlIHRoZXkgYXJlIGV4cHJlc3NlZCBhdCBoaWdoZXIgbGV2ZWxzIGluIHRoZSBNeWVsb2lkMiBjbHVzdGVyCiogdGhleSB1c2UgMTAgZ2VuZXMgdG8gZGlzY3JpbWluYXRlIG1pY3JvZ2xpYSwgZm91ciBvZiB3aGljaCBoYXZlIG5vdCBiZWVuIAppbmxjdWRlZCBieSBbQEZhcmhhZGlhbl06ICoqQ0xFQzlBKiosICoqVElNRDQqKiwgKipUTkZTRjE4KiosICoqQ1hDTDEyKioKKiB0aGUgZ2VuZXMgKipDTEVDOUEqKiwgKipUSU1ENCoqLCAqKlRORlNGMTgqKiwgKipDWENMMTIqKiBhcmUgbm90IGluY2x1ZGVkIGluCnRoZSA2MCBnZW5lcyB1c2VkIGJ5IFtARmFyaGFkaWFuXSwgYnV0IHRoZXkgZG8gbm90IHNob3cgc3BlY2lmaWMgZXhwcmVzc2lvbgpmb3IgTXllbG9pZDIgY2VsbHMKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MjB9CiMgMTAgZ2VuZXMgdGhhdCBkaXNjcmltaW5hdGUgbWljcm9nbGlhCm1pY3JvZ2xpYSA8LSBjKCJDMVFDIiwgIkMxUUIiLCAiQzFRQSIsICJUUkVNMiIsICJUSU1ENCIsICJBUE9DMSIsIAogICAgICAgICAgICAgICAiQVBPRSIsICJUTkZTRjE4IiwgIkNMRUM5QSIsICJDWENMMTIiKQojRmVhdHVyZVBsb3QoaGl2NCwgZmVhdHVyZXMgPSBtaWNyb2dsaWEsIG5jb2wgPSAzKQoKI21pY3JvZ2xpYSAlaW4lIHBhcGVyCgpJZGVudHMoaGl2NCkgPC0gImNlbGxfdHlwZSIKCiMgIHR3byBnZW5lcyB3aGNpaCBtaWdodCBzdXBwb3J0IHRoYXQgbXllbG9pZDIgY2x1c3RlciBjb250YWlucyBtaWNyb2dsaWEtbGlrZSBjZWxscwojRmVhdHVyZVBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKCJHUFIzNCIsICJUTUVNMTE5IiksIGxhYmVsID0gVFJVRSwgcHQuc2l6ZSA9IC43LAogICAgICAgIyAgICAgcmVwZWwgPSBUUlVFKQojRG90UGxvdChoaXY0LCBmZWF0dXJlcyA9IGMoIlRNRU0xMTkiLCAiR1BSMzQiKSwgZ3JvdXAuYnkgPSAiY2VsbF90eXBlIikgKyAKICAjICAgY29vcmRfZmxpcCgpICsKICAgIyAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgdmp1c3QgPSAwLjgsIGhqdXN0PTEpKQoKIyB0aGVzZSBhcmUgbm90IGlubGN1ZGVkIGluIHRoZSBGYXJoYWRpYW4gZ2VuZSBzaWduYXR1cmUKRmVhdHVyZVBsb3QoaGl2NCwgZmVhdHVyZXMgPSBjKCJDTEVDOUEiLCAiVElNRDQiLCAiVE5GU0YxOCIsICJDWENMMTIiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJHUFIzNCIsICJUTUVNMTE5IiksCiAgICAgICAgICAgIHB0LnNpemUgPSAuNywgbGFiZWwgPSBUUlVFLCByZXBlbCA9IFRSVUUsIG5jb2w9IDIpCgoKCmBgYAoKIyMjIFNhbmtvd3NraSBldCBhbC4KCltAU2Fua293c2tpXSBkZXNjcmliZSBkaWZmZXJlbnQgc3RhdGVzIG9mIG1pY3JvZ2xpYSBjZWxscyBmcm9tIHRoZSBodW1hbiBicmFpbi4KCkluIHRoZSBwYXBlciBtaWNyb2dsaWEgY2VsbHMgd2VyZSBvYnRhaW5lZCB0aHJvdWdoIGJyYWluIHN1cmdlcnkuCk1pY3JvZ2xpYSB3ZXJlIGRlZmluZWQgYnkgYSBjb3JlIHNpZ25hdHVyZSBjYWxsZWQgIm1pY3JvZ2xpYSBzaWduYXR1cmUiIGJlbG93LgpbQFNhbmtvd3NraV0gcGVyZm9ybWVkIHVuc3VwZXJ2aXNlZCBjbHVzdGVyaW5nIHVzaW5nIFJhY2UgSUQzIHdoaWNoIHJlc3VsdGVkCmluIDkgbWFqb3Igc3ViY2x1c3RlcnMgb2YgdGhlIG1pY3JvZ2xpYSBjZWxscy4gVGhlIGF1dGhvcnMgc3VnZ2VzdGVkIHRoYXQgdGhlc2UKc3ViY2x1c3RlcnMgcmVwcmVzZW50IHRoZSB3aWRlIHNwZWN0cnVtIG9mIHRyYW5zY3JpcHRpb25hbCBzdGF0ZXMgaW4gaHVtYW4gCm1pY3JvZ2xpYS4KCioqUmFjZUlEOioqClJhY2VJRCBpcyBhIGNsdXN0ZXJpbmcgYWxnb3JpdGhtIGZvciB0aGUgaWRlbnRpZmljYXRpb24gb2YgY2VsbCB0eXBlcyBmcm9tIApzY1JOQS1zZXEgZGF0YS4gSXQgd2FzIGRlc2lnbmVkIHRvIHdvcmsgcGFydGljdWxhcmx5IHdlbGwgZm9yIHRoZSBkZXRlY3Rpb24gb2YKcmFyZSBjZWxscy4gU2VlIGZvciBtb3JlIGRldGFpbHM6IGh0dHBzOi8vZ2l0aHViLmNvbS9kZ3J1bi9SYWNlSUQzX1N0ZW1JRDJfcGFja2FnZQoKCiogVGhlIG1pY3JvZ2xpYSBzaWduYXR1cmUgaXMgbW9zdCBwcm9ub3VuY2VkIGluIE15ZWxvaWQyIGNsdXN0ZXIgd2hpY2ggc3VwcG9ydHMgCnRoZSBoeXBvdGhlc2lzIHRoYXQgTXllb2lkMiBhcmUgbWljcm9nbGlhLWxpa2UgY2VsbHMuCiogVGhlIG1vbm9jeXRlIHNpZ25hdHVyZSBpcyBsZXNzIHByb25vdW5jZWQgaW4gTXllbG9pZDIgY2x1c3RlciBhbmQgbW9yZSAKcHJvbm91bmNlZCBpbiB0aGUgb3RoZXIgTXllbG9pZCBjbHVzdGVycyB3aGljaCBpcyBpbiBsaW5lIHdpdGggdGhlIGFzc3VtcHRpb24gCnRoYXQgdGhlIGNlbGxzIGluIGJsb29kIGFuZCBDU0YgYXJlIG1vbm9jeXRlcyBvciBtb25vY3l0ZS1kZXJpdmVkIG1hY3JvcGhhZ2VzCnJhdGhlciB0aGFuIG1pY3JvZ2xpYS1saWtlIGNlbGxzLgoqIEhvbWVvc3RhdGljIG1pY3JvZ2xpYSBnZW5lIHNpZ25hdHVyZSAoY29yZSBzaWduYXR1cmUgZ2VuZXMgZXhwcmVzc2VkIGJ5IGFsbCBjbHVzdGVycyBpbiB0aGUgCnBhcGVyKSBpcyBmb3VuZCBpbiBhbGwgTXllbG9pZCBjbHVzdGVyIGFzIHdlbGwgYXMgTksgY2VsbHMsIHdpdGggaGlnaCBleHByZXNzaW9uIAphbHNvIGluIE15ZWxvaWQyLiBJdCBpcyBub3QgY2xlYXIgd2h5IE5LIGNlbGxzIHdvdWxkIGV4cHJlc3MgYSBob21lb3N0YXRpYyAKbWljcm9nbGlhIHNpZ25hdHVyZS4gVGhlIHJlYXNvbiB3aHkgYWxsIE15ZWxvaWQgY2x1c3RlciBleHByZXNzIHRoaXMgc2lnbmF0dXJlIAptaWdodCBiZSB0aGF0IGhvbWVvc3RhdGljIG1pY3JvbGdsaWEgaGF2ZSBzb21lIG92ZXJsYXAgaW4gZ2VuZSBleHByZXNzaW9uIHdpdGggCnBlcmlwaGVyYWwgbWFjcm9waGFnZXMuIAoKVHdvIHBvdGVudGlhbCBtYXJrZXJzIGZvciBNeWVsb2lkMiBhcmUgKipDU0YxUioqIGFuZCAqKk1BUkNLUyoqIHdoaWNoIGFyZSBtb3N0IApoaWdobHkgZXhwcmVzc2VkIGluIE15ZWxvaWQyIGNlbGxzLgoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0yMH0KIyBtaWNyb2dsaWEgZ2VuZSBzaWduYXR1cmUgZnJvbSBzdXBwbGVtZW50YXJ5IHRhYmxlIDNhCm1pY3JvZ2xpYSA8LSBjKCJQMlJZMTIiLCAiQ1gzQ1IxIiwgIkNTRjFSIiwgIlRNRU0xMTkiLCAiU0xDMkE1IiApCgojIG1vbm9jeXRlIGdlbmUgc2lnbmF0dXJlIGZyb20gc3VwcGxlbWVudGFyeSB0YWJsZSAzYSAKbW9ub2N5dGUgPC0gYygiQ0NSMiIsICJDTEVDMTJBIiwgIlBMQUM4IiwgIkZDTjEiLCAiUzEwMEE5IikKCiMgaG9tZW9zdGF0aWMgbWljcm9sZ2lhIGdlbmUgc2lnYW50dXJlCmhvbWVvc3RhdGljIDwtIGMoIkNYM0NSMSIsICJUTUVNMTE5IiwgIkNTRjFSIiwgIlAyUlkxMiIsCiAgICAgICAgICAgICAgICAgIlAyUlkxMyIsIlNFTFBMRyIsICJNQVJDS1MiKQoKCnRzbmVfbGlzdCA8LSBtYXAoc2VxLmludCgxOjMpLCBmdW5jdGlvbihuKXsKICBuYW1lcyA8LSBjKCJtaWNyb2dsaWEiLCAibW9ub2N5dGUiLCAiaG9tZW9zdGF0aWMiKQogIGZlYXR1cmVfbGlzdCA8LSBsaXN0KG1pY3JvZ2xpYSwgbW9ub2N5dGUsIGhvbWVvc3RhdGljKQogIGZlYXR1cmVzID0gZmVhdHVyZV9saXN0W1tuXV0KICBoaXYgPC0gQWRkTW9kdWxlU2NvcmUoaGl2NCwgZmVhdHVyZXMgPSBmZWF0dXJlcykKICAjIGZlYXR1cmUgcGxvdAogIElkZW50cyhoaXYpIDwtICJjZWxsX3R5cGUiCiAgRmVhdHVyZVBsb3QoaGl2LCBmZWF0dXJlcyA9ICJDbHVzdGVyMSIsIHB0LnNpemUgPSAuNSwgbGFiZWwgPSBUUlVFLCByZXBlbD1UUlVFKSsKICAgIHNjYWxlX2NvbG91cl9ncmFkaWVudG4oY29sb3VycyA9IHJldihicmV3ZXIucGFsKG4gPSAxMSwgbmFtZSA9ICJSZEJ1IikpKSArCiAgICBsYWJzKHRpdGxlID0gcGFzdGUwKG5hbWVzW25dLCIgbWljcm9nbGlhIGdlbmUgc2lnbmF0dXJlIikpCn0pCiAgCmRvdHBsb3RfbGlzdCA8LSBtYXAoc2VxLmludCgxOjMpLCBmdW5jdGlvbihuKXsKICBuYW1lcyA8LSBjKCJtaWNyb2dsaWEiLCAibW9ub2N5dGUiLCAiaG9tZW9zdGF0aWMiKQogIGZlYXR1cmVfbGlzdCA8LSBsaXN0KG1pY3JvZ2xpYSwgbW9ub2N5dGUsIGhvbWVvc3RhdGljKQogIGZlYXR1cmVzID0gZmVhdHVyZV9saXN0W1tuXV0gCiAgIyBkb3QgcGxvdAogIERvdFBsb3QoaGl2NCwgZmVhdHVyZXMgPSBmZWF0dXJlcywgZ3JvdXAuYnkgPSAiY2VsbF90eXBlIikgKwogICAgY29vcmRfZmxpcCgpICsKICAgICAgICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3Q9MSkpICsKICBsYWJzKHRpdGxlID0gcGFzdGUwKG5hbWVzW25dLCIgZ2VuZSBzaWduYXR1cmUiKSkKfSkKICAKZG8uY2FsbChncmlkLmFycmFuZ2UsIGMoYXBwZW5kKHRzbmVfbGlzdCwgZG90cGxvdF9saXN0KSwgbmNvbCA9IDIsIG5yb3cgPSAzKSkKYGBgCgojIyMjIENsdXN0ZXJzIGFjcm9zcyB0aGUgdHJhbnNjcmlwdGlvbmFsIHNwZWN0cnVtIG9mIG1pY3JvZ2xpYQoKW0BTYW5rb3dza2ldIGRlZmluZWQgOSBzdWJjbHVzdGVycyB3aXRoaW4gdGhlIAptaWNyb2dsaWEgY2VsbCBwb3B1bGF0aW9uLiBDYW4gd2UgZmluZCB0aGVzZSBnZW5lIHNpZ25hdHVyZXMgaW4gdGhlIENTRi1kZXJpdmVkCk15ZWxvaWQgY2VsbHM/IFRoaXMgY291bGQgZnVydGhlciBjb25maXJtIHRoYXQgTXllbG9pZDIgYW5kIE15ZWxvaWQ1IGFyZSAKbWljcm9nbGlhLWxpa2UgY2VsbHMuIAoKKiAqKmhvbWVvc3RhdGljIGNsdXN0ZXJzKioKICArIEMyOiBzdHJvbmcgZXhwcmVzc3Npb24gb2YgTUNILUlJIGFuZCBhbnRpdmlyYWwgaW1tdW5pdHkgZ2VuZXMgCihITEEtRFJBLCBDRDc0LCBJRkk0NEwpCiAgKyBDMzogaGlnaCBleHByZXNzaW9uIG9mIG1pY3JvZ2xpYWwgY29yZSBnZW5lcyBDWDNDUjEsIFRNRU0xMTkgICAKKiAqKmFudGlnZW4gcHJvY2Vzc2luZyBhbmQgcGVwdGlkZSBhbnRpZ2VuIHByZXNlbnRhdGlvbioqCkM2IGFuZCBDNyB3ZXJlIGNoYXJhY3Rlcml6ZWQgYnkgbG93IGV4cHJlc3Npb24gb2YgQ1gzQ1IxIGFuZCBoaWdoIGV4cHJlc3Npb24Kb2YgaW50ZWdyaW4tcmVjZXB0b3IgYmluZGluZyBwcm90ZWluIGFuZCBtZXRhYm9saXNtIGdlbmVzIChTUFAxLCBBUE9FLCBMUEwpLgoqICoqIHByb2luZmxhbW1hdG9yeSBjbHVzdGVyczoqKiAKQzEsIEM1LCBDOCwgQzkgd2VyZSBjaGFyYWN0ZXJpemVkIGJ5IGV4cHJlc3Npb24gb2YgY2hlbW9raW5lIGFuZCBjeXRva2luZSAKZ2VuZXMgKENDTDIsIElMMUIpLgoKU2luY2UgQ2x1c3RlciBDMiB3YXMgY2hhcmFjdGVyaXplZCBhcyBhIGhvbWVvc3RhdGkgbWljcm9nbGlhIGNsdXN0ZXIgYW5kIHNob3dlZApleHByZXNzaW9uIG9mIE1IQy1JSSBhbmQgYW50aXZyaWFsIGltbXVuaXR5IGdlbmVzIGxpa2UgSUZJNDRMLCBITEEtRFJBLCBDRDc0LCAKdGhpcyBzdXBwb3J0cyB0aGUgbWljcm9nbGlhLWxpa2UgaWRlbnRpdHkgb2YgTXllbG9pZDIgYW5kIE15ZWxvaWQ1LiBIb3dldmVyLCAKdGhlcmUgaXMgYWxzbyBzb21lIGV4cHJlc3Npb24gb2YgdGhpcyBzaWduYXR1cmUgaW4gTWVsb2lkMSBhbmQgTXllbG9pZDMgd2hpY2gKbWFpbmx5IG9yaWdpbmF0ZSBmcm9tIEJsb29kIHNhbXBsZXMgYW5kIGFsc28gaW4gQiBjZWxscy4gCgpUaGVyZSBpcyBhbHNvIGEgaGlnaCBzY29yZSBmb3IgQzUgYW5kIEM4IHNpZ25hdHVyZSBnZW5lcywgd2hpY2ggYXJlIGJvdGggCnByb2luZmxhbW1hdG9yeSBnZW5lIHNpZ25hdHVyZXMuCgpgYGB7ciwgZmlnLndpZHRoID0gMTUsIGZpZy5oZWlnaHQ9MTB9CiMgZ2V0IGRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZCBnZW5lcyBwZXIgY2x1c3RlciBhY3Jvc3MgdGhlIHRyYW5zY3JpcHRpb25hbCAKIyBzcGVjdHJ1bSBvZiBtaWNyb2dsaWEgCmV4Y2VsX3NoZWV0cygiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL2RhdGEvMjAxOV9TYW5rb3dza2lfTWFwcGluZ19taWNyb2dsaWFzdGF0ZXNfaW5fdGhlX2h1bWFuX2JyYWluX1N1cHBsZW1lbnRhcnlfdGFibGVzLnhsc3giKQpjbHVzdGVyX2dlbmVzIDwtIHJlYWRfZXhjZWwoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9kYXRhLzIwMTlfU2Fua293c2tpX01hcHBpbmdfbWljcm9nbGlhc3RhdGVzX2luX3RoZV9odW1hbl9icmFpbl9TdXBwbGVtZW50YXJ5X3RhYmxlcy54bHN4Iiwgc2hlZXQgPSAiU3VwcGwuIHRhYmxlIDMiKQojbmFtZXMobWljcm9nbGlhX3NpZ25fZGYpIFsxXSA8LSAiZ2VuZV9uYW1lIgojbWljcm9nbGlhX3NpZ24gPC0gbWljcm9nbGlhX3NpZ25fZGZbLCJnZW5lX25hbWUiXQoKIyBDMwoKY2x1c3Rlcl9saXN0IDwtIG1hcChzZXEuaW50KDE6OCksIGZ1bmN0aW9uKG4pIHsKICBuYW1lcyA8LSBjKCJjMSIsICJjMiIsICJjMyIsICJjNSIsICJjNiIsICJjNyIsICJjOCIsICJjOSIpCiAgbmFtZSA8LSBuYW1lc1tuXQogIGNsdXN0ZXIgPC0gYygxLDIsMyw1LDYsNyw4LDkpCiAgY2x1c3Rlcl9udW1iZXIgPC0gY2x1c3RlcltuXQogIGMgPC0gcHVsbChjbHVzdGVyX2dlbmVzICU+JSBmaWx0ZXIoQ2x1c3RlciA9PSBjbHVzdGVyX251bWJlciksIEdFTkVJRCkKICBjIDwtIGNbYyAlaW4lIHJvd25hbWVzKGhpdjRAYXNzYXlzJFJOQUBjb3VudHMpXQogIGNsdXN0ZXJfbGlzdCA8LSBsaXN0KG5hbWUgPSBuYW1lLCBjbHVzdGVyID0gYykKfSkKCgpjbHVzdGVyX3Bsb3RzIDwtIG1hcChzZXEuaW50KDE6OCksIGZ1bmN0aW9uKG4pewogIGMgPC0gY2x1c3Rlcl9saXN0W1tuXV0kY2x1c3RlcgogIG5hbWUgPC0gY2x1c3Rlcl9saXN0W1tuXV0kbmFtZQogIGhpdmMgPC0gQWRkTW9kdWxlU2NvcmUoaGl2NCwgZmVhdHVyZXMgPSBjKQogIElkZW50cyhoaXZjKSA8LSAiY2VsbF90eXBlIgogIEZlYXR1cmVQbG90KGhpdmMsIGZlYXR1cmVzID0gIkNsdXN0ZXIxIiwgcHQuc2l6ZSA9IC41LCBsYWJlbCA9IFRSVUUsCiAgICAgICAgICAgICAgcmVwZWwgPSBUUlVFKSArCiAgICAgIHNjYWxlX2NvbG91cl9ncmFkaWVudG4oY29sb3VycyA9IHJldihicmV3ZXIucGFsKG4gPSAxMSwgbmFtZSA9ICJSZEJ1IikpKSArCiAgICBsYWJzKHRpdGxlID0gcGFzdGUwKCJTaWduYXR1cmUgY2x1c3RlciAiLCBuYW1lKSkKfSkKCmRvLmNhbGwoZ3JpZC5hcnJhbmdlLCBjKGNsdXN0ZXJfcGxvdHMsIG5jb2wgPSAyLCBucm93ID0gNCkpCgojbWFwKHNlcS5pbnQoMTo4KSwgZnVuY3Rpb24obil7CiAjIGMgPC0gY2x1c3Rlcl9saXN0W1tuXV0kY2x1c3RlcgogICNuYW1lIDwtIGNsdXN0ZXJfbGlzdFtbbl1dJG5hbWUKICAjRG90UGxvdChoaXY0LCBmZWF0dXJlcyA9IGMsIGdyb3VwLmJ5ID0gImNlbGxfdHlwZSIpICsKICAjY29vcmRfZmxpcCgpICsKICAjICAgICAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgdmp1c3QgPSAwLjgsIGhqdXN0PTEpKSArCiAgI2xhYnModGl0bGUgPSBwYXN0ZTAoIkRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZCBnZW5lcyBvZiBjbHVzdGVyICIsIG5hbWUpKQojfSkKYGBgCgojIyB7LX0KCi0tLQoKIyMgR2VuZXMgd2hpY2ggYXJlIHVwcmVndWxhdGVkIGluIE15ZWxvaWQyIGNvbXBhcmVkIHRvIGFsbCBvdGhlciBNeWVsb2lkIGNsdXN0ZXJzCgoqIG92ZXJsYXAgb2YgNSBnZW5lcyB3aXRoIEtyYXNlbWFuIG1pY3JvZ2xpYSAtPiBpbmZsYW1tYXRvcnkgbW9sZWN1bGVzIAp1cHJlZ3VsYXRlZCBpbiBkaXNlYXNlIGFzc29jaWF0ZWQgbWljcm9nbGlhIChLcmFzZW1hbm4pCiogb3ZlcmxhcCBvZiAzIGdlbmVzIHdpdGggZGlzZWFzZS1hc3NvY2lhdGVkIG1pY3JvZ2xpYSAoS2VyZW4tU2hhdWwpCiogU2Fua293c2tpIHNpZ25hdHVyZQoKICArIDQgZ2VuZXMgb3ZlcmxhcCB3aXRoIG1pY3JvZ2xpYSBzaWduYXR1cmUKICArICoqemVybyBvdmVybGFwIHdpdGggbW9ub2N5dGUgZ2VuZSBzaWduYXR1cmUqKgogICsgNCBnZW5lcyBvdmVybGFwIHdpdGggaG9tZW9zdGF0aWMgbWljcm9nbGlhIHNpZ25hdHVyZQogIAoqIEVzYXVsb3ZhIHBhcGVyIC0+IDggb2YgMTAgZ2VuZXMgdGhhdCBkaXNjcmltaW5hdGUgbWljcm9nbGlhIGFyZSBmb3VuZCB1cHJlZ3VsYXRlZAppbiBNeWVsb2lkMiBjbHVzdGVyCiogR2xhc3MgcGFwZXIgLT4gMTMyIG9mIHRoZSBtaWNyb2dsaWEgc2lnbmF0dXJlIGFyZSBmb3VuZCBpbiB0aGUgZ2VuZXMgCnVwcmVndWxhdGVkIGluIE15ZWxvaWQyLCAyOCBvZiB0aGVzZSBhcmUgYWxzbyBpbmNsdWRlZCBpbiB0aGUgRmFyaGFkaWFuIFBhcGVyIApzaWduYXR1cmUsIDEwNCBhcmUgbmV3IG1hcmVrciBnZW5lcyAKCmBgYHtyfQpJZGVudHMoaGl2NCkgPC0gImNlbGxfdHlwZSIKIyBGaW5kIE1hcmtlcnMgdGhhdCBkaXN0aW5ndWlzaCBNeTIgZnJvbSB0aGUgb3RoZXIgTXllbG9pZCBjbHVzdGVycwpteTJfbWFya2VycyA8LSBGaW5kTWFya2VycyhoaXY0LCBpZGVudC4xICA9ICJNeWVsb2lkMiIsCiAgICAgICAgICAgIGlkZW50LjIgID0gYygiTXllbG9pZDEiLCAiTXllbG9pZDMiLCAiTXllbG9pZDQiLCAiTXllbG9pZDUiKSkKbXkyX21hcmtlcnMgPC0gbXkyX21hcmtlcnMgJT4lIHJvd25hbWVzX3RvX2NvbHVtbih2YXIgPSAiZ2VuZSIpCiMgQ2FuIHdlIGZpbmQgbWduZCBnZW5lcz8gKEtyYXNlbWFubikKbXkyX21hcmtlcnMgJT4lIGZpbHRlcihnZW5lICVpbiUgbWduZCAmIGF2Z19sb2cyRkMgPiAwKQojIGdlbmVzIGluIGRpc2Vhc2UtYXNzb2NhaXRlZCBtaWNyb2dsaWEgKEtlcmVuLVNoYXVsKQpteTJfbWFya2VycyAlPiUgZmlsdGVyKGdlbmUgJWluJSBkaXNlYXNlICYgYXZnX2xvZzJGQyA+IDApCgojIFNhbmtvd3NraQojIG1pY3JvZ2xpYSBnZW5lIHNpZ25hdHVyZQptaWNyb2dsaWEgPC0gYygiUDJSWTEyIiwgIkNYM0NSMSIsICJDU0YxUiIsICJUTUVNMTE5IiwgIlNMQzJBNSIgKQoKIyBtb25vY3l0ZSBnZW5lIHNpZ25hdHVyZQptb25vY3l0ZSA8LSBjKCJDQ1IyIiwgIkNMRUMxMkEiLCAiUExBQzgiLCAiRkNOMSIsICJTMTAwQTkiKQoKIyBob21lb3N0YXRpYyBtaWNyb2xnaWEgZ2VuZSBzaWdhbnR1cmUKaG9tZW9zdGF0aWMgPC0gYygiQ1gzQ1IxIiwgIlRNRU0xMTkiLCAiQ1NGMVIiLCAiUDJSWTEyIiwKICAgICAgICAgICAgICAgICAiUDJSWTEzIiwiU0VMUExHIiwgIk1BUkNLUyIpCgoKbXkyX21hcmtlcnMgJT4lIGZpbHRlcihnZW5lICVpbiUgbWljcm9nbGlhICYgYXZnX2xvZzJGQyA+IDApCm15Ml9tYXJrZXJzICU+JSBmaWx0ZXIoZ2VuZSAlaW4lIG1vbm9jeXRlICYgYXZnX2xvZzJGQyA+IDApCm15Ml9tYXJrZXJzICU+JSBmaWx0ZXIoZ2VuZSAlaW4lIGhvbWVvc3RhdGljICYgYXZnX2xvZzJGQyA+IDApCgoKIyBFc2F1bG92YQojIDEwIGdlbmVzIHRoYXQgZGlzY3JpbWluYXRlIG1pY3JvZ2xpYQptaWNyb2dsaWEgPC0gYygiQzFRQyIsICJDMVFCIiwgIkMxUUEiLCAiVFJFTTIiLCAiVElNRDQiLCAiQVBPQzEiLCAKICAgICAgICAgICAgICAgIkFQT0UiLCAiVE5GU0YxOCIsICJDTEVDOUEiLCAiQ1hDTDEyIikKIyBDYW4gd2UgZmluZCB0aGVzZSAxMCBnZW5lcyBpbiB0aGUgTXllbG9pZDIgdXByZWd1bGF0ZWQgZ2VuZXM/Cm15Ml9tYXJrZXJzICU+JSBmaWx0ZXIoZ2VuZSAlaW4lIG1pY3JvZ2xpYSAmIGF2Z19sb2cyRkMgPiAwKQoKCiMgR2xhc3MKIyA4NCBvZiB0aGUgbWljcm9nbGlhIHNpZ25hdHVyZSBnZW5lcyBhcmUgbW9yZSBoaWdobHkgZXhwcmVzc2VkIGluIHRoZSAKbWljcm9nbGlhX2dlbmVzIDwtIHJlYWQudGFibGUoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9kYXRhL01pY3JvZ2xpYV9nZW5lX3NpZ25hdHVyX2ZvdW5kX2luX0hJVjFfSElWMl9zYW1wbGVzIikKbTEgPC0gbXkyX21hcmtlcnMgJT4lIGZpbHRlcihnZW5lICVpbiUgbWljcm9nbGlhX2dlbmVzIFtbImdlbmVfbmFtZSJdXSAmIGF2Z19sb2cyRkMgPjApCiMgcmVtb3ZlIHRoZSBnZW5lcyB0aGF0IHdlcmUgYWxyZWFkeSB1c2VkIGJ5IHRoZSBGYXJoYWRpYW4gcGFwZXIKbTEgPC0gbTFbWyJnZW5lIl1dW20xW1siZ2VuZSJdXSAlaW4lIHBhcGVyID09IEZBTFNFXQoKaGl2X25ldyA8LSBBZGRNb2R1bGVTY29yZShoaXY0LCBmZWF0dXJlcyA9IG0xKQpGZWF0dXJlUGxvdChoaXZfbmV3LCBmZWF0dXJlcyA9ICJDbHVzdGVyMSIpICsKICBzY2FsZV9jb2xvdXJfZ3JhZGllbnRuKGNvbG91cnMgPSByZXYoYnJld2VyLnBhbChuID0gMTEsIG5hbWUgPSAiUmRCdSIpKSkgKwogICAgbGFicyh0aXRsZSA9ICJTZWxlY3RlZCBzaWduYXR1cmUgZ2VuZXMgZnJvbSB0aGUgR2xhc3MgcGFwZXIiKQoKYGBgCgojIyAgQ29uY2x1c2lvbnMgb24gTXlsb2lkMiBjZWxsIHR5cGUKClRha2VuIHRvZ2V0aGVyIHRoZSByZXN1bHRzIGFib3ZlIGRvIG5vdCBwcm92aWRlIGEgY2xlYXIgcGljdHVyZSBvbiB3aGV0aGVyIHRoZQpNeWVsb2lkMiBjbHVzdGVyIGNvbnNpc3RzIG9mIG1pY3JvZ2xpYS1saWtlIGNlbGxzLiBUaGVyZSBhcmUgc2V2ZXJhbCBnZW5lcyB3aGljaCAKYXJlIGFzc29jaWF0ZWQgd2l0aCBtaWNyb2dsaWEgYW5kIGRpc2Vhc2UtYXNzb2NpYXRlZCBtaWNyb2dsaWEsIHNldmVyYWwgb2Ygd2hpY2ggCnJlZmVycmVkIHRvIGJ5IFtARmFyaGFkaWFuXS4gTmV2ZXJ0aGVsZXNzLCB0aGVyZSBhcmUgYWxzbyBtYW55IGdlbmVzIHdoaWNoIAphcmUgZGVzY3JpYmVkIHRvIGJlIG1pY3JvZ2xpYSBtYXJrZXJzIGluIHRoZSBsaXRlcmF0dXJlLCBidXQgZG8gbm90IHNob3cgYSAKc2lnbmlmaWNhbnRseSBoaWdoZXIgZXhwcmVzc2lvbiBpbiBNeWVsb2lkMiB0aGFuIGluIHRoZSBvdGhlciBNeWVsb2lkIGNsdXN0ZXJzLgpUaGVyZWZvcmUsIHRoZSBjbHVzdGVyIHdpbGwgYmUgY29uc2lkZXJlZCBtaWNyb2dsaWEtbGlrZSBmb3Igbm93IGFuZCB0aGUKZm9sbG93aW5nIGFuYWx5c2lzIHdpbGwgcHJvdmlkZSBhZGRpdGlvbmFsIGluc2lnaHRzIG9uIHRoZSBpZGVudGl0eSBhbmQgCmNoYXJhY3RlcmlzdGljcyBvZiB0aGlzIGNsdXN0ZXIuICAKCgojIyBRdWFsaXR5IG9mIGRpZmZlcmVudCBzYW1wbGVzIGJlZm9yZSBxdWFsaXR5IGNvbnRyb2wgey50YWJzZXR9CgojIyMgTnVtYmVyIG9mIEZlYXR1cmVzCgpgYGB7ciwgcmVzdWx0cyA9ICJhc2lzIiwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTEyfQoKI2hhdmUgYSBsb29rIGF0IHRoZSBudW1iZXIgb2YgZGV0ZWN0ZWQgZmVhdHVyZXMKcDEgPC0gaGl2QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkgKwogIGdlb21fYm94cGxvdChhZXMoeCA9IG9yaWcuaWRlbnQsIHkgPSBuRmVhdHVyZV9STkEsIGZpbGwgPSBvcmlnLmlkZW50KSkgKwogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIHZqdXN0ID0gMC44LCBoanVzdCA9IDEpKSArCiAgTm9MZWdlbmQoKQoKcDIgPC0gaGl2QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkgKwogIGdlb21faGlzdG9ncmFtKGFlcyh4ID0gbkZlYXR1cmVfUk5BLCBmaWxsID0gb3JpZy5pZGVudCksIGJpbnMgPSAxMDApICsKICBmYWNldF93cmFwKH4gb3JpZy5pZGVudCwgbmNvbCA9IDQpICsKICBOb0xlZ2VuZCgpCgpwMyA8LSBoaXZAbWV0YS5kYXRhICU+JSAKICBnZ3Bsb3QoKSArCiAgZ2VvbV92aW9saW4oYWVzKHggPSBvcmlnLmlkZW50LCB5ID0gbkZlYXR1cmVfUk5BLCBmaWxsID0gb3JpZy5pZGVudCkpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3QgPSAxKSkgKwogIE5vTGVnZW5kKCkKCnA0IDwtIGhpdkBtZXRhLmRhdGEgJT4lIAogIGdncGxvdCgpICsKICBnZW9tX3Zpb2xpbihhZXMoeCA9IG9yaWcuaWRlbnQsIHkgPSBuRmVhdHVyZV9STkEsIGZpbGwgPSBvcmlnLmlkZW50KSkgKwogIHNjYWxlX3lfbG9nMTAoKSArCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgdmp1c3QgPSAwLjgsIGhqdXN0ID0gMSkpICsKICBOb0xlZ2VuZCgpCgpmaWd1cmUgPC0gZ2dhcnJhbmdlKHAxLCBwMywgcDQsIHAyLCBuY29sID0gMiwgbnJvdyA9IDIpCmFubm90YXRlX2ZpZ3VyZShmaWd1cmUsIHRvcCA9IHRleHRfZ3JvYigiTnVtYmVyIG9mIEZlYXR1cmVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemUgPSAyNSwgIGZhY2UgPSAiYm9sZCIpKQoKCmhpdkBtZXRhLmRhdGEgJT4lCiAgcmVuYW1lKHNhbXBsZSA9IG9yaWcuaWRlbnQpICU+JSAKICBncm91cF9ieShzYW1wbGUpICU+JSAKICBzdW1tYXJpc2UobiA9IG4oKSwgcTI1ID0gcXVhbnRpbGUobkZlYXR1cmVfUk5BLCAuMjUpLAogICAgICAgICAgICBxNTAgPSBxdWFudGlsZShuRmVhdHVyZV9STkEsIC41KSwgCiAgICAgICAgICAgIHE3NSA9IHF1YW50aWxlKG5GZWF0dXJlX1JOQSwgLjc1KSwgCiAgICAgICAgICAgIG1lYW4gPSBtZWFuKG5GZWF0dXJlX1JOQSkpICU+JQogICAga2FibGUoY2FwdGlvbiA9ICJOdW1iZXIgb2YgRmVhdHVyZXMgcGVyIHNhbXBsZSIpCgpgYGAKCgojIyMgTGlicmFyeSBTaXplCgpgYGB7ciwgcmVzdWx0cyA9ICJhc2lzIiwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTEyfQojIGhhdmUgYSBsb29rIGF0IHRoZSBsaWJyYXJ5IHNpemUKcDEgPC0gaGl2QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkgKwogIGdlb21fYm94cGxvdChhZXMoeCA9IG9yaWcuaWRlbnQsIHkgPSBuQ291bnRfUk5BLCBmaWxsID0gb3JpZy5pZGVudCkpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3QgPSAxKSkgKwogIE5vTGVnZW5kKCkKCnAyIDwtIGhpdkBtZXRhLmRhdGEgJT4lIAogIGdncGxvdCgpICsKICBnZW9tX2hpc3RvZ3JhbShhZXMoeCA9IG5Db3VudF9STkEsIGZpbGwgPSBvcmlnLmlkZW50KSwgYmlucyA9IDEwMCkgKwogIGZhY2V0X3dyYXAofiBvcmlnLmlkZW50LCBuY29sID0gNCkgKwogIE5vTGVnZW5kKCkKCnAzIDwtIGhpdkBtZXRhLmRhdGEgJT4lIAogIGdncGxvdCgpICsKICBnZW9tX3Zpb2xpbihhZXMoeCA9IG9yaWcuaWRlbnQsIHkgPSBuQ291bnRfUk5BLCBmaWxsID0gb3JpZy5pZGVudCkpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3QgPSAxKSkgKwogIE5vTGVnZW5kKCkKCnA0IDwtIGhpdkBtZXRhLmRhdGEgJT4lIAogIGdncGxvdCgpICsKICBnZW9tX3Zpb2xpbihhZXMoeCA9IG9yaWcuaWRlbnQsIHkgPSBuQ291bnRfUk5BLCBmaWxsID0gb3JpZy5pZGVudCkpICsKICBzY2FsZV95X2xvZzEwKCkgKwogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIHZqdXN0ID0gMC44LCBoanVzdCA9IDEpKSArCiAgTm9MZWdlbmQoKQogIApmaWd1cmUgPC0gZ2dhcnJhbmdlKHAxLCBwMywgcDQsIHAyLCBuY29sID0gMiwgbnJvdyA9IDIpCmFubm90YXRlX2ZpZ3VyZShmaWd1cmUsIHRvcCA9IHRleHRfZ3JvYigiTGlicmFyeSBzaXplIChudW1iZXIgb2YgY291bnRzKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplID0gMjUsICBmYWNlID0gImJvbGQiKSkKaGl2QG1ldGEuZGF0YSAlPiUKICByZW5hbWUoc2FtcGxlID0gb3JpZy5pZGVudCkgJT4lIAogIGdyb3VwX2J5KHNhbXBsZSkgJT4lIAogIHN1bW1hcmlzZShuID0gbigpLCBxMjUgPSBxdWFudGlsZSggbkNvdW50X1JOQSwgLjI1KSwKICAgICAgICAgICAgcTUwID0gcXVhbnRpbGUobkNvdW50X1JOQSwgLjUpLCAKICAgICAgICAgICAgcTc1ID0gcXVhbnRpbGUobkNvdW50X1JOQSwgLjc1KSwgCiAgICAgICAgICAgIG1lYW4gPSBtZWFuKG5Db3VudF9STkEpKSAlPiUgCiAgICBrYWJsZShjYXB0aW9uID0gIkxpYnJhcnkgc2l6ZSBwZXIgc2FtcGxlIikKCmBgYAoKCiMjIyBQZXJjZW50YWdlIG9mIE1pdG9jaG9uZHJpYWwgZ2VuZXMKCmBgYHtyLCByZXN1bHRzID0gImFzaXMiLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MTJ9CiMgaGF2ZSBhIGxvb2sgYXQgdGhlIHBlcmNlbnRhZ2Ugb2YgbWl0b2Nob25kcmlhbCBnZW5lcwpwMSA8LSBoaXZAbWV0YS5kYXRhICU+JSAKICBnZ3Bsb3QoKSArCiAgZ2VvbV9ib3hwbG90KGFlcyh4ID0gb3JpZy5pZGVudCwgeSA9IHBlcmNlbnRfbXQsIGZpbGwgPSBvcmlnLmlkZW50KSkgKwogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIHZqdXN0ID0gMC44LCBoanVzdCA9IDEpKSArCiAgTm9MZWdlbmQoKQoKcDIgPC0gaGl2QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkgKwogIGdlb21faGlzdG9ncmFtKGFlcyh4ID0gcGVyY2VudF9tdCwgZmlsbCA9IG9yaWcuaWRlbnQpLCBiaW5zID0gMTAwKSArCiAgZmFjZXRfd3JhcCh+IG9yaWcuaWRlbnQsIG5jb2wgPSA0KSArCiAgTm9MZWdlbmQoKQoKcDMgPC0gaGl2QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkgKwogIGdlb21fdmlvbGluKGFlcyh4ID0gb3JpZy5pZGVudCwgeSA9IHBlcmNlbnRfbXQsIGZpbGwgPSBvcmlnLmlkZW50KSkgKwogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIHZqdXN0ID0gMC44LCBoanVzdCA9IDEpKSArCiAgTm9MZWdlbmQoKQoKcDQgPC0gaGl2QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkgKwogIGdlb21fdmlvbGluKGFlcyh4ID0gb3JpZy5pZGVudCwgeSA9IHBlcmNlbnRfbXQsIGZpbGwgPSBvcmlnLmlkZW50KSkgKwogIHNjYWxlX3lfbG9nMTAoKSArCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgdmp1c3QgPSAwLjgsIGhqdXN0ID0gMSkpICsKICBOb0xlZ2VuZCgpCiAgCmZpZ3VyZSA8LSBnZ2FycmFuZ2UocDEsIHAzLCBwNCwgcDIsIG5jb2wgPSAyLCBucm93ID0gMikKYW5ub3RhdGVfZmlndXJlKGZpZ3VyZSwgdG9wID0gdGV4dF9ncm9iKCJQZXJjZW50YWdlIG9mIE1pdG9jaG9uZHJpYWwgZ2VuZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplID0gMjUsICBmYWNlID0gImJvbGQiKSkKCmhpdkBtZXRhLmRhdGEgJT4lCiAgcmVuYW1lKHNhbXBsZSA9IG9yaWcuaWRlbnQpICU+JSAKICBncm91cF9ieShzYW1wbGUpICU+JSAKICBzdW1tYXJpc2UobiA9IG4oKSwgcTI1ID0gcXVhbnRpbGUoIHBlcmNlbnRfbXQsIC4yNSksCiAgICAgICAgICAgIHE1MCA9IHF1YW50aWxlKHBlcmNlbnRfbXQsIC41KSwgCiAgICAgICAgICAgIHE3NSA9IHF1YW50aWxlKHBlcmNlbnRfbXQsIC43NSksIAogICAgICAgICAgICBtZWFuID0gbWVhbihwZXJjZW50X210KSkgJT4lIAogICAga2FibGUoY2FwdGlvbiA9ICJQZXJjZW50YWdlIG9mIG1pdG9jaG9uZHJpYWwgZ2VuZXMgcGVyIHNhbXBsZSIpCgpgYGAKCiMjIHstfQoKIyMgUXVhbGl0eSBvZiB0aGUgZGlmZmVyZW50IHNhbXBsZXMgYWZ0ZXIgcXVhbGl0eSBjb250cm9sIHsudGFic2V0fQoKCkl0IHNlZW1zIHRoYXQgdGhlIENTRjEgc2FtcGxlcywgYXMgd2VsbCBhcyB0aGUgdHdvIHVuaW5mZWN0ZWQgc2FtcGxlcyBoYXZlIHZlcnkKZmV3IGNlbGxzIHdpdGggbkZlYXR1cmVfUk5BID4gNTAwLCBzbyB3ZSBhcmUgbGVmdCB3aXRoIGxlc3MgY2VsbHMgZnJvbSB0aGVzZQpzYW1wbGVzCgojIyMgTnVtYmVyIG9mIGZlYXR1cmVzIAoKYGBge3IsIHJlc3VsdHMgPSAiYXNpcyIsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMn0KCiMgSGF2ZSBhIGxvb2sgYXQgdGhlIG51bWJlciBvZiBGZWF0dXJlIFJOQQpwMSA8LSBoaXZfZmlsdEBtZXRhLmRhdGEgJT4lCiAgZ2dwbG90KCkgKwogIGdlb21fYm94cGxvdChhZXMoeCA9IG9yaWcuaWRlbnQsIHkgPSBuRmVhdHVyZV9STkEsIGZpbGwgPSBvcmlnLmlkZW50KSkgKwogIE5vTGVnZW5kKCkKCnAyIDwtIGhpdl9maWx0QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkrCiAgZ2VvbV92aW9saW4oYWVzKHggPSBvcmlnLmlkZW50LCB5ID0gbkZlYXR1cmVfUk5BLCBmaWxsID0gb3JpZy5pZGVudCkpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3QgPSAxKSkgKwogIE5vTGVnZW5kKCkKCnAzIDwtIGhpdl9maWx0QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkgKwogIGdlb21faGlzdG9ncmFtKGFlcyh4ID0gbkZlYXR1cmVfUk5BLCBmaWxsID0gb3JpZy5pZGVudCkpICsKICBmYWNldF93cmFwKH5vcmlnLmlkZW50LCBuY29sID0gNCkgKwogIE5vTGVnZW5kKCkKCmZpZ3VyZSA8LSBnZ2FycmFuZ2UocDEsIHAyLCBwMywgbmNvbCA9IDIsIG5yb3cgPSAyKQphbm5vdGF0ZV9maWd1cmUoZmlndXJlLCB0b3AgPSB0ZXh0X2dyb2IoIk51bWJlciBvZiBmZWF0dXJlcyBhZnRlciBxdWFsaXR5IGNvbnRyb2wiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IDI1LCAgZmFjZSA9ICJib2xkIikpCgpoaXZfZmlsdEBtZXRhLmRhdGEgJT4lIAogIHJlbmFtZShzYW1wbGUgPSBvcmlnLmlkZW50KSAlPiUgCiAgZ3JvdXBfYnkoc2FtcGxlKSAlPiUKICBzdW1tYXJpc2UobiA9IG4oKSwgcTI1ID0gcXVhbnRpbGUobkZlYXR1cmVfUk5BLCAuMjUpLAogICAgICAgICAgICBxNTAgPSBxdWFudGlsZShuRmVhdHVyZV9STkEsIC41KSwKICAgICAgICAgICAgcTc1ID0gcXVhbnRpbGUobkZlYXR1cmVfUk5BLCAuNzUpLAogICAgICAgICAgICBtZWFuID0gbWVhbihuRmVhdHVyZV9STkEpKSAlPiUKICAgIGthYmxlKGNhcHRpb24gPSAiTnVtYmVyIG9mIEZlYXR1cmVzIHBlciBzYW1wbGUgYWZ0ZXIgcXVhbGl0eSBjb250cm9sIikKCmBgYAoKIyMjIExpYnJhcnkgc2l6ZSAKCmBgYHtyLCByZXN1bHRzID0gImFzaXMiLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MTJ9CnAxIDwtIGhpdl9maWx0QG1ldGEuZGF0YSAlPiUKICBnZ3Bsb3QoKSArCiAgZ2VvbV9ib3hwbG90KGFlcyh4ID0gb3JpZy5pZGVudCwgeSA9IG5Db3VudF9STkEsIGZpbGwgPSBvcmlnLmlkZW50KSkgKwogIE5vTGVnZW5kKCkKCnAyIDwtIGhpdl9maWx0QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkrCiAgZ2VvbV92aW9saW4oYWVzKHggPSBvcmlnLmlkZW50LCB5ID0gbkNvdW50X1JOQSwgZmlsbCA9IG9yaWcuaWRlbnQpKSArCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgdmp1c3QgPSAwLjgsIGhqdXN0ID0gMSkpICsKICBOb0xlZ2VuZCgpCgpwMyA8LSBoaXZfZmlsdEBtZXRhLmRhdGEgJT4lIAogIGdncGxvdCgpICsKICBnZW9tX2hpc3RvZ3JhbShhZXMoeCA9IG5Db3VudF9STkEsIGZpbGwgPSBvcmlnLmlkZW50KSkgKwogIGZhY2V0X3dyYXAofm9yaWcuaWRlbnQsIG5jb2wgPSA0KSArCiAgTm9MZWdlbmQoKQoKZmlndXJlIDwtIGdnYXJyYW5nZShwMSwgcDIsIHAzLCBuY29sID0gMiwgbnJvdyA9IDIpCmFubm90YXRlX2ZpZ3VyZShmaWd1cmUsIHRvcCA9IHRleHRfZ3JvYigiTGlicmFyeSBzaXplIChudW1iZXIgb2YgY291bnRzKSBhZnRlciBxdWFsaXR5IGNvbnRyb2wiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IDI1LCAgZmFjZSA9ICJib2xkIikpCgpoaXZfZmlsdEBtZXRhLmRhdGEgJT4lIAogIHJlbmFtZShzYW1wbGUgPSBvcmlnLmlkZW50KSAlPiUgCiAgZ3JvdXBfYnkoc2FtcGxlKSAlPiUKICBzdW1tYXJpc2UobiA9IG4oKSwgcTI1ID0gcXVhbnRpbGUobkNvdW50X1JOQSwgLjI1KSwKICAgICAgICAgICAgcTUwID0gcXVhbnRpbGUobkNvdW50X1JOQSwgLjUpLAogICAgICAgICAgICBxNzUgPSBxdWFudGlsZShuQ291bnRfUk5BLCAuNzUpLAogICAgICAgICAgICBtZWFuID0gbWVhbihuQ291bnRfUk5BKSkgJT4lCiAga2FibGUoY2FwdGlvbiA9ICJMaWJyYXJ5IHNpemUgcGVyIHNhbXBsZSBhZnRlciBxdWFsaXR5IGNvbnRyb2wiKQoKYGBgCgojIyMgUGVyY2VudGFnZSBvZiBNaXRvY2hvbmRyaWFsIGdlbmVzIAoKYGBge3IsIHJlc3VsdHMgPSAiYXNpcyIsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMn0KcDEgPC0gaGl2X2ZpbHRAbWV0YS5kYXRhICU+JQogIGdncGxvdCgpICsKICBnZW9tX2JveHBsb3QoYWVzKHggPSBvcmlnLmlkZW50LCB5ID0gcGVyY2VudF9tdCwgZmlsbCA9IG9yaWcuaWRlbnQpKSArCiAgTm9MZWdlbmQoKQoKcDIgPC0gaGl2X2ZpbHRAbWV0YS5kYXRhICU+JSAKICBnZ3Bsb3QoKSsKICBnZW9tX3Zpb2xpbihhZXMoeCA9IG9yaWcuaWRlbnQsIHkgPSBwZXJjZW50X210LCBmaWxsID0gb3JpZy5pZGVudCkpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCB2anVzdCA9IDAuOCwgaGp1c3QgPSAxKSkgKwogIE5vTGVnZW5kKCkKCnAzIDwtIGhpdl9maWx0QG1ldGEuZGF0YSAlPiUgCiAgZ2dwbG90KCkgKwogIGdlb21faGlzdG9ncmFtKGFlcyh4ID0gcGVyY2VudF9tdCwgZmlsbCA9IG9yaWcuaWRlbnQpKSArCiAgZmFjZXRfd3JhcCh+b3JpZy5pZGVudCwgbmNvbCA9IDQpICsKICBOb0xlZ2VuZCgpCgpmaWd1cmUgPC0gZ2dhcnJhbmdlKHAxLCBwMiwgcDMsIG5jb2wgPSAyLCBucm93ID0gMikKYW5ub3RhdGVfZmlndXJlKGZpZ3VyZSwgdG9wID0gdGV4dF9ncm9iKCJQZXJjZW50YWdlIG9mIE1pdG9jaG9uZHJpYWwgZ2VuZXMgYWZ0ZXIgcXVhbGl0eSBjb250cm9sIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemUgPSAyNSwgIGZhY2UgPSAiYm9sZCIpKQoKaGl2X2ZpbHRAbWV0YS5kYXRhICU+JSAKICByZW5hbWUoc2FtcGxlID0gb3JpZy5pZGVudCkgJT4lIAogIGdyb3VwX2J5KHNhbXBsZSkgJT4lCiAgc3VtbWFyaXNlKG4gPSBuKCksIHEyNSA9IHF1YW50aWxlKHBlcmNlbnRfbXQsIC4yNSksCiAgICAgICAgICAgIHE1MCA9IHF1YW50aWxlKHBlcmNlbnRfbXQsIC41KSwKICAgICAgICAgICAgcTc1ID0gcXVhbnRpbGUocGVyY2VudF9tdCwgLjc1KSwKICAgICAgICAgICAgbWVhbiA9IG1lYW4ocGVyY2VudF9tdCkpICU+JSAKICAgIGthYmxlKGNhcHRpb24gPSAiUGVyY2VudGFnZSBvZiBtaXRvY2hvbmRyaWFsIGdlbmVzIHBlciBzYW1wbGUgYWZ0ZXIgcXVhbGl0eSBjb250cm9sIikKCmBgYAoKIyMgey19Ci0tLQoKCiMgUmVmZXJlbmNlcwoK</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>





</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("HIV_CSF_dataset_analysis.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
