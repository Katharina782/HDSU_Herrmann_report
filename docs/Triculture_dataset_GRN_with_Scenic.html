<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Katharina Mikulik" />


<title>TF activity in iMg from triculture dataset</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Report</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Introduction.html">Introduction</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Results
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="HIV_CSF_dataset_analysis.html">1. CSF/Blood samples</a>
    </li>
    <li>
      <a href="TF_activity_analysis_of_myeloid2_cluster.html">2. TF activity Myeloid2</a>
    </li>
    <li>
      <a href="Triculture_dataset_analysis_and_integration_Farhadian_dataset.html">3. Integration CSF/Blood &amp; triculture</a>
    </li>
    <li>
      <a href="Triculture_dataset_GRN_with_Scenic.html">4. TF activity iMg</a>
    </li>
  </ul>
</li>
<li>
  <a href="Discussion.html">Discussion</a>
</li>
<li>
  <a href="Methods.html">Methods</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Katharina782/report">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">TF activity in iMg from triculture dataset</h1>
<h4 class="author">Katharina Mikulik</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#gene-regulatory-network-inference-with-scenic">Gene regulatory network inference with SCENIC</a></li>
<li><a href="#bulk-atacseq-footprinting-c20-cell-line">Bulk ATACseq footprinting, C20 cell line</a></li>
<li><a href="#tf-activity-in-img">TF activity in iMg</a>
<ul>
<li><a href="#heatmap-for-all-tfs">Heatmap for all TFs</a></li>
<li><a href="#heatmap-of-25-tfs-with-differential-binding-score">Heatmap of 25 TFs with differential binding score</a>
<ul>
<li><a href="#hierarchical-clustering-with-different-k">Hierarchical clustering with different k</a>
<ul>
<li><a href="#wss-plot">wss plot</a></li>
<li><a href="#different-k">different k</a></li>
<li><a href="#k-4">k = 4</a></li>
<li><a href="#section"></a></li>
</ul></li>
<li><a href="#split-heatmaps-to-find-patterns">Split heatmaps to find patterns</a>
<ul>
<li><a href="#separate-heatmaps-according-to-infection-condition">Separate Heatmaps according to infection condition</a></li>
<li><a href="#split-heatmaps-according-to-tf-binding-scores-from-atacseq-data">Split Heatmaps according to TF binding scores from ATACseq data</a></li>
</ul></li>
</ul></li>
<li><a href="#statistical-tests-to-find-tf-activity-differences-between-clusters">Statistical Tests to find TF activity differences between clusters</a></li>
<li><a href="#posthoc-analysis">Posthoc analysis</a>
<ul>
<li><a href="#more-bound-in-latent-infection">more bound in latent infection</a></li>
<li><a href="#more-bound-in-uninfected">more bound in uninfected</a></li>
</ul></li>
<li><a href="#correlations-between-conditions">Correlations between conditions</a>
<ul>
<li><a href="#correlation-matrix">Correlation matrix</a></li>
<li><a href="#scatter-matrix">Scatter matrix</a></li>
</ul></li>
<li><a href="#correlation-between-tfs-differentiating-myeloid2-clusters">Correlation between TFs differentiating Myeloid2 clusters</a>
<ul>
<li><a href="#correlation-matrix-1">Correlation Matrix</a></li>
<li><a href="#scatter-matrix-1">Scatter Matrix</a></li>
</ul></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-12-22
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>report/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20211203code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20211203)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20211203code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20211203)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKatharina782reporttreefdf25ce5decf9dff024fb0470f591b4a70f6aee6targetblankfdf25cea"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/Katharina782/report/tree/fdf25ce5decf9dff024fb0470f591b4a70f6aee6" target="_blank">fdf25ce</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKatharina782reporttreefdf25ce5decf9dff024fb0470f591b4a70f6aee6targetblankfdf25cea" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/Katharina782/report/tree/fdf25ce5decf9dff024fb0470f591b4a70f6aee6" target="_blank">fdf25ce</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    analysis/Independent_cell_type_identification_Farhadian_dataset_cache/
    Ignored:    analysis/Triculture_dataset_analysis_and_integration_Farhadian_dataset_cache/

Untracked files:
    Untracked:  README.html

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/Triculture_dataset_GRN_with_Scenic.Rmd</code>) and HTML (<code>docs/Triculture_dataset_GRN_with_Scenic.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/0a10c5865c15bdc0867dc5c069dc4cfb7703f73c/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">0a10c58</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/bdbb921b65681909caf7252afe838d8b807681c3/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">bdbb921</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/efc0f94be22d7f357aeb93d42cfe3cec476f700a/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">efc0f94</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
wflow_publish(c(“analysis/TF_activity_analysis_of_myeloid2_cluster.Rmd”,
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/9597c36bc5a6df5f071249d97949566b2c7db870/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/ea7e899746b03ca612d93ad003c875fc101d2329/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">ea7e899</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/6783264e95c3864ae6a468bdfed32b21af801b6d/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">6783264</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/9e2c322b7e27fe7694e862cf4b11ae612816498d/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">9e2c322</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(c(“analysis/Triculture_dataset_GRN_with_Scenic.Rmd”,
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/40651d96647f10219a4aec953c8d618d57bc13f5/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/f7243f8882ef1868800d5f0e420f83d5e4ba39bb/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">f7243f8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/f7243f8882ef1868800d5f0e420f83d5e4ba39bb/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">f7243f8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/8b791e32c4621d66dad520814dea9593d4ae12a6/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">8b791e3</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/9ee308625fb863ad709edf2660babe4de93ced91/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/e87fa963caeed78821ac7f482359072ce58b8529/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">e87fa96</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
<td>
new files
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<style>
body {
text-align: justify}
</style>
<pre class="r"><code>library(tidyverse)
library(Seurat)
library(edgeR)
library(Matrix)
library(data.table)
library(ggplot2)
library(dplyr)
library(ggrepel)
#library(harmony)
library(RColorBrewer)
library(pheatmap)
library(ggcorrplot)
library(ComplexHeatmap)
library(circlize)
library(ggpubr)
library(gridExtra)
library(corrplot)
library(rstatix)
library(knitr)
library(metap)
library(multtest)
library(readxl)</code></pre>
<div id="gene-regulatory-network-inference-with-scenic" class="section level2">
<h2>Gene regulatory network inference with SCENIC</h2>
<p>To infer GRNs from iMg cells from the triculture dataset <span class="citation">[@Ryan]</span> (4333 cells in total) I again used SCENIC.</p>
<p>When referring to differentially bound TFs in the C20 cell line in the following I am referring to differential binding scores between infection conditions obtained from bulk ATACseq data from C20 cell line cultures using TOBIAS.</p>
<p>I first tried to run SCENIC with 3000 most highly variable genes (HVG), but then I only got an overlap with differentially bound TFS of eight. When using 10,000 HVG SCENIC returns 232 TFS and their corresponding activity score for each cell. 25 of these TFs overlap with differentially bound TFs in the C20 cell line.</p>
<pre class="r"><code># read in triculture Seurat object
triculture &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/triculture_clean_seurat_object&quot;)

# read in CSF HIV Seurat object
hiv7 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/total_7_samples_label_transfer.rds&quot;)

imicroglia &lt;- subset(triculture, cell_type == &quot;iMg&quot;)</code></pre>
<details>
<summary>
<strong>preparing matrix for SCENIC</strong>
</summary>
<p>First, I use SCTransform for normalization of the expression data, then the top 10,000 HVGs are selected and the matrix transposed, because the pySCENIC pipeline used requires an in input matrix which has genes as columns and cells as rows. (<a href="https://github.com/hdsu-bioquant/pySCENIC_pipeline/blob/master/input/gene_exp_mtx_example.tsv" class="uri">https://github.com/hdsu-bioquant/pySCENIC_pipeline/blob/master/input/gene_exp_mtx_example.tsv</a>)</p>
<pre><code># use 10 000 most highly variable genes
scenic &lt;- SCTransform(imicroglia, variable.features.n = 10000, verbose=FALSE)
saveRDS(scenic, &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/triculture_scenic&quot;)
scenic &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/triculture_scenic&quot;)
scenic_hvg &lt;- subset(scenic, features = scenic@assays$SCT@var.features)
scenic_mtx &lt;- t(scenic_hvg@assays$SCT@scale.data)
write.table(x = scenic_mtx, file = &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/pySCENIC_pipeline/input/triculture_mtx.tsv&quot;, sep = &quot;\t&quot;)

#scenic_matrix &lt;- read.table(file = &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/pySCENIC_pipeline/input/triculture_mtx.tsv&quot;, sep = &quot;\t&quot;)</code></pre>
<hr />
</details>
<details>
<summary>
<strong>AuCell matrix - output from Scenic</strong>
</summary>
<p>The output from SCENIC is a matrix containing cells as rows and 232 TFs as columns. Five exemplary rows and columns are shown below. The TF activity for each cell can be used to draw conclusions about different cell states.</p>
<pre class="r"><code>auc_mtx &lt;- read.csv(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/pySCENIC_output/aucell_img_10k.csv&quot;)
auc_mtx &lt;- auc_mtx %&gt;% column_to_rownames(&quot;Cell&quot;)
auc_mtx &lt;- auc_mtx %&gt;% setnames( old = colnames(auc_mtx), new = sapply(strsplit(
  colnames(auc_mtx), &quot;[...]&quot;), `[`, 1))

auc_mtx[1:5, 1:5] %&gt;% kable(caption = &quot;Layout of TF activity matrix&quot;)</code></pre>
<table>
<caption>Layout of TF activity matrix</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ARID3A</th>
<th align="right">ARNT</th>
<th align="right">ARNTL2</th>
<th align="right">ASCL2</th>
<th align="right">ATF2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ca_AAACCTGGTGTTCGAT-1</td>
<td align="right">0.0337910</td>
<td align="right">0.0864444</td>
<td align="right">0.063000</td>
<td align="right">0.0002</td>
<td align="right">0.01125</td>
</tr>
<tr class="even">
<td align="left">ca_AAACCTGGTTGTACAC-1</td>
<td align="right">0.0200299</td>
<td align="right">0.0237778</td>
<td align="right">0.024625</td>
<td align="right">0.0629</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="left">ca_AAACGGGAGAATTCCC-1</td>
<td align="right">0.0436418</td>
<td align="right">0.0133333</td>
<td align="right">0.006375</td>
<td align="right">0.0000</td>
<td align="right">0.11100</td>
</tr>
<tr class="even">
<td align="left">ca_AAACGGGAGACAGACC-1</td>
<td align="right">0.0314925</td>
<td align="right">0.0000000</td>
<td align="right">0.063625</td>
<td align="right">0.0804</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="left">ca_AAACGGGTCACATACG-1</td>
<td align="right">0.0402687</td>
<td align="right">0.0971111</td>
<td align="right">0.067625</td>
<td align="right">0.0000</td>
<td align="right">0.00000</td>
</tr>
</tbody>
</table>
<hr />
</details>
<details>
<summary>
<strong>Number of iMg in each condition</strong>
</summary>
<pre class="r"><code># add auc matrix to metadata of hiv4 seurat object
tri_mg &lt;- AddMetaData(imicroglia, 
                    metadata = auc_mtx, 
                    col.name = colnames(auc_mtx))</code></pre>
<pre class="r"><code>tri_mg@meta.data %&gt;% 
  rename(condition  = orig.ident) %&gt;%
  group_by(condition) %&gt;%
  summarize(n = n()) %&gt;% 
  kable(caption = &quot;Number of cells in each condition&quot;)</code></pre>
<table>
<caption>Number of cells in each condition</caption>
<thead>
<tr class="header">
<th align="left">condition</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Inf</td>
<td align="right">1166</td>
</tr>
<tr class="even">
<td align="left">Inf+EFZ</td>
<td align="right">1382</td>
</tr>
<tr class="odd">
<td align="left">Uninf</td>
<td align="right">1163</td>
</tr>
<tr class="even">
<td align="left">Uninf+EFZ</td>
<td align="right">722</td>
</tr>
</tbody>
</table>
<hr />
</details>
</div>
<div id="bulk-atacseq-footprinting-c20-cell-line" class="section level1">
<h1>Bulk ATACseq footprinting, C20 cell line</h1>
<p>The C20 cell line was derived from an HIV+ patient treated with ART (Antiretroviral Therapy). Since the access of ART to the brain is limited due to the blood-brain barrier, the effects of ART on these cells are probably negligible. Only the 75 TFs with p-values for differential binding scores below 1e-50 were used. We will focus on TFs which show differential binding scores between latent infection and uninfected conditions in primary microglia. For 25 of these 75 TFs there is a TF activity score for the iMg. Focusing on these 25 TFs we might be able to find activity patterns that correlate with the TF binding scores. Five TFs are more bound in latent infection and twenty TFs are more bound in uninfected cells</p>
<p>The reason why we find more of the TFs more bound in uninfected cells in the TF activity score matrix from SCENIC is unclear.</p>
<pre class="r"><code>tfs_ana &lt;- read.table(&quot;/media/ag-cherrmann/projects/06_HIV_Microglia/data/atacseq/data-2020-11-06/tobias/TOBIAS_snakemake/footprint_mglia2_GlassTF_17-03/TFBS/bindetect_results.txt&quot;, sep = &quot;\t&quot;, header = TRUE)

top_tfs &lt;- tfs_ana %&gt;% filter(uninf_red_pvalue &lt; 1e-50)

# keep only the TFs in the dataframe which overlap between the two datasets.
overlap_atac &lt;- top_tfs %&gt;% filter(name %in% colnames(auc_mtx))

# dataframe containing only the 25 Tfs whcih overlap with TF activity matrix from SCENIC 
# adding a column with information in which infection condition the TF is more bound
atac_tfs_df &lt;- top_tfs %&gt;% filter(name %in% colnames(auc_mtx)) %&gt;% 
  mutate(condition = ifelse(uninf_red_change &gt; 0, &quot;up_uninf&quot;, &quot;up_latent&quot;))

# List of 5 TFs more bound in latent infection
up_latent &lt;- atac_tfs_df$name[atac_tfs_df$condition == &quot;up_latent&quot;]
# list of 25 TFs more bound in uninfected cells
up_uninf &lt;- atac_tfs_df$name[atac_tfs_df$condition == &quot;up_uninf&quot;]</code></pre>
<details>
<summary>
<strong>Volcano Plot ATAC-seq footprinting</strong>
</summary>
<pre class="r"><code>top_tfs %&gt;% 
  # add a column containing information in which condition the corresponding TF 
  # is upregulated
  mutate(condition = ifelse(uninf_red_change &lt; 0, &quot;up_latent&quot;, &quot;up_uninf&quot;)) %&gt;%
  # add a column conaining the labels for the plot
  # I only want to label cells which are also found by Scenic
  mutate(label = ifelse(name %in% overlap_atac$name, name, NA)) %&gt;% 
  ggplot(aes(x = uninf_red_change,
             y = -log10(uninf_red_pvalue),
             col = condition, 
             label = label)) +
  geom_point() +
  geom_hline(yintercept = -log10(1e-50), col = &quot;red&quot;) +
  geom_text(nudge_x = .05, nudge_y = 2) +
  labs(title = &quot;TFs with differential binding scores&quot;) +
  ylab(&quot;-log10(p_value)&quot;) +
  xlab(&quot;differential binding score&quot;)
Warning: Removed 50 rows containing missing values (geom_text).</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-7-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-7-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-7-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-7-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</details>
</div>
<div id="tf-activity-in-img" class="section level1">
<h1>TF activity in iMg</h1>
<div id="heatmap-for-all-tfs" class="section level2">
<h2>Heatmap for all TFs</h2>
<p>In the heatmap of TF activities below you can already see a trend towards a separation of cells treated with EFZ (blue and green) from untreated cells (red and orange).</p>
<details>
<summary>
<strong>Heatmap of 232 TFs and their activity in iMg</strong>
</summary>
<pre class="r"><code>conditions &lt;- tri_mg@meta.data %&gt;%
                    rownames_to_column(&quot;cell&quot;) %&gt;%
                    select(&quot;cell&quot;, &quot;orig.ident&quot;)%&gt;% column_to_rownames(&quot;cell&quot;)


ht &lt;- Heatmap(t(auc_mtx), 
      col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
      show_column_names = FALSE,
      row_names_side = &quot;left&quot;,
      top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                         name = &quot;condition&quot;, col =  
                                         list(condition = c(&quot;Uninf&quot; = &quot;orange&quot;, 
                                                            &quot;Inf+EFZ&quot; = &quot;green&quot;,
                                                            &quot;Inf&quot; = &quot;red&quot;,
                                                            &quot;Uninf+EFZ&quot; = &quot;blue&quot;)))
)
ht</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-8-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-8-1">
Past versions of unnamed-chunk-8-1.png
</button>
</p>
<div id="fig-unnamed-chunk-8-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-8-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-8-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</details>
</div>
<div id="heatmap-of-25-tfs-with-differential-binding-score" class="section level2">
<h2>Heatmap of 25 TFs with differential binding score</h2>
<p>We will now investigate if we can find activity patterns which resemble the differential binding score patterns found in 25 TFs.</p>
<div id="hierarchical-clustering-with-different-k" class="section level3 tabset">
<h3 class="tabset">Hierarchical clustering with different k</h3>
<p>Using hierarchical clustering we migth be able to identify clusters with certain patterns of TF activity. Judging from the different heatmaps, k = 4 might be the most informative, since for k = 5 there is only one TF (NHLH1) differentiating an additional cluster. The plot of within-clusters sum of squares should help to pick the best number of clusters, however as can be seen below there is no obvious kink in the curve.</p>
<p>Hierarchical clustering with k = 2 seems to split the cells into treated vs.  untreated cells. These two clusters have a very evident biological meaning. Using k = 3 or k = 4 keeps these two biologically relevant groups separate, but also creates additional clusters which seem to be a mixture of treated and untreated cells. Having a closer look at clusters from k = 4 might give som additional biological insights.</p>
<p>Having a closer look at the four clusters, it becomes evident that the two left most clusters separate treated cells from untreated cells, independent of the infection condition. There are more Inf+EFZ than Uninf+EFZ in the first cluster, however this is in line with the lower cell number of Uninf+EFZ (722 cells) compared to Inf+EFZ (1382 cells).</p>
<p>Two TFs seem to be more active in Inf+EFZ and Uninf+EFZ (compared to Inf and Uninf):</p>
<ul>
<li>RUNX3</li>
<li>JUNB</li>
</ul>
<p>Three TFs seem to be more active in Inf and Uninf (compared to Inf+EFZ and Uninf+EFZ):</p>
<ul>
<li>NFAT5</li>
<li>TCF7L2</li>
<li>CEBPB</li>
</ul>
<p>TCF4 distinguishes a third cluster.</p>
<p>Is there a biological meaning behind that? Maybe we can associate them with a particular condition?</p>
<div id="wss-plot" class="section level4">
<h4>wss plot</h4>
<pre class="r"><code>df &lt;- hiv7@meta.data %&gt;% filter(cell_type == &quot;Myeloid2&quot;, 
                                    orig.ident == &quot;HIV1_CSF&quot;)
mtx &lt;- auc_mtx[, atac_tfs_df$name]

# Decide on a k for clustering
wss = sapply(2:15, function(k) {
  kmeans(x = t(mtx), centers = k)$tot.withinss
})

plot(2:15, wss, type = &quot;b&quot;, 
     xlab = &quot;Number of clusters k&quot;, 
     ylab = &quot;Total within-clusters sum of square&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-9-1">
Past versions of unnamed-chunk-9-1.png
</button>
</p>
<div id="fig-unnamed-chunk-9-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="different-k" class="section level4">
<h4>different k</h4>
<pre class="r"><code>
ht_list &lt;- map(seq.int(2,6), function(n){
  ht &lt;- Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
        col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        column_title = paste0(&quot;k = &quot;, n),
        show_column_names = FALSE,
        row_names_side = &quot;left&quot;,
        top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                           name = &quot;condition&quot;,
                                           col = list(condition = 
                                                        c(&quot;Uninf&quot; = &quot;orange&quot;, 
                                                          &quot;Inf+EFZ&quot; = &quot;green&quot;,
                                                          &quot;Inf&quot; = &quot;red&quot;, 
                                                          &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
        column_km = n,
         )
  
})

ht_list &lt;- ht_list[[1]] + ht_list[[2]] + ht_list[[3]] + ht_list[[4]] + ht_list[[5]]
draw(ht_list, column_title = &quot;Hierarchical clustering with different k&quot;, ht_gap = unit(2, &quot;cm&quot;))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-10-1">
Past versions of unnamed-chunk-10-1.png
</button>
</p>
<div id="fig-unnamed-chunk-10-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="k-4" class="section level4">
<h4>k = 4</h4>
<pre class="r"><code>ht &lt;- draw(Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
      col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
      column_title = &quot;hierarchical clustering with k = 4&quot;,
      show_column_names = FALSE,
      row_names_side = &quot;left&quot;,
      top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                         name = &quot;condition&quot;,
                                         col = list(condition = 
                                                      c(&quot;Uninf&quot; = &quot;orange&quot;, 
                                                        &quot;Inf+EFZ&quot; = &quot;green&quot;,
                                                        &quot;Inf&quot; = &quot;red&quot;, 
                                                        &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
      column_km = 4,
       ))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-11-1">
Past versions of unnamed-chunk-11-1.png
</button>
</p>
<div id="fig-unnamed-chunk-11-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="section" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<hr />
</div>
</div>
<div id="split-heatmaps-to-find-patterns" class="section level3 tabset">
<h3 class="tabset">Split heatmaps to find patterns</h3>
<div id="separate-heatmaps-according-to-infection-condition" class="section level4">
<h4>Separate Heatmaps according to infection condition</h4>
<p>Separating the cells according to different conditions it becomes very evident, that there is a bigger difference between cells treated with EFZ vs. untreated cells than between infected vs uninfected cells. The Inf+EFZ (green) and Uninf+EFZ (blue) show very similar TF activity patterns and the Inf (red) and Uninf (orange) show very similar TF activity patterns. These findings represent the findings from above</p>
<p>Two TFs seem to be more active in Inf+EFZ and Uninf+EFZ (compared to Inf and Uninf):</p>
<ul>
<li><strong>RUNX3</strong></li>
<li><strong>JUNB</strong></li>
</ul>
<p>Three TFs seem to be more active in Inf and Uninf (compared to Inf+EFZ and Uninf+EFZ):</p>
<ul>
<li><strong>NFAT5:</strong> In microglia cells inflammatory signals trigger NFAT5 expression. (Yang X.L. et al., Dev Neurosci, 2018)</li>
<li><strong>TCF7L2</strong></li>
<li><strong>CEBPB</strong> regulates pro-inflammatory gene expression, increased expression in HAND (HIV-associated neurocognitive disorder), BUT no data from microglia (Canchi S. et al. J Neuroinflammation, 2020)</li>
</ul>
<pre class="r"><code>ht_conditions &lt;- Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
        #col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        column_title = &quot;split according to infection condition&quot;,
        show_column_names = FALSE,
        row_names_side = &quot;left&quot;,
        col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                           name = &quot;condition&quot;, col = list(condition = c(&quot;Uninf&quot; = &quot;orange&quot;, &quot;Inf+EFZ&quot; = &quot;green&quot;, &quot;Inf&quot; = &quot;red&quot;, &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
        #row_km = 2,
        #row_split = atac_tfs_df$condition,
        column_split = tri_mg$orig.ident,
        left_annotation = rowAnnotation(TF_footprinting = (atac_tfs_df %&gt;% 
                                                         select(name, condition) %&gt;%
                                                         column_to_rownames(&quot;name&quot;))[[&quot;condition&quot;]],
              name = &quot;TF_footprinting&quot;,
              col = list(TF_footprinting = c(&quot;up_latent&quot; = &quot;pink&quot;, 
                                             &quot;up_uninf&quot; = &quot;darkgreen&quot;)))
        )

ht_conditions </code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-12-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-12-1">
Past versions of unnamed-chunk-12-1.png
</button>
</p>
<div id="fig-unnamed-chunk-12-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-12-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-12-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-12-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="split-heatmaps-according-to-tf-binding-scores-from-atacseq-data" class="section level4">
<h4>Split Heatmaps according to TF binding scores from ATACseq data</h4>
<p>Separating the heatmap along the rows, according to TFs either more bound in latently infected microglia or more bound in uninfected primary microglia, does not result in a separation according to treatment with EFZ.</p>
<p>What one might expect to see, is that TFs more bound in uninfected primary microglia would also show higher activity in uninfected iMg, while TFs more bound in latently infected primary microglia would show higher activity in Inf+EFZ iMg. However, such a pattern is not immediately visible in the heatmap below.</p>
<p>The TFs more bound in latently infected cells do not seem to correlate with any condition, but rather vary a lot more across all cells than the TFs more bound in uninfected cells which show some correlation with the condition and less across all cells.</p>
<pre class="r"><code>ht_tfs1 &lt;- Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
        #col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        column_title = &quot;split according to TF binding score for latent vs. uninfected&quot;,
        show_column_names = FALSE,
        row_names_side = &quot;left&quot;,
        #column_km = 4,
        row_split = atac_tfs_df$condition,
        col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                           name = &quot;condition&quot;, 
                                           col = list(condition = 
                                                        c(&quot;Uninf&quot; = &quot;orange&quot;,
                                                          &quot;Inf+EFZ&quot; = &quot;green&quot;,
                                                          &quot;Inf&quot; = &quot;red&quot;,
                                                          &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
        #column_split = tri_mg$orig.ident
        left_annotation = rowAnnotation(TF_footprinting = 
                                          (atac_tfs_df %&gt;% 
                                            select(name, condition) %&gt;%
                                            column_to_rownames(&quot;name&quot;))[[&quot;condition&quot;]],
                      name = &quot;TF_footprinting&quot;,
                      col = list(TF_footprinting = c(&quot;up_latent&quot; = &quot;pink&quot;, 
                                                     &quot;up_uninf&quot; = &quot;darkgreen&quot;)))
        )


#ht_list &lt;- ht_conditions + ht_tfs
#draw(ht_list)</code></pre>
<pre class="r"><code>ht_tfs2 &lt;- Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
        #col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        column_title = &quot;split according to TF binding score for latent vs. uninfected&quot;,
        show_column_names = FALSE,
        row_names_side = &quot;left&quot;,
        #column_km = 4,
        row_split = atac_tfs_df$condition,
        column_split = tri_mg@meta.data$orig.ident,
        col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                           name = &quot;condition&quot;, col =
                                             list(condition =
                                                    c(&quot;Uninf&quot; = &quot;orange&quot;,
                                                      &quot;Inf+EFZ&quot; = &quot;green&quot;, 
                                                      &quot;Inf&quot; = &quot;red&quot;, 
                                                      &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
        #column_split = tri_mg$orig.ident
        left_annotation = rowAnnotation(TF_footprinting = 
                                          (atac_tfs_df %&gt;% 
                                            select(name, condition) %&gt;%
                                            column_to_rownames(&quot;name&quot;))[[&quot;condition&quot;]],
                      name = &quot;TF_footprinting&quot;,
                      col = list(TF_footprinting = c(&quot;up_latent&quot; = &quot;pink&quot;, 
                                                     &quot;up_uninf&quot; = &quot;darkgreen&quot;)))
        )</code></pre>
<pre class="r"><code>ht_list &lt;- ht_tfs1 + ht_tfs2
draw(ht_list, ht_gap = unit(2, &quot;cm&quot;))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-15-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-15-1">
Past versions of unnamed-chunk-15-1.png
</button>
</p>
<div id="fig-unnamed-chunk-15-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-15-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-15-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-15-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
</div>
</div>
<div id="statistical-tests-to-find-tf-activity-differences-between-clusters" class="section level2">
<h2>Statistical Tests to find TF activity differences between clusters</h2>
<p>To quantitatively investigate whether we can find TFs which have significantly different activity between clusters we can use Kruskal-Wallis test and pairwise wilcox test as a posthoc analysis.</p>
<p>206 TFs have different acivity between the clusters.</p>
<pre class="r"><code>p_values &lt;- map(seq.int(1:length(colnames(auc_mtx))), function(n){
  tf &lt;- colnames(auc_mtx)[n]
  #print(tf)
  #print(triculture@meta.data[tf])
  p_values &lt;- unlist(kruskal.test(pull(tri_mg@meta.data[tf]) ~ orig.ident,
                                  tri_mg@meta.data))[&quot;p.value&quot;]
  #print(p_values)
  #list(tf = tf, p_value = p_values)
})

# adjust for multiple hypothesis testing
adj_p_values &lt;- p.adjust(as.numeric(unname(unlist(p_values))), method = &quot;fdr&quot;)


# how many transcription factors are significantly different between the clusters?
#length(adj_p_values[adj_p_values&lt;0.01])</code></pre>
</div>
<div id="posthoc-analysis" class="section level2 tabset">
<h2 class="tabset">Posthoc analysis</h2>
<div id="more-bound-in-latent-infection" class="section level3">
<h3>more bound in latent infection</h3>
<p><strong>Boxplots of TFs activity across conditions of TFs more bound in latent infection</strong></p>
<p>Among the TFs more bound in latently infected cells there is a difference in activity for REST and ZEB1, but only between treatment conditions and not between infection conditions. For the other three TFs there are no differences or patterns.</p>
<pre class="r"><code>
boxplot_list &lt;- map(up_latent, function(tf) {
  ggplot() +
    geom_boxplot(aes(x = tri_mg@meta.data %&gt;% pull(&quot;orig.ident&quot;),
                     y = tri_mg@meta.data %&gt;% pull(tf), 
                 fill = tri_mg@meta.data %&gt;% pull(&quot;orig.ident&quot;))) +
    stat_pvalue_manual(tri_mg@meta.data %&gt;% 
                         pairwise_wilcox_test(as.formula(paste0(tf, &quot; ~ orig.ident&quot;))) %&gt;% 
                         add_xy_position()) +
    xlab(&quot;Condition&quot;) +
    ylab(paste0(tf)) +
    guides(fill = guide_legend(title = &quot;condition&quot;))
})

do.call(gridExtra::grid.arrange, c(boxplot_list, ncol = 3, nrow = 2))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-17-1">
Past versions of unnamed-chunk-17-1.png
</button>
</p>
<div id="fig-unnamed-chunk-17-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="more-bound-in-uninfected" class="section level3">
<h3>more bound in uninfected</h3>
<p><strong>Boxplots of TFs activity across conditions of TFs more bound in uninfected primary microglia</strong></p>
<p>In the plots below the trend of TF activity being negatively correlated between treated and untreated cells, independent of the infection status can be seen for some TFs, for example CEBPB and MEF2C. For other TFs there is no difference between either infection status or treatment, for example CREB1 and ETS1.</p>
<p>Yet, even though the effect of treatment is most prominent, some TFs are additionally following the pattern of the footprinting. For example, MEF2C is more bound in the uninfected iMg than in infected iMg.</p>
<p>One assumption is that TFs which are markers of microglia cells might be more or less active depending on whether the cells were treated with EFZ or not. An argument against this assumption is that both CEBPB and MEF2C are typically expressed in microglia, yet we observe an opposite trend. CEBPB is more active in Inf and Uninf cells than in Inf+EFZ and Uninf+EFZ cells, while MEF2C is more active in Inf+EFZ and Uninf+EFZ cells than in Inf and Uninf cells.</p>
<pre class="r"><code>

boxplot_list &lt;- map(up_uninf, function(tf) {
  ggplot() +
    geom_boxplot(aes(x = tri_mg@meta.data %&gt;% pull(&quot;orig.ident&quot;),
                     y = tri_mg@meta.data %&gt;% pull(tf), 
                 fill = tri_mg@meta.data %&gt;% pull(&quot;orig.ident&quot;))) +
    stat_pvalue_manual(tri_mg@meta.data %&gt;% 
                         pairwise_wilcox_test(as.formula(paste0(tf, &quot; ~ orig.ident&quot;))) %&gt;% 
                         add_xy_position()) +
    xlab(&quot;Condition&quot;) +
    ylab(paste0(tf)) +
    guides(fill = guide_legend(title = &quot;condition&quot;))
})

do.call(gridExtra::grid.arrange, c(boxplot_list, ncol = 5, nrow = 4))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" width="1920" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-18-1">
Past versions of unnamed-chunk-18-1.png
</button>
</p>
<div id="fig-unnamed-chunk-18-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>
#annotate_figure(figure,
 #               top = text_grob(&quot;TFs activity across conditions for TFs more bound in uninfected primary microglia&quot;, size = 20))</code></pre>
<hr />
</div>
</div>
<div id="correlations-between-conditions" class="section level2 tabset">
<h2 class="tabset">Correlations between conditions</h2>
<p><strong>Interpretation here</strong></p>
<div id="correlation-matrix" class="section level3">
<h3>Correlation matrix</h3>
<pre class="r"><code>cor_mtx &lt;- tri_mg@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;%
  select(c(&quot;cell&quot;, &quot;orig.ident&quot;, colnames(auc_mtx))) %&gt;%
  group_by(orig.ident) %&gt;%
  summarize_if(is.numeric, mean) %&gt;% 
  gather(TF, value, -orig.ident) %&gt;% 
  spread(orig.ident, value) %&gt;% 
  column_to_rownames(&quot;TF&quot;) %&gt;% cor()

testCor &lt;- cor.mtest(cor_mtx, conf.level = 0.95)

# plot correlations
# p.mat = matrix of p_values


corrplot(cor_mtx,
         #method = &quot;color&quot;, 
         order = &quot;hclust&quot;, 
         addrect = 4, # add boxes 
         p.mat = testCor$p, 
         #sig.level = .05,
         insig = &quot;p-value&quot;, 
         tl.col = &quot;black&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-19-1">
Past versions of unnamed-chunk-19-1.png
</button>
</p>
<div id="fig-unnamed-chunk-19-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="scatter-matrix" class="section level3">
<h3>Scatter matrix</h3>
<pre class="r"><code>tri_mg@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;%
  select(c(&quot;cell&quot;, &quot;orig.ident&quot;, colnames(auc_mtx))) %&gt;%
  group_by(orig.ident) %&gt;%
  summarize_if(is.numeric, mean) %&gt;% 
  gather(TF, value, -orig.ident) %&gt;% 
  spread(orig.ident, value) %&gt;% 
  column_to_rownames(&quot;TF&quot;) %&gt;% GGally::ggpairs() +
    labs(title = &quot;Scatter matrix for different conditions&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-20-1">
Past versions of unnamed-chunk-20-1.png
</button>
</p>
<div id="fig-unnamed-chunk-20-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
</div>
<div id="correlation-between-tfs-differentiating-myeloid2-clusters" class="section level2 tabset">
<h2 class="tabset">Correlation between TFs differentiating Myeloid2 clusters</h2>
<p>These TFs were differntially active between the three hierarchical clusters in Myeloid2 cells from HIV-infected patients. Across three different patients they showed correlated changes in activity. YY1, ETS1 and REST were positively correlated with each other and negatively correlated with MEF2A, ETV6, JUNB, MEF2C, MXI1 and CEBPB. The pattern observed for the iMg from the triculture dataset does not resemble the pattern observed in Myeloid2 cells.</p>
<div id="correlation-matrix-1" class="section level3">
<h3>Correlation Matrix</h3>
<pre class="r"><code>intersect_csf &lt;- read.table(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/atac_intersect_TFs_different_across_patients_3_clusters&quot;)


cor_mtx &lt;- tri_mg@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;% 
  select(c(&quot;cell&quot;, &quot;orig.ident&quot;, intersect_csf$x[intersect_csf$x %in% colnames(auc_mtx)])) %&gt;% # only TFs with differential binding scores from ATACseq
  group_by(orig.ident) %&gt;%
  summarize_if(is.numeric, mean) %&gt;% 
  column_to_rownames(&quot;orig.ident&quot;) %&gt;% cor()

testCor &lt;- cor.mtest(cor_mtx, conf.level = 0.95)

corrplot(cor_mtx,
         #method = &quot;color&quot;,
         order = &quot;hclust&quot;, 
         addrect = 4, # add boxes 
         p.mat = testCor$p,
         insig = &quot;p-value&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-21-1">
Past versions of unnamed-chunk-21-1.png
</button>
</p>
<div id="fig-unnamed-chunk-21-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="scatter-matrix-1" class="section level3">
<h3>Scatter Matrix</h3>
<pre class="r"><code>tri_mg@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;% 
  select(c(&quot;cell&quot;, &quot;orig.ident&quot;, intersect_csf$x[intersect_csf$x %in% colnames(auc_mtx)])) %&gt;% # only TFs with differential binding scores from ATACseq
  group_by(orig.ident) %&gt;%
  summarize_if(is.numeric, mean) %&gt;% 
  column_to_rownames(&quot;orig.ident&quot;) %&gt;%
  GGally::ggpairs() +
  labs(title = &quot;Scatter Matrix for different TFs&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-22-1">
Past versions of unnamed-chunk-22-1.png
</button>
</p>
<div id="fig-unnamed-chunk-22-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()
R version 4.0.2 (2020-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.3.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] parallel  grid      stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] readxl_1.3.1         multtest_2.46.0      Biobase_2.50.0      
 [4] BiocGenerics_0.36.1  metap_1.6            knitr_1.30          
 [7] rstatix_0.6.0        corrplot_0.92        gridExtra_2.3       
[10] ggpubr_0.4.0         circlize_0.4.13      ComplexHeatmap_2.9.4
[13] ggcorrplot_0.1.3     pheatmap_1.0.12      RColorBrewer_1.1-2  
[16] ggrepel_0.9.1        data.table_1.14.2    Matrix_1.3-4        
[19] edgeR_3.32.0         limma_3.46.0         SeuratObject_4.0.3  
[22] Seurat_4.0.5         forcats_0.5.0        stringr_1.4.0       
[25] dplyr_1.0.7          purrr_0.3.4          readr_1.4.0         
[28] tidyr_1.1.2          tibble_3.1.6         ggplot2_3.3.5       
[31] tidyverse_1.3.0      workflowr_1.6.2     

loaded via a namespace (and not attached):
  [1] utf8_1.2.2            reticulate_1.22       tidyselect_1.1.1     
  [4] htmlwidgets_1.5.4     Rtsne_0.15            munsell_0.5.0        
  [7] mutoss_0.1-12         codetools_0.2-18      ica_1.0-2            
 [10] future_1.23.0         miniUI_0.1.1.1        withr_2.4.3          
 [13] colorspace_2.0-2      highr_0.8             rstudioapi_0.13      
 [16] stats4_4.0.2          ROCR_1.0-11           ggsignif_0.6.0       
 [19] tensor_1.5            listenv_0.8.0         labeling_0.4.2       
 [22] Rdpack_2.1.2          git2r_0.27.1          mnormt_2.0.2         
 [25] polyclip_1.10-0       farver_2.1.0          rprojroot_2.0.2      
 [28] TH.data_1.0-10        parallelly_1.29.0     vctrs_0.3.8          
 [31] generics_0.1.1        xfun_0.29             R6_2.5.1             
 [34] doParallel_1.0.16     clue_0.3-60           locfit_1.5-9.4       
 [37] reshape_0.8.8         spatstat.utils_2.2-0  assertthat_0.2.1     
 [40] promises_1.2.0.1      scales_1.1.1          multcomp_1.4-15      
 [43] gtable_0.3.0          globals_0.14.0        goftest_1.2-3        
 [46] sandwich_3.0-0        rlang_0.4.12          GlobalOptions_0.1.2  
 [49] splines_4.0.2         lazyeval_0.2.2        spatstat.geom_2.3-0  
 [52] broom_0.7.2           yaml_2.2.1            reshape2_1.4.4       
 [55] abind_1.4-5           modelr_0.1.8          backports_1.2.0      
 [58] httpuv_1.6.3          tools_4.0.2           ellipsis_0.3.2       
 [61] spatstat.core_2.3-1   ggridges_0.5.2        TFisher_0.2.0        
 [64] Rcpp_1.0.7            plyr_1.8.6            rpart_4.1-15         
 [67] deldir_1.0-6          pbapply_1.5-0         GetoptLong_1.0.5     
 [70] cowplot_1.1.1         S4Vectors_0.28.1      zoo_1.8-9            
 [73] haven_2.3.1           cluster_2.1.0         fs_1.5.1             
 [76] magrittr_2.0.1        magick_2.5.2          scattermore_0.7      
 [79] openxlsx_4.2.3        lmtest_0.9-39         reprex_0.3.0         
 [82] RANN_2.6.1            tmvnsim_1.0-2         mvtnorm_1.1-1        
 [85] whisker_0.4           fitdistrplus_1.1-6    matrixStats_0.61.0   
 [88] hms_1.1.1             patchwork_1.1.1       mime_0.12            
 [91] evaluate_0.14         xtable_1.8-4          rio_0.5.16           
 [94] IRanges_2.24.1        shape_1.4.6           compiler_4.0.2       
 [97] KernSmooth_2.23-18    crayon_1.4.2          htmltools_0.5.2      
[100] mgcv_1.8-33           later_1.3.0           lubridate_1.7.9.2    
[103] DBI_1.1.1             dbplyr_2.0.0          MASS_7.3-53          
[106] car_3.0-10            cli_3.1.0             rbibutils_2.2.4      
[109] igraph_1.2.9          pkgconfig_2.0.3       sn_2.0.1             
[112] numDeriv_2016.8-1.1   foreign_0.8-80        plotly_4.9.2.1       
[115] spatstat.sparse_2.0-0 xml2_1.3.2            foreach_1.5.1        
[118] rvest_0.3.6           digest_0.6.29         sctransform_0.3.2    
[121] RcppAnnoy_0.0.19      spatstat.data_2.1-0   rmarkdown_2.6        
[124] cellranger_1.1.0      leiden_0.3.5          uwot_0.1.10          
[127] curl_4.3.2            shiny_1.7.1           rjson_0.2.20         
[130] lifecycle_1.0.1       nlme_3.1-150          jsonlite_1.7.2       
[133] carData_3.0-4         viridisLite_0.4.0     fansi_0.5.0          
[136] pillar_1.6.4          GGally_2.0.0          lattice_0.20-41      
[139] plotrix_3.8-2         fastmap_1.1.0         httr_1.4.2           
[142] survival_3.2-7        glue_1.6.0            zip_2.1.1            
[145] png_0.1-7             iterators_1.0.13      stringi_1.7.6        
[148] mathjaxr_1.4-0        irlba_2.3.3           future.apply_1.8.1   </code></pre>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiVEYgYWN0aXZpdHkgaW4gaU1nIGZyb20gdHJpY3VsdHVyZSBkYXRhc2V0IgphdXRob3I6ICJLYXRoYXJpbmEgTWlrdWxpayIKb3V0cHV0OiBodG1sX2RvY3VtZW50Ci0tLQoKPHN0eWxlPgpib2R5IHsKdGV4dC1hbGlnbjoganVzdGlmeX0KPC9zdHlsZT4KCmBgYHtyIHNldHVwLCBpbmNsdWRlID0gRkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldChjYWNoZSA9IEZBTFNFLCBhdXRvZGVwID0gVFJVRSwgCiAgICAgICAgICAgICAgICAgICAgICBjb2xsYXBzZSA9IFRSVUUsIG1lc3NhZ2UgPSBGQUxTRSkKCmBgYAoKCmBgYHtyfQpsaWJyYXJ5KHRpZHl2ZXJzZSkKbGlicmFyeShTZXVyYXQpCmxpYnJhcnkoZWRnZVIpCmxpYnJhcnkoTWF0cml4KQpsaWJyYXJ5KGRhdGEudGFibGUpCmxpYnJhcnkoZ2dwbG90MikKbGlicmFyeShkcGx5cikKbGlicmFyeShnZ3JlcGVsKQojbGlicmFyeShoYXJtb255KQpsaWJyYXJ5KFJDb2xvckJyZXdlcikKbGlicmFyeShwaGVhdG1hcCkKbGlicmFyeShnZ2NvcnJwbG90KQpsaWJyYXJ5KENvbXBsZXhIZWF0bWFwKQpsaWJyYXJ5KGNpcmNsaXplKQpsaWJyYXJ5KGdncHVicikKbGlicmFyeShncmlkRXh0cmEpCmxpYnJhcnkoY29ycnBsb3QpCmxpYnJhcnkocnN0YXRpeCkKbGlicmFyeShrbml0cikKbGlicmFyeShtZXRhcCkKbGlicmFyeShtdWx0dGVzdCkKbGlicmFyeShyZWFkeGwpCmBgYAoKIyMgR2VuZSByZWd1bGF0b3J5IG5ldHdvcmsgaW5mZXJlbmNlIHdpdGggU0NFTklDCgpUbyBpbmZlciBHUk5zIGZyb20gaU1nIGNlbGxzIGZyb20gdGhlIHRyaWN1bHR1cmUgZGF0YXNldCBbQFJ5YW5dICg0MzMzIGNlbGxzIGluIAp0b3RhbCkgSSBhZ2FpbiB1c2VkIFNDRU5JQy4KCldoZW4gcmVmZXJyaW5nIHRvIGRpZmZlcmVudGlhbGx5IGJvdW5kIFRGcyBpbiB0aGUgQzIwIGNlbGwgbGluZSBpbiB0aGUgZm9sbG93aW5nCkkgYW0gcmVmZXJyaW5nIHRvIGRpZmZlcmVudGlhbCBiaW5kaW5nIHNjb3JlcyBiZXR3ZWVuIGluZmVjdGlvbiBjb25kaXRpb25zIApvYnRhaW5lZCBmcm9tIGJ1bGsgQVRBQ3NlcSBkYXRhIGZyb20gQzIwIGNlbGwgbGluZSBjdWx0dXJlcyB1c2luZyBUT0JJQVMuCgpJIGZpcnN0IHRyaWVkIHRvIHJ1biBTQ0VOSUMgd2l0aCAzMDAwIG1vc3QgaGlnaGx5IHZhcmlhYmxlIGdlbmVzIChIVkcpLCBidXQgdGhlbgpJIG9ubHkgZ290IGFuIG92ZXJsYXAgd2l0aCBkaWZmZXJlbnRpYWxseSBib3VuZCBURlMgb2YgZWlnaHQuIFdoZW4gdXNpbmcgMTAsMDAwCkhWRyBTQ0VOSUMgcmV0dXJucyAyMzIgVEZTIGFuZCB0aGVpciBjb3JyZXNwb25kaW5nIGFjdGl2aXR5IHNjb3JlIGZvciBlYWNoIGNlbGwuCjI1IG9mIHRoZXNlIFRGcyBvdmVybGFwIHdpdGggZGlmZmVyZW50aWFsbHkgYm91bmQgVEZzIGluIHRoZSBDMjAgY2VsbCBsaW5lLgoKCgoKYGBge3J9CiMgcmVhZCBpbiB0cmljdWx0dXJlIFNldXJhdCBvYmplY3QKdHJpY3VsdHVyZSA8LSByZWFkUkRTKCIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL1RyaWN1bHR1cmVfZGF0YXNldF9SeWFuX3BhcGVyL3RyaWN1bHR1cmVfY2xlYW5fc2V1cmF0X29iamVjdCIpCgojIHJlYWQgaW4gQ1NGIEhJViBTZXVyYXQgb2JqZWN0CmhpdjcgPC0gcmVhZFJEUygiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9SZXByb2R1Y2VfRmFyaGFkaWFuX1BhcGVyL1NldXJhdF9vYmplY3RzL3RvdGFsXzdfc2FtcGxlc19sYWJlbF90cmFuc2Zlci5yZHMiKQoKaW1pY3JvZ2xpYSA8LSBzdWJzZXQodHJpY3VsdHVyZSwgY2VsbF90eXBlID09ICJpTWciKQoKYGBgCgoKPGRldGFpbHM+CjxzdW1tYXJ5PioqcHJlcGFyaW5nIG1hdHJpeCBmb3IgU0NFTklDKio8L3N1bW1hcnk+CgpGaXJzdCwgSSB1c2UgU0NUcmFuc2Zvcm0gZm9yIG5vcm1hbGl6YXRpb24gb2YgdGhlIGV4cHJlc3Npb24gZGF0YSwgdGhlbgp0aGUgdG9wIDEwLDAwMCBIVkdzIGFyZSBzZWxlY3RlZCBhbmQgdGhlIG1hdHJpeCB0cmFuc3Bvc2VkLCBiZWNhdXNlIHRoZSBweVNDRU5JQwpwaXBlbGluZSB1c2VkIHJlcXVpcmVzIGFuIGluIGlucHV0IG1hdHJpeCB3aGljaCBoYXMgZ2VuZXMgYXMgY29sdW1ucyBhbmQgY2VsbHMgCmFzIHJvd3MuCiAoaHR0cHM6Ly9naXRodWIuY29tL2hkc3UtYmlvcXVhbnQvcHlTQ0VOSUNfcGlwZWxpbmUvYmxvYi9tYXN0ZXIvaW5wdXQvZ2VuZV9leHBfbXR4X2V4YW1wbGUudHN2KQoKYGBgCiMgdXNlIDEwIDAwMCBtb3N0IGhpZ2hseSB2YXJpYWJsZSBnZW5lcwpzY2VuaWMgPC0gU0NUcmFuc2Zvcm0oaW1pY3JvZ2xpYSwgdmFyaWFibGUuZmVhdHVyZXMubiA9IDEwMDAwLCB2ZXJib3NlPUZBTFNFKQpzYXZlUkRTKHNjZW5pYywgIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvVHJpY3VsdHVyZV9kYXRhc2V0X1J5YW5fcGFwZXIvdHJpY3VsdHVyZV9zY2VuaWMiKQpzY2VuaWMgPC0gcmVhZFJEUygiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9UcmljdWx0dXJlX2RhdGFzZXRfUnlhbl9wYXBlci90cmljdWx0dXJlX3NjZW5pYyIpCnNjZW5pY19odmcgPC0gc3Vic2V0KHNjZW5pYywgZmVhdHVyZXMgPSBzY2VuaWNAYXNzYXlzJFNDVEB2YXIuZmVhdHVyZXMpCnNjZW5pY19tdHggPC0gdChzY2VuaWNfaHZnQGFzc2F5cyRTQ1RAc2NhbGUuZGF0YSkKd3JpdGUudGFibGUoeCA9IHNjZW5pY19tdHgsIGZpbGUgPSAiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9weVNDRU5JQ19waXBlbGluZS9pbnB1dC90cmljdWx0dXJlX210eC50c3YiLCBzZXAgPSAiXHQiKQoKI3NjZW5pY19tYXRyaXggPC0gcmVhZC50YWJsZShmaWxlID0gIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvcHlTQ0VOSUNfcGlwZWxpbmUvaW5wdXQvdHJpY3VsdHVyZV9tdHgudHN2Iiwgc2VwID0gIlx0IikKYGBgCi0tLQo8L2RldGFpbHM+CgoKPGRldGFpbHM+CjxzdW1tYXJ5PioqQXVDZWxsIG1hdHJpeCAtIG91dHB1dCBmcm9tIFNjZW5pYyoqPC9zdW1tYXJ5PgoKVGhlIG91dHB1dCBmcm9tIFNDRU5JQyBpcyBhIG1hdHJpeCBjb250YWluaW5nIGNlbGxzIGFzIHJvd3MgYW5kIDIzMiBURnMKYXMgY29sdW1ucy4gRml2ZSBleGVtcGxhcnkgcm93cyBhbmQgY29sdW1ucyBhcmUgc2hvd24gYmVsb3cuIFRoZSBURiBhY3Rpdml0eSBmb3IgZWFjaCBjZWxsIGNhbiBiZSB1c2VkIHRvIGRyYXcgY29uY2x1c2lvbnMKYWJvdXQgZGlmZmVyZW50IGNlbGwgc3RhdGVzLiAKCgpgYGB7cn0KYXVjX210eCA8LSByZWFkLmNzdigiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9UcmljdWx0dXJlX2RhdGFzZXRfUnlhbl9wYXBlci9weVNDRU5JQ19vdXRwdXQvYXVjZWxsX2ltZ18xMGsuY3N2IikKYXVjX210eCA8LSBhdWNfbXR4ICU+JSBjb2x1bW5fdG9fcm93bmFtZXMoIkNlbGwiKQphdWNfbXR4IDwtIGF1Y19tdHggJT4lIHNldG5hbWVzKCBvbGQgPSBjb2xuYW1lcyhhdWNfbXR4KSwgbmV3ID0gc2FwcGx5KHN0cnNwbGl0KAogIGNvbG5hbWVzKGF1Y19tdHgpLCAiWy4uLl0iKSwgYFtgLCAxKSkKCmF1Y19tdHhbMTo1LCAxOjVdICU+JSBrYWJsZShjYXB0aW9uID0gIkxheW91dCBvZiBURiBhY3Rpdml0eSBtYXRyaXgiKQpgYGAKCi0tLQo8L2RldGFpbHM+Cgo8ZGV0YWlscz4KPHN1bW1hcnk+KipOdW1iZXIgb2YgaU1nIGluIGVhY2ggY29uZGl0aW9uKio8L3N1bW1hcnk+CgoKYGBge3J9CiMgYWRkIGF1YyBtYXRyaXggdG8gbWV0YWRhdGEgb2YgaGl2NCBzZXVyYXQgb2JqZWN0CnRyaV9tZyA8LSBBZGRNZXRhRGF0YShpbWljcm9nbGlhLCAKICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YSA9IGF1Y19tdHgsIAogICAgICAgICAgICAgICAgICAgIGNvbC5uYW1lID0gY29sbmFtZXMoYXVjX210eCkpCgpgYGAKCgpgYGB7ciwgcmVzdWx0cyA9ICJhc2lzIn0KdHJpX21nQG1ldGEuZGF0YSAlPiUgCiAgcmVuYW1lKGNvbmRpdGlvbiAgPSBvcmlnLmlkZW50KSAlPiUKICBncm91cF9ieShjb25kaXRpb24pICU+JQogIHN1bW1hcml6ZShuID0gbigpKSAlPiUgCiAga2FibGUoY2FwdGlvbiA9ICJOdW1iZXIgb2YgY2VsbHMgaW4gZWFjaCBjb25kaXRpb24iKQpgYGAKCi0tLQo8L2RldGFpbHM+CgoKIyBCdWxrIEFUQUNzZXEgZm9vdHByaW50aW5nLCBDMjAgY2VsbCBsaW5lCgpUaGUgQzIwIGNlbGwgbGluZSB3YXMgZGVyaXZlZCBmcm9tIAphbiBISVYrIHBhdGllbnQgIHRyZWF0ZWQgd2l0aCBBUlQgKEFudGlyZXRyb3ZpcmFsIFRoZXJhcHkpLiBTaW5jZSB0aGUgYWNjZXNzIApvZiBBUlQgdG8gdGhlIGJyYWluIGlzIGxpbWl0ZWQgZHVlIHRvIHRoZSBibG9vZC1icmFpbiBiYXJyaWVyLCB0aGUgZWZmZWN0cyBvZiAKQVJUIG9uIHRoZXNlIGNlbGxzIGFyZSBwcm9iYWJseSBuZWdsaWdpYmxlLiBPbmx5IHRoZSA3NSBURnMgd2l0aCBwLXZhbHVlcyBmb3IgZGlmZmVyZW50aWFsIGJpbmRpbmcgc2NvcmVzIGJlbG93IDFlLTUwIHdlcmUgdXNlZC4gV2Ugd2lsbCBmb2N1cyBvbiBURnMgd2hpY2ggc2hvdyBkaWZmZXJlbnRpYWwgYmluZGluZyBzY29yZXMgYmV0d2VlbiBsYXRlbnQKaW5mZWN0aW9uIGFuZCB1bmluZmVjdGVkIGNvbmRpdGlvbnMgaW4gcHJpbWFyeSBtaWNyb2dsaWEuCkZvciAyNSBvZiB0aGVzZSA3NSBURnMgdGhlcmUgaXMgYSBURiBhY3Rpdml0eSBzY29yZSBmb3IgdGhlIGlNZy4gRm9jdXNpbmcgb24gdGhlc2UgMjUgVEZzIHdlIG1pZ2h0IGJlIGFibGUgdG8gZmluZCBhY3Rpdml0eSBwYXR0ZXJucyB0aGF0IApjb3JyZWxhdGUgd2l0aCB0aGUgVEYgYmluZGluZyBzY29yZXMuIEZpdmUgVEZzIGFyZSBtb3JlIGJvdW5kIGluIGxhdGVudCBpbmZlY3Rpb24KYW5kIHR3ZW50eSBURnMgYXJlIG1vcmUgYm91bmQgaW4gdW5pbmZlY3RlZCBjZWxscwoKVGhlIHJlYXNvbiB3aHkgd2UgZmluZCBtb3JlIG9mIHRoZSBURnMgbW9yZSBib3VuZCBpbiB1bmluZmVjdGVkIGNlbGxzIAppbiB0aGUgVEYgYWN0aXZpdHkgc2NvcmUgbWF0cml4IGZyb20gU0NFTklDIGlzIHVuY2xlYXIuCgpgYGB7cn0KdGZzX2FuYSA8LSByZWFkLnRhYmxlKCIvbWVkaWEvYWctY2hlcnJtYW5uL3Byb2plY3RzLzA2X0hJVl9NaWNyb2dsaWEvZGF0YS9hdGFjc2VxL2RhdGEtMjAyMC0xMS0wNi90b2JpYXMvVE9CSUFTX3NuYWtlbWFrZS9mb290cHJpbnRfbWdsaWEyX0dsYXNzVEZfMTctMDMvVEZCUy9iaW5kZXRlY3RfcmVzdWx0cy50eHQiLCBzZXAgPSAiXHQiLCBoZWFkZXIgPSBUUlVFKQoKdG9wX3RmcyA8LSB0ZnNfYW5hICU+JSBmaWx0ZXIodW5pbmZfcmVkX3B2YWx1ZSA8IDFlLTUwKQoKIyBrZWVwIG9ubHkgdGhlIFRGcyBpbiB0aGUgZGF0YWZyYW1lIHdoaWNoIG92ZXJsYXAgYmV0d2VlbiB0aGUgdHdvIGRhdGFzZXRzLgpvdmVybGFwX2F0YWMgPC0gdG9wX3RmcyAlPiUgZmlsdGVyKG5hbWUgJWluJSBjb2xuYW1lcyhhdWNfbXR4KSkKCiMgZGF0YWZyYW1lIGNvbnRhaW5pbmcgb25seSB0aGUgMjUgVGZzIHdoY2loIG92ZXJsYXAgd2l0aCBURiBhY3Rpdml0eSBtYXRyaXggZnJvbSBTQ0VOSUMgCiMgYWRkaW5nIGEgY29sdW1uIHdpdGggaW5mb3JtYXRpb24gaW4gd2hpY2ggaW5mZWN0aW9uIGNvbmRpdGlvbiB0aGUgVEYgaXMgbW9yZSBib3VuZAphdGFjX3Rmc19kZiA8LSB0b3BfdGZzICU+JSBmaWx0ZXIobmFtZSAlaW4lIGNvbG5hbWVzKGF1Y19tdHgpKSAlPiUgCiAgbXV0YXRlKGNvbmRpdGlvbiA9IGlmZWxzZSh1bmluZl9yZWRfY2hhbmdlID4gMCwgInVwX3VuaW5mIiwgInVwX2xhdGVudCIpKQoKIyBMaXN0IG9mIDUgVEZzIG1vcmUgYm91bmQgaW4gbGF0ZW50IGluZmVjdGlvbgp1cF9sYXRlbnQgPC0gYXRhY190ZnNfZGYkbmFtZVthdGFjX3Rmc19kZiRjb25kaXRpb24gPT0gInVwX2xhdGVudCJdCiMgbGlzdCBvZiAyNSBURnMgbW9yZSBib3VuZCBpbiB1bmluZmVjdGVkIGNlbGxzCnVwX3VuaW5mIDwtIGF0YWNfdGZzX2RmJG5hbWVbYXRhY190ZnNfZGYkY29uZGl0aW9uID09ICJ1cF91bmluZiJdCmBgYAoKPGRldGFpbHM+CjxzdW1tYXJ5PioqVm9sY2FubyBQbG90IEFUQUMtc2VxIGZvb3RwcmludGluZyoqPC9zdW1tYXJ5PgoKYGBge3IsIGZpZy5oZWlnaHQ9OCwgZmlnLndpZHRoPTEyfQp0b3BfdGZzICU+JSAKICAjIGFkZCBhIGNvbHVtbiBjb250YWluaW5nIGluZm9ybWF0aW9uIGluIHdoaWNoIGNvbmRpdGlvbiB0aGUgY29ycmVzcG9uZGluZyBURiAKICAjIGlzIHVwcmVndWxhdGVkCiAgbXV0YXRlKGNvbmRpdGlvbiA9IGlmZWxzZSh1bmluZl9yZWRfY2hhbmdlIDwgMCwgInVwX2xhdGVudCIsICJ1cF91bmluZiIpKSAlPiUKICAjIGFkZCBhIGNvbHVtbiBjb25haW5pbmcgdGhlIGxhYmVscyBmb3IgdGhlIHBsb3QKICAjIEkgb25seSB3YW50IHRvIGxhYmVsIGNlbGxzIHdoaWNoIGFyZSBhbHNvIGZvdW5kIGJ5IFNjZW5pYwogIG11dGF0ZShsYWJlbCA9IGlmZWxzZShuYW1lICVpbiUgb3ZlcmxhcF9hdGFjJG5hbWUsIG5hbWUsIE5BKSkgJT4lIAogIGdncGxvdChhZXMoeCA9IHVuaW5mX3JlZF9jaGFuZ2UsCiAgICAgICAgICAgICB5ID0gLWxvZzEwKHVuaW5mX3JlZF9wdmFsdWUpLAogICAgICAgICAgICAgY29sID0gY29uZGl0aW9uLCAKICAgICAgICAgICAgIGxhYmVsID0gbGFiZWwpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAtbG9nMTAoMWUtNTApLCBjb2wgPSAicmVkIikgKwogIGdlb21fdGV4dChudWRnZV94ID0gLjA1LCBudWRnZV95ID0gMikgKwogIGxhYnModGl0bGUgPSAiVEZzIHdpdGggZGlmZmVyZW50aWFsIGJpbmRpbmcgc2NvcmVzIikgKwogIHlsYWIoIi1sb2cxMChwX3ZhbHVlKSIpICsKICB4bGFiKCJkaWZmZXJlbnRpYWwgYmluZGluZyBzY29yZSIpCgpgYGAKCi0tLQo8L2RldGFpbHM+CgojIFRGIGFjdGl2aXR5IGluIGlNZyAKCiMjIEhlYXRtYXAgZm9yIGFsbCBURnMKCkluIHRoZSBoZWF0bWFwIG9mIFRGIGFjdGl2aXRpZXMgYmVsb3cgeW91IGNhbiBhbHJlYWR5IHNlZSBhIHRyZW5kIHRvd2FyZHMgYSBzZXBhcmF0aW9uIG9mIApjZWxscyB0cmVhdGVkIHdpdGggRUZaIChibHVlIGFuZCBncmVlbikgZnJvbSB1bnRyZWF0ZWQgY2VsbHMgKHJlZCBhbmQgb3JhbmdlKS4KCjxkZXRhaWxzPgo8c3VtbWFyeT4qKkhlYXRtYXAgb2YgMjMyIFRGcyBhbmQgdGhlaXIgYWN0aXZpdHkgaW4gaU1nKio8L3N1bW1hcnk+CgoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0yNX0KY29uZGl0aW9ucyA8LSB0cmlfbWdAbWV0YS5kYXRhICU+JQogICAgICAgICAgICAgICAgICAgIHJvd25hbWVzX3RvX2NvbHVtbigiY2VsbCIpICU+JQogICAgICAgICAgICAgICAgICAgIHNlbGVjdCgiY2VsbCIsICJvcmlnLmlkZW50IiklPiUgY29sdW1uX3RvX3Jvd25hbWVzKCJjZWxsIikKCgpodCA8LSBIZWF0bWFwKHQoYXVjX210eCksIAogICAgICBjb2wgPSAgY29sb3JSYW1wUGFsZXR0ZShyZXYoYnJld2VyLnBhbChuID0gNywgbmFtZSA9ICJSZFlsQnUiKSkpKDEwMCksCiAgICAgIHNob3dfY29sdW1uX25hbWVzID0gRkFMU0UsCiAgICAgIHJvd19uYW1lc19zaWRlID0gImxlZnQiLAogICAgICB0b3BfYW5ub3RhdGlvbiA9IEhlYXRtYXBBbm5vdGF0aW9uKGNvbmRpdGlvbiA9IGNvbmRpdGlvbnMkb3JpZy5pZGVudCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJjb25kaXRpb24iLCBjb2wgPSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChjb25kaXRpb24gPSBjKCJVbmluZiIgPSAib3JhbmdlIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbmYrRUZaIiA9ICJncmVlbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbmYiID0gInJlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVbmluZitFRloiID0gImJsdWUiKSkpCikKaHQKYGBgCgotLS0KPC9kZXRhaWxzPgoKCiMjIEhlYXRtYXAgb2YgMjUgVEZzIHdpdGggZGlmZmVyZW50aWFsIGJpbmRpbmcgc2NvcmUKCldlIHdpbGwgbm93IGludmVzdGlnYXRlIGlmIHdlIGNhbiBmaW5kIGFjdGl2aXR5IHBhdHRlcm5zIHdoaWNoIHJlc2VtYmxlCnRoZSBkaWZmZXJlbnRpYWwgYmluZGluZyBzY29yZSBwYXR0ZXJucyBmb3VuZCBpbiAyNSBURnMuCgoKIyMjIEhpZXJhcmNoaWNhbCBjbHVzdGVyaW5nIHdpdGggZGlmZmVyZW50IGsgey50YWJzZXR9CgpVc2luZyBoaWVyYXJjaGljYWwgY2x1c3RlcmluZyB3ZSBtaWd0aCBiZSBhYmxlIHRvIGlkZW50aWZ5IGNsdXN0ZXJzIHdpdGggY2VydGFpbgpwYXR0ZXJucyBvZiBURiBhY3Rpdml0eS4gSnVkZ2luZyBmcm9tIHRoZSBkaWZmZXJlbnQgaGVhdG1hcHMsIGsgPSA0IG1pZ2h0IGJlIHRoZQptb3N0IGluZm9ybWF0aXZlLCBzaW5jZSBmb3IgayA9IDUgdGhlcmUgaXMgb25seSBvbmUgVEYgKE5ITEgxKSBkaWZmZXJlbnRpYXRpbmcgCmFuIGFkZGl0aW9uYWwgY2x1c3Rlci4gVGhlIHBsb3Qgb2Ygd2l0aGluLWNsdXN0ZXJzIHN1bSBvZiBzcXVhcmVzIHNob3VsZCBoZWxwIAp0byBwaWNrIHRoZSBiZXN0IG51bWJlciBvZiBjbHVzdGVycywgaG93ZXZlciBhcyBjYW4gYmUgc2VlbiBiZWxvdyB0aGVyZSBpcyBubyAKb2J2aW91cyBraW5rIGluIHRoZSBjdXJ2ZS4KCkhpZXJhcmNoaWNhbCBjbHVzdGVyaW5nIHdpdGggayA9IDIgc2VlbXMgdG8gc3BsaXQgdGhlIGNlbGxzIGludG8gdHJlYXRlZCB2cy4gCnVudHJlYXRlZCBjZWxscy4gVGhlc2UgdHdvIGNsdXN0ZXJzIGhhdmUgYSB2ZXJ5IGV2aWRlbnQgYmlvbG9naWNhbCBtZWFuaW5nLgpVc2luZyBrID0gMyBvciBrID0gNCBrZWVwcyB0aGVzZSB0d28gYmlvbG9naWNhbGx5IApyZWxldmFudCBncm91cHMgc2VwYXJhdGUsIGJ1dCBhbHNvIGNyZWF0ZXMgYWRkaXRpb25hbCBjbHVzdGVycyB3aGljaCBzZWVtIHRvIGJlCmEgbWl4dHVyZSBvZiB0cmVhdGVkIGFuZCB1bnRyZWF0ZWQgY2VsbHMuIEhhdmluZyBhIGNsb3NlciBsb29rIGF0IGNsdXN0ZXJzIGZyb20KayA9IDQgbWlnaHQgZ2l2ZSBzb20gYWRkaXRpb25hbCBiaW9sb2dpY2FsIGluc2lnaHRzLgoKSGF2aW5nIGEgY2xvc2VyIGxvb2sgYXQgdGhlIGZvdXIgY2x1c3RlcnMsIGl0IGJlY29tZXMgZXZpZGVudCB0aGF0IHRoZSB0d28gbGVmdAptb3N0IGNsdXN0ZXJzIHNlcGFyYXRlIHRyZWF0ZWQgY2VsbHMgZnJvbSB1bnRyZWF0ZWQgY2VsbHMsIGluZGVwZW5kZW50IG9mIHRoZSAKaW5mZWN0aW9uIGNvbmRpdGlvbi4gVGhlcmUgYXJlIG1vcmUgSW5mK0VGWiB0aGFuIFVuaW5mK0VGWiBpbiB0aGUgZmlyc3QgY2x1c3RlciwKaG93ZXZlciB0aGlzIGlzIGluIGxpbmUgd2l0aCB0aGUgbG93ZXIgY2VsbCBudW1iZXIgb2YgVW5pbmYrRUZaICg3MjIgY2VsbHMpIApjb21wYXJlZCB0byBJbmYrRUZaICgxMzgyIGNlbGxzKS4KClR3byBURnMgc2VlbSB0byBiZSBtb3JlIGFjdGl2ZSBpbiBJbmYrRUZaIGFuZCBVbmluZitFRlogKGNvbXBhcmVkIHRvIEluZiBhbmQgVW5pbmYpOgoKKiBSVU5YMwoqIEpVTkIKClRocmVlIFRGcyBzZWVtIHRvIGJlIG1vcmUgYWN0aXZlIGluIEluZiBhbmQgVW5pbmYgKGNvbXBhcmVkIHRvIEluZitFRlogYW5kIFVuaW5mK0VGWik6CgoqIE5GQVQ1CiogVENGN0wyCiogQ0VCUEIKClRDRjQgZGlzdGluZ3Vpc2hlcyBhIHRoaXJkIGNsdXN0ZXIuIAoKSXMgdGhlcmUgYSBiaW9sb2dpY2FsIG1lYW5pbmcgYmVoaW5kIHRoYXQ/IE1heWJlIHdlIGNhbiBhc3NvY2lhdGUgdGhlbSB3aXRoIAphIHBhcnRpY3VsYXIgY29uZGl0aW9uPwoKIyMjIyB3c3MgcGxvdAoKYGBge3J9CmRmIDwtIGhpdjdAbWV0YS5kYXRhICU+JSBmaWx0ZXIoY2VsbF90eXBlID09ICJNeWVsb2lkMiIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnLmlkZW50ID09ICJISVYxX0NTRiIpCm10eCA8LSBhdWNfbXR4WywgYXRhY190ZnNfZGYkbmFtZV0KCiMgRGVjaWRlIG9uIGEgayBmb3IgY2x1c3RlcmluZwp3c3MgPSBzYXBwbHkoMjoxNSwgZnVuY3Rpb24oaykgewogIGttZWFucyh4ID0gdChtdHgpLCBjZW50ZXJzID0gaykkdG90LndpdGhpbnNzCn0pCgpwbG90KDI6MTUsIHdzcywgdHlwZSA9ICJiIiwgCiAgICAgeGxhYiA9ICJOdW1iZXIgb2YgY2x1c3RlcnMgayIsIAogICAgIHlsYWIgPSAiVG90YWwgd2l0aGluLWNsdXN0ZXJzIHN1bSBvZiBzcXVhcmUiKQpgYGAKCiMjIyMgZGlmZmVyZW50IGsKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9MTB9CgpodF9saXN0IDwtIG1hcChzZXEuaW50KDIsNiksIGZ1bmN0aW9uKG4pewogIGh0IDwtIEhlYXRtYXAodChhdWNfbXR4WywgYXRhY190ZnNfZGYkbmFtZV0pLCAKICAgICAgICBjb2wgPSAgY29sb3JSYW1wUGFsZXR0ZShyZXYoYnJld2VyLnBhbChuID0gNywgbmFtZSA9ICJSZFlsQnUiKSkpKDEwMCksCiAgICAgICAgY29sdW1uX3RpdGxlID0gcGFzdGUwKCJrID0gIiwgbiksCiAgICAgICAgc2hvd19jb2x1bW5fbmFtZXMgPSBGQUxTRSwKICAgICAgICByb3dfbmFtZXNfc2lkZSA9ICJsZWZ0IiwKICAgICAgICB0b3BfYW5ub3RhdGlvbiA9IEhlYXRtYXBBbm5vdGF0aW9uKGNvbmRpdGlvbiA9IGNvbmRpdGlvbnMkb3JpZy5pZGVudCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gImNvbmRpdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wgPSBsaXN0KGNvbmRpdGlvbiA9IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMoIlVuaW5mIiA9ICJvcmFuZ2UiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbmYrRUZaIiA9ICJncmVlbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW5mIiA9ICJyZWQiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVbmluZitFRloiID0gImJsdWUiKSkpLAogICAgICAgIGNvbHVtbl9rbSA9IG4sCiAgICAgICAgICkKICAKfSkKCmh0X2xpc3QgPC0gaHRfbGlzdFtbMV1dICsgaHRfbGlzdFtbMl1dICsgaHRfbGlzdFtbM11dICsgaHRfbGlzdFtbNF1dICsgaHRfbGlzdFtbNV1dCmRyYXcoaHRfbGlzdCwgY29sdW1uX3RpdGxlID0gIkhpZXJhcmNoaWNhbCBjbHVzdGVyaW5nIHdpdGggZGlmZmVyZW50IGsiLCBodF9nYXAgPSB1bml0KDIsICJjbSIpKQpgYGAKCgojIyMjIGsgPSA0CgpgYGB7ciwgZmlnLndpZHRoID0gMTUsIGZpZy5oZWlnaHQ9MTB9Cmh0IDwtIGRyYXcoSGVhdG1hcCh0KGF1Y19tdHhbLCBhdGFjX3Rmc19kZiRuYW1lXSksIAogICAgICBjb2wgPSAgY29sb3JSYW1wUGFsZXR0ZShyZXYoYnJld2VyLnBhbChuID0gNywgbmFtZSA9ICJSZFlsQnUiKSkpKDEwMCksCiAgICAgIGNvbHVtbl90aXRsZSA9ICJoaWVyYXJjaGljYWwgY2x1c3RlcmluZyB3aXRoIGsgPSA0IiwKICAgICAgc2hvd19jb2x1bW5fbmFtZXMgPSBGQUxTRSwKICAgICAgcm93X25hbWVzX3NpZGUgPSAibGVmdCIsCiAgICAgIHRvcF9hbm5vdGF0aW9uID0gSGVhdG1hcEFubm90YXRpb24oY29uZGl0aW9uID0gY29uZGl0aW9ucyRvcmlnLmlkZW50LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gImNvbmRpdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sID0gbGlzdChjb25kaXRpb24gPSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYygiVW5pbmYiID0gIm9yYW5nZSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbmYrRUZaIiA9ICJncmVlbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkluZiIgPSAicmVkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlVuaW5mK0VGWiIgPSAiYmx1ZSIpKSksCiAgICAgIGNvbHVtbl9rbSA9IDQsCiAgICAgICApKQpgYGAKCiMjIyMgey19CgotLS0KCiMjIyBTcGxpdCBoZWF0bWFwcyB0byBmaW5kIHBhdHRlcm5zIHsudGFic2V0fQoKIyMjIyBTZXBhcmF0ZSBIZWF0bWFwcyBhY2NvcmRpbmcgdG8gaW5mZWN0aW9uIGNvbmRpdGlvbgoKU2VwYXJhdGluZyB0aGUgY2VsbHMgYWNjb3JkaW5nIHRvIGRpZmZlcmVudCBjb25kaXRpb25zIGl0IGJlY29tZXMgdmVyeSAKZXZpZGVudCwgdGhhdCB0aGVyZSBpcyBhIGJpZ2dlciBkaWZmZXJlbmNlIGJldHdlZW4gY2VsbHMgdHJlYXRlZCB3aXRoIEVGWiAKdnMuIHVudHJlYXRlZCBjZWxscyB0aGFuIGJldHdlZW4gaW5mZWN0ZWQgdnMgdW5pbmZlY3RlZCBjZWxscy4gVGhlIEluZitFRlogKGdyZWVuKQphbmQgVW5pbmYrRUZaIChibHVlKSBzaG93IHZlcnkgc2ltaWxhciBURiBhY3Rpdml0eSBwYXR0ZXJucyBhbmQgdGhlIEluZiAocmVkKSBhbmQgClVuaW5mIChvcmFuZ2UpIHNob3cgdmVyeSBzaW1pbGFyIFRGIGFjdGl2aXR5IHBhdHRlcm5zLiBUaGVzZSBmaW5kaW5ncwpyZXByZXNlbnQgdGhlIGZpbmRpbmdzIGZyb20gYWJvdmUgCgoKVHdvIFRGcyBzZWVtIHRvIGJlIG1vcmUgYWN0aXZlIGluIEluZitFRlogYW5kIFVuaW5mK0VGWiAoY29tcGFyZWQgdG8gSW5mIGFuZCBVbmluZik6CgoqICoqUlVOWDMqKgoqICoqSlVOQioqCgpUaHJlZSBURnMgc2VlbSB0byBiZSBtb3JlIGFjdGl2ZSBpbiBJbmYgYW5kIFVuaW5mIChjb21wYXJlZCB0byBJbmYrRUZaIGFuZCBVbmluZitFRlopOgoKKiAqKk5GQVQ1OioqIEluIG1pY3JvZ2xpYSBjZWxscyBpbmZsYW1tYXRvcnkgc2lnbmFscyB0cmlnZ2VyIE5GQVQ1IGV4cHJlc3Npb24uIAooWWFuZyBYLkwuIGV0IGFsLiwgRGV2IE5ldXJvc2NpLCAyMDE4KQoqICoqVENGN0wyKioKKiAqKkNFQlBCKiogcmVndWxhdGVzIHByby1pbmZsYW1tYXRvcnkgZ2VuZSBleHByZXNzaW9uLAppbmNyZWFzZWQgZXhwcmVzc2lvbiBpbiBIQU5EIChISVYtYXNzb2NpYXRlZCBuZXVyb2NvZ25pdGl2ZSBkaXNvcmRlciksIApCVVQgbm8gZGF0YSBmcm9tIG1pY3JvZ2xpYSAoQ2FuY2hpIFMuIGV0IGFsLiBKIE5ldXJvaW5mbGFtbWF0aW9uLCAyMDIwKQoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMH0KaHRfY29uZGl0aW9ucyA8LSBIZWF0bWFwKHQoYXVjX210eFssIGF0YWNfdGZzX2RmJG5hbWVdKSwgCiAgICAgICAgI2NvbCA9ICBjb2xvclJhbXBQYWxldHRlKHJldihicmV3ZXIucGFsKG4gPSA3LCBuYW1lID0gIlJkWWxCdSIpKSkoMTAwKSwKICAgICAgICBjb2x1bW5fdGl0bGUgPSAic3BsaXQgYWNjb3JkaW5nIHRvIGluZmVjdGlvbiBjb25kaXRpb24iLAogICAgICAgIHNob3dfY29sdW1uX25hbWVzID0gRkFMU0UsCiAgICAgICAgcm93X25hbWVzX3NpZGUgPSAibGVmdCIsCiAgICAgICAgY29sID0gIGNvbG9yUmFtcFBhbGV0dGUocmV2KGJyZXdlci5wYWwobiA9IDcsIG5hbWUgPSAiUmRZbEJ1IikpKSgxMDApLAogICAgICAgIHRvcF9hbm5vdGF0aW9uID0gSGVhdG1hcEFubm90YXRpb24oY29uZGl0aW9uID0gY29uZGl0aW9ucyRvcmlnLmlkZW50LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSAiY29uZGl0aW9uIiwgY29sID0gbGlzdChjb25kaXRpb24gPSBjKCJVbmluZiIgPSAib3JhbmdlIiwgIkluZitFRloiID0gImdyZWVuIiwgIkluZiIgPSAicmVkIiwgIlVuaW5mK0VGWiIgPSAiYmx1ZSIpKSksCiAgICAgICAgI3Jvd19rbSA9IDIsCiAgICAgICAgI3Jvd19zcGxpdCA9IGF0YWNfdGZzX2RmJGNvbmRpdGlvbiwKICAgICAgICBjb2x1bW5fc3BsaXQgPSB0cmlfbWckb3JpZy5pZGVudCwKICAgICAgICBsZWZ0X2Fubm90YXRpb24gPSByb3dBbm5vdGF0aW9uKFRGX2Zvb3RwcmludGluZyA9IChhdGFjX3Rmc19kZiAlPiUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdChuYW1lLCBjb25kaXRpb24pICU+JQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5fdG9fcm93bmFtZXMoIm5hbWUiKSlbWyJjb25kaXRpb24iXV0sCiAgICAgICAgICAgICAgbmFtZSA9ICJURl9mb290cHJpbnRpbmciLAogICAgICAgICAgICAgIGNvbCA9IGxpc3QoVEZfZm9vdHByaW50aW5nID0gYygidXBfbGF0ZW50IiA9ICJwaW5rIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1cF91bmluZiIgPSAiZGFya2dyZWVuIikpKQogICAgICAgICkKCmh0X2NvbmRpdGlvbnMgCgoKYGBgCgojIyMjIFNwbGl0IEhlYXRtYXBzIGFjY29yZGluZyB0byBURiBiaW5kaW5nIHNjb3JlcyBmcm9tIEFUQUNzZXEgZGF0YQoKU2VwYXJhdGluZyB0aGUgaGVhdG1hcCBhbG9uZyB0aGUgcm93cywgYWNjb3JkaW5nIHRvIFRGcyBlaXRoZXIgbW9yZSBib3VuZCBpbiAKbGF0ZW50bHkgaW5mZWN0ZWQgbWljcm9nbGlhIG9yIG1vcmUgYm91bmQgaW4gdW5pbmZlY3RlZCBwcmltYXJ5IG1pY3JvZ2xpYSwKZG9lcyBub3QgcmVzdWx0IGluIGEgc2VwYXJhdGlvbiBhY2NvcmRpbmcgdG8gdHJlYXRtZW50IHdpdGggRUZaLiAKCldoYXQgb25lIG1pZ2h0IGV4cGVjdCB0byBzZWUsIGlzIHRoYXQgVEZzIG1vcmUgYm91bmQgaW4gdW5pbmZlY3RlZCBwcmltYXJ5IAptaWNyb2dsaWEgd291bGQgYWxzbyBzaG93IGhpZ2hlciBhY3Rpdml0eSBpbiB1bmluZmVjdGVkIGlNZywgd2hpbGUgVEZzIG1vcmUgCmJvdW5kIGluIGxhdGVudGx5IGluZmVjdGVkIHByaW1hcnkgbWljcm9nbGlhIHdvdWxkIHNob3cgaGlnaGVyIGFjdGl2aXR5IGluIApJbmYrRUZaIGlNZy4gSG93ZXZlciwgc3VjaCBhIHBhdHRlcm4gaXMgbm90IGltbWVkaWF0ZWx5IHZpc2libGUgaW4gdGhlIGhlYXRtYXAgCmJlbG93LgoKVGhlIFRGcyBtb3JlIGJvdW5kIGluIGxhdGVudGx5IGluZmVjdGVkIGNlbGxzIGRvIG5vdCBzZWVtIHRvIGNvcnJlbGF0ZSB3aXRoIGFueSBjb25kaXRpb24sIGJ1dCByYXRoZXIgdmFyeSBhIGxvdCBtb3JlIGFjcm9zcyBhbGwgY2VsbHMgdGhhbiB0aGUgVEZzIG1vcmUgYm91bmQgCmluIHVuaW5mZWN0ZWQgY2VsbHMgd2hpY2ggc2hvdyBzb21lIGNvcnJlbGF0aW9uIHdpdGggdGhlIGNvbmRpdGlvbiBhbmQgbGVzcyAKYWNyb3NzIGFsbCBjZWxscy4KCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTEwfQpodF90ZnMxIDwtIEhlYXRtYXAodChhdWNfbXR4WywgYXRhY190ZnNfZGYkbmFtZV0pLCAKICAgICAgICAjY29sID0gIGNvbG9yUmFtcFBhbGV0dGUocmV2KGJyZXdlci5wYWwobiA9IDcsIG5hbWUgPSAiUmRZbEJ1IikpKSgxMDApLAogICAgICAgIGNvbHVtbl90aXRsZSA9ICJzcGxpdCBhY2NvcmRpbmcgdG8gVEYgYmluZGluZyBzY29yZSBmb3IgbGF0ZW50IHZzLiB1bmluZmVjdGVkIiwKICAgICAgICBzaG93X2NvbHVtbl9uYW1lcyA9IEZBTFNFLAogICAgICAgIHJvd19uYW1lc19zaWRlID0gImxlZnQiLAogICAgICAgICNjb2x1bW5fa20gPSA0LAogICAgICAgIHJvd19zcGxpdCA9IGF0YWNfdGZzX2RmJGNvbmRpdGlvbiwKICAgICAgICBjb2wgPSAgY29sb3JSYW1wUGFsZXR0ZShyZXYoYnJld2VyLnBhbChuID0gNywgbmFtZSA9ICJSZFlsQnUiKSkpKDEwMCksCiAgICAgICAgdG9wX2Fubm90YXRpb24gPSBIZWF0bWFwQW5ub3RhdGlvbihjb25kaXRpb24gPSBjb25kaXRpb25zJG9yaWcuaWRlbnQsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJjb25kaXRpb24iLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbCA9IGxpc3QoY29uZGl0aW9uID0gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYygiVW5pbmYiID0gIm9yYW5nZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW5mK0VGWiIgPSAiZ3JlZW4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkluZiIgPSAicmVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVbmluZitFRloiID0gImJsdWUiKSkpLAogICAgICAgICNjb2x1bW5fc3BsaXQgPSB0cmlfbWckb3JpZy5pZGVudAogICAgICAgIGxlZnRfYW5ub3RhdGlvbiA9IHJvd0Fubm90YXRpb24oVEZfZm9vdHByaW50aW5nID0gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhdGFjX3Rmc19kZiAlPiUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0KG5hbWUsIGNvbmRpdGlvbikgJT4lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uX3RvX3Jvd25hbWVzKCJuYW1lIikpW1siY29uZGl0aW9uIl1dLAogICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJURl9mb290cHJpbnRpbmciLAogICAgICAgICAgICAgICAgICAgICAgY29sID0gbGlzdChURl9mb290cHJpbnRpbmcgPSBjKCJ1cF9sYXRlbnQiID0gInBpbmsiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXBfdW5pbmYiID0gImRhcmtncmVlbiIpKSkKICAgICAgICApCgoKI2h0X2xpc3QgPC0gaHRfY29uZGl0aW9ucyArIGh0X3RmcwojZHJhdyhodF9saXN0KQpgYGAKCgpgYGB7cn0KaHRfdGZzMiA8LSBIZWF0bWFwKHQoYXVjX210eFssIGF0YWNfdGZzX2RmJG5hbWVdKSwgCiAgICAgICAgI2NvbCA9ICBjb2xvclJhbXBQYWxldHRlKHJldihicmV3ZXIucGFsKG4gPSA3LCBuYW1lID0gIlJkWWxCdSIpKSkoMTAwKSwKICAgICAgICBjb2x1bW5fdGl0bGUgPSAic3BsaXQgYWNjb3JkaW5nIHRvIFRGIGJpbmRpbmcgc2NvcmUgZm9yIGxhdGVudCB2cy4gdW5pbmZlY3RlZCIsCiAgICAgICAgc2hvd19jb2x1bW5fbmFtZXMgPSBGQUxTRSwKICAgICAgICByb3dfbmFtZXNfc2lkZSA9ICJsZWZ0IiwKICAgICAgICAjY29sdW1uX2ttID0gNCwKICAgICAgICByb3dfc3BsaXQgPSBhdGFjX3Rmc19kZiRjb25kaXRpb24sCiAgICAgICAgY29sdW1uX3NwbGl0ID0gdHJpX21nQG1ldGEuZGF0YSRvcmlnLmlkZW50LAogICAgICAgIGNvbCA9ICBjb2xvclJhbXBQYWxldHRlKHJldihicmV3ZXIucGFsKG4gPSA3LCBuYW1lID0gIlJkWWxCdSIpKSkoMTAwKSwKICAgICAgICB0b3BfYW5ub3RhdGlvbiA9IEhlYXRtYXBBbm5vdGF0aW9uKGNvbmRpdGlvbiA9IGNvbmRpdGlvbnMkb3JpZy5pZGVudCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gImNvbmRpdGlvbiIsIGNvbCA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QoY29uZGl0aW9uID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMoIlVuaW5mIiA9ICJvcmFuZ2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW5mK0VGWiIgPSAiZ3JlZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkluZiIgPSAicmVkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVbmluZitFRloiID0gImJsdWUiKSkpLAogICAgICAgICNjb2x1bW5fc3BsaXQgPSB0cmlfbWckb3JpZy5pZGVudAogICAgICAgIGxlZnRfYW5ub3RhdGlvbiA9IHJvd0Fubm90YXRpb24oVEZfZm9vdHByaW50aW5nID0gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhdGFjX3Rmc19kZiAlPiUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0KG5hbWUsIGNvbmRpdGlvbikgJT4lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uX3RvX3Jvd25hbWVzKCJuYW1lIikpW1siY29uZGl0aW9uIl1dLAogICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJURl9mb290cHJpbnRpbmciLAogICAgICAgICAgICAgICAgICAgICAgY29sID0gbGlzdChURl9mb290cHJpbnRpbmcgPSBjKCJ1cF9sYXRlbnQiID0gInBpbmsiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXBfdW5pbmYiID0gImRhcmtncmVlbiIpKSkKICAgICAgICApCmBgYAoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMH0KaHRfbGlzdCA8LSBodF90ZnMxICsgaHRfdGZzMgpkcmF3KGh0X2xpc3QsIGh0X2dhcCA9IHVuaXQoMiwgImNtIikpCgpgYGAKCi0tLQoKIyMgU3RhdGlzdGljYWwgVGVzdHMgdG8gZmluZCBURiBhY3Rpdml0eSBkaWZmZXJlbmNlcyBiZXR3ZWVuIGNsdXN0ZXJzCgpUbyBxdWFudGl0YXRpdmVseSBpbnZlc3RpZ2F0ZSB3aGV0aGVyIHdlIGNhbiBmaW5kIFRGcyB3aGljaCBoYXZlIHNpZ25pZmljYW50bHkKZGlmZmVyZW50IGFjdGl2aXR5IGJldHdlZW4gY2x1c3RlcnMgd2UgY2FuIHVzZSBLcnVza2FsLVdhbGxpcyB0ZXN0IGFuZCAKcGFpcndpc2Ugd2lsY294IHRlc3QgYXMgYSBwb3N0aG9jIGFuYWx5c2lzLiAKCjIwNiBURnMgaGF2ZSBkaWZmZXJlbnQgYWNpdml0eSBiZXR3ZWVuIHRoZSBjbHVzdGVycy4gCgpgYGB7cn0KcF92YWx1ZXMgPC0gbWFwKHNlcS5pbnQoMTpsZW5ndGgoY29sbmFtZXMoYXVjX210eCkpKSwgZnVuY3Rpb24obil7CiAgdGYgPC0gY29sbmFtZXMoYXVjX210eClbbl0KICAjcHJpbnQodGYpCiAgI3ByaW50KHRyaWN1bHR1cmVAbWV0YS5kYXRhW3RmXSkKICBwX3ZhbHVlcyA8LSB1bmxpc3Qoa3J1c2thbC50ZXN0KHB1bGwodHJpX21nQG1ldGEuZGF0YVt0Zl0pIH4gb3JpZy5pZGVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyaV9tZ0BtZXRhLmRhdGEpKVsicC52YWx1ZSJdCiAgI3ByaW50KHBfdmFsdWVzKQogICNsaXN0KHRmID0gdGYsIHBfdmFsdWUgPSBwX3ZhbHVlcykKfSkKCiMgYWRqdXN0IGZvciBtdWx0aXBsZSBoeXBvdGhlc2lzIHRlc3RpbmcKYWRqX3BfdmFsdWVzIDwtIHAuYWRqdXN0KGFzLm51bWVyaWModW5uYW1lKHVubGlzdChwX3ZhbHVlcykpKSwgbWV0aG9kID0gImZkciIpCgoKIyBob3cgbWFueSB0cmFuc2NyaXB0aW9uIGZhY3RvcnMgYXJlIHNpZ25pZmljYW50bHkgZGlmZmVyZW50IGJldHdlZW4gdGhlIGNsdXN0ZXJzPwojbGVuZ3RoKGFkal9wX3ZhbHVlc1thZGpfcF92YWx1ZXM8MC4wMV0pCgpgYGAKCiMjIFBvc3Rob2MgYW5hbHlzaXMgey50YWJzZXR9CgojIyMgbW9yZSBib3VuZCBpbiBsYXRlbnQgaW5mZWN0aW9uCgoqKkJveHBsb3RzIG9mIFRGcyBhY3Rpdml0eSBhY3Jvc3MgY29uZGl0aW9ucyBvZiBURnMgbW9yZSBib3VuZCBpbiBsYXRlbnQgaW5mZWN0aW9uKioKCkFtb25nIHRoZSBURnMgbW9yZSBib3VuZCBpbiBsYXRlbnRseSBpbmZlY3RlZCBjZWxscyB0aGVyZSBpcyBhIGRpZmZlcmVuY2UgaW4gCmFjdGl2aXR5IGZvciBSRVNUIGFuZCBaRUIxLCBidXQgb25seSBiZXR3ZWVuIHRyZWF0bWVudCBjb25kaXRpb25zIGFuZCBub3QgCmJldHdlZW4gaW5mZWN0aW9uIGNvbmRpdGlvbnMuIEZvciB0aGUgb3RoZXIgdGhyZWUgVEZzIHRoZXJlIGFyZSBubyBkaWZmZXJlbmNlcyAKb3IgcGF0dGVybnMuIAoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD04fQoKYm94cGxvdF9saXN0IDwtIG1hcCh1cF9sYXRlbnQsIGZ1bmN0aW9uKHRmKSB7CiAgZ2dwbG90KCkgKwogICAgZ2VvbV9ib3hwbG90KGFlcyh4ID0gdHJpX21nQG1ldGEuZGF0YSAlPiUgcHVsbCgib3JpZy5pZGVudCIpLAogICAgICAgICAgICAgICAgICAgICB5ID0gdHJpX21nQG1ldGEuZGF0YSAlPiUgcHVsbCh0ZiksIAogICAgICAgICAgICAgICAgIGZpbGwgPSB0cmlfbWdAbWV0YS5kYXRhICU+JSBwdWxsKCJvcmlnLmlkZW50IikpKSArCiAgICBzdGF0X3B2YWx1ZV9tYW51YWwodHJpX21nQG1ldGEuZGF0YSAlPiUgCiAgICAgICAgICAgICAgICAgICAgICAgICBwYWlyd2lzZV93aWxjb3hfdGVzdChhcy5mb3JtdWxhKHBhc3RlMCh0ZiwgIiB+IG9yaWcuaWRlbnQiKSkpICU+JSAKICAgICAgICAgICAgICAgICAgICAgICAgIGFkZF94eV9wb3NpdGlvbigpKSArCiAgICB4bGFiKCJDb25kaXRpb24iKSArCiAgICB5bGFiKHBhc3RlMCh0ZikpICsKICAgIGd1aWRlcyhmaWxsID0gZ3VpZGVfbGVnZW5kKHRpdGxlID0gImNvbmRpdGlvbiIpKQp9KQoKZG8uY2FsbChncmlkRXh0cmE6OmdyaWQuYXJyYW5nZSwgYyhib3hwbG90X2xpc3QsIG5jb2wgPSAzLCBucm93ID0gMikpCmBgYAoKIyMjIG1vcmUgYm91bmQgaW4gdW5pbmZlY3RlZCAKCioqQm94cGxvdHMgb2YgVEZzIGFjdGl2aXR5IGFjcm9zcyBjb25kaXRpb25zIG9mIFRGcyBtb3JlIGJvdW5kIGluIHVuaW5mZWN0ZWQgcHJpbWFyeSBtaWNyb2dsaWEqKgoKSW4gdGhlIHBsb3RzIGJlbG93IHRoZSB0cmVuZCBvZiBURiBhY3Rpdml0eSBiZWluZyBuZWdhdGl2ZWx5IGNvcnJlbGF0ZWQgYmV0d2Vlbgp0cmVhdGVkIGFuZCB1bnRyZWF0ZWQgY2VsbHMsIGluZGVwZW5kZW50IG9mIHRoZSBpbmZlY3Rpb24gc3RhdHVzIGNhbiBiZSBzZWVuIGZvcgpzb21lIFRGcywgZm9yIGV4YW1wbGUgQ0VCUEIgYW5kIE1FRjJDLiBGb3Igb3RoZXIgVEZzIHRoZXJlIGlzIG5vIGRpZmZlcmVuY2UgCmJldHdlZW4gZWl0aGVyIGluZmVjdGlvbiBzdGF0dXMgb3IgdHJlYXRtZW50LCBmb3IgZXhhbXBsZSBDUkVCMSBhbmQgRVRTMS4KCllldCwgZXZlbiB0aG91Z2ggdGhlIGVmZmVjdCBvZiB0cmVhdG1lbnQgaXMgbW9zdCBwcm9taW5lbnQsIHNvbWUgVEZzIGFyZSAKYWRkaXRpb25hbGx5IGZvbGxvd2luZyB0aGUgcGF0dGVybiBvZiB0aGUgZm9vdHByaW50aW5nLiBGb3IgZXhhbXBsZSwgTUVGMkMgaXMKbW9yZSBib3VuZCBpbiB0aGUgdW5pbmZlY3RlZCBpTWcgdGhhbiBpbiBpbmZlY3RlZCBpTWcuCgoKT25lIGFzc3VtcHRpb24gaXMgdGhhdCBURnMgd2hpY2ggYXJlIG1hcmtlcnMgb2YgbWljcm9nbGlhIGNlbGxzIG1pZ2h0IApiZSBtb3JlIG9yIGxlc3MgYWN0aXZlIGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSBjZWxscyB3ZXJlIHRyZWF0ZWQgd2l0aCBFRlogb3IgCm5vdC4gQW4gYXJndW1lbnQgYWdhaW5zdCB0aGlzIGFzc3VtcHRpb24gaXMgdGhhdCBib3RoIENFQlBCIGFuZCBNRUYyQyBhcmUgCnR5cGljYWxseSBleHByZXNzZWQgaW4gbWljcm9nbGlhLCB5ZXQgd2Ugb2JzZXJ2ZSBhbiBvcHBvc2l0ZSB0cmVuZC4gCkNFQlBCIGlzIG1vcmUgYWN0aXZlIGluIEluZiBhbmQgVW5pbmYgY2VsbHMgdGhhbiBpbiBJbmYrRUZaIGFuZCBVbmluZitFRlogY2VsbHMsCndoaWxlIE1FRjJDIGlzIG1vcmUgYWN0aXZlIGluIEluZitFRlogYW5kIFVuaW5mK0VGWiBjZWxscyB0aGFuIGluIEluZiBhbmQgVW5pbmYKY2VsbHMuCgoKYGBge3IsIGZpZy53aWR0aD0yMCwgZmlnLmhlaWdodD0xNX0KCgpib3hwbG90X2xpc3QgPC0gbWFwKHVwX3VuaW5mLCBmdW5jdGlvbih0ZikgewogIGdncGxvdCgpICsKICAgIGdlb21fYm94cGxvdChhZXMoeCA9IHRyaV9tZ0BtZXRhLmRhdGEgJT4lIHB1bGwoIm9yaWcuaWRlbnQiKSwKICAgICAgICAgICAgICAgICAgICAgeSA9IHRyaV9tZ0BtZXRhLmRhdGEgJT4lIHB1bGwodGYpLCAKICAgICAgICAgICAgICAgICBmaWxsID0gdHJpX21nQG1ldGEuZGF0YSAlPiUgcHVsbCgib3JpZy5pZGVudCIpKSkgKwogICAgc3RhdF9wdmFsdWVfbWFudWFsKHRyaV9tZ0BtZXRhLmRhdGEgJT4lIAogICAgICAgICAgICAgICAgICAgICAgICAgcGFpcndpc2Vfd2lsY294X3Rlc3QoYXMuZm9ybXVsYShwYXN0ZTAodGYsICIgfiBvcmlnLmlkZW50IikpKSAlPiUgCiAgICAgICAgICAgICAgICAgICAgICAgICBhZGRfeHlfcG9zaXRpb24oKSkgKwogICAgeGxhYigiQ29uZGl0aW9uIikgKwogICAgeWxhYihwYXN0ZTAodGYpKSArCiAgICBndWlkZXMoZmlsbCA9IGd1aWRlX2xlZ2VuZCh0aXRsZSA9ICJjb25kaXRpb24iKSkKfSkKCmRvLmNhbGwoZ3JpZEV4dHJhOjpncmlkLmFycmFuZ2UsIGMoYm94cGxvdF9saXN0LCBuY29sID0gNSwgbnJvdyA9IDQpKQoKI2Fubm90YXRlX2ZpZ3VyZShmaWd1cmUsCiAjICAgICAgICAgICAgICAgdG9wID0gdGV4dF9ncm9iKCJURnMgYWN0aXZpdHkgYWNyb3NzIGNvbmRpdGlvbnMgZm9yIFRGcyBtb3JlIGJvdW5kIGluIHVuaW5mZWN0ZWQgcHJpbWFyeSBtaWNyb2dsaWEiLCBzaXplID0gMjApKQoKYGBgCgotLS0KCgojIyBDb3JyZWxhdGlvbnMgYmV0d2VlbiBjb25kaXRpb25zIHsudGFic2V0fQoKKipJbnRlcnByZXRhdGlvbiBoZXJlKioKCiMjIyBDb3JyZWxhdGlvbiBtYXRyaXgKCmBgYHtyfQpjb3JfbXR4IDwtIHRyaV9tZ0BtZXRhLmRhdGEgJT4lIAogIHJvd25hbWVzX3RvX2NvbHVtbigiY2VsbCIpICU+JQogIHNlbGVjdChjKCJjZWxsIiwgIm9yaWcuaWRlbnQiLCBjb2xuYW1lcyhhdWNfbXR4KSkpICU+JQogIGdyb3VwX2J5KG9yaWcuaWRlbnQpICU+JQogIHN1bW1hcml6ZV9pZihpcy5udW1lcmljLCBtZWFuKSAlPiUgCiAgZ2F0aGVyKFRGLCB2YWx1ZSwgLW9yaWcuaWRlbnQpICU+JSAKICBzcHJlYWQob3JpZy5pZGVudCwgdmFsdWUpICU+JSAKICBjb2x1bW5fdG9fcm93bmFtZXMoIlRGIikgJT4lIGNvcigpCgp0ZXN0Q29yIDwtIGNvci5tdGVzdChjb3JfbXR4LCBjb25mLmxldmVsID0gMC45NSkKCiMgcGxvdCBjb3JyZWxhdGlvbnMKIyBwLm1hdCA9IG1hdHJpeCBvZiBwX3ZhbHVlcwoKCmNvcnJwbG90KGNvcl9tdHgsCiAgICAgICAgICNtZXRob2QgPSAiY29sb3IiLCAKICAgICAgICAgb3JkZXIgPSAiaGNsdXN0IiwgCiAgICAgICAgIGFkZHJlY3QgPSA0LCAjIGFkZCBib3hlcyAKICAgICAgICAgcC5tYXQgPSB0ZXN0Q29yJHAsIAogICAgICAgICAjc2lnLmxldmVsID0gLjA1LAogICAgICAgICBpbnNpZyA9ICJwLXZhbHVlIiwgCiAgICAgICAgIHRsLmNvbCA9ICJibGFjayIpCgpgYGAKCiMjIyBTY2F0dGVyIG1hdHJpeAoKYGBge3IsIGZpZy53aWR0aD0xMiwgZmlnLmhlaWdodD04fQp0cmlfbWdAbWV0YS5kYXRhICU+JSAKICByb3duYW1lc190b19jb2x1bW4oImNlbGwiKSAlPiUKICBzZWxlY3QoYygiY2VsbCIsICJvcmlnLmlkZW50IiwgY29sbmFtZXMoYXVjX210eCkpKSAlPiUKICBncm91cF9ieShvcmlnLmlkZW50KSAlPiUKICBzdW1tYXJpemVfaWYoaXMubnVtZXJpYywgbWVhbikgJT4lIAogIGdhdGhlcihURiwgdmFsdWUsIC1vcmlnLmlkZW50KSAlPiUgCiAgc3ByZWFkKG9yaWcuaWRlbnQsIHZhbHVlKSAlPiUgCiAgY29sdW1uX3RvX3Jvd25hbWVzKCJURiIpICU+JSBHR2FsbHk6OmdncGFpcnMoKSArCiAgICBsYWJzKHRpdGxlID0gIlNjYXR0ZXIgbWF0cml4IGZvciBkaWZmZXJlbnQgY29uZGl0aW9ucyIpCmBgYAoKLS0tCgoKIyMgQ29ycmVsYXRpb24gYmV0d2VlbiBURnMgZGlmZmVyZW50aWF0aW5nIE15ZWxvaWQyIGNsdXN0ZXJzIHsudGFic2V0fQoKVGhlc2UgVEZzIHdlcmUgZGlmZmVybnRpYWxseSBhY3RpdmUgYmV0d2VlbiB0aGUgdGhyZWUgaGllcmFyY2hpY2FsIGNsdXN0ZXJzIGluCk15ZWxvaWQyIGNlbGxzIGZyb20gSElWLWluZmVjdGVkIHBhdGllbnRzLiBBY3Jvc3MgdGhyZWUgZGlmZmVyZW50IHBhdGllbnRzCnRoZXkgc2hvd2VkIGNvcnJlbGF0ZWQgY2hhbmdlcyBpbiBhY3Rpdml0eS4gWVkxLCBFVFMxIGFuZCBSRVNUIHdlcmUgcG9zaXRpdmVseQpjb3JyZWxhdGVkIHdpdGggZWFjaCBvdGhlciBhbmQgbmVnYXRpdmVseQpjb3JyZWxhdGVkIHdpdGggTUVGMkEsIEVUVjYsIEpVTkIsIE1FRjJDLCBNWEkxIGFuZCBDRUJQQi4gVGhlIHBhdHRlcm4gb2JzZXJ2ZWQgZm9yIHRoZSBpTWcgZnJvbSB0aGUgdHJpY3VsdHVyZSBkYXRhc2V0IGRvZXMgbm90CnJlc2VtYmxlIHRoZSBwYXR0ZXJuIG9ic2VydmVkIGluIE15ZWxvaWQyIGNlbGxzLiAKCiMjIyBDb3JyZWxhdGlvbiBNYXRyaXgKCmBgYHtyfQppbnRlcnNlY3RfY3NmIDwtIHJlYWQudGFibGUoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9kYXRhL2F0YWNfaW50ZXJzZWN0X1RGc19kaWZmZXJlbnRfYWNyb3NzX3BhdGllbnRzXzNfY2x1c3RlcnMiKQoKCmNvcl9tdHggPC0gdHJpX21nQG1ldGEuZGF0YSAlPiUgCiAgcm93bmFtZXNfdG9fY29sdW1uKCJjZWxsIikgJT4lIAogIHNlbGVjdChjKCJjZWxsIiwgIm9yaWcuaWRlbnQiLCBpbnRlcnNlY3RfY3NmJHhbaW50ZXJzZWN0X2NzZiR4ICVpbiUgY29sbmFtZXMoYXVjX210eCldKSkgJT4lICMgb25seSBURnMgd2l0aCBkaWZmZXJlbnRpYWwgYmluZGluZyBzY29yZXMgZnJvbSBBVEFDc2VxCiAgZ3JvdXBfYnkob3JpZy5pZGVudCkgJT4lCiAgc3VtbWFyaXplX2lmKGlzLm51bWVyaWMsIG1lYW4pICU+JSAKICBjb2x1bW5fdG9fcm93bmFtZXMoIm9yaWcuaWRlbnQiKSAlPiUgY29yKCkKCnRlc3RDb3IgPC0gY29yLm10ZXN0KGNvcl9tdHgsIGNvbmYubGV2ZWwgPSAwLjk1KQoKY29ycnBsb3QoY29yX210eCwKICAgICAgICAgI21ldGhvZCA9ICJjb2xvciIsCiAgICAgICAgIG9yZGVyID0gImhjbHVzdCIsIAogICAgICAgICBhZGRyZWN0ID0gNCwgIyBhZGQgYm94ZXMgCiAgICAgICAgIHAubWF0ID0gdGVzdENvciRwLAogICAgICAgICBpbnNpZyA9ICJwLXZhbHVlIikKYGBgCgojIyMgU2NhdHRlciBNYXRyaXgKCmBgYHtyLCBmaWcuaGVpZ2h0PTEwLCBmaWcud2lkdGg9MTV9CnRyaV9tZ0BtZXRhLmRhdGEgJT4lIAogIHJvd25hbWVzX3RvX2NvbHVtbigiY2VsbCIpICU+JSAKICBzZWxlY3QoYygiY2VsbCIsICJvcmlnLmlkZW50IiwgaW50ZXJzZWN0X2NzZiR4W2ludGVyc2VjdF9jc2YkeCAlaW4lIGNvbG5hbWVzKGF1Y19tdHgpXSkpICU+JSAjIG9ubHkgVEZzIHdpdGggZGlmZmVyZW50aWFsIGJpbmRpbmcgc2NvcmVzIGZyb20gQVRBQ3NlcQogIGdyb3VwX2J5KG9yaWcuaWRlbnQpICU+JQogIHN1bW1hcml6ZV9pZihpcy5udW1lcmljLCBtZWFuKSAlPiUgCiAgY29sdW1uX3RvX3Jvd25hbWVzKCJvcmlnLmlkZW50IikgJT4lCiAgR0dhbGx5OjpnZ3BhaXJzKCkgKwogIGxhYnModGl0bGUgPSAiU2NhdHRlciBNYXRyaXggZm9yIGRpZmZlcmVudCBURnMiKQpgYGAKCi0tLQoKIyBSZWZlcmVuY2Vz</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>





</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Triculture_dataset_GRN_with_Scenic.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
