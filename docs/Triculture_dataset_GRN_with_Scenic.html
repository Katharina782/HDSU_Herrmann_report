<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Katharina Mikulik" />


<title>Transcription factor activity in iMg</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Report</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Abstract</a>
</li>
<li>
  <a href="Introduction.html">Introduction</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Results
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="HIV_CSF_dataset_analysis.html">1. CSF/Blood samples</a>
    </li>
    <li>
      <a href="TF_activity_analysis_of_myeloid2_cluster.html">2. TF activity Myeloid2</a>
    </li>
    <li>
      <a href="Triculture_csf_integration.html">3. Integration CSF/Blood &amp; triculture</a>
    </li>
    <li>
      <a href="Triculture_dataset_GRN_with_Scenic.html">4. TF activity iMg</a>
    </li>
  </ul>
</li>
<li>
  <a href="Discussion.html">Discussion</a>
</li>
<li>
  <a href="Methods.html">Methods</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Katharina782/report">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Transcription factor activity in iMg</h1>
<h4 class="author">Katharina Mikulik</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2022-01-10
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>report/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20211203code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20211203)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20211203code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20211203)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKatharina782reporttree62d16f3043806e5fedbcfbe59a665a3831327f83targetblank62d16f3a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/Katharina782/report/tree/62d16f3043806e5fedbcfbe59a665a3831327f83" target="_blank">62d16f3</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKatharina782reporttree62d16f3043806e5fedbcfbe59a665a3831327f83targetblank62d16f3a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/Katharina782/report/tree/62d16f3043806e5fedbcfbe59a665a3831327f83" target="_blank">62d16f3</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    analysis/Independent_cell_type_identification_Farhadian_dataset_cache/
    Ignored:    analysis/Triculture_csf_integration_cache/

Untracked files:
    Untracked:  README.html
    Untracked:  analysis/Triculture_csf_integration/
    Untracked:  data/triculture_seurat_object
    Untracked:  rebuild file.Rmd
    Untracked:  rebuild-file.Rmd
    Untracked:  rebuild-file.html
    Untracked:  rebuild-file_cache/
    Untracked:  rebuild-file_files/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/Triculture_dataset_GRN_with_Scenic.Rmd</code>) and HTML (<code>docs/Triculture_dataset_GRN_with_Scenic.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/62d16f3043806e5fedbcfbe59a665a3831327f83/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">62d16f3</a>
</td>
<td>
Katharina782
</td>
<td>
2022-01-10
</td>
<td>
wflow_publish(all = TRUE, delete_cache = TRUE, republish = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/b0b092ff1257cac1b7152b5935305972e22c90f8/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">b0b092f</a>
</td>
<td>
Katharina782
</td>
<td>
2022-01-09
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/12b0e376866060301ab81b01f5d7eac64029a77b/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">12b0e37</a>
</td>
<td>
Katharina782
</td>
<td>
2022-01-09
</td>
<td>
wflow_publish(all = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/12b0e376866060301ab81b01f5d7eac64029a77b/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">12b0e37</a>
</td>
<td>
Katharina782
</td>
<td>
2022-01-09
</td>
<td>
wflow_publish(all = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/f35ba45536a8b7546c4144a569fe908ce206aa4d/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">f35ba45</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-31
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/75af25c571d2f255bb408c63df6ee70c423b892a/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">75af25c</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-31
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/dfcd540d3a574f3ad19196570abd4c6c51bd0aa3/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">dfcd540</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-31
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/d0fdb768719231ff1aad5dbf5161957e35112d9c/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">d0fdb76</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-30
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/cae354b1737a3561e0416a6c1fa88bb7a0498e9b/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">cae354b</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-30
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/8ea0b5199c3439beabde205536a1fb8e82c3b2ca/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">8ea0b51</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/0e99d5039ae0f3249d1c414151748f9809099f6c/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">0e99d50</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-28
</td>
<td>
wflow_publish(c("analysis/_site.yml“,”analysis/Triculture_dataset_GRN_with_Scenic.Rmd"))
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/95e3d72f7a8e38583d6fa7f64215f44b97d8718b/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">95e3d72</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-28
</td>
<td>
wflow_publish(“analysis/Triculture_dataset_GRN_with_Scenic.Rmd”)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/6c5f3b175db2cc63caa1ba67e59c08e1a22f412b/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">6c5f3b1</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-27
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/d85a63137b84a09c19647281ffe67edbcce2e1eb/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">d85a631</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/0a10c5865c15bdc0867dc5c069dc4cfb7703f73c/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">0a10c58</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/bdbb921b65681909caf7252afe838d8b807681c3/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">bdbb921</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/efc0f94be22d7f357aeb93d42cfe3cec476f700a/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">efc0f94</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
wflow_publish(c(“analysis/TF_activity_analysis_of_myeloid2_cluster.Rmd,”
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/9597c36bc5a6df5f071249d97949566b2c7db870/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/ea7e899746b03ca612d93ad003c875fc101d2329/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">ea7e899</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/6783264e95c3864ae6a468bdfed32b21af801b6d/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">6783264</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/9e2c322b7e27fe7694e862cf4b11ae612816498d/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">9e2c322</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(c(“analysis/Triculture_dataset_GRN_with_Scenic.Rmd,”
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/40651d96647f10219a4aec953c8d618d57bc13f5/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/f7243f8882ef1868800d5f0e420f83d5e4ba39bb/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">f7243f8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/f7243f8882ef1868800d5f0e420f83d5e4ba39bb/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">f7243f8</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
<td>
wflow_publish(all = TRUE, republish = TRUE, delete_cache = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/8b791e32c4621d66dad520814dea9593d4ae12a6/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">8b791e3</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/Katharina782/report/9ee308625fb863ad709edf2660babe4de93ced91/docs/Triculture_dataset_GRN_with_Scenic.html" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/Katharina782/report/blob/e87fa963caeed78821ac7f482359072ce58b8529/analysis/Triculture_dataset_GRN_with_Scenic.Rmd" target="_blank">e87fa96</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-16
</td>
<td>
new files
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<style>
body {
text-align: justify}
</style>
<pre class="r"><code>library(tidyverse)
library(Seurat)
library(edgeR)
library(Matrix)
library(data.table)
library(ggplot2)
library(dplyr)
library(ggrepel)
#library(harmony)
library(RColorBrewer)
library(pheatmap)
library(ggcorrplot)
library(ComplexHeatmap)
library(circlize)
library(ggpubr)
library(gridExtra)
library(corrplot)
library(rstatix)
library(knitr)
library(metap)
library(multtest)
library(readxl)</code></pre>
<div id="grn-inference-with-scenic" class="section level1">
<h1>GRN inference with SCENIC</h1>
<p>To infer GRNs from iMg cells of the triculture data set <span class="citation">(<a href="#ref-Ryan" role="doc-biblioref">Ryan SK 2020</a>)</span> (4333 cells in total) SCENIC was used as before. When referring to differentially bound TFs in the C20 cell line in the following I am referring to differential binding scores between infection conditions obtained from bulk ATACseq data from C20 cell line cultures using TOBIAS.</p>
<p>First SCENIC was run with 3000 most highly variable genes (HVG), but then only eight of the TFs overlapped with the differentially bound TFs. Using 10,000 HVG SCENIC returned 232 TFS and their corresponding activity scores for each cell. Of these 232 TFs 25 overlap with differentially bound TFs in the C20 cell line.</p>
<pre class="r"><code># read in triculture Seurat object
triculture &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/triculture_clean_seurat_object&quot;)

# read in CSF HIV Seurat object
hiv7 &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Reproduce_Farhadian_Paper/Seurat_objects/total_7_samples_label_transfer.rds&quot;)

imicroglia &lt;- subset(triculture, cell_type == &quot;iMg&quot;)</code></pre>
<details>
<summary>
<strong>Preparing expression matrix for SCENIC</strong>
</summary>
<p>First, SCTransform was used for normalization of the expression data, then the top 10,000 HVGs are selected and the matrix transposed, because the pySCENIC pipeline requires an input matrix which has genes as columns and cells as rows. (<a href="https://github.com/hdsu-bioquant/pySCENIC_pipeline/blob/master/input/gene_exp_mtx_example.tsv" class="uri">https://github.com/hdsu-bioquant/pySCENIC_pipeline/blob/master/input/gene_exp_mtx_example.tsv</a>)</p>
<pre><code># use 10 000 most highly variable genes
scenic &lt;- SCTransform(imicroglia, variable.features.n = 10000, verbose=FALSE)
saveRDS(scenic, &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/triculture_scenic&quot;)
scenic &lt;- readRDS(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/triculture_scenic&quot;)
scenic_hvg &lt;- subset(scenic, features = scenic@assays$SCT@var.features)
scenic_mtx &lt;- t(scenic_hvg@assays$SCT@scale.data)
write.table(x = scenic_mtx, file = &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/pySCENIC_pipeline/input/triculture_mtx.tsv&quot;, sep = &quot;\t&quot;)

#scenic_matrix &lt;- read.table(file = &quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/pySCENIC_pipeline/input/triculture_mtx.tsv&quot;, sep = &quot;\t&quot;)</code></pre>
<hr />
</details>
<details>
<summary>
<strong>AuCell matrix - output from Scenic</strong>
</summary>
<p>The output from SCENIC is a matrix containing cells as rows and 232 TFs as columns. Five exemplary rows and columns are shown below. The TF activity for each cell can be used to draw conclusions about different cell states.</p>
<pre class="r"><code>auc_mtx &lt;- read.csv(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/src/Triculture_dataset_Ryan_paper/pySCENIC_output/aucell_img_10k.csv&quot;)
auc_mtx &lt;- auc_mtx %&gt;% column_to_rownames(&quot;Cell&quot;)
auc_mtx &lt;- auc_mtx %&gt;% setnames( old = colnames(auc_mtx), new = sapply(strsplit(
  colnames(auc_mtx), &quot;[...]&quot;), `[`, 1))

auc_mtx[1:5, 1:5] %&gt;% kable(caption = &quot;Layout of TF activity matrix&quot;)</code></pre>
<table>
<caption>Layout of TF activity matrix</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ARID3A</th>
<th align="right">ARNT</th>
<th align="right">ARNTL2</th>
<th align="right">ASCL2</th>
<th align="right">ATF2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ca_AAACCTGGTGTTCGAT-1</td>
<td align="right">0.0337910</td>
<td align="right">0.0864444</td>
<td align="right">0.063000</td>
<td align="right">0.0002</td>
<td align="right">0.01125</td>
</tr>
<tr class="even">
<td align="left">ca_AAACCTGGTTGTACAC-1</td>
<td align="right">0.0200299</td>
<td align="right">0.0237778</td>
<td align="right">0.024625</td>
<td align="right">0.0629</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="left">ca_AAACGGGAGAATTCCC-1</td>
<td align="right">0.0436418</td>
<td align="right">0.0133333</td>
<td align="right">0.006375</td>
<td align="right">0.0000</td>
<td align="right">0.11100</td>
</tr>
<tr class="even">
<td align="left">ca_AAACGGGAGACAGACC-1</td>
<td align="right">0.0314925</td>
<td align="right">0.0000000</td>
<td align="right">0.063625</td>
<td align="right">0.0804</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="left">ca_AAACGGGTCACATACG-1</td>
<td align="right">0.0402687</td>
<td align="right">0.0971111</td>
<td align="right">0.067625</td>
<td align="right">0.0000</td>
<td align="right">0.00000</td>
</tr>
</tbody>
</table>
<hr />
</details>
<details>
<summary>
<strong>Number of iMg in each condition</strong>
</summary>
<pre class="r"><code># add auc matrix to metadata of hiv4 seurat object
tri_mg &lt;- AddMetaData(imicroglia, 
                    metadata = auc_mtx, 
                    col.name = colnames(auc_mtx))</code></pre>
<pre class="r"><code>tri_mg@meta.data %&gt;% 
  rename(condition  = orig.ident) %&gt;%
  group_by(condition) %&gt;%
  summarize(n = n()) %&gt;% 
  kable(caption = &quot;Number of cells in each condition&quot;)</code></pre>
<table>
<caption>Number of cells in each condition</caption>
<thead>
<tr class="header">
<th align="left">condition</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Inf</td>
<td align="right">1166</td>
</tr>
<tr class="even">
<td align="left">Inf+EFZ</td>
<td align="right">1382</td>
</tr>
<tr class="odd">
<td align="left">Uninf</td>
<td align="right">1163</td>
</tr>
<tr class="even">
<td align="left">Uninf+EFZ</td>
<td align="right">722</td>
</tr>
</tbody>
</table>
<hr />
</details>
</div>
<div id="bulk-atacseq-footprinting" class="section level1">
<h1>Bulk ATACseq footprinting</h1>
<p>The C20 cell line was derived from an HIV+ patient treated with ART (Antiretroviral Therapy). Since the access of ART to the brain is limited due to the blood-brain barrier, the effects of ART on these cells are probably negligible. Only the 75 TFs with p-values for differential binding scores below 1e-50 were used. We will focus on TFs which show differential binding scores between latent infection and uninfected conditions in the C20 cell line. For 25 of these 75 TFs there is a TF activity score for the iMg. Focusing on these 25 TFs we might be able to find activity patterns that correlate with the TF binding scores. Five TFs are more bound in latent infection and twenty TFs are more bound in uninfected cells. The reason why we find more of the TFs more bound in uninfected cells in the TF activity score matrix from SCENIC is unclear.</p>
<pre class="r"><code>tfs_ana &lt;- read.table(&quot;/media/ag-cherrmann/projects/06_HIV_Microglia/data/atacseq/data-2020-11-06/tobias/TOBIAS_snakemake/footprint_mglia2_GlassTF_17-03/TFBS/bindetect_results.txt&quot;, sep = &quot;\t&quot;, header = TRUE)

top_tfs &lt;- tfs_ana %&gt;% filter(uninf_red_pvalue &lt; 1e-50)

# keep only the TFs in the dataframe which overlap between the two datasets.
overlap_atac &lt;- top_tfs %&gt;% filter(name %in% colnames(auc_mtx))

# dataframe containing only the 25 Tfs whcih overlap with TF activity matrix from SCENIC 
# adding a column with information in which infection condition the TF is more bound
atac_tfs_df &lt;- top_tfs %&gt;% filter(name %in% colnames(auc_mtx)) %&gt;% 
  mutate(condition = ifelse(uninf_red_change &gt; 0, &quot;up_uninf&quot;, &quot;up_latent&quot;))

# List of 5 TFs more bound in latent infection
up_latent &lt;- atac_tfs_df$name[atac_tfs_df$condition == &quot;up_latent&quot;]
# list of 25 TFs more bound in uninfected cells
up_uninf &lt;- atac_tfs_df$name[atac_tfs_df$condition == &quot;up_uninf&quot;]</code></pre>
<details>
<summary>
<strong>Volcano Plot ATAC-seq footprinting</strong>
</summary>
<pre class="r"><code>top_tfs %&gt;% 
  # add a column containing information in which condition the corresponding TF 
  # is upregulated
  mutate(condition = ifelse(uninf_red_change &lt; 0, &quot;up_latent&quot;, &quot;up_uninf&quot;)) %&gt;%
  # add a column conaining the labels for the plot
  # I only want to label cells which are also found by Scenic
  mutate(label = ifelse(name %in% overlap_atac$name, name, NA)) %&gt;% 
  ggplot(aes(x = uninf_red_change,
             y = -log10(uninf_red_pvalue),
             col = condition, 
             label = label)) +
  geom_point() +
  geom_hline(yintercept = -log10(1e-50), col = &quot;red&quot;) +
  geom_text(nudge_x = .05, nudge_y = 2) +
  labs(title = &quot;TFs with differential binding scores&quot;) +
  ylab(&quot;-log10(p_value)&quot;) +
  xlab(&quot;differential binding score&quot;)
Warning: Removed 50 rows containing missing values (geom_text).</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-7-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9597c36bc5a6df5f071249d97949566b2c7db870/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-7-1.png" target="_blank">9597c36</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-7-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-7-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</details>
</div>
<div id="tf-activity-in-img" class="section level1">
<h1>TF activity in iMg</h1>
<p>In the heatmap of TF activities below you can already see a trend towards a separation of cells treated with EFZ (blue and green) from untreated cells (red and orange). It will be interesting to see if an activity pattern resembling the differential binding score pattern from the C20 cell line footprinting can be found. For this we will focus on the 25 TFs which are found in the C20 cell line and the triculture data set respectively.</p>
<details>
<summary>
<strong>Heatmap of 232 TFs and their activity in iMg</strong>
</summary>
<pre class="r"><code>conditions &lt;- tri_mg@meta.data %&gt;%
                    rownames_to_column(&quot;cell&quot;) %&gt;%
                    select(&quot;cell&quot;, &quot;orig.ident&quot;)%&gt;% column_to_rownames(&quot;cell&quot;)


ht &lt;- Heatmap(t(auc_mtx), 
      col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
      show_column_names = FALSE,
      row_names_side = &quot;left&quot;,
      top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                         name = &quot;condition&quot;, col =  
                                         list(condition = c(&quot;Uninf&quot; = &quot;orange&quot;, 
                                                            &quot;Inf+EFZ&quot; = &quot;green&quot;,
                                                            &quot;Inf&quot; = &quot;red&quot;,
                                                            &quot;Uninf+EFZ&quot; = &quot;blue&quot;)))
)
ht</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-8-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-8-1">
Past versions of unnamed-chunk-8-1.png
</button>
</p>
<div id="fig-unnamed-chunk-8-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-8-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-8-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</details>
<div id="k-means-clustering-with-different-k" class="section level3 tabset">
<h3 class="tabset">K-means clustering with different k</h3>
<p>Using k-means clustering we might be able to identify clusters with certain patterns of TF activity. Judging from the different heatmaps shown belo, k = 4 might be the most informative, since for k = 5 there is only one TF (NHLH1) differentiating an additional cluster. The plot of within-clusters sum of squares should help to pick the best number of clusters, however as can be seen below there is no obvious kink in the curve.</p>
<p>K-means clustering with k = 2 seems to split the cells into treated vs.  untreated cells. These two clusters have a very evident biological meaning. Using k = 3 or k = 4 keeps these two biologically relevant groups separate, but also creates additional clusters which seem to be a mixture of treated and untreated cells. Having a closer look at clusters from k = 4 might give som additional biological insights.</p>
<p>Having a closer look at the four clusters, it becomes evident that the two left most clusters separate treated cells from untreated cells, independent of the infection condition. There are more Inf+EFZ than Uninf+EFZ in the first cluster, however this is in line with the lower cell number of Uninf+EFZ (722 cells) compared to Inf+EFZ (1382 cells).</p>
<p>Two TFs seem to be more active in Inf+EFZ and Uninf+EFZ compared to Inf and Uninf, namely RUNX3 and JUNB. Another three TFs seem to be more active in Inf and Uninf compared to Inf+EFZ and Uninf+EFZ, namely NFAT5, TCF7L2 and CEBPB. TCF4 distinguishes a third cluster. Is there a biological meaning behind that? Can these TFs be associated with a particular condition?</p>
<div id="different-k" class="section level4">
<h4>Different k</h4>
<pre class="r"><code>
ht_list &lt;- map(seq.int(2,6), function(n){
  ht &lt;- Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
        col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        column_title = paste0(&quot;k = &quot;, n),
        show_column_names = FALSE,
        row_names_side = &quot;left&quot;,
        top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                           name = &quot;condition&quot;,
                                           col = list(condition = 
                                                        c(&quot;Uninf&quot; = &quot;orange&quot;, 
                                                          &quot;Inf+EFZ&quot; = &quot;green&quot;,
                                                          &quot;Inf&quot; = &quot;red&quot;, 
                                                          &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
        column_km = n,
         )
  
})

ht_list &lt;- ht_list[[1]] + ht_list[[2]] + ht_list[[3]] + ht_list[[4]] + ht_list[[5]]
draw(ht_list, column_title = &quot;K-means clustering with different k&quot;, ht_gap = unit(2, &quot;cm&quot;))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-9-1">
Past versions of unnamed-chunk-9-1.png
</button>
</p>
<div id="fig-unnamed-chunk-9-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/12b0e376866060301ab81b01f5d7eac64029a77b/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" target="_blank">12b0e37</a>
</td>
<td>
Katharina782
</td>
<td>
2022-01-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-9-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="k-4" class="section level4">
<h4>k = 4</h4>
<pre class="r"><code>ht &lt;- draw(Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
      col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
      column_title = &quot;K-means clustering with k = 4&quot;,
      show_column_names = FALSE,
      row_names_side = &quot;left&quot;,
      top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                         name = &quot;condition&quot;,
                                         col = list(condition = 
                                                      c(&quot;Uninf&quot; = &quot;orange&quot;, 
                                                        &quot;Inf+EFZ&quot; = &quot;green&quot;,
                                                        &quot;Inf&quot; = &quot;red&quot;, 
                                                        &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
      column_km = 4,
       ))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-10-1">
Past versions of unnamed-chunk-10-1.png
</button>
</p>
<div id="fig-unnamed-chunk-10-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/12b0e376866060301ab81b01f5d7eac64029a77b/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">12b0e37</a>
</td>
<td>
Katharina782
</td>
<td>
2022-01-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/8ea0b5199c3439beabde205536a1fb8e82c3b2ca/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">8ea0b51</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-10-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="wss-plot" class="section level4">
<h4>WSS plot</h4>
<pre class="r"><code>df &lt;- hiv7@meta.data %&gt;% filter(cell_type == &quot;Myeloid2&quot;, 
                                    orig.ident == &quot;HIV1_CSF&quot;)
mtx &lt;- auc_mtx[, atac_tfs_df$name]

# Decide on a k for clustering
wss = sapply(2:15, function(k) {
  kmeans(x = t(mtx), centers = k)$tot.withinss
})

plot(2:15, wss, type = &quot;b&quot;, 
     xlab = &quot;Number of clusters k&quot;, 
     ylab = &quot;Total within-clusters sum of square&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-11-1">
Past versions of unnamed-chunk-11-1.png
</button>
</p>
<div id="fig-unnamed-chunk-11-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/12b0e376866060301ab81b01f5d7eac64029a77b/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">12b0e37</a>
</td>
<td>
Katharina782
</td>
<td>
2022-01-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/8ea0b5199c3439beabde205536a1fb8e82c3b2ca/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">8ea0b51</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-11-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="section" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<hr />
</div>
</div>
<div id="split-heatmaps-to-find-patterns" class="section level3 tabset">
<h3 class="tabset">Split heatmaps to find patterns</h3>
<div id="separate-heatmaps-according-to-infection-condition" class="section level4">
<h4>Separate Heatmaps according to infection condition</h4>
<p>Separating the cells according to different conditions shows that there is a bigger difference between cells treated with EFZ vs. untreated cells than between infected vs uninfected cells. The Inf+EFZ (green) and Uninf+EFZ (blue) show very similar TF activity patterns and the Inf (red) and Uninf (orange) show very similar TF activity patterns. These findings recapitulate the findings from above.</p>
<p>Two TFs seem to be more active in Inf+EFZ and Uninf+EFZ compared to Inf and Uninf, namely RUNX3 and JUNB. Three TFs seem to be more active in Inf and Uninf compared to Inf+EFZ and Uninf+EFZ, namely NFAT5, TCF7L2 and CEBPB. In microglia cells inflammatory signals trigger NFAT5 expression <span class="citation">(<a href="#ref-Yang" role="doc-biblioref">Yang XL 2018</a>)</span>. CEBPB regulates pro-inflammatory gene expression and its expression is increased in the brain during HAND, however, there is no data from microglia cells <span class="citation">(<a href="#ref-Canchi" role="doc-biblioref">Canchi S 2020</a>)</span>.</p>
<pre class="r"><code>ht_conditions &lt;- Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
        #col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        column_title = &quot;split according to infection condition&quot;,
        show_column_names = FALSE,
        row_names_side = &quot;left&quot;,
        col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                           name = &quot;condition&quot;, col = list(condition = c(&quot;Uninf&quot; = &quot;orange&quot;, &quot;Inf+EFZ&quot; = &quot;green&quot;, &quot;Inf&quot; = &quot;red&quot;, &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
        #row_km = 2,
        #row_split = atac_tfs_df$condition,
        column_split = tri_mg$orig.ident,
        left_annotation = rowAnnotation(TF_footprinting = (atac_tfs_df %&gt;% 
                                                         select(name, condition) %&gt;%
                                                         column_to_rownames(&quot;name&quot;))[[&quot;condition&quot;]],
              name = &quot;TF_footprinting&quot;,
              col = list(TF_footprinting = c(&quot;up_latent&quot; = &quot;pink&quot;, 
                                             &quot;up_uninf&quot; = &quot;darkgreen&quot;)))
        )

ht_conditions </code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-12-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-12-1">
Past versions of unnamed-chunk-12-1.png
</button>
</p>
<div id="fig-unnamed-chunk-12-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-12-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-12-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-12-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="split-heatmaps-according-to-tf-binding-scores-from-atacseq-data" class="section level4">
<h4>Split Heatmaps according to TF binding scores from ATACseq data</h4>
<p>Separating the heatmap along the rows, according to TFs either more bound in latently infected microglia or more bound in uninfected primary microglia, does not result in a separation according to treatment with EFZ.</p>
<p>What one might expect to see, is that TFs more bound in uninfected primary microglia would also show higher activity in uninfected iMg, while TFs more bound in latently infected primary microglia would show higher activity in Inf+EFZ iMg. However, such a pattern is not immediately visible in the heatmap below.</p>
<p>The TFs more bound in latently infected cells do not seem to correlate with any condition, but rather vary a lot more across all cells than the TFs more bound in uninfected cells which show some correlation with the condition and less across all cells.</p>
<pre class="r"><code>ht_tfs1 &lt;- Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
        #col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        column_title = &quot;split according to TF binding score for latent vs. uninfected&quot;,
        show_column_names = FALSE,
        row_names_side = &quot;left&quot;,
        #column_km = 4,
        row_split = atac_tfs_df$condition,
        col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                           name = &quot;condition&quot;, 
                                           col = list(condition = 
                                                        c(&quot;Uninf&quot; = &quot;orange&quot;,
                                                          &quot;Inf+EFZ&quot; = &quot;green&quot;,
                                                          &quot;Inf&quot; = &quot;red&quot;,
                                                          &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
        #column_split = tri_mg$orig.ident
        left_annotation = rowAnnotation(TF_footprinting = 
                                          (atac_tfs_df %&gt;% 
                                            select(name, condition) %&gt;%
                                            column_to_rownames(&quot;name&quot;))[[&quot;condition&quot;]],
                      name = &quot;TF_footprinting&quot;,
                      col = list(TF_footprinting = c(&quot;up_latent&quot; = &quot;pink&quot;, 
                                                     &quot;up_uninf&quot; = &quot;darkgreen&quot;)))
        )


#ht_list &lt;- ht_conditions + ht_tfs
#draw(ht_list)</code></pre>
<pre class="r"><code>ht_tfs2 &lt;- Heatmap(t(auc_mtx[, atac_tfs_df$name]), 
        #col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        column_title = &quot;split according to TF binding score for latent vs. uninfected&quot;,
        show_column_names = FALSE,
        row_names_side = &quot;left&quot;,
        #column_km = 4,
        row_split = atac_tfs_df$condition,
        column_split = tri_mg@meta.data$orig.ident,
        col =  colorRampPalette(rev(brewer.pal(n = 7, name = &quot;RdYlBu&quot;)))(100),
        top_annotation = HeatmapAnnotation(condition = conditions$orig.ident, 
                                           name = &quot;condition&quot;, col =
                                             list(condition =
                                                    c(&quot;Uninf&quot; = &quot;orange&quot;,
                                                      &quot;Inf+EFZ&quot; = &quot;green&quot;, 
                                                      &quot;Inf&quot; = &quot;red&quot;, 
                                                      &quot;Uninf+EFZ&quot; = &quot;blue&quot;))),
        #column_split = tri_mg$orig.ident
        left_annotation = rowAnnotation(TF_footprinting = 
                                          (atac_tfs_df %&gt;% 
                                            select(name, condition) %&gt;%
                                            column_to_rownames(&quot;name&quot;))[[&quot;condition&quot;]],
                      name = &quot;TF_footprinting&quot;,
                      col = list(TF_footprinting = c(&quot;up_latent&quot; = &quot;pink&quot;, 
                                                     &quot;up_uninf&quot; = &quot;darkgreen&quot;)))
        )</code></pre>
<pre class="r"><code>ht_list &lt;- ht_tfs1 + ht_tfs2
draw(ht_list, ht_gap = unit(2, &quot;cm&quot;))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-15-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-15-1">
Past versions of unnamed-chunk-15-1.png
</button>
</p>
<div id="fig-unnamed-chunk-15-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-15-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-15-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-15-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
</div>
<div id="tf-activity-differences-between-clusters" class="section level2">
<h2>TF activity differences between clusters</h2>
<p>To quantitatively investigate whether we can find TFs which have significantly different activity between clusters we can use Kruskal-Wallis test and pairwise wilcox test as a posthoc analysis. 206 TFs have different acivity between the clusters.</p>
<pre class="r"><code>p_values &lt;- map(seq.int(1:length(colnames(auc_mtx))), function(n){
  tf &lt;- colnames(auc_mtx)[n]
  #print(tf)
  #print(triculture@meta.data[tf])
  p_values &lt;- unlist(kruskal.test(pull(tri_mg@meta.data[tf]) ~ orig.ident,
                                  tri_mg@meta.data))[&quot;p.value&quot;]
  #print(p_values)
  #list(tf = tf, p_value = p_values)
})

# adjust for multiple hypothesis testing
adj_p_values &lt;- p.adjust(as.numeric(unname(unlist(p_values))), method = &quot;fdr&quot;)


# how many transcription factors are significantly different between the clusters?
#length(adj_p_values[adj_p_values&lt;0.01])</code></pre>
<div id="posthoc-analysis" class="section level3 tabset">
<h3 class="tabset">Posthoc analysis</h3>
<div id="more-bound-in-latent-infection" class="section level4">
<h4>more bound in latent infection</h4>
<p><strong>Boxplots of TFs activity across conditions of TFs more bound in latent infection</strong></p>
<p>Among the TFs more bound in latently infected cells there is a difference in activity for REST and ZEB1, but only between treatment conditions and not between infection conditions. For the other three TFs there are no differences or patterns.</p>
<pre class="r"><code>
boxplot_list &lt;- map(up_latent, function(tf) {
  ggplot() +
    geom_boxplot(aes(x = tri_mg@meta.data %&gt;% pull(&quot;orig.ident&quot;),
                     y = tri_mg@meta.data %&gt;% pull(tf), 
                 fill = tri_mg@meta.data %&gt;% pull(&quot;orig.ident&quot;))) +
    stat_pvalue_manual(tri_mg@meta.data %&gt;% 
                         pairwise_wilcox_test(as.formula(paste0(tf, &quot; ~ orig.ident&quot;))) %&gt;% 
                         add_xy_position()) +
    xlab(&quot;Condition&quot;) +
    ylab(paste0(tf)) +
    guides(fill = guide_legend(title = &quot;condition&quot;))
})

do.call(gridExtra::grid.arrange, c(boxplot_list, ncol = 3, nrow = 2))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-17-1">
Past versions of unnamed-chunk-17-1.png
</button>
</p>
<div id="fig-unnamed-chunk-17-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-17-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="more-bound-in-uninfected" class="section level4">
<h4>more bound in uninfected</h4>
<p><strong>Boxplots of TFs activity across conditions of TFs more bound in uninfected primary microglia</strong></p>
<p>In the plots below the trend of TF activity being negatively correlated between treated and untreated cells, independently of the infection status can be seen for some TFs, for example CEBPB and MEF2C. For other TFs there is no difference between either infection status or treatment, for example CREB1 and ETS1.</p>
<p>Yet, even though the effect of treatment is most prominent, some TFs are additionally following the pattern of the footprinting. For example, RUNX3, CUX1, MEF2A, YY1 and MEF2C are more active in uninfected cells than in infected cells, but more active in infected + EFZ cells than uninfected + EFZ cells. These TFs, therefore, follow the footprining pattern at least in the untreated conditon. Conversely, NFAT5, TCF7L2 and CEBPB are more active in infected than in uninfected cells, but more bound in uninfected + EFZ cells than in infected + EFZ cells. It is unclear why the patterns are contrary to each other between the treatment conditions. JUNB and NFYB are the only two TFs which are more bound in uninfected +/- EFZ compared to infected +/- EFZ, which means they are following the footprinting pattern independently of the treatment condition.</p>
<p>One assumption is that TFs which are markers of microglia cells might be more or less active depending on whether the cells were treated with EFZ or not. An argument against this assumption is that both CEBPB and MEF2C are typically expressed in microglia, yet we observe an opposite trend. CEBPB is more active in Inf and Uninf cells than in Inf+EFZ and Uninf+EFZ cells, while MEF2C is more active in Inf+EFZ and Uninf+EFZ cells than in Inf and Uninf cells.</p>
<pre class="r"><code>

boxplot_list &lt;- map(up_uninf, function(tf) {
  ggplot() +
    geom_boxplot(aes(x = tri_mg@meta.data %&gt;% pull(&quot;orig.ident&quot;),
                     y = tri_mg@meta.data %&gt;% pull(tf), 
                 fill = tri_mg@meta.data %&gt;% pull(&quot;orig.ident&quot;))) +
    stat_pvalue_manual(tri_mg@meta.data %&gt;% 
                         pairwise_wilcox_test(as.formula(paste0(tf, &quot; ~ orig.ident&quot;))) %&gt;% 
                         add_xy_position()) +
    xlab(&quot;Condition&quot;) +
    ylab(paste0(tf)) +
    guides(fill = guide_legend(title = &quot;condition&quot;))
})

do.call(gridExtra::grid.arrange, c(boxplot_list, ncol = 5, nrow = 4))</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" width="1920" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-18-1">
Past versions of unnamed-chunk-18-1.png
</button>
</p>
<div id="fig-unnamed-chunk-18-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/114a941064f12efce14ce5eb1f7cc94e6a004074/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" target="_blank">114a941</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-18-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>
#annotate_figure(figure,
 #               top = text_grob(&quot;TFs activity across conditions for TFs more bound in uninfected primary microglia&quot;, size = 20))</code></pre>
<hr />
</div>
</div>
</div>
<div id="correlations-between-conditions" class="section level2 tabset">
<h2 class="tabset">Correlations between conditions</h2>
<p>The correlation plot and scatter matrix below further emphasizes what has already become evident from the previous analysis. Inf and Uninf iMg show a higher correlation with each other than for example Uninf+EFZ and Uninf. The Inf+EFZ iMg hardly correlate with the Inf iMg, but show a higher correlation with the Uninf+EFZ. The effect of EFZ treatment seems to be stronger than the effect of the infection.</p>
<div id="correlation-matrix" class="section level3">
<h3>Correlation matrix</h3>
<pre class="r"><code>cor_mtx &lt;- tri_mg@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;%
  select(c(&quot;cell&quot;, &quot;orig.ident&quot;, colnames(auc_mtx))) %&gt;%
  group_by(orig.ident) %&gt;%
  summarize_if(is.numeric, mean) %&gt;% 
  gather(TF, value, -orig.ident) %&gt;% 
  spread(orig.ident, value) %&gt;% 
  column_to_rownames(&quot;TF&quot;) %&gt;% cor()

testCor &lt;- cor.mtest(cor_mtx, conf.level = 0.95)

# plot correlations
# p.mat = matrix of p_values


corrplot(cor_mtx,
         #method = &quot;color&quot;, 
         order = &quot;hclust&quot;, 
         addrect = 4, # add boxes 
         p.mat = testCor$p, 
         #sig.level = .05,
         insig = &quot;p-value&quot;, 
         tl.col = &quot;black&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-19-1">
Past versions of unnamed-chunk-19-1.png
</button>
</p>
<div id="fig-unnamed-chunk-19-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-19-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="scatter-matrix" class="section level3">
<h3>Scatter matrix</h3>
<pre class="r"><code>tri_mg@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;%
  select(c(&quot;cell&quot;, &quot;orig.ident&quot;, colnames(auc_mtx))) %&gt;%
  group_by(orig.ident) %&gt;%
  summarize_if(is.numeric, mean) %&gt;% 
  gather(TF, value, -orig.ident) %&gt;% 
  spread(orig.ident, value) %&gt;% 
  column_to_rownames(&quot;TF&quot;) %&gt;% GGally::ggpairs() +
    labs(title = &quot;Scatter matrix for different conditions&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-20-1">
Past versions of unnamed-chunk-20-1.png
</button>
</p>
<div id="fig-unnamed-chunk-20-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-20-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
</div>
<div id="correlation-between-tfs-differentiating-myeloid2-clusters" class="section level2 tabset">
<h2 class="tabset">Correlation between TFs differentiating Myeloid2 clusters</h2>
<p>These TFs were differentially active between the three k-means clusters in Myeloid2 cells from HIV-infected patients. Across three different patients they showed correlated changes in activity. YY1, ETS1 and REST were positively correlated with each other and negatively correlated with MEF2A, ETV6, JUNB, MEF2C, MXI1 and CEBPB. The pattern observed for the iMg from the triculture data set does not resemble the pattern observed in Myeloid2 cells. A suprising observation is that there is pairs of TFs which are highly correlated, for example ETS1 and ETV6 or REST and CEBPB.</p>
<div id="correlation-matrix-1" class="section level3">
<h3>Correlation Matrix</h3>
<pre class="r"><code>intersect_csf &lt;- read.table(&quot;/media/ag-cherrmann/kmikulik/HIV_microglia/data/atac_intersect_TFs_different_across_patients_3_clusters&quot;)


cor_mtx &lt;- tri_mg@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;% 
  select(c(&quot;cell&quot;, &quot;orig.ident&quot;, intersect_csf$x[intersect_csf$x %in% colnames(auc_mtx)])) %&gt;% # only TFs with differential binding scores from ATACseq
  group_by(orig.ident) %&gt;%
  summarize_if(is.numeric, mean) %&gt;% 
  column_to_rownames(&quot;orig.ident&quot;) %&gt;% cor()

testCor &lt;- cor.mtest(cor_mtx, conf.level = 0.95)

corrplot(cor_mtx,
         #method = &quot;color&quot;,
         order = &quot;hclust&quot;, 
         addrect = 4, # add boxes 
         p.mat = testCor$p,
         insig = &quot;p-value&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-21-1">
Past versions of unnamed-chunk-21-1.png
</button>
</p>
<div id="fig-unnamed-chunk-21-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-21-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="scatter-matrix-1" class="section level3">
<h3>Scatter Matrix</h3>
<pre class="r"><code>tri_mg@meta.data %&gt;% 
  rownames_to_column(&quot;cell&quot;) %&gt;% 
  select(c(&quot;cell&quot;, &quot;orig.ident&quot;, intersect_csf$x[intersect_csf$x %in% colnames(auc_mtx)])) %&gt;% # only TFs with differential binding scores from ATACseq
  group_by(orig.ident) %&gt;%
  summarize_if(is.numeric, mean) %&gt;% 
  column_to_rownames(&quot;orig.ident&quot;) %&gt;%
  GGally::ggpairs() +
  labs(title = &quot;Scatter Matrix for different TFs&quot;)</code></pre>
<p><img src="figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-22-1">
Past versions of unnamed-chunk-22-1.png
</button>
</p>
<div id="fig-unnamed-chunk-22-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/40651d96647f10219a4aec953c8d618d57bc13f5/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" target="_blank">40651d9</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/436b5c2790a0ce492f776915a9e543bf3a84511d/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" target="_blank">436b5c2</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-20
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/fce26d5dd39fcac3f053aaaa3ceb1e2c02e05654/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" target="_blank">fce26d5</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/Katharina782/report/blob/9ee308625fb863ad709edf2660babe4de93ced91/docs/figure/Triculture_dataset_GRN_with_Scenic.Rmd/unnamed-chunk-22-1.png" target="_blank">9ee3086</a>
</td>
<td>
Katharina782
</td>
<td>
2021-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
</div>
</div>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<p>GRN inference based on gene expression in iMg did not show very clear results. 25 of the TFs were also found to have differential binding scores in the C20 cell line, but the patterns in activity were not always consistent. Some TFs more bound in uninfected cells followed the pattern found by footprinting, but only for either the treated cells or the untreated cells, but not for both. For the five TFs more bound in latent infection in C20 cells, no pattern was observed. Also, the correlation in activity of the tree TFs YY1, ETS1 and REST, found in Myeloid2 cells, was not found in iMg which weakens the hypothesis that the cluster of interest found in Myeloid2 cells might be latently infected cells. The interpretation of the results is difficult due to the fact that the effect of EFZ treatment seems to overshadow any effect of the HIV infection. This strong effect of the drugs should be kept in mind in any further analysis, since it makes the comparison between cells from patients and from cell culture particularly hard. Drug concentrations in the blood and even more so in the CSF are very low and the direct application of drugs in cell culture might not resemble the physiological effect very well.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Canchi" class="csl-entry">
Canchi S, Rissman RA, Swinton MK. 2020. <em>Transcriptomic Analysis of Brain Tissues Identifies a Role for CCAAT Enhancer Binding Protein β in HIV-Associated Neurocognitive Disorder</em>. <em>J Neuroinflammation</em>. Vol. 17(1). <a href="https://doi: 10.1186/s12974-020-01781-w">doi: 10.1186/s12974-020-01781-w</a>.
</div>
<div id="ref-Ryan" class="csl-entry">
Ryan SK, Garifallou JP, Gonzalez MV. 2020. <em>Neuroinflammation and Eif2 Signaling Persist Despite Antiretroviral Treatment in an hiPSC Tri-Culture Model of HIV Infection</em>. <em>#SStem Cell Reports</em>. Vol. 14(4). <a href="https://doi: 10.1016/j.stemcr.2020.02.010">doi: 10.1016/j.stemcr.2020.02.010</a>.
</div>
<div id="ref-Yang" class="csl-entry">
Yang XL, Peng BW, Wang X. 2018. <em>Nfat5 Has a Job in the Brain</em>. <em>Dev Neurosci</em>. Vol. 40(4). <a href="https://doi: 10.1159/000493789">doi: 10.1159/000493789</a>.
</div>
</div>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()
R version 4.0.2 (2020-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /usr/lib64/libopenblasp-r0.3.3.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] parallel  grid      stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] readxl_1.3.1         multtest_2.46.0      Biobase_2.50.0      
 [4] BiocGenerics_0.36.1  metap_1.6            knitr_1.30          
 [7] rstatix_0.6.0        corrplot_0.92        gridExtra_2.3       
[10] ggpubr_0.4.0         circlize_0.4.13      ComplexHeatmap_2.9.4
[13] ggcorrplot_0.1.3     pheatmap_1.0.12      RColorBrewer_1.1-2  
[16] ggrepel_0.9.1        data.table_1.14.2    Matrix_1.3-4        
[19] edgeR_3.32.0         limma_3.46.0         SeuratObject_4.0.3  
[22] Seurat_4.0.5         forcats_0.5.0        stringr_1.4.0       
[25] dplyr_1.0.7          purrr_0.3.4          readr_1.4.0         
[28] tidyr_1.1.2          tibble_3.1.6         ggplot2_3.3.5       
[31] tidyverse_1.3.0      workflowr_1.6.2     

loaded via a namespace (and not attached):
  [1] utf8_1.2.2            reticulate_1.22       tidyselect_1.1.1     
  [4] htmlwidgets_1.5.4     Rtsne_0.15            munsell_0.5.0        
  [7] mutoss_0.1-12         codetools_0.2-18      ica_1.0-2            
 [10] future_1.23.0         miniUI_0.1.1.1        withr_2.4.3          
 [13] colorspace_2.0-2      highr_0.8             rstudioapi_0.13      
 [16] stats4_4.0.2          ROCR_1.0-11           ggsignif_0.6.0       
 [19] tensor_1.5            listenv_0.8.0         labeling_0.4.2       
 [22] Rdpack_2.1.2          git2r_0.27.1          mnormt_2.0.2         
 [25] polyclip_1.10-0       farver_2.1.0          rprojroot_2.0.2      
 [28] TH.data_1.0-10        parallelly_1.29.0     vctrs_0.3.8          
 [31] generics_0.1.1        xfun_0.29             R6_2.5.1             
 [34] doParallel_1.0.16     clue_0.3-60           locfit_1.5-9.4       
 [37] reshape_0.8.8         spatstat.utils_2.2-0  assertthat_0.2.1     
 [40] promises_1.2.0.1      scales_1.1.1          multcomp_1.4-15      
 [43] gtable_0.3.0          globals_0.14.0        goftest_1.2-3        
 [46] sandwich_3.0-0        rlang_0.4.12          GlobalOptions_0.1.2  
 [49] splines_4.0.2         lazyeval_0.2.2        spatstat.geom_2.3-0  
 [52] broom_0.7.2           yaml_2.2.1            reshape2_1.4.4       
 [55] abind_1.4-5           modelr_0.1.8          backports_1.2.0      
 [58] httpuv_1.6.3          tools_4.0.2           ellipsis_0.3.2       
 [61] spatstat.core_2.3-1   ggridges_0.5.2        TFisher_0.2.0        
 [64] Rcpp_1.0.7            plyr_1.8.6            rpart_4.1-15         
 [67] deldir_1.0-6          pbapply_1.5-0         GetoptLong_1.0.5     
 [70] cowplot_1.1.1         S4Vectors_0.28.1      zoo_1.8-9            
 [73] haven_2.3.1           cluster_2.1.0         fs_1.5.1             
 [76] magrittr_2.0.1        magick_2.5.2          scattermore_0.7      
 [79] openxlsx_4.2.3        lmtest_0.9-39         reprex_0.3.0         
 [82] RANN_2.6.1            tmvnsim_1.0-2         mvtnorm_1.1-1        
 [85] whisker_0.4           fitdistrplus_1.1-6    matrixStats_0.61.0   
 [88] hms_1.1.1             patchwork_1.1.1       mime_0.12            
 [91] evaluate_0.14         xtable_1.8-4          rio_0.5.16           
 [94] IRanges_2.24.1        shape_1.4.6           compiler_4.0.2       
 [97] KernSmooth_2.23-18    crayon_1.4.2          htmltools_0.5.2      
[100] mgcv_1.8-33           later_1.3.0           lubridate_1.7.9.2    
[103] DBI_1.1.1             dbplyr_2.0.0          MASS_7.3-53          
[106] car_3.0-10            cli_3.1.0             rbibutils_2.2.4      
[109] igraph_1.2.9          pkgconfig_2.0.3       sn_2.0.1             
[112] numDeriv_2016.8-1.1   foreign_0.8-80        plotly_4.9.2.1       
[115] spatstat.sparse_2.0-0 xml2_1.3.2            foreach_1.5.1        
[118] rvest_0.3.6           digest_0.6.29         sctransform_0.3.2    
[121] RcppAnnoy_0.0.19      spatstat.data_2.1-0   rmarkdown_2.6        
[124] cellranger_1.1.0      leiden_0.3.5          uwot_0.1.10          
[127] curl_4.3.2            shiny_1.7.1           rjson_0.2.20         
[130] lifecycle_1.0.1       nlme_3.1-150          jsonlite_1.7.2       
[133] carData_3.0-4         viridisLite_0.4.0     fansi_0.5.0          
[136] pillar_1.6.4          GGally_2.0.0          lattice_0.20-41      
[139] plotrix_3.8-2         fastmap_1.1.0         httr_1.4.2           
[142] survival_3.2-7        glue_1.6.0            zip_2.1.1            
[145] png_0.1-7             iterators_1.0.13      stringi_1.7.6        
[148] mathjaxr_1.4-0        irlba_2.3.3           future.apply_1.8.1   </code></pre>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiVHJhbnNjcmlwdGlvbiBmYWN0b3IgYWN0aXZpdHkgaW4gaU1nIgphdXRob3I6ICJLYXRoYXJpbmEgTWlrdWxpayIKb3V0cHV0OiBodG1sX2RvY3VtZW50CmJpYmxpb2dyYXBoeTogcmVmZXJlbmNlcy5iaWIKbGluay1jaXRhdGlvbnM6IHllcwotLS0KCjxzdHlsZT4KYm9keSB7CnRleHQtYWxpZ246IGp1c3RpZnl9Cjwvc3R5bGU+CgpgYGB7ciBzZXR1cCwgaW5jbHVkZSA9IEZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoY2FjaGUgPSBGQUxTRSwgYXV0b2RlcCA9IFRSVUUsIAogICAgICAgICAgICAgICAgICAgICAgY29sbGFwc2UgPSBUUlVFLCBtZXNzYWdlID0gRkFMU0UpCgpgYGAKCgpgYGB7cn0KbGlicmFyeSh0aWR5dmVyc2UpCmxpYnJhcnkoU2V1cmF0KQpsaWJyYXJ5KGVkZ2VSKQpsaWJyYXJ5KE1hdHJpeCkKbGlicmFyeShkYXRhLnRhYmxlKQpsaWJyYXJ5KGdncGxvdDIpCmxpYnJhcnkoZHBseXIpCmxpYnJhcnkoZ2dyZXBlbCkKI2xpYnJhcnkoaGFybW9ueSkKbGlicmFyeShSQ29sb3JCcmV3ZXIpCmxpYnJhcnkocGhlYXRtYXApCmxpYnJhcnkoZ2djb3JycGxvdCkKbGlicmFyeShDb21wbGV4SGVhdG1hcCkKbGlicmFyeShjaXJjbGl6ZSkKbGlicmFyeShnZ3B1YnIpCmxpYnJhcnkoZ3JpZEV4dHJhKQpsaWJyYXJ5KGNvcnJwbG90KQpsaWJyYXJ5KHJzdGF0aXgpCmxpYnJhcnkoa25pdHIpCmxpYnJhcnkobWV0YXApCmxpYnJhcnkobXVsdHRlc3QpCmxpYnJhcnkocmVhZHhsKQpgYGAKCiMgR1JOIGluZmVyZW5jZSB3aXRoIFNDRU5JQwoKVG8gaW5mZXIgR1JOcyBmcm9tIGlNZyBjZWxscyBvZiB0aGUgdHJpY3VsdHVyZSBkYXRhIHNldCBbQFJ5YW5dICg0MzMzIGNlbGxzIGluIAp0b3RhbCkgU0NFTklDIHdhcyB1c2VkIGFzIGJlZm9yZS4gV2hlbiByZWZlcnJpbmcgdG8gZGlmZmVyZW50aWFsbHkgYm91bmQgVEZzIGluIHRoZSBDMjAgY2VsbCBsaW5lIGluIHRoZSBmb2xsb3dpbmcgSSBhbSByZWZlcnJpbmcgdG8gZGlmZmVyZW50aWFsIGJpbmRpbmcgc2NvcmVzIGJldHdlZW4gaW5mZWN0aW9uIGNvbmRpdGlvbnMgCm9idGFpbmVkIGZyb20gYnVsayBBVEFDc2VxIGRhdGEgZnJvbSBDMjAgY2VsbCBsaW5lIGN1bHR1cmVzIHVzaW5nIFRPQklBUy4KCkZpcnN0IFNDRU5JQyB3YXMgcnVuIHdpdGggMzAwMCBtb3N0IGhpZ2hseSB2YXJpYWJsZSBnZW5lcyAoSFZHKSwgYnV0IHRoZW4Kb25seSBlaWdodCBvZiB0aGUgVEZzIG92ZXJsYXBwZWQgd2l0aCB0aGUgZGlmZmVyZW50aWFsbHkgYm91bmQgVEZzLiBVc2luZyAxMCwwMDAKSFZHIFNDRU5JQyByZXR1cm5lZCAyMzIgVEZTIGFuZCB0aGVpciBjb3JyZXNwb25kaW5nIGFjdGl2aXR5IHNjb3JlcyBmb3IgZWFjaCBjZWxsLgpPZiB0aGVzZSAyMzIgVEZzIDI1IG92ZXJsYXAgd2l0aCBkaWZmZXJlbnRpYWxseSBib3VuZCBURnMgaW4gdGhlIEMyMCBjZWxsIGxpbmUuCgpgYGB7cn0KIyByZWFkIGluIHRyaWN1bHR1cmUgU2V1cmF0IG9iamVjdAp0cmljdWx0dXJlIDwtIHJlYWRSRFMoIi9tZWRpYS9hZy1jaGVycm1hbm4va21pa3VsaWsvSElWX21pY3JvZ2xpYS9zcmMvVHJpY3VsdHVyZV9kYXRhc2V0X1J5YW5fcGFwZXIvdHJpY3VsdHVyZV9jbGVhbl9zZXVyYXRfb2JqZWN0IikKCiMgcmVhZCBpbiBDU0YgSElWIFNldXJhdCBvYmplY3QKaGl2NyA8LSByZWFkUkRTKCIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL1JlcHJvZHVjZV9GYXJoYWRpYW5fUGFwZXIvU2V1cmF0X29iamVjdHMvdG90YWxfN19zYW1wbGVzX2xhYmVsX3RyYW5zZmVyLnJkcyIpCgppbWljcm9nbGlhIDwtIHN1YnNldCh0cmljdWx0dXJlLCBjZWxsX3R5cGUgPT0gImlNZyIpCgpgYGAKCgo8ZGV0YWlscz4KPHN1bW1hcnk+KipQcmVwYXJpbmcgZXhwcmVzc2lvbiBtYXRyaXggZm9yIFNDRU5JQyoqPC9zdW1tYXJ5PgoKRmlyc3QsIFNDVHJhbnNmb3JtIHdhcyB1c2VkIGZvciBub3JtYWxpemF0aW9uIG9mIHRoZSBleHByZXNzaW9uIGRhdGEsIHRoZW4KdGhlIHRvcCAxMCwwMDAgSFZHcyBhcmUgc2VsZWN0ZWQgYW5kIHRoZSBtYXRyaXggdHJhbnNwb3NlZCwgYmVjYXVzZSB0aGUgcHlTQ0VOSUMKcGlwZWxpbmUgcmVxdWlyZXMgYW4gaW5wdXQgbWF0cml4IHdoaWNoIGhhcyBnZW5lcyBhcyBjb2x1bW5zIGFuZCBjZWxscyAKYXMgcm93cy4KIChodHRwczovL2dpdGh1Yi5jb20vaGRzdS1iaW9xdWFudC9weVNDRU5JQ19waXBlbGluZS9ibG9iL21hc3Rlci9pbnB1dC9nZW5lX2V4cF9tdHhfZXhhbXBsZS50c3YpCgpgYGAKIyB1c2UgMTAgMDAwIG1vc3QgaGlnaGx5IHZhcmlhYmxlIGdlbmVzCnNjZW5pYyA8LSBTQ1RyYW5zZm9ybShpbWljcm9nbGlhLCB2YXJpYWJsZS5mZWF0dXJlcy5uID0gMTAwMDAsIHZlcmJvc2U9RkFMU0UpCnNhdmVSRFMoc2NlbmljLCAiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9UcmljdWx0dXJlX2RhdGFzZXRfUnlhbl9wYXBlci90cmljdWx0dXJlX3NjZW5pYyIpCnNjZW5pYyA8LSByZWFkUkRTKCIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL1RyaWN1bHR1cmVfZGF0YXNldF9SeWFuX3BhcGVyL3RyaWN1bHR1cmVfc2NlbmljIikKc2NlbmljX2h2ZyA8LSBzdWJzZXQoc2NlbmljLCBmZWF0dXJlcyA9IHNjZW5pY0Bhc3NheXMkU0NUQHZhci5mZWF0dXJlcykKc2NlbmljX210eCA8LSB0KHNjZW5pY19odmdAYXNzYXlzJFNDVEBzY2FsZS5kYXRhKQp3cml0ZS50YWJsZSh4ID0gc2NlbmljX210eCwgZmlsZSA9ICIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL3B5U0NFTklDX3BpcGVsaW5lL2lucHV0L3RyaWN1bHR1cmVfbXR4LnRzdiIsIHNlcCA9ICJcdCIpCgojc2NlbmljX21hdHJpeCA8LSByZWFkLnRhYmxlKGZpbGUgPSAiL21lZGlhL2FnLWNoZXJybWFubi9rbWlrdWxpay9ISVZfbWljcm9nbGlhL3NyYy9weVNDRU5JQ19waXBlbGluZS9pbnB1dC90cmljdWx0dXJlX210eC50c3YiLCBzZXAgPSAiXHQiKQpgYGAKLS0tCjwvZGV0YWlscz4KCgo8ZGV0YWlscz4KPHN1bW1hcnk+KipBdUNlbGwgbWF0cml4IC0gb3V0cHV0IGZyb20gU2NlbmljKio8L3N1bW1hcnk+CgpUaGUgb3V0cHV0IGZyb20gU0NFTklDIGlzIGEgbWF0cml4IGNvbnRhaW5pbmcgY2VsbHMgYXMgcm93cyBhbmQgMjMyIFRGcwphcyBjb2x1bW5zLiBGaXZlIGV4ZW1wbGFyeSByb3dzIGFuZCBjb2x1bW5zIGFyZSBzaG93biBiZWxvdy4gVGhlIFRGIGFjdGl2aXR5IGZvciBlYWNoIGNlbGwgY2FuIGJlIHVzZWQgdG8gZHJhdyBjb25jbHVzaW9ucwphYm91dCBkaWZmZXJlbnQgY2VsbCBzdGF0ZXMuIAoKCmBgYHtyfQphdWNfbXR4IDwtIHJlYWQuY3N2KCIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvc3JjL1RyaWN1bHR1cmVfZGF0YXNldF9SeWFuX3BhcGVyL3B5U0NFTklDX291dHB1dC9hdWNlbGxfaW1nXzEway5jc3YiKQphdWNfbXR4IDwtIGF1Y19tdHggJT4lIGNvbHVtbl90b19yb3duYW1lcygiQ2VsbCIpCmF1Y19tdHggPC0gYXVjX210eCAlPiUgc2V0bmFtZXMoIG9sZCA9IGNvbG5hbWVzKGF1Y19tdHgpLCBuZXcgPSBzYXBwbHkoc3Ryc3BsaXQoCiAgY29sbmFtZXMoYXVjX210eCksICJbLi4uXSIpLCBgW2AsIDEpKQoKYXVjX210eFsxOjUsIDE6NV0gJT4lIGthYmxlKGNhcHRpb24gPSAiTGF5b3V0IG9mIFRGIGFjdGl2aXR5IG1hdHJpeCIpCmBgYAoKLS0tCjwvZGV0YWlscz4KCjxkZXRhaWxzPgo8c3VtbWFyeT4qKk51bWJlciBvZiBpTWcgaW4gZWFjaCBjb25kaXRpb24qKjwvc3VtbWFyeT4KCgpgYGB7cn0KIyBhZGQgYXVjIG1hdHJpeCB0byBtZXRhZGF0YSBvZiBoaXY0IHNldXJhdCBvYmplY3QKdHJpX21nIDwtIEFkZE1ldGFEYXRhKGltaWNyb2dsaWEsIAogICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhID0gYXVjX210eCwgCiAgICAgICAgICAgICAgICAgICAgY29sLm5hbWUgPSBjb2xuYW1lcyhhdWNfbXR4KSkKCmBgYAoKCmBgYHtyLCByZXN1bHRzID0gImFzaXMifQp0cmlfbWdAbWV0YS5kYXRhICU+JSAKICByZW5hbWUoY29uZGl0aW9uICA9IG9yaWcuaWRlbnQpICU+JQogIGdyb3VwX2J5KGNvbmRpdGlvbikgJT4lCiAgc3VtbWFyaXplKG4gPSBuKCkpICU+JSAKICBrYWJsZShjYXB0aW9uID0gIk51bWJlciBvZiBjZWxscyBpbiBlYWNoIGNvbmRpdGlvbiIpCmBgYAoKLS0tCjwvZGV0YWlscz4KCgojIEJ1bGsgQVRBQ3NlcSBmb290cHJpbnRpbmcKClRoZSBDMjAgY2VsbCBsaW5lIHdhcyBkZXJpdmVkIGZyb20gCmFuIEhJVisgcGF0aWVudCAgdHJlYXRlZCB3aXRoIEFSVCAoQW50aXJldHJvdmlyYWwgVGhlcmFweSkuIFNpbmNlIHRoZSBhY2Nlc3MgCm9mIEFSVCB0byB0aGUgYnJhaW4gaXMgbGltaXRlZCBkdWUgdG8gdGhlIGJsb29kLWJyYWluIGJhcnJpZXIsIHRoZSBlZmZlY3RzIG9mIApBUlQgb24gdGhlc2UgY2VsbHMgYXJlIHByb2JhYmx5IG5lZ2xpZ2libGUuIE9ubHkgdGhlIDc1IFRGcyB3aXRoIHAtdmFsdWVzIGZvciBkaWZmZXJlbnRpYWwgYmluZGluZyBzY29yZXMgYmVsb3cgMWUtNTAgd2VyZSB1c2VkLiBXZSB3aWxsIGZvY3VzIG9uIFRGcyB3aGljaCBzaG93IGRpZmZlcmVudGlhbCBiaW5kaW5nIHNjb3JlcyBiZXR3ZWVuIGxhdGVudAppbmZlY3Rpb24gYW5kIHVuaW5mZWN0ZWQgY29uZGl0aW9ucyBpbiB0aGUgQzIwIGNlbGwgbGluZS4gRm9yIDI1IG9mIHRoZXNlIDc1IFRGcyB0aGVyZSBpcyBhIFRGIGFjdGl2aXR5IHNjb3JlIGZvciB0aGUgaU1nLiBGb2N1c2luZyBvbiB0aGVzZSAyNSBURnMgd2UgbWlnaHQgYmUgYWJsZSB0byBmaW5kIGFjdGl2aXR5IHBhdHRlcm5zIHRoYXQgCmNvcnJlbGF0ZSB3aXRoIHRoZSBURiBiaW5kaW5nIHNjb3Jlcy4gRml2ZSBURnMgYXJlIG1vcmUgYm91bmQgaW4gbGF0ZW50IGluZmVjdGlvbgphbmQgdHdlbnR5IFRGcyBhcmUgbW9yZSBib3VuZCBpbiB1bmluZmVjdGVkIGNlbGxzLiBUaGUgcmVhc29uIHdoeSB3ZSBmaW5kIG1vcmUgb2YgdGhlIFRGcyBtb3JlIGJvdW5kIGluIHVuaW5mZWN0ZWQgY2VsbHMgCmluIHRoZSBURiBhY3Rpdml0eSBzY29yZSBtYXRyaXggZnJvbSBTQ0VOSUMgaXMgdW5jbGVhci4KCmBgYHtyfQp0ZnNfYW5hIDwtIHJlYWQudGFibGUoIi9tZWRpYS9hZy1jaGVycm1hbm4vcHJvamVjdHMvMDZfSElWX01pY3JvZ2xpYS9kYXRhL2F0YWNzZXEvZGF0YS0yMDIwLTExLTA2L3RvYmlhcy9UT0JJQVNfc25ha2VtYWtlL2Zvb3RwcmludF9tZ2xpYTJfR2xhc3NURl8xNy0wMy9URkJTL2JpbmRldGVjdF9yZXN1bHRzLnR4dCIsIHNlcCA9ICJcdCIsIGhlYWRlciA9IFRSVUUpCgp0b3BfdGZzIDwtIHRmc19hbmEgJT4lIGZpbHRlcih1bmluZl9yZWRfcHZhbHVlIDwgMWUtNTApCgojIGtlZXAgb25seSB0aGUgVEZzIGluIHRoZSBkYXRhZnJhbWUgd2hpY2ggb3ZlcmxhcCBiZXR3ZWVuIHRoZSB0d28gZGF0YXNldHMuCm92ZXJsYXBfYXRhYyA8LSB0b3BfdGZzICU+JSBmaWx0ZXIobmFtZSAlaW4lIGNvbG5hbWVzKGF1Y19tdHgpKQoKIyBkYXRhZnJhbWUgY29udGFpbmluZyBvbmx5IHRoZSAyNSBUZnMgd2hjaWggb3ZlcmxhcCB3aXRoIFRGIGFjdGl2aXR5IG1hdHJpeCBmcm9tIFNDRU5JQyAKIyBhZGRpbmcgYSBjb2x1bW4gd2l0aCBpbmZvcm1hdGlvbiBpbiB3aGljaCBpbmZlY3Rpb24gY29uZGl0aW9uIHRoZSBURiBpcyBtb3JlIGJvdW5kCmF0YWNfdGZzX2RmIDwtIHRvcF90ZnMgJT4lIGZpbHRlcihuYW1lICVpbiUgY29sbmFtZXMoYXVjX210eCkpICU+JSAKICBtdXRhdGUoY29uZGl0aW9uID0gaWZlbHNlKHVuaW5mX3JlZF9jaGFuZ2UgPiAwLCAidXBfdW5pbmYiLCAidXBfbGF0ZW50IikpCgojIExpc3Qgb2YgNSBURnMgbW9yZSBib3VuZCBpbiBsYXRlbnQgaW5mZWN0aW9uCnVwX2xhdGVudCA8LSBhdGFjX3Rmc19kZiRuYW1lW2F0YWNfdGZzX2RmJGNvbmRpdGlvbiA9PSAidXBfbGF0ZW50Il0KIyBsaXN0IG9mIDI1IFRGcyBtb3JlIGJvdW5kIGluIHVuaW5mZWN0ZWQgY2VsbHMKdXBfdW5pbmYgPC0gYXRhY190ZnNfZGYkbmFtZVthdGFjX3Rmc19kZiRjb25kaXRpb24gPT0gInVwX3VuaW5mIl0KYGBgCgo8ZGV0YWlscz4KPHN1bW1hcnk+KipWb2xjYW5vIFBsb3QgQVRBQy1zZXEgZm9vdHByaW50aW5nKio8L3N1bW1hcnk+CgpgYGB7ciwgZmlnLmhlaWdodD04LCBmaWcud2lkdGg9MTJ9CnRvcF90ZnMgJT4lIAogICMgYWRkIGEgY29sdW1uIGNvbnRhaW5pbmcgaW5mb3JtYXRpb24gaW4gd2hpY2ggY29uZGl0aW9uIHRoZSBjb3JyZXNwb25kaW5nIFRGIAogICMgaXMgdXByZWd1bGF0ZWQKICBtdXRhdGUoY29uZGl0aW9uID0gaWZlbHNlKHVuaW5mX3JlZF9jaGFuZ2UgPCAwLCAidXBfbGF0ZW50IiwgInVwX3VuaW5mIikpICU+JQogICMgYWRkIGEgY29sdW1uIGNvbmFpbmluZyB0aGUgbGFiZWxzIGZvciB0aGUgcGxvdAogICMgSSBvbmx5IHdhbnQgdG8gbGFiZWwgY2VsbHMgd2hpY2ggYXJlIGFsc28gZm91bmQgYnkgU2NlbmljCiAgbXV0YXRlKGxhYmVsID0gaWZlbHNlKG5hbWUgJWluJSBvdmVybGFwX2F0YWMkbmFtZSwgbmFtZSwgTkEpKSAlPiUgCiAgZ2dwbG90KGFlcyh4ID0gdW5pbmZfcmVkX2NoYW5nZSwKICAgICAgICAgICAgIHkgPSAtbG9nMTAodW5pbmZfcmVkX3B2YWx1ZSksCiAgICAgICAgICAgICBjb2wgPSBjb25kaXRpb24sIAogICAgICAgICAgICAgbGFiZWwgPSBsYWJlbCkpICsKICBnZW9tX3BvaW50KCkgKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IC1sb2cxMCgxZS01MCksIGNvbCA9ICJyZWQiKSArCiAgZ2VvbV90ZXh0KG51ZGdlX3ggPSAuMDUsIG51ZGdlX3kgPSAyKSArCiAgbGFicyh0aXRsZSA9ICJURnMgd2l0aCBkaWZmZXJlbnRpYWwgYmluZGluZyBzY29yZXMiKSArCiAgeWxhYigiLWxvZzEwKHBfdmFsdWUpIikgKwogIHhsYWIoImRpZmZlcmVudGlhbCBiaW5kaW5nIHNjb3JlIikKCmBgYAoKLS0tCjwvZGV0YWlscz4KCiMgVEYgYWN0aXZpdHkgaW4gaU1nIAoKSW4gdGhlIGhlYXRtYXAgb2YgVEYgYWN0aXZpdGllcyBiZWxvdyB5b3UgY2FuIGFscmVhZHkgc2VlIGEgdHJlbmQgdG93YXJkcyBhIHNlcGFyYXRpb24gb2YgCmNlbGxzIHRyZWF0ZWQgd2l0aCBFRlogKGJsdWUgYW5kIGdyZWVuKSBmcm9tIHVudHJlYXRlZCBjZWxscyAocmVkIGFuZCBvcmFuZ2UpLiBJdAp3aWxsIGJlIGludGVyZXN0aW5nIHRvIHNlZSBpZiBhbiBhY3Rpdml0eSBwYXR0ZXJuIHJlc2VtYmxpbmcgdGhlIGRpZmZlcmVudGlhbApiaW5kaW5nIHNjb3JlIHBhdHRlcm4gZnJvbSB0aGUgQzIwIGNlbGwgbGluZSBmb290cHJpbnRpbmcgY2FuIGJlIGZvdW5kLiBGb3IgdGhpcwp3ZSB3aWxsIGZvY3VzIG9uIHRoZSAyNSBURnMgd2hpY2ggYXJlIGZvdW5kIGluIHRoZSBDMjAgY2VsbCBsaW5lIGFuZCB0aGUgCnRyaWN1bHR1cmUgZGF0YSBzZXQgcmVzcGVjdGl2ZWx5LgoKCjxkZXRhaWxzPgo8c3VtbWFyeT4qKkhlYXRtYXAgb2YgMjMyIFRGcyBhbmQgdGhlaXIgYWN0aXZpdHkgaW4gaU1nKio8L3N1bW1hcnk+CgoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0yNX0KY29uZGl0aW9ucyA8LSB0cmlfbWdAbWV0YS5kYXRhICU+JQogICAgICAgICAgICAgICAgICAgIHJvd25hbWVzX3RvX2NvbHVtbigiY2VsbCIpICU+JQogICAgICAgICAgICAgICAgICAgIHNlbGVjdCgiY2VsbCIsICJvcmlnLmlkZW50IiklPiUgY29sdW1uX3RvX3Jvd25hbWVzKCJjZWxsIikKCgpodCA8LSBIZWF0bWFwKHQoYXVjX210eCksIAogICAgICBjb2wgPSAgY29sb3JSYW1wUGFsZXR0ZShyZXYoYnJld2VyLnBhbChuID0gNywgbmFtZSA9ICJSZFlsQnUiKSkpKDEwMCksCiAgICAgIHNob3dfY29sdW1uX25hbWVzID0gRkFMU0UsCiAgICAgIHJvd19uYW1lc19zaWRlID0gImxlZnQiLAogICAgICB0b3BfYW5ub3RhdGlvbiA9IEhlYXRtYXBBbm5vdGF0aW9uKGNvbmRpdGlvbiA9IGNvbmRpdGlvbnMkb3JpZy5pZGVudCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJjb25kaXRpb24iLCBjb2wgPSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChjb25kaXRpb24gPSBjKCJVbmluZiIgPSAib3JhbmdlIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbmYrRUZaIiA9ICJncmVlbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbmYiID0gInJlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVbmluZitFRloiID0gImJsdWUiKSkpCikKaHQKYGBgCgotLS0KPC9kZXRhaWxzPgoKCiMjIyBLLW1lYW5zIGNsdXN0ZXJpbmcgd2l0aCBkaWZmZXJlbnQgayB7LnRhYnNldH0KClVzaW5nIGstbWVhbnMgY2x1c3RlcmluZyB3ZSBtaWdodCBiZSBhYmxlIHRvIGlkZW50aWZ5IGNsdXN0ZXJzIHdpdGggY2VydGFpbgpwYXR0ZXJucyBvZiBURiBhY3Rpdml0eS4gSnVkZ2luZyBmcm9tIHRoZSBkaWZmZXJlbnQgaGVhdG1hcHMgc2hvd24gYmVsbywKayA9IDQgbWlnaHQgYmUgdGhlIG1vc3QgaW5mb3JtYXRpdmUsIHNpbmNlIGZvciBrID0gNSB0aGVyZSBpcyBvbmx5IG9uZSBURiAoTkhMSDEpIGRpZmZlcmVudGlhdGluZyBhbiBhZGRpdGlvbmFsIGNsdXN0ZXIuIFRoZSBwbG90IG9mIHdpdGhpbi1jbHVzdGVycyBzdW0gb2Ygc3F1YXJlcyBzaG91bGQgaGVscCB0byBwaWNrIHRoZSBiZXN0IG51bWJlciBvZiBjbHVzdGVycywgaG93ZXZlciBhcyBjYW4gYmUgc2VlbiBiZWxvdyB0aGVyZSBpcyBubyBvYnZpb3VzIGtpbmsgaW4gdGhlIGN1cnZlLgoKSy1tZWFucyBjbHVzdGVyaW5nIHdpdGggayA9IDIgc2VlbXMgdG8gc3BsaXQgdGhlIGNlbGxzIGludG8gdHJlYXRlZCB2cy4gCnVudHJlYXRlZCBjZWxscy4gVGhlc2UgdHdvIGNsdXN0ZXJzIGhhdmUgYSB2ZXJ5IGV2aWRlbnQgYmlvbG9naWNhbCBtZWFuaW5nLgpVc2luZyBrID0gMyBvciBrID0gNCBrZWVwcyB0aGVzZSB0d28gYmlvbG9naWNhbGx5IApyZWxldmFudCBncm91cHMgc2VwYXJhdGUsIGJ1dCBhbHNvIGNyZWF0ZXMgYWRkaXRpb25hbCBjbHVzdGVycyB3aGljaCBzZWVtIHRvIGJlCmEgbWl4dHVyZSBvZiB0cmVhdGVkIGFuZCB1bnRyZWF0ZWQgY2VsbHMuIEhhdmluZyBhIGNsb3NlciBsb29rIGF0IGNsdXN0ZXJzIGZyb20KayA9IDQgbWlnaHQgZ2l2ZSBzb20gYWRkaXRpb25hbCBiaW9sb2dpY2FsIGluc2lnaHRzLgoKSGF2aW5nIGEgY2xvc2VyIGxvb2sgYXQgdGhlIGZvdXIgY2x1c3RlcnMsIGl0IGJlY29tZXMgZXZpZGVudCB0aGF0IHRoZSB0d28gbGVmdAptb3N0IGNsdXN0ZXJzIHNlcGFyYXRlIHRyZWF0ZWQgY2VsbHMgZnJvbSB1bnRyZWF0ZWQgY2VsbHMsIGluZGVwZW5kZW50IG9mIHRoZSAKaW5mZWN0aW9uIGNvbmRpdGlvbi4gVGhlcmUgYXJlIG1vcmUgSW5mK0VGWiB0aGFuIFVuaW5mK0VGWiBpbiB0aGUgZmlyc3QgY2x1c3RlciwKaG93ZXZlciB0aGlzIGlzIGluIGxpbmUgd2l0aCB0aGUgbG93ZXIgY2VsbCBudW1iZXIgb2YgVW5pbmYrRUZaICg3MjIgY2VsbHMpIApjb21wYXJlZCB0byBJbmYrRUZaICgxMzgyIGNlbGxzKS4KClR3byBURnMgc2VlbSB0byBiZSBtb3JlIGFjdGl2ZSBpbiBJbmYrRUZaIGFuZCBVbmluZitFRlogY29tcGFyZWQgdG8gSW5mIGFuZCAKVW5pbmYsIG5hbWVseSBSVU5YMyBhbmQgSlVOQi4gQW5vdGhlciB0aHJlZSBURnMgc2VlbSB0byBiZSBtb3JlIGFjdGl2ZSBpbiBJbmYgCmFuZCBVbmluZiBjb21wYXJlZCB0byBJbmYrRUZaIGFuZCBVbmluZitFRlosIG5hbWVseSBORkFUNSwgVENGN0wyIGFuZCBDRUJQQi4gClRDRjQgZGlzdGluZ3Vpc2hlcyBhIHRoaXJkIGNsdXN0ZXIuIElzIHRoZXJlIGEgYmlvbG9naWNhbCBtZWFuaW5nIGJlaGluZCB0aGF0PyAKQ2FuIHRoZXNlIFRGcyBiZSBhc3NvY2lhdGVkIHdpdGggYSBwYXJ0aWN1bGFyIGNvbmRpdGlvbj8KCgojIyMjIERpZmZlcmVudCBrCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTEwfQoKaHRfbGlzdCA8LSBtYXAoc2VxLmludCgyLDYpLCBmdW5jdGlvbihuKXsKICBodCA8LSBIZWF0bWFwKHQoYXVjX210eFssIGF0YWNfdGZzX2RmJG5hbWVdKSwgCiAgICAgICAgY29sID0gIGNvbG9yUmFtcFBhbGV0dGUocmV2KGJyZXdlci5wYWwobiA9IDcsIG5hbWUgPSAiUmRZbEJ1IikpKSgxMDApLAogICAgICAgIGNvbHVtbl90aXRsZSA9IHBhc3RlMCgiayA9ICIsIG4pLAogICAgICAgIHNob3dfY29sdW1uX25hbWVzID0gRkFMU0UsCiAgICAgICAgcm93X25hbWVzX3NpZGUgPSAibGVmdCIsCiAgICAgICAgdG9wX2Fubm90YXRpb24gPSBIZWF0bWFwQW5ub3RhdGlvbihjb25kaXRpb24gPSBjb25kaXRpb25zJG9yaWcuaWRlbnQsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJjb25kaXRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sID0gbGlzdChjb25kaXRpb24gPSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjKCJVbmluZiIgPSAib3JhbmdlIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW5mK0VGWiIgPSAiZ3JlZW4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkluZiIgPSAicmVkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVW5pbmYrRUZaIiA9ICJibHVlIikpKSwKICAgICAgICBjb2x1bW5fa20gPSBuLAogICAgICAgICApCiAgCn0pCgpodF9saXN0IDwtIGh0X2xpc3RbWzFdXSArIGh0X2xpc3RbWzJdXSArIGh0X2xpc3RbWzNdXSArIGh0X2xpc3RbWzRdXSArIGh0X2xpc3RbWzVdXQpkcmF3KGh0X2xpc3QsIGNvbHVtbl90aXRsZSA9ICJLLW1lYW5zIGNsdXN0ZXJpbmcgd2l0aCBkaWZmZXJlbnQgayIsIGh0X2dhcCA9IHVuaXQoMiwgImNtIikpCmBgYAoKCiMjIyMgayA9IDQKCmBgYHtyLCBmaWcud2lkdGggPSAxNSwgZmlnLmhlaWdodD0xMH0KaHQgPC0gZHJhdyhIZWF0bWFwKHQoYXVjX210eFssIGF0YWNfdGZzX2RmJG5hbWVdKSwgCiAgICAgIGNvbCA9ICBjb2xvclJhbXBQYWxldHRlKHJldihicmV3ZXIucGFsKG4gPSA3LCBuYW1lID0gIlJkWWxCdSIpKSkoMTAwKSwKICAgICAgY29sdW1uX3RpdGxlID0gIkstbWVhbnMgY2x1c3RlcmluZyB3aXRoIGsgPSA0IiwKICAgICAgc2hvd19jb2x1bW5fbmFtZXMgPSBGQUxTRSwKICAgICAgcm93X25hbWVzX3NpZGUgPSAibGVmdCIsCiAgICAgIHRvcF9hbm5vdGF0aW9uID0gSGVhdG1hcEFubm90YXRpb24oY29uZGl0aW9uID0gY29uZGl0aW9ucyRvcmlnLmlkZW50LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gImNvbmRpdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sID0gbGlzdChjb25kaXRpb24gPSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYygiVW5pbmYiID0gIm9yYW5nZSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbmYrRUZaIiA9ICJncmVlbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkluZiIgPSAicmVkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlVuaW5mK0VGWiIgPSAiYmx1ZSIpKSksCiAgICAgIGNvbHVtbl9rbSA9IDQsCiAgICAgICApKQpgYGAKCiMjIyMgV1NTIHBsb3QKCmBgYHtyfQpkZiA8LSBoaXY3QG1ldGEuZGF0YSAlPiUgZmlsdGVyKGNlbGxfdHlwZSA9PSAiTXllbG9pZDIiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZy5pZGVudCA9PSAiSElWMV9DU0YiKQptdHggPC0gYXVjX210eFssIGF0YWNfdGZzX2RmJG5hbWVdCgojIERlY2lkZSBvbiBhIGsgZm9yIGNsdXN0ZXJpbmcKd3NzID0gc2FwcGx5KDI6MTUsIGZ1bmN0aW9uKGspIHsKICBrbWVhbnMoeCA9IHQobXR4KSwgY2VudGVycyA9IGspJHRvdC53aXRoaW5zcwp9KQoKcGxvdCgyOjE1LCB3c3MsIHR5cGUgPSAiYiIsIAogICAgIHhsYWIgPSAiTnVtYmVyIG9mIGNsdXN0ZXJzIGsiLCAKICAgICB5bGFiID0gIlRvdGFsIHdpdGhpbi1jbHVzdGVycyBzdW0gb2Ygc3F1YXJlIikKYGBgCgoKIyMjIyB7LX0KCi0tLQoKIyMjIFNwbGl0IGhlYXRtYXBzIHRvIGZpbmQgcGF0dGVybnMgey50YWJzZXR9CgojIyMjIFNlcGFyYXRlIEhlYXRtYXBzIGFjY29yZGluZyB0byBpbmZlY3Rpb24gY29uZGl0aW9uCgpTZXBhcmF0aW5nIHRoZSBjZWxscyBhY2NvcmRpbmcgdG8gZGlmZmVyZW50IGNvbmRpdGlvbnMgc2hvd3MgdGhhdCB0aGVyZSBpcyBhIGJpZ2dlciBkaWZmZXJlbmNlIGJldHdlZW4gY2VsbHMgdHJlYXRlZCB3aXRoIEVGWiB2cy4gdW50cmVhdGVkIGNlbGxzIHRoYW4gYmV0d2VlbiAKaW5mZWN0ZWQgdnMgdW5pbmZlY3RlZCBjZWxscy4gVGhlIEluZitFRlogKGdyZWVuKSBhbmQgVW5pbmYrRUZaIChibHVlKSBzaG93IHZlcnkgc2ltaWxhciBURiBhY3Rpdml0eSBwYXR0ZXJucyBhbmQgdGhlIEluZiAocmVkKSBhbmQgClVuaW5mIChvcmFuZ2UpIHNob3cgdmVyeSBzaW1pbGFyIFRGIGFjdGl2aXR5IHBhdHRlcm5zLiBUaGVzZSBmaW5kaW5ncwpyZWNhcGl0dWxhdGUgdGhlIGZpbmRpbmdzIGZyb20gYWJvdmUuCgoKVHdvIFRGcyBzZWVtIHRvIGJlIG1vcmUgYWN0aXZlIGluIEluZitFRlogYW5kIFVuaW5mK0VGWiBjb21wYXJlZCB0byBJbmYgYW5kIApVbmluZiwgbmFtZWx5IFJVTlgzIGFuZCBKVU5CLiBUaHJlZSBURnMgc2VlbSB0byBiZSBtb3JlIGFjdGl2ZSBpbiBJbmYgYW5kIFVuaW5mCmNvbXBhcmVkIHRvIEluZitFRlogYW5kIFVuaW5mK0VGWiwgbmFtZWx5IE5GQVQ1LCBUQ0Y3TDIgYW5kIENFQlBCLiBJbiBtaWNyb2dsaWEgCmNlbGxzIGluZmxhbW1hdG9yeSBzaWduYWxzIHRyaWdnZXIgTkZBVDUgZXhwcmVzc2lvbiBbQFlhbmddLiBDRUJQQiByZWd1bGF0ZXMgcHJvLWluZmxhbW1hdG9yeSBnZW5lIGV4cHJlc3Npb24gYW5kIGl0cyBleHByZXNzaW9uIGlzIAppbmNyZWFzZWQgaW4gdGhlIGJyYWluIGR1cmluZyBIQU5ELCBob3dldmVyLCB0aGVyZSBpcyBubyBkYXRhIGZyb20gbWljcm9nbGlhIApjZWxscyBbQENhbmNoaV0uIAoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMH0KaHRfY29uZGl0aW9ucyA8LSBIZWF0bWFwKHQoYXVjX210eFssIGF0YWNfdGZzX2RmJG5hbWVdKSwgCiAgICAgICAgI2NvbCA9ICBjb2xvclJhbXBQYWxldHRlKHJldihicmV3ZXIucGFsKG4gPSA3LCBuYW1lID0gIlJkWWxCdSIpKSkoMTAwKSwKICAgICAgICBjb2x1bW5fdGl0bGUgPSAic3BsaXQgYWNjb3JkaW5nIHRvIGluZmVjdGlvbiBjb25kaXRpb24iLAogICAgICAgIHNob3dfY29sdW1uX25hbWVzID0gRkFMU0UsCiAgICAgICAgcm93X25hbWVzX3NpZGUgPSAibGVmdCIsCiAgICAgICAgY29sID0gIGNvbG9yUmFtcFBhbGV0dGUocmV2KGJyZXdlci5wYWwobiA9IDcsIG5hbWUgPSAiUmRZbEJ1IikpKSgxMDApLAogICAgICAgIHRvcF9hbm5vdGF0aW9uID0gSGVhdG1hcEFubm90YXRpb24oY29uZGl0aW9uID0gY29uZGl0aW9ucyRvcmlnLmlkZW50LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSAiY29uZGl0aW9uIiwgY29sID0gbGlzdChjb25kaXRpb24gPSBjKCJVbmluZiIgPSAib3JhbmdlIiwgIkluZitFRloiID0gImdyZWVuIiwgIkluZiIgPSAicmVkIiwgIlVuaW5mK0VGWiIgPSAiYmx1ZSIpKSksCiAgICAgICAgI3Jvd19rbSA9IDIsCiAgICAgICAgI3Jvd19zcGxpdCA9IGF0YWNfdGZzX2RmJGNvbmRpdGlvbiwKICAgICAgICBjb2x1bW5fc3BsaXQgPSB0cmlfbWckb3JpZy5pZGVudCwKICAgICAgICBsZWZ0X2Fubm90YXRpb24gPSByb3dBbm5vdGF0aW9uKFRGX2Zvb3RwcmludGluZyA9IChhdGFjX3Rmc19kZiAlPiUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdChuYW1lLCBjb25kaXRpb24pICU+JQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5fdG9fcm93bmFtZXMoIm5hbWUiKSlbWyJjb25kaXRpb24iXV0sCiAgICAgICAgICAgICAgbmFtZSA9ICJURl9mb290cHJpbnRpbmciLAogICAgICAgICAgICAgIGNvbCA9IGxpc3QoVEZfZm9vdHByaW50aW5nID0gYygidXBfbGF0ZW50IiA9ICJwaW5rIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1cF91bmluZiIgPSAiZGFya2dyZWVuIikpKQogICAgICAgICkKCmh0X2NvbmRpdGlvbnMgCgoKYGBgCgojIyMjIFNwbGl0IEhlYXRtYXBzIGFjY29yZGluZyB0byBURiBiaW5kaW5nIHNjb3JlcyBmcm9tIEFUQUNzZXEgZGF0YQoKU2VwYXJhdGluZyB0aGUgaGVhdG1hcCBhbG9uZyB0aGUgcm93cywgYWNjb3JkaW5nIHRvIFRGcyBlaXRoZXIgbW9yZSBib3VuZCBpbiAKbGF0ZW50bHkgaW5mZWN0ZWQgbWljcm9nbGlhIG9yIG1vcmUgYm91bmQgaW4gdW5pbmZlY3RlZCBwcmltYXJ5IG1pY3JvZ2xpYSwKZG9lcyBub3QgcmVzdWx0IGluIGEgc2VwYXJhdGlvbiBhY2NvcmRpbmcgdG8gdHJlYXRtZW50IHdpdGggRUZaLiAKCldoYXQgb25lIG1pZ2h0IGV4cGVjdCB0byBzZWUsIGlzIHRoYXQgVEZzIG1vcmUgYm91bmQgaW4gdW5pbmZlY3RlZCBwcmltYXJ5IAptaWNyb2dsaWEgd291bGQgYWxzbyBzaG93IGhpZ2hlciBhY3Rpdml0eSBpbiB1bmluZmVjdGVkIGlNZywgd2hpbGUgVEZzIG1vcmUgCmJvdW5kIGluIGxhdGVudGx5IGluZmVjdGVkIHByaW1hcnkgbWljcm9nbGlhIHdvdWxkIHNob3cgaGlnaGVyIGFjdGl2aXR5IGluIApJbmYrRUZaIGlNZy4gSG93ZXZlciwgc3VjaCBhIHBhdHRlcm4gaXMgbm90IGltbWVkaWF0ZWx5IHZpc2libGUgaW4gdGhlIGhlYXRtYXAgCmJlbG93LgoKVGhlIFRGcyBtb3JlIGJvdW5kIGluIGxhdGVudGx5IGluZmVjdGVkIGNlbGxzIGRvIG5vdCBzZWVtIHRvIGNvcnJlbGF0ZSB3aXRoIGFueSBjb25kaXRpb24sIGJ1dCByYXRoZXIgdmFyeSBhIGxvdCBtb3JlIGFjcm9zcyBhbGwgY2VsbHMgdGhhbiB0aGUgVEZzIG1vcmUgYm91bmQgCmluIHVuaW5mZWN0ZWQgY2VsbHMgd2hpY2ggc2hvdyBzb21lIGNvcnJlbGF0aW9uIHdpdGggdGhlIGNvbmRpdGlvbiBhbmQgbGVzcyAKYWNyb3NzIGFsbCBjZWxscy4KCgpgYGB7ciwgZmlnLndpZHRoPTE1LCBmaWcuaGVpZ2h0PTEwfQpodF90ZnMxIDwtIEhlYXRtYXAodChhdWNfbXR4WywgYXRhY190ZnNfZGYkbmFtZV0pLCAKICAgICAgICAjY29sID0gIGNvbG9yUmFtcFBhbGV0dGUocmV2KGJyZXdlci5wYWwobiA9IDcsIG5hbWUgPSAiUmRZbEJ1IikpKSgxMDApLAogICAgICAgIGNvbHVtbl90aXRsZSA9ICJzcGxpdCBhY2NvcmRpbmcgdG8gVEYgYmluZGluZyBzY29yZSBmb3IgbGF0ZW50IHZzLiB1bmluZmVjdGVkIiwKICAgICAgICBzaG93X2NvbHVtbl9uYW1lcyA9IEZBTFNFLAogICAgICAgIHJvd19uYW1lc19zaWRlID0gImxlZnQiLAogICAgICAgICNjb2x1bW5fa20gPSA0LAogICAgICAgIHJvd19zcGxpdCA9IGF0YWNfdGZzX2RmJGNvbmRpdGlvbiwKICAgICAgICBjb2wgPSAgY29sb3JSYW1wUGFsZXR0ZShyZXYoYnJld2VyLnBhbChuID0gNywgbmFtZSA9ICJSZFlsQnUiKSkpKDEwMCksCiAgICAgICAgdG9wX2Fubm90YXRpb24gPSBIZWF0bWFwQW5ub3RhdGlvbihjb25kaXRpb24gPSBjb25kaXRpb25zJG9yaWcuaWRlbnQsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJjb25kaXRpb24iLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbCA9IGxpc3QoY29uZGl0aW9uID0gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYygiVW5pbmYiID0gIm9yYW5nZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW5mK0VGWiIgPSAiZ3JlZW4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkluZiIgPSAicmVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVbmluZitFRloiID0gImJsdWUiKSkpLAogICAgICAgICNjb2x1bW5fc3BsaXQgPSB0cmlfbWckb3JpZy5pZGVudAogICAgICAgIGxlZnRfYW5ub3RhdGlvbiA9IHJvd0Fubm90YXRpb24oVEZfZm9vdHByaW50aW5nID0gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhdGFjX3Rmc19kZiAlPiUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0KG5hbWUsIGNvbmRpdGlvbikgJT4lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uX3RvX3Jvd25hbWVzKCJuYW1lIikpW1siY29uZGl0aW9uIl1dLAogICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJURl9mb290cHJpbnRpbmciLAogICAgICAgICAgICAgICAgICAgICAgY29sID0gbGlzdChURl9mb290cHJpbnRpbmcgPSBjKCJ1cF9sYXRlbnQiID0gInBpbmsiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXBfdW5pbmYiID0gImRhcmtncmVlbiIpKSkKICAgICAgICApCgoKI2h0X2xpc3QgPC0gaHRfY29uZGl0aW9ucyArIGh0X3RmcwojZHJhdyhodF9saXN0KQpgYGAKCgpgYGB7cn0KaHRfdGZzMiA8LSBIZWF0bWFwKHQoYXVjX210eFssIGF0YWNfdGZzX2RmJG5hbWVdKSwgCiAgICAgICAgI2NvbCA9ICBjb2xvclJhbXBQYWxldHRlKHJldihicmV3ZXIucGFsKG4gPSA3LCBuYW1lID0gIlJkWWxCdSIpKSkoMTAwKSwKICAgICAgICBjb2x1bW5fdGl0bGUgPSAic3BsaXQgYWNjb3JkaW5nIHRvIFRGIGJpbmRpbmcgc2NvcmUgZm9yIGxhdGVudCB2cy4gdW5pbmZlY3RlZCIsCiAgICAgICAgc2hvd19jb2x1bW5fbmFtZXMgPSBGQUxTRSwKICAgICAgICByb3dfbmFtZXNfc2lkZSA9ICJsZWZ0IiwKICAgICAgICAjY29sdW1uX2ttID0gNCwKICAgICAgICByb3dfc3BsaXQgPSBhdGFjX3Rmc19kZiRjb25kaXRpb24sCiAgICAgICAgY29sdW1uX3NwbGl0ID0gdHJpX21nQG1ldGEuZGF0YSRvcmlnLmlkZW50LAogICAgICAgIGNvbCA9ICBjb2xvclJhbXBQYWxldHRlKHJldihicmV3ZXIucGFsKG4gPSA3LCBuYW1lID0gIlJkWWxCdSIpKSkoMTAwKSwKICAgICAgICB0b3BfYW5ub3RhdGlvbiA9IEhlYXRtYXBBbm5vdGF0aW9uKGNvbmRpdGlvbiA9IGNvbmRpdGlvbnMkb3JpZy5pZGVudCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gImNvbmRpdGlvbiIsIGNvbCA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QoY29uZGl0aW9uID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMoIlVuaW5mIiA9ICJvcmFuZ2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW5mK0VGWiIgPSAiZ3JlZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkluZiIgPSAicmVkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVbmluZitFRloiID0gImJsdWUiKSkpLAogICAgICAgICNjb2x1bW5fc3BsaXQgPSB0cmlfbWckb3JpZy5pZGVudAogICAgICAgIGxlZnRfYW5ub3RhdGlvbiA9IHJvd0Fubm90YXRpb24oVEZfZm9vdHByaW50aW5nID0gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhdGFjX3Rmc19kZiAlPiUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0KG5hbWUsIGNvbmRpdGlvbikgJT4lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uX3RvX3Jvd25hbWVzKCJuYW1lIikpW1siY29uZGl0aW9uIl1dLAogICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJURl9mb290cHJpbnRpbmciLAogICAgICAgICAgICAgICAgICAgICAgY29sID0gbGlzdChURl9mb290cHJpbnRpbmcgPSBjKCJ1cF9sYXRlbnQiID0gInBpbmsiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXBfdW5pbmYiID0gImRhcmtncmVlbiIpKSkKICAgICAgICApCmBgYAoKYGBge3IsIGZpZy53aWR0aD0xNSwgZmlnLmhlaWdodD0xMH0KaHRfbGlzdCA8LSBodF90ZnMxICsgaHRfdGZzMgpkcmF3KGh0X2xpc3QsIGh0X2dhcCA9IHVuaXQoMiwgImNtIikpCgpgYGAKCi0tLQoKIyMgVEYgYWN0aXZpdHkgZGlmZmVyZW5jZXMgYmV0d2VlbiBjbHVzdGVycwoKVG8gcXVhbnRpdGF0aXZlbHkgaW52ZXN0aWdhdGUgd2hldGhlciB3ZSBjYW4gZmluZCBURnMgd2hpY2ggaGF2ZSBzaWduaWZpY2FudGx5CmRpZmZlcmVudCBhY3Rpdml0eSBiZXR3ZWVuIGNsdXN0ZXJzIHdlIGNhbiB1c2UgS3J1c2thbC1XYWxsaXMgdGVzdCBhbmQgCnBhaXJ3aXNlIHdpbGNveCB0ZXN0IGFzIGEgcG9zdGhvYyBhbmFseXNpcy4gMjA2IFRGcyBoYXZlIGRpZmZlcmVudCBhY2l2aXR5CmJldHdlZW4gdGhlIGNsdXN0ZXJzLiAKCmBgYHtyfQpwX3ZhbHVlcyA8LSBtYXAoc2VxLmludCgxOmxlbmd0aChjb2xuYW1lcyhhdWNfbXR4KSkpLCBmdW5jdGlvbihuKXsKICB0ZiA8LSBjb2xuYW1lcyhhdWNfbXR4KVtuXQogICNwcmludCh0ZikKICAjcHJpbnQodHJpY3VsdHVyZUBtZXRhLmRhdGFbdGZdKQogIHBfdmFsdWVzIDwtIHVubGlzdChrcnVza2FsLnRlc3QocHVsbCh0cmlfbWdAbWV0YS5kYXRhW3RmXSkgfiBvcmlnLmlkZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpX21nQG1ldGEuZGF0YSkpWyJwLnZhbHVlIl0KICAjcHJpbnQocF92YWx1ZXMpCiAgI2xpc3QodGYgPSB0ZiwgcF92YWx1ZSA9IHBfdmFsdWVzKQp9KQoKIyBhZGp1c3QgZm9yIG11bHRpcGxlIGh5cG90aGVzaXMgdGVzdGluZwphZGpfcF92YWx1ZXMgPC0gcC5hZGp1c3QoYXMubnVtZXJpYyh1bm5hbWUodW5saXN0KHBfdmFsdWVzKSkpLCBtZXRob2QgPSAiZmRyIikKCgojIGhvdyBtYW55IHRyYW5zY3JpcHRpb24gZmFjdG9ycyBhcmUgc2lnbmlmaWNhbnRseSBkaWZmZXJlbnQgYmV0d2VlbiB0aGUgY2x1c3RlcnM/CiNsZW5ndGgoYWRqX3BfdmFsdWVzW2Fkal9wX3ZhbHVlczwwLjAxXSkKCmBgYAoKIyMjIFBvc3Rob2MgYW5hbHlzaXMgey50YWJzZXR9CgojIyMjIG1vcmUgYm91bmQgaW4gbGF0ZW50IGluZmVjdGlvbgoKKipCb3hwbG90cyBvZiBURnMgYWN0aXZpdHkgYWNyb3NzIGNvbmRpdGlvbnMgb2YgVEZzIG1vcmUgYm91bmQgaW4gbGF0ZW50IGluZmVjdGlvbioqCgpBbW9uZyB0aGUgVEZzIG1vcmUgYm91bmQgaW4gbGF0ZW50bHkgaW5mZWN0ZWQgY2VsbHMgdGhlcmUgaXMgYSBkaWZmZXJlbmNlIGluIAphY3Rpdml0eSBmb3IgUkVTVCBhbmQgWkVCMSwgYnV0IG9ubHkgYmV0d2VlbiB0cmVhdG1lbnQgY29uZGl0aW9ucyBhbmQgbm90IApiZXR3ZWVuIGluZmVjdGlvbiBjb25kaXRpb25zLiBGb3IgdGhlIG90aGVyIHRocmVlIFRGcyB0aGVyZSBhcmUgbm8gZGlmZmVyZW5jZXMgCm9yIHBhdHRlcm5zLiAKCmBgYHtyLCBmaWcud2lkdGg9MTUsIGZpZy5oZWlnaHQ9OH0KCmJveHBsb3RfbGlzdCA8LSBtYXAodXBfbGF0ZW50LCBmdW5jdGlvbih0ZikgewogIGdncGxvdCgpICsKICAgIGdlb21fYm94cGxvdChhZXMoeCA9IHRyaV9tZ0BtZXRhLmRhdGEgJT4lIHB1bGwoIm9yaWcuaWRlbnQiKSwKICAgICAgICAgICAgICAgICAgICAgeSA9IHRyaV9tZ0BtZXRhLmRhdGEgJT4lIHB1bGwodGYpLCAKICAgICAgICAgICAgICAgICBmaWxsID0gdHJpX21nQG1ldGEuZGF0YSAlPiUgcHVsbCgib3JpZy5pZGVudCIpKSkgKwogICAgc3RhdF9wdmFsdWVfbWFudWFsKHRyaV9tZ0BtZXRhLmRhdGEgJT4lIAogICAgICAgICAgICAgICAgICAgICAgICAgcGFpcndpc2Vfd2lsY294X3Rlc3QoYXMuZm9ybXVsYShwYXN0ZTAodGYsICIgfiBvcmlnLmlkZW50IikpKSAlPiUgCiAgICAgICAgICAgICAgICAgICAgICAgICBhZGRfeHlfcG9zaXRpb24oKSkgKwogICAgeGxhYigiQ29uZGl0aW9uIikgKwogICAgeWxhYihwYXN0ZTAodGYpKSArCiAgICBndWlkZXMoZmlsbCA9IGd1aWRlX2xlZ2VuZCh0aXRsZSA9ICJjb25kaXRpb24iKSkKfSkKCmRvLmNhbGwoZ3JpZEV4dHJhOjpncmlkLmFycmFuZ2UsIGMoYm94cGxvdF9saXN0LCBuY29sID0gMywgbnJvdyA9IDIpKQpgYGAKCiMjIyMgbW9yZSBib3VuZCBpbiB1bmluZmVjdGVkIAoKKipCb3hwbG90cyBvZiBURnMgYWN0aXZpdHkgYWNyb3NzIGNvbmRpdGlvbnMgb2YgVEZzIG1vcmUgYm91bmQgaW4gdW5pbmZlY3RlZCBwcmltYXJ5IG1pY3JvZ2xpYSoqCgpJbiB0aGUgcGxvdHMgYmVsb3cgdGhlIHRyZW5kIG9mIFRGIGFjdGl2aXR5IGJlaW5nIG5lZ2F0aXZlbHkgY29ycmVsYXRlZCBiZXR3ZWVuCnRyZWF0ZWQgYW5kIHVudHJlYXRlZCBjZWxscywgaW5kZXBlbmRlbnRseSBvZiB0aGUgaW5mZWN0aW9uIHN0YXR1cyBjYW4gYmUgc2VlbiBmb3IKc29tZSBURnMsIGZvciBleGFtcGxlIENFQlBCIGFuZCBNRUYyQy4gRm9yIG90aGVyIFRGcyB0aGVyZSBpcyBubyBkaWZmZXJlbmNlIApiZXR3ZWVuIGVpdGhlciBpbmZlY3Rpb24gc3RhdHVzIG9yIHRyZWF0bWVudCwgZm9yIGV4YW1wbGUgQ1JFQjEgYW5kIEVUUzEuCgpZZXQsIGV2ZW4gdGhvdWdoIHRoZSBlZmZlY3Qgb2YgdHJlYXRtZW50IGlzIG1vc3QgcHJvbWluZW50LCBzb21lIFRGcyBhcmUgCmFkZGl0aW9uYWxseSBmb2xsb3dpbmcgdGhlIHBhdHRlcm4gb2YgdGhlIGZvb3RwcmludGluZy4gRm9yIGV4YW1wbGUsIFJVTlgzLCBDVVgxLCBNRUYyQSwgWVkxIGFuZCBNRUYyQyBhcmUgbW9yZSBhY3RpdmUgaW4gdW5pbmZlY3RlZCBjZWxscyB0aGFuIGluIGluZmVjdGVkIGNlbGxzLCBidXQgbW9yZSBhY3RpdmUgaW4gaW5mZWN0ZWQgKyBFRlogY2VsbHMgdGhhbiB1bmluZmVjdGVkICsgRUZaIGNlbGxzLiBUaGVzZSBURnMsIHRoZXJlZm9yZSwgZm9sbG93IHRoZSBmb290cHJpbmluZyBwYXR0ZXJuIGF0IGxlYXN0IGluIHRoZSB1bnRyZWF0ZWQgY29uZGl0b24uIENvbnZlcnNlbHksIE5GQVQ1LCBUQ0Y3TDIgYW5kIENFQlBCIGFyZSAKbW9yZSBhY3RpdmUgaW4gaW5mZWN0ZWQgdGhhbiBpbiB1bmluZmVjdGVkIGNlbGxzLCBidXQgbW9yZSBib3VuZCBpbiB1bmluZmVjdGVkICsKRUZaIGNlbGxzIHRoYW4gaW4gaW5mZWN0ZWQgKyBFRlogY2VsbHMuIEl0IGlzIHVuY2xlYXIgd2h5IHRoZSBwYXR0ZXJucyBhcmUgY29udHJhcnkKdG8gZWFjaCBvdGhlciBiZXR3ZWVuIHRoZSB0cmVhdG1lbnQgY29uZGl0aW9ucy4gSlVOQiBhbmQgTkZZQiBhcmUgdGhlIG9ubHkgdHdvIApURnMgd2hpY2ggYXJlIG1vcmUgYm91bmQgaW4gdW5pbmZlY3RlZCArLy0gRUZaIGNvbXBhcmVkIHRvIGluZmVjdGVkICsvLSBFRlosIHdoaWNoCm1lYW5zIHRoZXkgYXJlIGZvbGxvd2luZyB0aGUgZm9vdHByaW50aW5nIHBhdHRlcm4gaW5kZXBlbmRlbnRseSBvZiB0aGUgdHJlYXRtZW50CmNvbmRpdGlvbi4KCk9uZSBhc3N1bXB0aW9uIGlzIHRoYXQgVEZzIHdoaWNoIGFyZSBtYXJrZXJzIG9mIG1pY3JvZ2xpYSBjZWxscyBtaWdodCAKYmUgbW9yZSBvciBsZXNzIGFjdGl2ZSBkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgY2VsbHMgd2VyZSB0cmVhdGVkIHdpdGggRUZaIG9yIApub3QuIEFuIGFyZ3VtZW50IGFnYWluc3QgdGhpcyBhc3N1bXB0aW9uIGlzIHRoYXQgYm90aCBDRUJQQiBhbmQgTUVGMkMgYXJlIAp0eXBpY2FsbHkgZXhwcmVzc2VkIGluIG1pY3JvZ2xpYSwgeWV0IHdlIG9ic2VydmUgYW4gb3Bwb3NpdGUgdHJlbmQuIENFQlBCIGlzIG1vcmUgYWN0aXZlIGluIEluZiBhbmQgVW5pbmYgY2VsbHMgdGhhbiBpbiBJbmYrRUZaIGFuZCBVbmluZitFRlogY2VsbHMsIHdoaWxlIE1FRjJDIGlzIG1vcmUgYWN0aXZlIGluIEluZitFRlogYW5kIFVuaW5mK0VGWiBjZWxscyB0aGFuIAppbiBJbmYgYW5kIFVuaW5mIGNlbGxzLgoKCmBgYHtyLCBmaWcud2lkdGg9MjAsIGZpZy5oZWlnaHQ9MTV9CgoKYm94cGxvdF9saXN0IDwtIG1hcCh1cF91bmluZiwgZnVuY3Rpb24odGYpIHsKICBnZ3Bsb3QoKSArCiAgICBnZW9tX2JveHBsb3QoYWVzKHggPSB0cmlfbWdAbWV0YS5kYXRhICU+JSBwdWxsKCJvcmlnLmlkZW50IiksCiAgICAgICAgICAgICAgICAgICAgIHkgPSB0cmlfbWdAbWV0YS5kYXRhICU+JSBwdWxsKHRmKSwgCiAgICAgICAgICAgICAgICAgZmlsbCA9IHRyaV9tZ0BtZXRhLmRhdGEgJT4lIHB1bGwoIm9yaWcuaWRlbnQiKSkpICsKICAgIHN0YXRfcHZhbHVlX21hbnVhbCh0cmlfbWdAbWV0YS5kYXRhICU+JSAKICAgICAgICAgICAgICAgICAgICAgICAgIHBhaXJ3aXNlX3dpbGNveF90ZXN0KGFzLmZvcm11bGEocGFzdGUwKHRmLCAiIH4gb3JpZy5pZGVudCIpKSkgJT4lIAogICAgICAgICAgICAgICAgICAgICAgICAgYWRkX3h5X3Bvc2l0aW9uKCkpICsKICAgIHhsYWIoIkNvbmRpdGlvbiIpICsKICAgIHlsYWIocGFzdGUwKHRmKSkgKwogICAgZ3VpZGVzKGZpbGwgPSBndWlkZV9sZWdlbmQodGl0bGUgPSAiY29uZGl0aW9uIikpCn0pCgpkby5jYWxsKGdyaWRFeHRyYTo6Z3JpZC5hcnJhbmdlLCBjKGJveHBsb3RfbGlzdCwgbmNvbCA9IDUsIG5yb3cgPSA0KSkKCiNhbm5vdGF0ZV9maWd1cmUoZmlndXJlLAogIyAgICAgICAgICAgICAgIHRvcCA9IHRleHRfZ3JvYigiVEZzIGFjdGl2aXR5IGFjcm9zcyBjb25kaXRpb25zIGZvciBURnMgbW9yZSBib3VuZCBpbiB1bmluZmVjdGVkIHByaW1hcnkgbWljcm9nbGlhIiwgc2l6ZSA9IDIwKSkKCmBgYAoKLS0tCgoKIyMgQ29ycmVsYXRpb25zIGJldHdlZW4gY29uZGl0aW9ucyB7LnRhYnNldH0KClRoZSBjb3JyZWxhdGlvbiBwbG90IGFuZCBzY2F0dGVyIG1hdHJpeCBiZWxvdyBmdXJ0aGVyIGVtcGhhc2l6ZXMgd2hhdCBoYXMKYWxyZWFkeSBiZWNvbWUgZXZpZGVudCBmcm9tIHRoZSBwcmV2aW91cyBhbmFseXNpcy4gSW5mIGFuZCBVbmluZiBpTWcgc2hvdyBhIApoaWdoZXIgY29ycmVsYXRpb24gd2l0aCBlYWNoIG90aGVyIHRoYW4gZm9yIGV4YW1wbGUgVW5pbmYrRUZaIGFuZCBVbmluZi4gVGhlIApJbmYrRUZaIGlNZyBoYXJkbHkgY29ycmVsYXRlIHdpdGggdGhlIEluZiBpTWcsIGJ1dCBzaG93IGEgaGlnaGVyIGNvcnJlbGF0aW9uIAp3aXRoIHRoZSBVbmluZitFRlouIFRoZSBlZmZlY3Qgb2YgRUZaIHRyZWF0bWVudCBzZWVtcyB0byBiZSBzdHJvbmdlciB0aGFuIHRoZSAKZWZmZWN0IG9mIHRoZSBpbmZlY3Rpb24uCgojIyMgQ29ycmVsYXRpb24gbWF0cml4CgpgYGB7cn0KY29yX210eCA8LSB0cmlfbWdAbWV0YS5kYXRhICU+JSAKICByb3duYW1lc190b19jb2x1bW4oImNlbGwiKSAlPiUKICBzZWxlY3QoYygiY2VsbCIsICJvcmlnLmlkZW50IiwgY29sbmFtZXMoYXVjX210eCkpKSAlPiUKICBncm91cF9ieShvcmlnLmlkZW50KSAlPiUKICBzdW1tYXJpemVfaWYoaXMubnVtZXJpYywgbWVhbikgJT4lIAogIGdhdGhlcihURiwgdmFsdWUsIC1vcmlnLmlkZW50KSAlPiUgCiAgc3ByZWFkKG9yaWcuaWRlbnQsIHZhbHVlKSAlPiUgCiAgY29sdW1uX3RvX3Jvd25hbWVzKCJURiIpICU+JSBjb3IoKQoKdGVzdENvciA8LSBjb3IubXRlc3QoY29yX210eCwgY29uZi5sZXZlbCA9IDAuOTUpCgojIHBsb3QgY29ycmVsYXRpb25zCiMgcC5tYXQgPSBtYXRyaXggb2YgcF92YWx1ZXMKCgpjb3JycGxvdChjb3JfbXR4LAogICAgICAgICAjbWV0aG9kID0gImNvbG9yIiwgCiAgICAgICAgIG9yZGVyID0gImhjbHVzdCIsIAogICAgICAgICBhZGRyZWN0ID0gNCwgIyBhZGQgYm94ZXMgCiAgICAgICAgIHAubWF0ID0gdGVzdENvciRwLCAKICAgICAgICAgI3NpZy5sZXZlbCA9IC4wNSwKICAgICAgICAgaW5zaWcgPSAicC12YWx1ZSIsIAogICAgICAgICB0bC5jb2wgPSAiYmxhY2siKQoKYGBgCgojIyMgU2NhdHRlciBtYXRyaXgKCmBgYHtyLCBmaWcud2lkdGg9MTIsIGZpZy5oZWlnaHQ9OH0KdHJpX21nQG1ldGEuZGF0YSAlPiUgCiAgcm93bmFtZXNfdG9fY29sdW1uKCJjZWxsIikgJT4lCiAgc2VsZWN0KGMoImNlbGwiLCAib3JpZy5pZGVudCIsIGNvbG5hbWVzKGF1Y19tdHgpKSkgJT4lCiAgZ3JvdXBfYnkob3JpZy5pZGVudCkgJT4lCiAgc3VtbWFyaXplX2lmKGlzLm51bWVyaWMsIG1lYW4pICU+JSAKICBnYXRoZXIoVEYsIHZhbHVlLCAtb3JpZy5pZGVudCkgJT4lIAogIHNwcmVhZChvcmlnLmlkZW50LCB2YWx1ZSkgJT4lIAogIGNvbHVtbl90b19yb3duYW1lcygiVEYiKSAlPiUgR0dhbGx5OjpnZ3BhaXJzKCkgKwogICAgbGFicyh0aXRsZSA9ICJTY2F0dGVyIG1hdHJpeCBmb3IgZGlmZmVyZW50IGNvbmRpdGlvbnMiKQpgYGAKCi0tLQoKCiMjIENvcnJlbGF0aW9uIGJldHdlZW4gVEZzIGRpZmZlcmVudGlhdGluZyBNeWVsb2lkMiBjbHVzdGVycyB7LnRhYnNldH0KClRoZXNlIFRGcyB3ZXJlIGRpZmZlcmVudGlhbGx5IGFjdGl2ZSBiZXR3ZWVuIHRoZSB0aHJlZSBrLW1lYW5zIGNsdXN0ZXJzIGluCk15ZWxvaWQyIGNlbGxzIGZyb20gSElWLWluZmVjdGVkIHBhdGllbnRzLiBBY3Jvc3MgdGhyZWUgZGlmZmVyZW50IHBhdGllbnRzCnRoZXkgc2hvd2VkIGNvcnJlbGF0ZWQgY2hhbmdlcyBpbiBhY3Rpdml0eS4gWVkxLCBFVFMxIGFuZCBSRVNUIHdlcmUgcG9zaXRpdmVseQpjb3JyZWxhdGVkIHdpdGggZWFjaCBvdGhlciBhbmQgbmVnYXRpdmVseQpjb3JyZWxhdGVkIHdpdGggTUVGMkEsIEVUVjYsIEpVTkIsIE1FRjJDLCBNWEkxIGFuZCBDRUJQQi4gVGhlIHBhdHRlcm4gb2JzZXJ2ZWQgZm9yIHRoZSBpTWcgZnJvbSB0aGUgdHJpY3VsdHVyZSBkYXRhIHNldCBkb2VzIG5vdApyZXNlbWJsZSB0aGUgcGF0dGVybiBvYnNlcnZlZCBpbiBNeWVsb2lkMiBjZWxscy4gQSBzdXByaXNpbmcgb2JzZXJ2YXRpb24gaXMgdGhhdAp0aGVyZSBpcyBwYWlycyBvZiBURnMgd2hpY2ggYXJlIGhpZ2hseSBjb3JyZWxhdGVkLCBmb3IgZXhhbXBsZSBFVFMxIGFuZCBFVFY2IG9yIApSRVNUIGFuZCBDRUJQQi4gCgojIyMgQ29ycmVsYXRpb24gTWF0cml4CgpgYGB7cn0KaW50ZXJzZWN0X2NzZiA8LSByZWFkLnRhYmxlKCIvbWVkaWEvYWctY2hlcnJtYW5uL2ttaWt1bGlrL0hJVl9taWNyb2dsaWEvZGF0YS9hdGFjX2ludGVyc2VjdF9URnNfZGlmZmVyZW50X2Fjcm9zc19wYXRpZW50c18zX2NsdXN0ZXJzIikKCgpjb3JfbXR4IDwtIHRyaV9tZ0BtZXRhLmRhdGEgJT4lIAogIHJvd25hbWVzX3RvX2NvbHVtbigiY2VsbCIpICU+JSAKICBzZWxlY3QoYygiY2VsbCIsICJvcmlnLmlkZW50IiwgaW50ZXJzZWN0X2NzZiR4W2ludGVyc2VjdF9jc2YkeCAlaW4lIGNvbG5hbWVzKGF1Y19tdHgpXSkpICU+JSAjIG9ubHkgVEZzIHdpdGggZGlmZmVyZW50aWFsIGJpbmRpbmcgc2NvcmVzIGZyb20gQVRBQ3NlcQogIGdyb3VwX2J5KG9yaWcuaWRlbnQpICU+JQogIHN1bW1hcml6ZV9pZihpcy5udW1lcmljLCBtZWFuKSAlPiUgCiAgY29sdW1uX3RvX3Jvd25hbWVzKCJvcmlnLmlkZW50IikgJT4lIGNvcigpCgp0ZXN0Q29yIDwtIGNvci5tdGVzdChjb3JfbXR4LCBjb25mLmxldmVsID0gMC45NSkKCmNvcnJwbG90KGNvcl9tdHgsCiAgICAgICAgICNtZXRob2QgPSAiY29sb3IiLAogICAgICAgICBvcmRlciA9ICJoY2x1c3QiLCAKICAgICAgICAgYWRkcmVjdCA9IDQsICMgYWRkIGJveGVzIAogICAgICAgICBwLm1hdCA9IHRlc3RDb3IkcCwKICAgICAgICAgaW5zaWcgPSAicC12YWx1ZSIpCmBgYAoKIyMjIFNjYXR0ZXIgTWF0cml4CgpgYGB7ciwgZmlnLmhlaWdodD0xMCwgZmlnLndpZHRoPTE1fQp0cmlfbWdAbWV0YS5kYXRhICU+JSAKICByb3duYW1lc190b19jb2x1bW4oImNlbGwiKSAlPiUgCiAgc2VsZWN0KGMoImNlbGwiLCAib3JpZy5pZGVudCIsIGludGVyc2VjdF9jc2YkeFtpbnRlcnNlY3RfY3NmJHggJWluJSBjb2xuYW1lcyhhdWNfbXR4KV0pKSAlPiUgIyBvbmx5IFRGcyB3aXRoIGRpZmZlcmVudGlhbCBiaW5kaW5nIHNjb3JlcyBmcm9tIEFUQUNzZXEKICBncm91cF9ieShvcmlnLmlkZW50KSAlPiUKICBzdW1tYXJpemVfaWYoaXMubnVtZXJpYywgbWVhbikgJT4lIAogIGNvbHVtbl90b19yb3duYW1lcygib3JpZy5pZGVudCIpICU+JQogIEdHYWxseTo6Z2dwYWlycygpICsKICBsYWJzKHRpdGxlID0gIlNjYXR0ZXIgTWF0cml4IGZvciBkaWZmZXJlbnQgVEZzIikKYGBgCgotLS0KCiMgQ29uY2x1c2lvbnMKCkdSTiBpbmZlcmVuY2UgYmFzZWQgb24gZ2VuZSBleHByZXNzaW9uIGluIGlNZyBkaWQgbm90IHNob3cgdmVyeSAKY2xlYXIgcmVzdWx0cy4gMjUgb2YgdGhlIFRGcyB3ZXJlIGFsc28gZm91bmQgdG8gaGF2ZSBkaWZmZXJlbnRpYWwgYmluZGluZyBzY29yZXMgCmluIHRoZSBDMjAgY2VsbCBsaW5lLCBidXQgdGhlIHBhdHRlcm5zIGluIGFjdGl2aXR5IHdlcmUgbm90IGFsd2F5cyBjb25zaXN0ZW50LiBTb21lIApURnMgbW9yZSBib3VuZCBpbiB1bmluZmVjdGVkIGNlbGxzIGZvbGxvd2VkIHRoZSBwYXR0ZXJuIGZvdW5kIGJ5IGZvb3RwcmludGluZywgYnV0Cm9ubHkgZm9yIGVpdGhlciB0aGUgdHJlYXRlZCBjZWxscyBvciB0aGUgdW50cmVhdGVkIGNlbGxzLCBidXQgbm90IGZvciBib3RoLiBGb3IgdGhlCmZpdmUgVEZzIG1vcmUgYm91bmQgaW4gbGF0ZW50IGluZmVjdGlvbiBpbiBDMjAgY2VsbHMsIG5vIHBhdHRlcm4gd2FzIG9ic2VydmVkLiBBbHNvLCAKdGhlIGNvcnJlbGF0aW9uIGluIGFjdGl2aXR5IG9mIHRoZSB0cmVlIFRGcyBZWTEsIEVUUzEgYW5kIFJFU1QsIGZvdW5kIGluIE15ZWxvaWQyIGNlbGxzLCAKd2FzIG5vdCBmb3VuZCBpbiBpTWcgd2hpY2ggd2Vha2VucyB0aGUgaHlwb3RoZXNpcyB0aGF0IHRoZSBjbHVzdGVyIG9mIGludGVyZXN0IGZvdW5kCmluIE15ZWxvaWQyIGNlbGxzIG1pZ2h0IGJlIGxhdGVudGx5IGluZmVjdGVkIGNlbGxzLiBUaGUgaW50ZXJwcmV0YXRpb24gb2YgdGhlIApyZXN1bHRzIGlzIGRpZmZpY3VsdCBkdWUgdG8gdGhlIGZhY3QgdGhhdCB0aGUgZWZmZWN0IG9mIEVGWiB0cmVhdG1lbnQgc2VlbXMKdG8gb3ZlcnNoYWRvdyBhbnkgZWZmZWN0IG9mIHRoZSBISVYgaW5mZWN0aW9uLiBUaGlzIHN0cm9uZyBlZmZlY3Qgb2YgdGhlIGRydWdzCnNob3VsZCBiZSBrZXB0IGluIG1pbmQgaW4gYW55IGZ1cnRoZXIgYW5hbHlzaXMsIHNpbmNlIGl0IG1ha2VzIHRoZSBjb21wYXJpc29uIGJldHdlZW4KY2VsbHMgZnJvbSBwYXRpZW50cyBhbmQgZnJvbSBjZWxsIGN1bHR1cmUgcGFydGljdWxhcmx5IGhhcmQuIERydWcgY29uY2VudHJhdGlvbnMgCmluIHRoZSBibG9vZCBhbmQgZXZlbiBtb3JlIHNvIGluIHRoZSBDU0YgYXJlIHZlcnkgbG93IGFuZCB0aGUgZGlyZWN0IGFwcGxpY2F0aW9uIG9mCmRydWdzIGluIGNlbGwgY3VsdHVyZSBtaWdodCBub3QgcmVzZW1ibGUgdGhlIHBoeXNpb2xvZ2ljYWwgZWZmZWN0IHZlcnkgd2VsbC4gCgoKIyBSZWZlcmVuY2Vz</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Triculture_dataset_GRN_with_Scenic.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
